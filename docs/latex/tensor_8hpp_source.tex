\doxysection{tensor.\+hpp}
\hypertarget{tensor_8hpp_source}{}\label{tensor_8hpp_source}\mbox{\hyperlink{tensor_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#include\ <iostream>}}
\DoxyCodeLine{00002\ \textcolor{preprocessor}{\#include\ <stdexcept>}}
\DoxyCodeLine{00003\ \textcolor{preprocessor}{\#include\ <random>}}
\DoxyCodeLine{00004\ \textcolor{preprocessor}{\#include\ <cassert>}}
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#include\ <vector>}}
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#include\ <algorithm>}}
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#include\ <cstdint>}}
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#include\ <cmath>}}
\DoxyCodeLine{00009\ \textcolor{preprocessor}{\#include\ <array>}}
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#include\ <arm\_neon.h>}}
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#include\ <type\_traits>}}
\DoxyCodeLine{00012\ \textcolor{preprocessor}{\#include\ <immintrin.h>}}
\DoxyCodeLine{00013\ \textcolor{preprocessor}{\#include\ <omp.h>}}
\DoxyCodeLine{00014\ }
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ <\_\_iterator/iterator\_traits.h>}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ <\_\_iterator/reverse\_iterator.h>}}
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#include\ <\_\_iterator/wrap\_iter.h>}}
\DoxyCodeLine{00018\ }
\DoxyCodeLine{00019\ }
\DoxyCodeLine{00020\ \textcolor{comment}{/*}}
\DoxyCodeLine{00021\ \textcolor{comment}{\ \ tensor\ synopsis}}
\DoxyCodeLine{00022\ \textcolor{comment}{}}
\DoxyCodeLine{00023\ \textcolor{comment}{template<class\ \_Tp>}}
\DoxyCodeLine{00024\ \textcolor{comment}{class\ tensor}}
\DoxyCodeLine{00025\ \textcolor{comment}{\{}}
\DoxyCodeLine{00026\ \textcolor{comment}{\ \ \ public:}}
\DoxyCodeLine{00027\ \textcolor{comment}{\ \ \ \ typedef\ tensor\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_self;}}
\DoxyCodeLine{00028\ \textcolor{comment}{\ \ \ \ typedef\ \_Tp\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ value\_type;}}
\DoxyCodeLine{00029\ \textcolor{comment}{\ \ \ \ typedef\ int64\_t\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ index\_type;}}
\DoxyCodeLine{00030\ \textcolor{comment}{\ \ \ \ typedef\ std::vector<index\_type>\ shape\_type;}}
\DoxyCodeLine{00031\ \textcolor{comment}{\ \ \ \ typedef\ value\_type\&\ \ \ \ \ \ \ \ \ \ \ \ \ reference;}}
\DoxyCodeLine{00032\ \textcolor{comment}{\ \ \ \ typedef\ const\ value\_type\&\ \ \ \ \ \ \ const\_reference;}}
\DoxyCodeLine{00033\ \textcolor{comment}{\ \ \ \ typedef\ value\_type*\ \ \ \ \ \ \ \ \ \ \ \ \ pointer;}}
\DoxyCodeLine{00034\ \textcolor{comment}{\ \ \ \ typedef\ const\ pointer\ \ \ \ \ \ \ \ \ \ \ const\_pointer;}}
\DoxyCodeLine{00035\ \textcolor{comment}{\ \ \ \ typedef\ std::vector<value\_type>\ data\_t;}}
\DoxyCodeLine{00036\ \textcolor{comment}{\ \ \ \ typedef\ const\ data\_t\ \ \ \ \ \ \ \ \ \ \ \ const\_data\_container;}}
\DoxyCodeLine{00037\ \textcolor{comment}{}}
\DoxyCodeLine{00038\ \textcolor{comment}{\ \ \ \ typedef\ std::\_\_wrap\_iter<typename\ std::allocator\_traits<std::allocator<\_Tp>>::pointer>}}
\DoxyCodeLine{00039\ \textcolor{comment}{\ \ \ \ \ \ \ \ \_\_iterator;}}
\DoxyCodeLine{00040\ \textcolor{comment}{\ \ \ \ typedef\ std::\_\_wrap\_iter<typename\ std::allocator\_traits<std::allocator<\_Tp>>::const\_pointer>}}
\DoxyCodeLine{00041\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_const\_iterator;}}
\DoxyCodeLine{00042\ \textcolor{comment}{\ \ \ \ typedef\ std::reverse\_iterator<\_\_iterator>\ \ \ \ \ \ \ reverse\_iterator;}}
\DoxyCodeLine{00043\ \textcolor{comment}{\ \ \ \ typedef\ std::reverse\_iterator<\_\_const\_iterator>\ const\_reverse\_iterator;}}
\DoxyCodeLine{00044\ \textcolor{comment}{}}
\DoxyCodeLine{00045\ \textcolor{comment}{}}
\DoxyCodeLine{00046\ \textcolor{comment}{\ \ \ private:}}
\DoxyCodeLine{00047\ \textcolor{comment}{\ \ \ \ data\_t\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_data\_;}}
\DoxyCodeLine{00048\ \textcolor{comment}{\ \ \ \ shape\_type\ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_shape\_;}}
\DoxyCodeLine{00049\ \textcolor{comment}{\ \ \ \ std::vector<index\_type>\ \_\_strides\_;}}
\DoxyCodeLine{00050\ \textcolor{comment}{}}
\DoxyCodeLine{00051\ \textcolor{comment}{\ \ \ public:}}
\DoxyCodeLine{00052\ \textcolor{comment}{\ \ \ \ tensor()\ =\ default;}}
\DoxyCodeLine{00053\ \textcolor{comment}{}}
\DoxyCodeLine{00054\ \textcolor{comment}{\ \ \ \ explicit\ tensor(const\ shape\_type\ \_\_sh,\ const\ value\_type\ \_\_v);}}
\DoxyCodeLine{00055\ \textcolor{comment}{\ \ \ \ explicit\ tensor(const\ shape\_type\ \_\_sh);}}
\DoxyCodeLine{00056\ \textcolor{comment}{\ \ \ \ explicit\ tensor(const\ data\_t\ \_\_d,\ const\ shape\_type\ \_\_sh);}}
\DoxyCodeLine{00057\ \textcolor{comment}{\ \ \ \ explicit\ tensor(const\ tensor\&\ \_\_t);}}
\DoxyCodeLine{00058\ \textcolor{comment}{}}
\DoxyCodeLine{00059\ \textcolor{comment}{\ \ \ \ tensor(tensor\&\&\ \_\_t)\ noexcept;}}
\DoxyCodeLine{00060\ \textcolor{comment}{\ \ \ \ tensor(const\ shape\_type\ \_\_sh,\ std::initializer\_list<value\_type>\ init\_list);}}
\DoxyCodeLine{00061\ \textcolor{comment}{\ \ \ \ tensor(const\ shape\_type\&\ \_\_sh,\ const\ tensor\&\ \_\_other);}}
\DoxyCodeLine{00062\ \textcolor{comment}{}}
\DoxyCodeLine{00063\ \textcolor{comment}{\ \ \ private:}}
\DoxyCodeLine{00064\ \textcolor{comment}{\ \ \ \ class\ \_\_destroy\_tensor}}
\DoxyCodeLine{00065\ \textcolor{comment}{\ \ \ \ \{}}
\DoxyCodeLine{00066\ \textcolor{comment}{\ \ \ \ \ \ \ public:}}
\DoxyCodeLine{00067\ \textcolor{comment}{\ \ \ \ \ \ \ \ \_\_destroy\_tensor(tensor\&\ \_\_tens);}}
\DoxyCodeLine{00068\ \textcolor{comment}{\ \ \ \ \ \ \ \ void\ operator()();}}
\DoxyCodeLine{00069\ \textcolor{comment}{}}
\DoxyCodeLine{00070\ \textcolor{comment}{\ \ \ \ \ \ \ private:}}
\DoxyCodeLine{00071\ \textcolor{comment}{\ \ \ \ \ \ \ \ tensor\&\ \_\_tens\_;}}
\DoxyCodeLine{00072\ \textcolor{comment}{\ \ \ \ \};}}
\DoxyCodeLine{00073\ \textcolor{comment}{}}
\DoxyCodeLine{00074\ \textcolor{comment}{\ \ \ public:}}
\DoxyCodeLine{00075\ \textcolor{comment}{\ \ \ \ \string~tensor();}}
\DoxyCodeLine{00076\ \textcolor{comment}{}}
\DoxyCodeLine{00077\ \textcolor{comment}{\ \ \ \ tensor\&\ operator=(const\ tensor\&\ \_\_other);}}
\DoxyCodeLine{00078\ \textcolor{comment}{\ \ \ \ tensor\&\ operator=(tensor\&\&\ \_\_other)\ noexcept;}}
\DoxyCodeLine{00079\ \textcolor{comment}{}}
\DoxyCodeLine{00080\ \textcolor{comment}{\ \ \ \ \_\_const\_iterator\ begin()\ const;}}
\DoxyCodeLine{00081\ \textcolor{comment}{\ \ \ \ \_\_const\_iterator\ end()\ const;}}
\DoxyCodeLine{00082\ \textcolor{comment}{}}
\DoxyCodeLine{00083\ \textcolor{comment}{\ \ \ \ const\_reverse\_iterator\ rbegin()\ const;}}
\DoxyCodeLine{00084\ \textcolor{comment}{\ \ \ \ const\_reverse\_iterator\ rend()\ const;}}
\DoxyCodeLine{00085\ \textcolor{comment}{}}
\DoxyCodeLine{00086\ \textcolor{comment}{\ \ \ \ data\_t\ \ \ \ \ storage()\ const;}}
\DoxyCodeLine{00087\ \textcolor{comment}{\ \ \ \ shape\_type\ shape()\ const;}}
\DoxyCodeLine{00088\ \textcolor{comment}{\ \ \ \ shape\_type\ strides()\ const;}}
\DoxyCodeLine{00089\ \textcolor{comment}{\ \ \ \ size\_t\ \ \ \ \ n\_dims()\ const;}}
\DoxyCodeLine{00090\ \textcolor{comment}{}}
\DoxyCodeLine{00091\ \textcolor{comment}{\ \ \ \ size\_t\ size(const\ index\_type\ \_\_dim)\ const;}}
\DoxyCodeLine{00092\ \textcolor{comment}{}}
\DoxyCodeLine{00093\ \textcolor{comment}{\ \ \ \ size\_t\ \ \ \ \ \ \ \ \ \ capacity()\ const\ noexcept;}}
\DoxyCodeLine{00094\ \textcolor{comment}{\ \ \ \ reference\ \ \ \ \ \ \ at(shape\_type\ \_\_idx);}}
\DoxyCodeLine{00095\ \textcolor{comment}{\ \ \ \ const\_reference\ at(const\ shape\_type\ \_\_idx)\ const;}}
\DoxyCodeLine{00096\ \textcolor{comment}{}}
\DoxyCodeLine{00097\ \textcolor{comment}{\ \ \ \ reference\ operator[](const\ size\_t\ \_\_in);}}
\DoxyCodeLine{00098\ \textcolor{comment}{}}
\DoxyCodeLine{00099\ \textcolor{comment}{\ \ \ \ const\_reference\ operator[](const\ size\_t\ \_\_in)\ const;}}
\DoxyCodeLine{00100\ \textcolor{comment}{}}
\DoxyCodeLine{00101\ \textcolor{comment}{\ \ \ \ tensor\ operator+(const\ tensor\&\ \_\_other)\ const;}}
\DoxyCodeLine{00102\ \textcolor{comment}{\ \ \ \ tensor\ operator-\/(const\ tensor\&\ \_\_other)\ const;}}
\DoxyCodeLine{00103\ \textcolor{comment}{\ \ \ \ tensor\ operator-\/=(const\ tensor\&\ \_\_other)\ const;}}
\DoxyCodeLine{00104\ \textcolor{comment}{\ \ \ \ tensor\ operator+=(const\ tensor\&\ \_\_other)\ const;}}
\DoxyCodeLine{00105\ \textcolor{comment}{\ \ \ \ tensor\ operator+(const\ value\_type\ \_scalar)\ const;}}
\DoxyCodeLine{00106\ \textcolor{comment}{\ \ \ \ tensor\ operator-\/(const\ value\_type\ \_scalar)\ const;}}
\DoxyCodeLine{00107\ \textcolor{comment}{\ \ \ \ tensor\ operator+=(const\_reference\ \_\_scalar)\ const;}}
\DoxyCodeLine{00108\ \textcolor{comment}{\ \ \ \ tensor\ operator-\/=(const\_reference\ \_\_scalar)\ const;}}
\DoxyCodeLine{00109\ \textcolor{comment}{}}
\DoxyCodeLine{00110\ \textcolor{comment}{\ \ \ \ bool\ operator==(const\ tensor\&\ \_\_other)\ const;}}
\DoxyCodeLine{00111\ \textcolor{comment}{\ \ \ \ bool\ operator!=(const\ tensor\&\ \_\_other)\ const\ \{\ return\ !(*this\ ==\ \_\_other);\ \}}}
\DoxyCodeLine{00112\ \textcolor{comment}{}}
\DoxyCodeLine{00113\ \textcolor{comment}{\ \ \ \ bool\ empty()\ const\ \{\ return\ this-\/>\_\_data\_.empty();\ \}}}
\DoxyCodeLine{00114\ \textcolor{comment}{}}
\DoxyCodeLine{00115\ \textcolor{comment}{\ \ \ \ double\ mean()\ const;}}
\DoxyCodeLine{00116\ \textcolor{comment}{}}
\DoxyCodeLine{00117\ \textcolor{comment}{\ \ \ \ tensor<bool>\ logical\_not()\ const;}}
\DoxyCodeLine{00118\ \textcolor{comment}{\ \ \ \ tensor<bool>\ logical\_or(const\ value\_type\ \_\_val)\ const;}}
\DoxyCodeLine{00119\ \textcolor{comment}{\ \ \ \ tensor<bool>\ logical\_or(const\ tensor\&\ \_\_other)\ const;}}
\DoxyCodeLine{00120\ \textcolor{comment}{}}
\DoxyCodeLine{00121\ \textcolor{comment}{\ \ \ \ tensor<bool>\ less\_equal(const\ tensor\&\ \_\_other)\ const;}}
\DoxyCodeLine{00122\ \textcolor{comment}{\ \ \ \ tensor<bool>\ less\_equal(const\ value\_type\ \_\_val)\ const;}}
\DoxyCodeLine{00123\ \textcolor{comment}{}}
\DoxyCodeLine{00124\ \textcolor{comment}{\ \ \ \ tensor<bool>\ greater\_equal(const\ tensor\&\ \_\_other)\ const;}}
\DoxyCodeLine{00125\ \textcolor{comment}{\ \ \ \ tensor<bool>\ greater\_equal(const\ value\_type\ \_\_val)\ const;}}
\DoxyCodeLine{00126\ \textcolor{comment}{}}
\DoxyCodeLine{00127\ \textcolor{comment}{\ \ \ \ tensor<bool>\ equal(const\ tensor\&\ \_\_other)\ const;}}
\DoxyCodeLine{00128\ \textcolor{comment}{\ \ \ \ tensor<bool>\ equal(const\ value\_type\ \_\_val)\ const;}}
\DoxyCodeLine{00129\ \textcolor{comment}{}}
\DoxyCodeLine{00130\ \textcolor{comment}{\ \ \ \ size\_t\ count\_nonzero(index\_type\ \_\_dim\ =\ -\/1LL)\ const;}}
\DoxyCodeLine{00131\ \textcolor{comment}{}}
\DoxyCodeLine{00132\ \textcolor{comment}{\ \ \ \ tensor\ slice(index\_type\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_dim,}}
\DoxyCodeLine{00133\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::optional<index\_type>\ \_\_start,}}
\DoxyCodeLine{00134\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::optional<index\_type>\ \_\_end,}}
\DoxyCodeLine{00135\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ index\_type\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_step)\ const;}}
\DoxyCodeLine{00136\ \textcolor{comment}{}}
\DoxyCodeLine{00137\ \textcolor{comment}{\ \ \ \ tensor\ fmax(const\ tensor\&\ \_\_other)\ const;}}
\DoxyCodeLine{00138\ \textcolor{comment}{\ \ \ \ tensor\ fmod(const\ tensor\&\ \_\_other)\ const;}}
\DoxyCodeLine{00139\ \textcolor{comment}{}}
\DoxyCodeLine{00140\ \textcolor{comment}{\ \ \ \ tensor\ frac()\ const;}}
\DoxyCodeLine{00141\ \textcolor{comment}{\ \ \ \ tensor\ log()\ const;}}
\DoxyCodeLine{00142\ \textcolor{comment}{\ \ \ \ tensor\ log10()\ const;}}
\DoxyCodeLine{00143\ \textcolor{comment}{\ \ \ \ tensor\ log2()\ const;}}
\DoxyCodeLine{00144\ \textcolor{comment}{}}
\DoxyCodeLine{00145\ \textcolor{comment}{\ \ \ \ tensor\ exp()\ const;}}
\DoxyCodeLine{00146\ \textcolor{comment}{}}
\DoxyCodeLine{00147\ \textcolor{comment}{\ \ \ \ tensor\ sqrt()\ const;}}
\DoxyCodeLine{00148\ \textcolor{comment}{}}
\DoxyCodeLine{00149\ \textcolor{comment}{\ \ \ \ tensor\ sum(const\ index\_type\ \_\_axis)\ const;}}
\DoxyCodeLine{00150\ \textcolor{comment}{}}
\DoxyCodeLine{00151\ \textcolor{comment}{\ \ \ \ tensor\ row(const\ index\_type\ \_\_index)\ const;}}
\DoxyCodeLine{00152\ \textcolor{comment}{\ \ \ \ tensor\ col(const\ index\_type\ \_\_index)\ const;}}
\DoxyCodeLine{00153\ \textcolor{comment}{}}
\DoxyCodeLine{00154\ \textcolor{comment}{\ \ \ \ tensor\ ceil()\ const;}}
\DoxyCodeLine{00155\ \textcolor{comment}{\ \ \ \ tensor\ floor()\ const;}}
\DoxyCodeLine{00156\ \textcolor{comment}{}}
\DoxyCodeLine{00157\ \textcolor{comment}{\ \ \ \ tensor\ clone()\ const;}}
\DoxyCodeLine{00158\ \textcolor{comment}{}}
\DoxyCodeLine{00159\ \textcolor{comment}{\ \ \ \ tensor\ clamp(const\_pointer\ \_\_min\_val\ =\ nullptr,\ const\_pointer\ \_\_max\_val\ =\ nullptr)\ const;}}
\DoxyCodeLine{00160\ \textcolor{comment}{}}
\DoxyCodeLine{00161\ \textcolor{comment}{\ \ \ \ tensor\ cos()\ const;}}
\DoxyCodeLine{00162\ \textcolor{comment}{\ \ \ \ tensor\ sin()\ const;}}
\DoxyCodeLine{00163\ \textcolor{comment}{\ \ \ \ tensor\ sinh()\ const;}}
\DoxyCodeLine{00164\ \textcolor{comment}{\ \ \ \ tensor\ asinh()\ const;}}
\DoxyCodeLine{00165\ \textcolor{comment}{\ \ \ \ tensor\ cosh()\ const;}}
\DoxyCodeLine{00166\ \textcolor{comment}{\ \ \ \ tensor\ acosh()\ const;}}
\DoxyCodeLine{00167\ \textcolor{comment}{}}
\DoxyCodeLine{00168\ \textcolor{comment}{\ \ \ \ tensor\ logical\_xor(const\ tensor\&\ \_\_other)\ const;}}
\DoxyCodeLine{00169\ \textcolor{comment}{\ \ \ \ tensor\ logical\_xor(const\ value\_type\ \_\_val)\ const;}}
\DoxyCodeLine{00170\ \textcolor{comment}{}}
\DoxyCodeLine{00171\ \textcolor{comment}{\ \ \ \ tensor\ logical\_and(const\ tensor\&\ \_\_other)\ const;}}
\DoxyCodeLine{00172\ \textcolor{comment}{\ \ \ \ tensor\ logical\_and(const\ value\_type\ \_\_val)\ const;}}
\DoxyCodeLine{00173\ \textcolor{comment}{}}
\DoxyCodeLine{00174\ \textcolor{comment}{\ \ \ \ tensor\ bitwise\_not()\ const;}}
\DoxyCodeLine{00175\ \textcolor{comment}{}}
\DoxyCodeLine{00176\ \textcolor{comment}{\ \ \ \ tensor\ bitwise\_and(const\ value\_type\ \_\_val)\ const;}}
\DoxyCodeLine{00177\ \textcolor{comment}{\ \ \ \ tensor\ bitwise\_and(const\ tensor\&\ \_\_other)\ const;}}
\DoxyCodeLine{00178\ \textcolor{comment}{}}
\DoxyCodeLine{00179\ \textcolor{comment}{\ \ \ \ tensor\ bitwise\_or(const\ value\_type\ \_\_val)\ const;}}
\DoxyCodeLine{00180\ \textcolor{comment}{\ \ \ \ tensor\ bitwise\_or(const\ tensor\&\ \_\_other)\ const;}}
\DoxyCodeLine{00181\ \textcolor{comment}{}}
\DoxyCodeLine{00182\ \textcolor{comment}{\ \ \ \ tensor\ bitwise\_xor(const\ value\_type\ \_\_val)\ const;}}
\DoxyCodeLine{00183\ \textcolor{comment}{\ \ \ \ tensor\ bitwise\_xor(const\ tensor\&\ \_\_other)\ const;}}
\DoxyCodeLine{00184\ \textcolor{comment}{}}
\DoxyCodeLine{00185\ \textcolor{comment}{\ \ \ \ tensor\ bitwise\_left\_shift(const\ int\ \_\_amount)\ const;}}
\DoxyCodeLine{00186\ \textcolor{comment}{\ \ \ \ tensor\ bitwise\_right\_shift(const\ int\ \_\_amount)\ const;}}
\DoxyCodeLine{00187\ \textcolor{comment}{}}
\DoxyCodeLine{00188\ \textcolor{comment}{\ \ \ \ tensor\ matmul(const\ tensor\&\ \_\_other)\ const;}}
\DoxyCodeLine{00189\ \textcolor{comment}{}}
\DoxyCodeLine{00190\ \textcolor{comment}{\ \ \ \ tensor\ reshape(const\ shape\_type\ \_\_shape)\ const;}}
\DoxyCodeLine{00191\ \textcolor{comment}{\ \ \ \ tensor\ reshape\_as(const\ tensor\&\ \_\_other)\ \{\ return\ this-\/>reshape(\_\_other.\_\_shape\_);\ \}}}
\DoxyCodeLine{00192\ \textcolor{comment}{}}
\DoxyCodeLine{00193\ \textcolor{comment}{\ \ \ \ tensor\ cross\_product(const\ tensor\&\ \_\_other)\ const;}}
\DoxyCodeLine{00194\ \textcolor{comment}{}}
\DoxyCodeLine{00195\ \textcolor{comment}{\ \ \ \ tensor\ absolute(const\ tensor\&\ \_\_tensor)\ const;}}
\DoxyCodeLine{00196\ \textcolor{comment}{}}
\DoxyCodeLine{00197\ \textcolor{comment}{\ \ \ \ tensor\ dot(const\ tensor\&\ \_\_other)\ const;}}
\DoxyCodeLine{00198\ \textcolor{comment}{}}
\DoxyCodeLine{00199\ \textcolor{comment}{\ \ \ \ tensor\ relu()\ const;}}
\DoxyCodeLine{00200\ \textcolor{comment}{}}
\DoxyCodeLine{00201\ \textcolor{comment}{\ \ \ \ tensor\ transpose()\ const;}}
\DoxyCodeLine{00202\ \textcolor{comment}{}}
\DoxyCodeLine{00203\ \textcolor{comment}{\ \ \ \ tensor\ pow(const\ tensor\&\ \_\_other)\ const;}}
\DoxyCodeLine{00204\ \textcolor{comment}{\ \ \ \ tensor\ pow(const\ value\_type\ \_\_val)\ const;}}
\DoxyCodeLine{00205\ \textcolor{comment}{}}
\DoxyCodeLine{00206\ \textcolor{comment}{\ \ \ \ tensor\ cumprod(index\_type\ \_\_dim\ =\ -\/1)\ const;}}
\DoxyCodeLine{00207\ \textcolor{comment}{}}
\DoxyCodeLine{00208\ \textcolor{comment}{\ \ \ \ tensor\ cat(const\ std::vector<tensor>\&\ \_others,\ index\_type\ \_dim)\ const;}}
\DoxyCodeLine{00209\ \textcolor{comment}{}}
\DoxyCodeLine{00210\ \textcolor{comment}{\ \ \ \ tensor\ argmax(index\_type\ \_\_dim)\ const;}}
\DoxyCodeLine{00211\ \textcolor{comment}{}}
\DoxyCodeLine{00212\ \textcolor{comment}{\ \ \ \ tensor\ unsqueeze(index\_type\ \_\_dim)\ const;}}
\DoxyCodeLine{00213\ \textcolor{comment}{}}
\DoxyCodeLine{00214\ \textcolor{comment}{\ \ \ \ index\_type\ lcm()\ const;}}
\DoxyCodeLine{00215\ \textcolor{comment}{}}
\DoxyCodeLine{00216\ \textcolor{comment}{\ \ \ \ void\ sqrt\_();}}
\DoxyCodeLine{00217\ \textcolor{comment}{}}
\DoxyCodeLine{00218\ \textcolor{comment}{\ \ \ \ void\ exp\_();}}
\DoxyCodeLine{00219\ \textcolor{comment}{}}
\DoxyCodeLine{00220\ \textcolor{comment}{\ \ \ \ void\ log2\_();}}
\DoxyCodeLine{00221\ \textcolor{comment}{\ \ \ \ void\ log10\_();}}
\DoxyCodeLine{00222\ \textcolor{comment}{\ \ \ \ void\ log\_();}}
\DoxyCodeLine{00223\ \textcolor{comment}{}}
\DoxyCodeLine{00224\ \textcolor{comment}{\ \ \ \ void\ frac\_();}}
\DoxyCodeLine{00225\ \textcolor{comment}{}}
\DoxyCodeLine{00226\ \textcolor{comment}{\ \ \ \ void\ fmod\_(const\ tensor\&\ \_\_other);}}
\DoxyCodeLine{00227\ \textcolor{comment}{}}
\DoxyCodeLine{00228\ \textcolor{comment}{\ \ \ \ void\ cos\_();}}
\DoxyCodeLine{00229\ \textcolor{comment}{\ \ \ \ void\ cosh\_();}}
\DoxyCodeLine{00230\ \textcolor{comment}{\ \ \ \ void\ acosh\_();}}
\DoxyCodeLine{00231\ \textcolor{comment}{\ \ \ \ void\ sin\_()\ const;}}
\DoxyCodeLine{00232\ \textcolor{comment}{\ \ \ \ void\ sinh\_();}}
\DoxyCodeLine{00233\ \textcolor{comment}{\ \ \ \ void\ asinh\_();}}
\DoxyCodeLine{00234\ \textcolor{comment}{}}
\DoxyCodeLine{00235\ \textcolor{comment}{\ \ \ \ void\ ceil\_();}}
\DoxyCodeLine{00236\ \textcolor{comment}{\ \ \ \ void\ floor\_();}}
\DoxyCodeLine{00237\ \textcolor{comment}{}}
\DoxyCodeLine{00238\ \textcolor{comment}{\ \ \ \ void\ relu\_();}}
\DoxyCodeLine{00239\ \textcolor{comment}{}}
\DoxyCodeLine{00240\ \textcolor{comment}{\ \ \ \ void\ clamp\_(const\_pointer\ \_\_min\_val\ =\ nullptr,\ const\_pointer\ \_\_max\_val\ =\ nullptr);}}
\DoxyCodeLine{00241\ \textcolor{comment}{}}
\DoxyCodeLine{00242\ \textcolor{comment}{\ \ \ \ void\ logical\_not\_()\ const;}}
\DoxyCodeLine{00243\ \textcolor{comment}{}}
\DoxyCodeLine{00244\ \textcolor{comment}{\ \ \ \ void\ logical\_or\_(const\ tensor\&\ \_\_other);}}
\DoxyCodeLine{00245\ \textcolor{comment}{\ \ \ \ void\ logical\_or\_(const\ value\_type\ \_\_val);}}
\DoxyCodeLine{00246\ \textcolor{comment}{}}
\DoxyCodeLine{00247\ \textcolor{comment}{\ \ \ \ void\ logical\_xor\_(const\ tensor\&\ \_\_other);}}
\DoxyCodeLine{00248\ \textcolor{comment}{\ \ \ \ void\ logical\_xor\_(const\ value\_type\ \_\_val);}}
\DoxyCodeLine{00249\ \textcolor{comment}{}}
\DoxyCodeLine{00250\ \textcolor{comment}{\ \ \ \ void\ logical\_and\_(const\ tensor\&\ \_\_other);}}
\DoxyCodeLine{00251\ \textcolor{comment}{\ \ \ \ void\ logical\_and\_(const\ value\_type\ \_\_val);}}
\DoxyCodeLine{00252\ \textcolor{comment}{}}
\DoxyCodeLine{00253\ \textcolor{comment}{\ \ \ \ void\ pow\_(const\ tensor\&\ \_\_other)\ const;}}
\DoxyCodeLine{00254\ \textcolor{comment}{\ \ \ \ void\ pow\_(const\ value\_type\ \_\_val)\ const;}}
\DoxyCodeLine{00255\ \textcolor{comment}{}}
\DoxyCodeLine{00256\ \textcolor{comment}{\ \ \ \ void\ bitwise\_left\_shift\_(const\ int\ \_\_amount);}}
\DoxyCodeLine{00257\ \textcolor{comment}{\ \ \ \ void\ bitwise\_right\_shift\_(const\ int\ \_\_amount);}}
\DoxyCodeLine{00258\ \textcolor{comment}{}}
\DoxyCodeLine{00259\ \textcolor{comment}{\ \ \ \ void\ bitwise\_and\_(const\ value\_type\ \_\_val);}}
\DoxyCodeLine{00260\ \textcolor{comment}{\ \ \ \ void\ bitwise\_and\_(const\ tensor\&\ \_\_other);}}
\DoxyCodeLine{00261\ \textcolor{comment}{}}
\DoxyCodeLine{00262\ \textcolor{comment}{\ \ \ \ void\ bitwise\_or\_(const\ value\_type\ \_\_val);}}
\DoxyCodeLine{00263\ \textcolor{comment}{\ \ \ \ void\ bitwise\_or\_(const\ tensor\&\ \_\_other);}}
\DoxyCodeLine{00264\ \textcolor{comment}{}}
\DoxyCodeLine{00265\ \textcolor{comment}{\ \ \ \ void\ bitwise\_xor\_(const\ value\_type\ \_\_val);}}
\DoxyCodeLine{00266\ \textcolor{comment}{\ \ \ \ void\ bitwise\_xor\_(const\ tensor\&\ \_\_other);}}
\DoxyCodeLine{00267\ \textcolor{comment}{}}
\DoxyCodeLine{00268\ \textcolor{comment}{\ \ \ \ void\ bitwise\_not\_();}}
\DoxyCodeLine{00269\ \textcolor{comment}{}}
\DoxyCodeLine{00270\ \textcolor{comment}{\ \ \ \ void\ view(std::initializer\_list<index\_type>\ \_\_new\_sh);}}
\DoxyCodeLine{00271\ \textcolor{comment}{}}
\DoxyCodeLine{00272\ \textcolor{comment}{\ \ \ \ void\ print()\ const\ noexcept;}}
\DoxyCodeLine{00273\ \textcolor{comment}{}}
\DoxyCodeLine{00274\ \textcolor{comment}{\ \ \ \ static\ tensor\ zeros(const\ shape\_type\&\ \_\_sh);}}
\DoxyCodeLine{00275\ \textcolor{comment}{}}
\DoxyCodeLine{00276\ \textcolor{comment}{\ \ \ \ static\ tensor\ ones(const\ shape\_type\&\ \_\_sh);}}
\DoxyCodeLine{00277\ \textcolor{comment}{}}
\DoxyCodeLine{00278\ \textcolor{comment}{\ \ \ \ static\ tensor\ randomize(const\ shape\_type\&\ \_\_sh,\ bool\ \_\_bounded\ =\ false);}}
\DoxyCodeLine{00279\ \textcolor{comment}{}}
\DoxyCodeLine{00280\ \textcolor{comment}{\ \ \ \ tensor<index\_type>\ argmax\_(index\_type\ \_\_dim)\ const;}}
\DoxyCodeLine{00281\ \textcolor{comment}{\ \ \ \ tensor<index\_type>\ argsort(index\_type\ \_\_dim\ =\ -\/1LL,\ bool\ \_\_ascending\ =\ true)\ const;}}
\DoxyCodeLine{00282\ \textcolor{comment}{}}
\DoxyCodeLine{00283\ \textcolor{comment}{\ \ \ private:}}
\DoxyCodeLine{00284\ \textcolor{comment}{\ \ \ \ static\ void\ \_\_check\_is\_scalar\_type(const\ std::string\ \_\_msg);}}
\DoxyCodeLine{00285\ \textcolor{comment}{}}
\DoxyCodeLine{00286\ \textcolor{comment}{\ \ \ \ static\ void\ \_\_check\_is\_integral\_type(const\ std::string\ \_\_msg);}}
\DoxyCodeLine{00287\ \textcolor{comment}{}}
\DoxyCodeLine{00288\ \textcolor{comment}{\ \ \ \ template<typename\ \_\_t>}}
\DoxyCodeLine{00289\ \textcolor{comment}{\ \ \ \ static\ void\ \_\_check\_is\_same\_type(const\ std::string\ \_\_msg);}}
\DoxyCodeLine{00290\ \textcolor{comment}{\ \ \ \ static\ void\ \_\_check\_is\_arithmetic\_type(const\ std::string\ \_\_msg);}}
\DoxyCodeLine{00291\ \textcolor{comment}{\ \ \ \ void\ \ \ \ \ \ \ \ \_\_compute\_strides();}}
\DoxyCodeLine{00292\ \textcolor{comment}{\ \ \ \ size\_t\ \ \ \ \ \ \_\_compute\_index(const\ std::vector<index\_type>\&\ \_\_idx)\ const;}}
\DoxyCodeLine{00293\ \textcolor{comment}{\ \ \ \ uint64\_t\ \ \ \ \_\_computeSize(const\ shape\_type\&\ \_\_dims)\ const;}}
\DoxyCodeLine{00294\ \textcolor{comment}{\ \ \ \ uint64\_t\ \ \ \ \_\_compute\_outer\_size(const\ index\_type\ \_\_dim)\ const;}}
\DoxyCodeLine{00295\ \textcolor{comment}{\ \ \ \ float\ \ \ \ \ \ \ \_\_frac(const\_reference\ \_\_scalar);}}
\DoxyCodeLine{00296\ \textcolor{comment}{\ \ \ \ index\_type\ \ \_\_lcm(const\ index\_type\ \_\_a,\ const\ index\_type\ \_\_b);}}
\DoxyCodeLine{00297\ \textcolor{comment}{\};\ \ //\ tensor\ class}}
\DoxyCodeLine{00298\ \textcolor{comment}{*/}}
\DoxyCodeLine{00299\ }
\DoxyCodeLine{00300\ \textcolor{keyword}{enum\ class}\ \mbox{\hyperlink{tensor_8hpp_adb53a8cc97236ca207c035241a5b7fb8}{Device}}\ \{}
\DoxyCodeLine{00301\ \ \ \ \ \mbox{\hyperlink{tensor_8hpp_adb53a8cc97236ca207c035241a5b7fb8a2b55387dd066c5bac646ac61543d152d}{CPU}},}
\DoxyCodeLine{00302\ \ \ \ \ \mbox{\hyperlink{tensor_8hpp_adb53a8cc97236ca207c035241a5b7fb8aa33b7755e5f9b504d2d038eaca4ff28d}{CUDA}}}
\DoxyCodeLine{00303\ \};}
\DoxyCodeLine{00304\ }
\DoxyCodeLine{00305\ \textcolor{comment}{/*tensor\ implementation*/}}
\DoxyCodeLine{00306\ }
\DoxyCodeLine{00307\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{00308\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classtensor}{tensor}}}
\DoxyCodeLine{00309\ \{}
\DoxyCodeLine{00310\ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00311\ \ \ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{classtensor}{tensor}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classtensor_ad3d7f4f7407f5b9e4db70d2e198b2d27}{\_\_self}};}
\DoxyCodeLine{00312\ \ \ \ \ \textcolor{keyword}{typedef}\ \_Tp\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classtensor_a12614e7ef399b40d0eca22d10360149f}{value\_type}};}
\DoxyCodeLine{00313\ \ \ \ \ \textcolor{keyword}{typedef}\ int64\_t\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classtensor_aae15c34415ce3896c43cb656ee7e6059}{index\_type}};}
\DoxyCodeLine{00314\ \ \ \ \ \textcolor{keyword}{typedef}\ std::vector<index\_type>\ \mbox{\hyperlink{classtensor_ab96aa71f8b92cb531a7e258f47315f45}{shape\_type}};}
\DoxyCodeLine{00315\ \ \ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{classtensor_a12614e7ef399b40d0eca22d10360149f}{value\_type}}\&\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classtensor_a7925293489f3786339e35f136449f9d4}{reference}};}
\DoxyCodeLine{00316\ \ \ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor_a12614e7ef399b40d0eca22d10360149f}{value\_type}}\&\ \ \ \ \ \ \ \mbox{\hyperlink{classtensor_aacd8d62096cc0d502cffd169e25f92f0}{const\_reference}};}
\DoxyCodeLine{00317\ \ \ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{classtensor_a12614e7ef399b40d0eca22d10360149f}{value\_type}}*\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classtensor_ab3deb9fb82cb557f32bd6e47f33951c9}{pointer}};}
\DoxyCodeLine{00318\ \ \ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor_a12614e7ef399b40d0eca22d10360149f}{value\_type}}*\ \ \ \ \ \ \ \mbox{\hyperlink{classtensor_a39d9b723cbcc4fbc18d2d655d1148166}{const\_pointer}};}
\DoxyCodeLine{00319\ \ \ \ \ \textcolor{keyword}{typedef}\ std::vector<value\_type>\ \mbox{\hyperlink{classtensor_a1248d808ef5c7b0f868bfa7c0cc25f59}{data\_t}};}
\DoxyCodeLine{00320\ \ \ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor_a1248d808ef5c7b0f868bfa7c0cc25f59}{data\_t}}\ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classtensor_a89c617bdfc7ef1b870582479c7aa7da2}{const\_data\_container}};}
\DoxyCodeLine{00321\ }
\DoxyCodeLine{00322\ \ \ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ data\_t::iterator\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classtensor_aef37b7165780c0fc7979b6624cb154e9}{iterator}};}
\DoxyCodeLine{00323\ \ \ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ data\_t::const\_iterator\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classtensor_a9566272a60b3b033b16a8a4d69e66f29}{const\_iterator}};}
\DoxyCodeLine{00324\ \ \ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ data\_t::reverse\_iterator\ \ \ \ \ \ \ \mbox{\hyperlink{classtensor_ada069268cbb9c123c871d025f6eb0532}{reverse\_iterator}};}
\DoxyCodeLine{00325\ \ \ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ data\_t::const\_reverse\_iterator\ \mbox{\hyperlink{classtensor_a11dba112dfddf751fa46b12673fd9405}{const\_reverse\_iterator}};}
\DoxyCodeLine{00326\ }
\DoxyCodeLine{00327\ }
\DoxyCodeLine{00328\ \ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00329\ \ \ \ \ \mbox{\hyperlink{classtensor_a1248d808ef5c7b0f868bfa7c0cc25f59}{data\_t}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_data\_;}
\DoxyCodeLine{00330\ \ \ \ \ \mbox{\hyperlink{classtensor_ab96aa71f8b92cb531a7e258f47315f45}{shape\_type}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_shape\_;}
\DoxyCodeLine{00331\ \ \ \ \ std::vector<index\_type>\ \_\_strides\_;}
\DoxyCodeLine{00332\ \ \ \ \ \mbox{\hyperlink{tensor_8hpp_adb53a8cc97236ca207c035241a5b7fb8}{Device}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_device\_;}
\DoxyCodeLine{00333\ }
\DoxyCodeLine{00334\ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00335\ \ \ \ \ \mbox{\hyperlink{classtensor_aa3049f7ce6b011e9037add3d9881bd83}{tensor}}()\ =\ \textcolor{keywordflow}{default};}
\DoxyCodeLine{00336\ }
\DoxyCodeLine{00337\ \ \ \ \ \textcolor{keyword}{explicit}\ \mbox{\hyperlink{classtensor_afaa30cca2bb4d8d5bbbe5de06e8e77e2}{tensor}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor_ab96aa71f8b92cb531a7e258f47315f45}{shape\_type}}\&\ \_\_sh,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor_a12614e7ef399b40d0eca22d10360149f}{value\_type}}\&\ \_\_v,\ \mbox{\hyperlink{tensor_8hpp_adb53a8cc97236ca207c035241a5b7fb8}{Device}}\ \_\_d\ =\ \mbox{\hyperlink{tensor_8hpp_adb53a8cc97236ca207c035241a5b7fb8a2b55387dd066c5bac646ac61543d152d}{Device::CPU}})\ :}
\DoxyCodeLine{00338\ \ \ \ \ \ \ \ \ \_\_shape\_(\_\_sh),}
\DoxyCodeLine{00339\ \ \ \ \ \ \ \ \ \_\_data\_(this-\/>\_\_computeSize(\_\_sh),\ \_\_v),}
\DoxyCodeLine{00340\ \ \ \ \ \ \ \ \ \_\_device\_(\_\_d)\ \{}
\DoxyCodeLine{00341\ \ \ \ \ \ \ \ \ this-\/>\_\_compute\_strides();}
\DoxyCodeLine{00342\ \ \ \ \ \}}
\DoxyCodeLine{00343\ }
\DoxyCodeLine{00344\ \ \ \ \ \textcolor{keyword}{explicit}\ \mbox{\hyperlink{classtensor_aa2ae9879255d3be01327fcc27cd9ab94}{tensor}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor_ab96aa71f8b92cb531a7e258f47315f45}{shape\_type}}\&\ \_\_sh,\ \mbox{\hyperlink{tensor_8hpp_adb53a8cc97236ca207c035241a5b7fb8}{Device}}\ \_\_d\ =\ \mbox{\hyperlink{tensor_8hpp_adb53a8cc97236ca207c035241a5b7fb8a2b55387dd066c5bac646ac61543d152d}{Device::CPU}})\ :}
\DoxyCodeLine{00345\ \ \ \ \ \ \ \ \ \_\_shape\_(\_\_sh),}
\DoxyCodeLine{00346\ \ \ \ \ \ \ \ \ \_\_device\_(\_\_d)\ \{}
\DoxyCodeLine{00347\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classtensor_aae15c34415ce3896c43cb656ee7e6059}{index\_type}}\ \_\_s\ =\ this-\/>\_\_computeSize(\_\_sh);}
\DoxyCodeLine{00348\ \ \ \ \ \ \ \ \ this-\/>\_\_data\_\ \ =\ \mbox{\hyperlink{classtensor_a1248d808ef5c7b0f868bfa7c0cc25f59}{data\_t}}(\_\_s);}
\DoxyCodeLine{00349\ \ \ \ \ \ \ \ \ this-\/>\_\_compute\_strides();}
\DoxyCodeLine{00350\ \ \ \ \ \}}
\DoxyCodeLine{00351\ }
\DoxyCodeLine{00352\ \ \ \ \ \textcolor{keyword}{explicit}\ \mbox{\hyperlink{classtensor_ab7c9217e98f8ccf9c366a65474faded7}{tensor}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor_a1248d808ef5c7b0f868bfa7c0cc25f59}{data\_t}}\&\ \_\_d,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor_ab96aa71f8b92cb531a7e258f47315f45}{shape\_type}}\&\ \_\_sh,\ \mbox{\hyperlink{tensor_8hpp_adb53a8cc97236ca207c035241a5b7fb8}{Device}}\ \_\_dev\ =\ \mbox{\hyperlink{tensor_8hpp_adb53a8cc97236ca207c035241a5b7fb8a2b55387dd066c5bac646ac61543d152d}{Device::CPU}})\ :}
\DoxyCodeLine{00353\ \ \ \ \ \ \ \ \ \_\_data\_(\_\_d),}
\DoxyCodeLine{00354\ \ \ \ \ \ \ \ \ \_\_shape\_(\_\_sh),}
\DoxyCodeLine{00355\ \ \ \ \ \ \ \ \ \_\_device\_(\_\_dev)\ \{}
\DoxyCodeLine{00356\ \ \ \ \ \ \ \ \ this-\/>\_\_compute\_strides();}
\DoxyCodeLine{00357\ \ \ \ \ \}}
\DoxyCodeLine{00358\ }
\DoxyCodeLine{00359\ \ \ \ \ \mbox{\hyperlink{classtensor_ab22c24a7f5afa3635a7ba8c4940e95ed}{tensor}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_t)\ :}
\DoxyCodeLine{00360\ \ \ \ \ \ \ \ \ \_\_data\_(\_\_t.\mbox{\hyperlink{classtensor_a4302a45c6c164b54316d6b869affca78}{storage}}()),}
\DoxyCodeLine{00361\ \ \ \ \ \ \ \ \ \_\_shape\_(\_\_t.\mbox{\hyperlink{classtensor_a33e40f89c3247e27e6bd03a992d73868}{shape}}()),}
\DoxyCodeLine{00362\ \ \ \ \ \ \ \ \ \_\_strides\_(\_\_t.\mbox{\hyperlink{classtensor_a0c7bf412aa5a913b58b26dd0a1069077}{strides}}()),}
\DoxyCodeLine{00363\ \ \ \ \ \ \ \ \ \_\_device\_(\_\_t.\mbox{\hyperlink{classtensor_a1ee059dcb01e158f4975fc692b0ce497}{device}}())\ \{\}}
\DoxyCodeLine{00364\ }
\DoxyCodeLine{00365\ \ \ \ \ \mbox{\hyperlink{classtensor_a4f8fd95536e28ab3176a64268f2e2e70}{tensor}}(\mbox{\hyperlink{classtensor}{tensor}}\&\&\ \_\_t)\ noexcept\ :}
\DoxyCodeLine{00366\ \ \ \ \ \ \ \ \ \_\_data\_(std::move(\_\_t.storage())),}
\DoxyCodeLine{00367\ \ \ \ \ \ \ \ \ \_\_shape\_(std::move(\_\_t.shape())),}
\DoxyCodeLine{00368\ \ \ \ \ \ \ \ \ \_\_strides\_(std::move(\_\_t.strides())),}
\DoxyCodeLine{00369\ \ \ \ \ \ \ \ \ \_\_device\_(std::move(\_\_t.device()))\ \{\}}
\DoxyCodeLine{00370\ }
\DoxyCodeLine{00371\ \ \ \ \ \mbox{\hyperlink{classtensor_a70819bf3c928f595299389d5e0605aeb}{tensor}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor_ab96aa71f8b92cb531a7e258f47315f45}{shape\_type}}\&\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_sh,}
\DoxyCodeLine{00372\ \ \ \ \ \ \ \ \ \ \ \ std::initializer\_list<value\_type>\ init\_list,}
\DoxyCodeLine{00373\ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{tensor_8hpp_adb53a8cc97236ca207c035241a5b7fb8}{Device}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_d\ =\ \mbox{\hyperlink{tensor_8hpp_adb53a8cc97236ca207c035241a5b7fb8a2b55387dd066c5bac646ac61543d152d}{Device::CPU}})\ :}
\DoxyCodeLine{00374\ \ \ \ \ \ \ \ \ \_\_shape\_(\_\_sh),}
\DoxyCodeLine{00375\ \ \ \ \ \ \ \ \ \_\_device\_(\_\_d)\ \{}
\DoxyCodeLine{00376\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classtensor_aae15c34415ce3896c43cb656ee7e6059}{index\_type}}\ \_\_s\ =\ this-\/>\_\_computeSize(\_\_sh);}
\DoxyCodeLine{00377\ \ \ \ \ \ \ \ \ assert(init\_list.size()\ ==\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{size\_t}\textcolor{keyword}{>}(\_\_s)}
\DoxyCodeLine{00378\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\&\ \textcolor{stringliteral}{"{}Initializer\ list\ size\ must\ match\ tensor\ size"{}});}
\DoxyCodeLine{00379\ \ \ \ \ \ \ \ \ this-\/>\_\_data\_\ =\ \mbox{\hyperlink{classtensor_a1248d808ef5c7b0f868bfa7c0cc25f59}{data\_t}}(init\_list);}
\DoxyCodeLine{00380\ \ \ \ \ \ \ \ \ this-\/>\_\_compute\_strides();}
\DoxyCodeLine{00381\ \ \ \ \ \}}
\DoxyCodeLine{00382\ }
\DoxyCodeLine{00383\ \ \ \ \ \mbox{\hyperlink{classtensor_a9d51a6b554af18e91501016b2d57b41a}{tensor}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor_ab96aa71f8b92cb531a7e258f47315f45}{shape\_type}}\&\ \_\_sh,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\ :}
\DoxyCodeLine{00384\ \ \ \ \ \ \ \ \ \_\_data\_(\_\_other.\mbox{\hyperlink{classtensor_a4302a45c6c164b54316d6b869affca78}{storage}}()),}
\DoxyCodeLine{00385\ \ \ \ \ \ \ \ \ \_\_shape\_(\_\_sh),}
\DoxyCodeLine{00386\ \ \ \ \ \ \ \ \ \_\_device\_(\_\_other.\mbox{\hyperlink{classtensor_a1ee059dcb01e158f4975fc692b0ce497}{device}}())\ \{}
\DoxyCodeLine{00387\ \ \ \ \ \ \ \ \ this-\/>\_\_compute\_strides();}
\DoxyCodeLine{00388\ \ \ \ \ \}}
\DoxyCodeLine{00389\ }
\DoxyCodeLine{00390\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classtensor_acadea452305a7e6dae19112bbbeb8b58}{\_\_is\_cuda\_device}}\ =\ this-\/>\_\_device\_\ ==\ \mbox{\hyperlink{tensor_8hpp_adb53a8cc97236ca207c035241a5b7fb8aa33b7755e5f9b504d2d038eaca4ff28d}{Device::CUDA}}\ ?\ true\ :\ \textcolor{keyword}{false};}
\DoxyCodeLine{00391\ }
\DoxyCodeLine{00392\ \ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00393\ \ \ \ \ \textcolor{keyword}{class\ }\_\_destroy\_tensor}
\DoxyCodeLine{00394\ \ \ \ \ \{}
\DoxyCodeLine{00395\ \ \ \ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00396\ \ \ \ \ \ \ \ \ \textcolor{keyword}{explicit}\ \_\_destroy\_tensor(\mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_tens)\ :}
\DoxyCodeLine{00397\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_tens\_(\_\_tens)\ \{\}}
\DoxyCodeLine{00398\ }
\DoxyCodeLine{00399\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ operator()()\ \{\}}
\DoxyCodeLine{00400\ }
\DoxyCodeLine{00401\ \ \ \ \ \ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00402\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_tens\_;}
\DoxyCodeLine{00403\ \ \ \ \ \};}
\DoxyCodeLine{00404\ }
\DoxyCodeLine{00405\ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00406\ \ \ \ \ \mbox{\hyperlink{classtensor_ae13b340184f9059a7b7cab926baee14c}{\string~tensor}}()\ \{\ \_\_destroy\_tensor\ (*\textcolor{keyword}{this})();\ \}}
\DoxyCodeLine{00407\ }
\DoxyCodeLine{00408\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\&\ \mbox{\hyperlink{classtensor_ab85b4bd02b93afb9bf6758cec5ee0cf3}{operator=}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other);}
\DoxyCodeLine{00409\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\&\ \mbox{\hyperlink{classtensor_ab85b4bd02b93afb9bf6758cec5ee0cf3}{operator=}}(\mbox{\hyperlink{classtensor}{tensor}}\&\&\ \_\_other)\ \textcolor{keyword}{noexcept};}
\DoxyCodeLine{00410\ }
\DoxyCodeLine{00411\ \ \ \ \ \mbox{\hyperlink{classtensor_a9566272a60b3b033b16a8a4d69e66f29}{const\_iterator}}\ \mbox{\hyperlink{classtensor_a890a5280ebb5ddce6ccd11b143aadaf8}{begin}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ this-\/>\_\_data\_.begin();\ \}}
\DoxyCodeLine{00412\ \ \ \ \ \mbox{\hyperlink{classtensor_a9566272a60b3b033b16a8a4d69e66f29}{const\_iterator}}\ \mbox{\hyperlink{classtensor_a98b05ef7f4173ff76a497d1117145743}{end}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ this-\/>\_\_data\_.end();\ \}}
\DoxyCodeLine{00413\ }
\DoxyCodeLine{00414\ \ \ \ \ \mbox{\hyperlink{classtensor_a11dba112dfddf751fa46b12673fd9405}{const\_reverse\_iterator}}\ \mbox{\hyperlink{classtensor_a9a79e5c47052ce93e492ba4e98efc34e}{rbegin}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classtensor_a11dba112dfddf751fa46b12673fd9405}{const\_reverse\_iterator}}(\mbox{\hyperlink{classtensor_ad2b9af5d0aa22943a4332420b0cc91fc}{end}}());\ \}}
\DoxyCodeLine{00415\ \ \ \ \ \mbox{\hyperlink{classtensor_a11dba112dfddf751fa46b12673fd9405}{const\_reverse\_iterator}}\ \mbox{\hyperlink{classtensor_abf94120af5347482a56912aa5619b197}{rend}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classtensor_a11dba112dfddf751fa46b12673fd9405}{const\_reverse\_iterator}}(\mbox{\hyperlink{classtensor_a52d5b20bef2ffe824342736d731f1002}{begin}}());\ \}}
\DoxyCodeLine{00416\ }
\DoxyCodeLine{00417\ \ \ \ \ \mbox{\hyperlink{classtensor_a1248d808ef5c7b0f868bfa7c0cc25f59}{data\_t}}\ \ \ \ \ \mbox{\hyperlink{classtensor_a72e61a1ae3a8be0bf05a2c70ae87e07a}{storage}}()\ const\ noexcept\ \{\ \textcolor{keywordflow}{return}\ this-\/>\_\_data\_;\ \}}
\DoxyCodeLine{00418\ \ \ \ \ \mbox{\hyperlink{classtensor_ab96aa71f8b92cb531a7e258f47315f45}{shape\_type}}\ \mbox{\hyperlink{classtensor_af4b56559e27899b16f97f893789eba1e}{shape}}()\ const\ noexcept\ \{\ \textcolor{keywordflow}{return}\ this-\/>\_\_shape\_;\ \}}
\DoxyCodeLine{00419\ \ \ \ \ \mbox{\hyperlink{classtensor_ab96aa71f8b92cb531a7e258f47315f45}{shape\_type}}\ \mbox{\hyperlink{classtensor_a413d1d32f53e498286b6635a27027852}{strides}}()\ const\ noexcept\ \{\ \textcolor{keywordflow}{return}\ this-\/>\_\_strides\_;\ \}}
\DoxyCodeLine{00420\ \ \ \ \ \mbox{\hyperlink{tensor_8hpp_adb53a8cc97236ca207c035241a5b7fb8}{Device}}\ \ \ \ \ \mbox{\hyperlink{classtensor_a1ee059dcb01e158f4975fc692b0ce497}{device}}()\ const\ noexcept\ \{\ \textcolor{keywordflow}{return}\ this-\/>\_\_device\_;\ \}}
\DoxyCodeLine{00421\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \ \ \ \ \mbox{\hyperlink{classtensor_a5ca3eb4e8f9e1fb6a12a84bb2ea8a88c}{n\_dims}}()\ const\ noexcept\ \{\ \textcolor{keywordflow}{return}\ this-\/>\_\_shape\_.size();\ \}}
\DoxyCodeLine{00422\ }
\DoxyCodeLine{00423\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classtensor_aea1ca9c0bbcbfc682b0f533c435ca9e9}{size}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor_aae15c34415ce3896c43cb656ee7e6059}{index\_type}}\ \_\_dim)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00424\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_\_dim\ <\ 0\ ||\ \_\_dim\ >=\ \textcolor{keyword}{static\_cast<}\mbox{\hyperlink{classtensor_aae15c34415ce3896c43cb656ee7e6059}{index\_type}}\textcolor{keyword}{>}(this-\/>\_\_shape\_.size()))}
\DoxyCodeLine{00425\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00426\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::invalid\_argument(\textcolor{stringliteral}{"{}dimension\ input\ is\ out\ of\ range"{}});}
\DoxyCodeLine{00427\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00428\ }
\DoxyCodeLine{00429\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_\_dim\ ==\ 0)}
\DoxyCodeLine{00430\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00431\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ this-\/>\_\_computeSize(this-\/>\_\_shape\_);}
\DoxyCodeLine{00432\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00433\ }
\DoxyCodeLine{00434\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ this-\/>\_\_shape\_[\_\_dim];}
\DoxyCodeLine{00435\ \ \ \ \ \}}
\DoxyCodeLine{00436\ }
\DoxyCodeLine{00437\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classtensor_ab39a76ae4819e472970b6238a701e3cd}{capacity}}()\ const\ noexcept\ \{\ \textcolor{keywordflow}{return}\ this-\/>\_\_data\_.capacity();\ \}}
\DoxyCodeLine{00438\ \ \ \ \ \mbox{\hyperlink{classtensor_a7925293489f3786339e35f136449f9d4}{reference}}\ \ \ \ \ \ \ \mbox{\hyperlink{classtensor_a2d8579b56377185e357d7845c8f5790d}{at}}(\mbox{\hyperlink{classtensor_ab96aa71f8b92cb531a7e258f47315f45}{shape\_type}}\ \_\_idx);}
\DoxyCodeLine{00439\ \ \ \ \ \mbox{\hyperlink{classtensor_aacd8d62096cc0d502cffd169e25f92f0}{const\_reference}}\ \mbox{\hyperlink{classtensor_ae13f75b1d5aede44026ef6460c299133}{at}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor_ab96aa71f8b92cb531a7e258f47315f45}{shape\_type}}\ \_\_idx)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00440\ }
\DoxyCodeLine{00441\ \ \ \ \ \mbox{\hyperlink{classtensor_a7925293489f3786339e35f136449f9d4}{reference}}\ \mbox{\hyperlink{classtensor_a9e64aa84cd5cf6b5ad6557bb7ace206b}{operator[]}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ \_\_in)\ \{}
\DoxyCodeLine{00442\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_\_in\ >=\ this-\/>\_\_data\_.size()\ ||\ \_\_in\ <\ 0)}
\DoxyCodeLine{00443\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00444\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::out\_of\_range(\textcolor{stringliteral}{"{}Access\ index\ is\ out\ of\ range"{}});}
\DoxyCodeLine{00445\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00446\ }
\DoxyCodeLine{00447\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ this-\/>\_\_data\_[\_\_in];}
\DoxyCodeLine{00448\ \ \ \ \ \}}
\DoxyCodeLine{00449\ }
\DoxyCodeLine{00450\ \ \ \ \ \mbox{\hyperlink{classtensor_aacd8d62096cc0d502cffd169e25f92f0}{const\_reference}}\ \mbox{\hyperlink{classtensor_a1d799d7498f5aa7cc6bc14cd89811736}{operator[]}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ \_\_in)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00451\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_\_in\ >=\ this-\/>\_\_data\_.size()\ ||\ \_\_in\ <\ 0)}
\DoxyCodeLine{00452\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00453\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::out\_of\_range(\textcolor{stringliteral}{"{}Access\ index\ is\ out\ of\ range"{}});}
\DoxyCodeLine{00454\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00455\ }
\DoxyCodeLine{00456\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ this-\/>\_\_data\_[\_\_in];}
\DoxyCodeLine{00457\ \ \ \ \ \}}
\DoxyCodeLine{00458\ }
\DoxyCodeLine{00459\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_a6b36211a42d25c7fcbdc420951ef3980}{operator+}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00460\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_af1cebd26ef00087d8c73e2e36101e513}{operator-\/}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00461\ }
\DoxyCodeLine{00462\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_ad92011956b17f6958aefeac943dfafee}{operator-\/=}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00463\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_a43fb9006c48d0f8b6ff83c515f49f2ed}{operator+=}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00464\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_a1eff5b2ee067c2b9b5d8ef6edd072460}{operator*=}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00465\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_a98997813fec16f4b37cbcf1220801c2f}{operator/=}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00466\ }
\DoxyCodeLine{00467\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_a625983cd49950299596f8b4f355101b0}{operator+}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor_a12614e7ef399b40d0eca22d10360149f}{value\_type}}\ \_scalar)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00468\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_a36c99d48529b3ab05fd460d6c90254ce}{operator-\/}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor_a12614e7ef399b40d0eca22d10360149f}{value\_type}}\ \_scalar)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00469\ }
\DoxyCodeLine{00470\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_a46ca2fdc27adf2fcf91315733d840f88}{operator+=}}(\mbox{\hyperlink{classtensor_aacd8d62096cc0d502cffd169e25f92f0}{const\_reference}}\ \_\_scalar)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00471\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_a29a72fe362d2919b391b19abb8501fc1}{operator-\/=}}(\mbox{\hyperlink{classtensor_aacd8d62096cc0d502cffd169e25f92f0}{const\_reference}}\ \_\_scalar)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00472\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_a98997813fec16f4b37cbcf1220801c2f}{operator/=}}(\mbox{\hyperlink{classtensor_aacd8d62096cc0d502cffd169e25f92f0}{const\_reference}}\ \_\_scalar)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00473\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_a49c9436fd5ca973697d23f7ee522dc19}{operator*=}}(\mbox{\hyperlink{classtensor_aacd8d62096cc0d502cffd169e25f92f0}{const\_reference}}\ \_\_scalar)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00474\ }
\DoxyCodeLine{00475\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classtensor_ad5f18cd6977c492f2d40c074c36456e1}{operator==}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00476\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((this-\/>\_\_shape\_\ !=\ \_\_other.\mbox{\hyperlink{classtensor_a33e40f89c3247e27e6bd03a992d73868}{shape}}())\ \&\&\ (this-\/>\_\_strides\_\ !=\ \_\_other.\mbox{\hyperlink{classtensor_a0c7bf412aa5a913b58b26dd0a1069077}{strides}}()))}
\DoxyCodeLine{00477\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00478\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00479\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00480\ }
\DoxyCodeLine{00481\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ this-\/>\_\_data\_\ ==\ \_\_other.\mbox{\hyperlink{classtensor_a4302a45c6c164b54316d6b869affca78}{storage}}();}
\DoxyCodeLine{00482\ \ \ \ \ \}}
\DoxyCodeLine{00483\ }
\DoxyCodeLine{00484\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classtensor_a52525f73888a2a980485aae22a4a3cb6}{operator!=}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ !(*\textcolor{keyword}{this}\ ==\ \_\_other);\ \}}
\DoxyCodeLine{00485\ }
\DoxyCodeLine{00486\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classtensor_a6001b8b369081b7cdeaed39304c165bf}{empty}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ this-\/>\_\_data\_.empty();\ \}}
\DoxyCodeLine{00487\ }
\DoxyCodeLine{00488\ \ \ \ \ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{classtensor_ad42a4223b51afd28b81182034b0abe1d}{mean}}()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00489\ }
\DoxyCodeLine{00490\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor<bool>}}\ \mbox{\hyperlink{classtensor_a96c722c8d9061c254da18c193a158014}{logical\_not}}()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00491\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor<bool>}}\ \mbox{\hyperlink{classtensor_a3ac04456abf5a11ea70c1d87d8f75f13}{logical\_or}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor_a12614e7ef399b40d0eca22d10360149f}{value\_type}}\ \_\_val)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00492\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor<bool>}}\ \mbox{\hyperlink{classtensor_a0dc360aa827e1525156c4b4a5de011c8}{logical\_or}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00493\ }
\DoxyCodeLine{00494\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor<bool>}}\ \mbox{\hyperlink{classtensor_a373dc75f35870b9e2c6a9f3531ac951f}{less\_equal}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00495\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor<bool>}}\ \mbox{\hyperlink{classtensor_a602d92df2b3622eee910a65021789821}{less\_equal}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor_a12614e7ef399b40d0eca22d10360149f}{value\_type}}\ \_\_val)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00496\ }
\DoxyCodeLine{00497\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor<bool>}}\ \mbox{\hyperlink{classtensor_a3037229a04911fdb49bf3d630d2ff9e8}{greater\_equal}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00498\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor<bool>}}\ \mbox{\hyperlink{classtensor_a617bac518334dd51278fb4bc02a2b300}{greater\_equal}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor_a12614e7ef399b40d0eca22d10360149f}{value\_type}}\ \_\_val)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00499\ }
\DoxyCodeLine{00500\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor<bool>}}\ \mbox{\hyperlink{classtensor_a8c769dc59060620bd81c9e3b3846f694}{equal}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00501\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor<bool>}}\ \mbox{\hyperlink{classtensor_aa4e11be82e26420084e5c631a6ac877c}{equal}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor_a12614e7ef399b40d0eca22d10360149f}{value\_type}}\ \_\_val)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00502\ }
\DoxyCodeLine{00503\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classtensor_a9e5024764efa18a9e882706d0d778821}{count\_nonzero}}(\mbox{\hyperlink{classtensor_aae15c34415ce3896c43cb656ee7e6059}{index\_type}}\ \_\_dim\ =\ -\/1LL)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00504\ }
\DoxyCodeLine{00505\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_a4b4e2d39e238aa3593cf23ca2f26e718}{slice}}(\mbox{\hyperlink{classtensor_aae15c34415ce3896c43cb656ee7e6059}{index\_type}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_dim,}
\DoxyCodeLine{00506\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::optional<index\_type>\ \_\_start,}
\DoxyCodeLine{00507\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::optional<index\_type>\ \_\_end,}
\DoxyCodeLine{00508\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classtensor_aae15c34415ce3896c43cb656ee7e6059}{index\_type}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_step)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00509\ }
\DoxyCodeLine{00510\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_a52752e0a9df45ae4789a7aeffb5a3886}{fmax}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00511\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_a58d80942a05a2ccd93a1ae69b0c3812e}{fmax}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor_a12614e7ef399b40d0eca22d10360149f}{value\_type}}\ \_\_val)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00512\ \ \ \ \ \textcolor{keywordtype}{void}\ \ \ \mbox{\hyperlink{classtensor_a50fcf3eb344fc6566d95db639681cada}{fmax\_}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other);}
\DoxyCodeLine{00513\ \ \ \ \ \textcolor{keywordtype}{void}\ \ \ \mbox{\hyperlink{classtensor_a50fcf3eb344fc6566d95db639681cada}{fmax\_}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor_a12614e7ef399b40d0eca22d10360149f}{value\_type}}\ \_\_val);}
\DoxyCodeLine{00514\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_afc4bd671a73337612886d180e1474a3d}{fmod}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00515\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_a20da53aa9024aff12cc0d640c42069a1}{fmod}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor_a12614e7ef399b40d0eca22d10360149f}{value\_type}}\ \_\_val)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00516\ }
\DoxyCodeLine{00517\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_a5160fd8a033949c11118968da884dc7b}{frac}}()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00518\ }
\DoxyCodeLine{00519\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_a3ea7dfde40f9c6770dc29c44056a2156}{log}}()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00520\ }
\DoxyCodeLine{00521\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_a602d6324093f123101cc7db2ba668469}{log10}}()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00522\ }
\DoxyCodeLine{00523\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_a3d32095f1a209c6f14791ff52b17ef36}{log2}}()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00524\ }
\DoxyCodeLine{00525\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_a875a2e416207ab7d21d7280f319d2811}{exp}}()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00526\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_a1d77db1bf021441a3def40f465aff222}{sqrt}}()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00527\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_a5e940a029c93f209885546325cd40137}{sum}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor_aae15c34415ce3896c43cb656ee7e6059}{index\_type}}\ \_\_axis)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00528\ }
\DoxyCodeLine{00529\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_af49007c641b05b186ed0194af4f34dfb}{row}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor_aae15c34415ce3896c43cb656ee7e6059}{index\_type}}\ \_\_index)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00530\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_a445a4b1ac467bcf53bb5066f2d30ac4b}{col}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor_aae15c34415ce3896c43cb656ee7e6059}{index\_type}}\ \_\_index)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00531\ }
\DoxyCodeLine{00532\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_aa95b96a066fd7c9fdf8b9544d073d240}{ceil}}()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00533\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_afcd98fdb4626e08981f63a424f4415e7}{floor}}()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00534\ }
\DoxyCodeLine{00535\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_af4d9ed02c039debcba0c7ce99197d08a}{clone}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00536\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classtensor_a1248d808ef5c7b0f868bfa7c0cc25f59}{data\_t}}\ \ \ \ \ \_\_d\ =\ this-\/>\_\_data\_;}
\DoxyCodeLine{00537\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classtensor_ab96aa71f8b92cb531a7e258f47315f45}{shape\_type}}\ \_\_s\ =\ this-\/>\_\_shape\_;}
\DoxyCodeLine{00538\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classtensor_ad3d7f4f7407f5b9e4db70d2e198b2d27}{\_\_self}}(\_\_d,\ \_\_s);}
\DoxyCodeLine{00539\ \ \ \ \ \}}
\DoxyCodeLine{00540\ }
\DoxyCodeLine{00541\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_ae3c45dc71c1090025661005112a1f834}{clamp}}(\mbox{\hyperlink{classtensor_a39d9b723cbcc4fbc18d2d655d1148166}{const\_pointer}}\ \_\_min\_val\ =\ \textcolor{keyword}{nullptr},\ \mbox{\hyperlink{classtensor_a39d9b723cbcc4fbc18d2d655d1148166}{const\_pointer}}\ \_\_max\_val\ =\ \textcolor{keyword}{nullptr})\ \textcolor{keyword}{const};}
\DoxyCodeLine{00542\ }
\DoxyCodeLine{00543\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_a1bf5fc465f680a3b33fb1c509bc4dc93}{cos}}()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00544\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_af0a1ce03a6de6dfff6a2ea5c99112a1e}{sin}}()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00545\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_aeb1b86b8cee70ea11835c73337472fde}{sinh}}()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00546\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_ad2e833191274a6b0dab157c1e11d64a4}{asinh}}()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00547\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_a929e7852fcd3caeefe513545d27037b3}{cosh}}()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00548\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_aebdbd731c2059f5cbbd5918c541ea986}{acosh}}()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00549\ }
\DoxyCodeLine{00550\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_a62d6154a5e082732a9f42327d071f09d}{logical\_xor}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00551\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_af8daceec856815ac882af82b0fbc84dc}{logical\_xor}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor_a12614e7ef399b40d0eca22d10360149f}{value\_type}}\ \_\_val)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00552\ }
\DoxyCodeLine{00553\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_a5a320fd86b0e479a6795cc4b61179a4b}{logical\_and}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00554\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_ac75503b9ffe82e9f4e705b56fbdf4431}{logical\_and}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor_a12614e7ef399b40d0eca22d10360149f}{value\_type}}\ \_\_val)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00555\ }
\DoxyCodeLine{00556\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_abd4feb2e4a8ea40a2aebb1c71a7d4ff1}{bitwise\_not}}()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00557\ }
\DoxyCodeLine{00558\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_a570fd42df92c758794f7e723d63eee44}{bitwise\_and}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor_a12614e7ef399b40d0eca22d10360149f}{value\_type}}\ \_\_val)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00559\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_ab97fa0c42bda04f0d6472c385ebad3df}{bitwise\_and}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00560\ }
\DoxyCodeLine{00561\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_a40250679b04095915146fef202c9ad0d}{bitwise\_or}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor_a12614e7ef399b40d0eca22d10360149f}{value\_type}}\ \_\_val)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00562\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_aa44e1727908dcde0b489636d39a9d36c}{bitwise\_or}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00563\ }
\DoxyCodeLine{00564\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_a200275c2657717c819dd999ed3cb9227}{bitwise\_xor}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor_a12614e7ef399b40d0eca22d10360149f}{value\_type}}\ \_\_val)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00565\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_ae10f9eaae862dc5d2310cd724cc2f8ac}{bitwise\_xor}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00566\ }
\DoxyCodeLine{00567\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_a2936dc04429a63739592064ea98880fb}{bitwise\_left\_shift}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \_\_amount)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00568\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_a947c9bfcbd602caa26a4d95530d70aa6}{bitwise\_right\_shift}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \_\_amount)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00569\ }
\DoxyCodeLine{00570\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_aaad2cf47c11950f3eadb37e979f80915}{matmul}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00571\ }
\DoxyCodeLine{00572\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_af80b79db3a2ac60e6cae9a419040a612}{reshape}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor_ab96aa71f8b92cb531a7e258f47315f45}{shape\_type}}\ \_\_shape)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00573\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_a81940759f28f7a48c816cd9ec446b9b3}{reshape\_as}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\ \{\ \textcolor{keywordflow}{return}\ this-\/>\mbox{\hyperlink{classtensor_af80b79db3a2ac60e6cae9a419040a612}{reshape}}(\_\_other.\_\_shape\_);\ \}}
\DoxyCodeLine{00574\ }
\DoxyCodeLine{00575\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_a387313f030fd5a23bf15e9995d0adc17}{cross\_product}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00576\ }
\DoxyCodeLine{00577\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_a095db7282b7b96c942254897446a2d7a}{absolute}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_tensor)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00578\ }
\DoxyCodeLine{00579\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_a8f97c11689b76f314fea48555461b56b}{dot}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00580\ }
\DoxyCodeLine{00581\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_ab4a4f04b5b3cd8a3995aae37e4c8febe}{relu}}()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00582\ }
\DoxyCodeLine{00583\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_aa0400a2a89687c79b39aae7df2fdf5cf}{transpose}}()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00584\ }
\DoxyCodeLine{00585\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_a3a1c379f02eb70c79bf377ad66e179de}{pow}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00586\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_a0f48db22414046cc753f29b2c200668f}{pow}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor_a12614e7ef399b40d0eca22d10360149f}{value\_type}}\ \_\_val)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00587\ }
\DoxyCodeLine{00588\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_a70e4695eb515074f90a7bdc0e44cff6d}{cumprod}}(\mbox{\hyperlink{classtensor_aae15c34415ce3896c43cb656ee7e6059}{index\_type}}\ \_\_dim\ =\ -\/1)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00589\ }
\DoxyCodeLine{00590\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_a7f8ce161d42ac5aaec8a1c9a461e21f7}{cat}}(\textcolor{keyword}{const}\ std::vector<tensor>\&\ \_others,\ \mbox{\hyperlink{classtensor_aae15c34415ce3896c43cb656ee7e6059}{index\_type}}\ \_dim)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00591\ }
\DoxyCodeLine{00592\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_a6a468a01a82f881e6adb610bd87bb127}{argmax}}(\mbox{\hyperlink{classtensor_aae15c34415ce3896c43cb656ee7e6059}{index\_type}}\ \_\_dim)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00593\ }
\DoxyCodeLine{00594\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_a1610887cad5d2ea8a0eef6fb5e38fd9f}{unsqueeze}}(\mbox{\hyperlink{classtensor_aae15c34415ce3896c43cb656ee7e6059}{index\_type}}\ \_\_dim)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00595\ }
\DoxyCodeLine{00596\ \ \ \ \ \mbox{\hyperlink{classtensor_aae15c34415ce3896c43cb656ee7e6059}{index\_type}}\ \mbox{\hyperlink{classtensor_a81394901132a9eaf23d2b8750ef0b064}{lcm}}()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00597\ \ \ \ \ \textcolor{keywordtype}{void}\ \ \ \ \ \ \ \mbox{\hyperlink{classtensor_a5558b4bd06c2493e3fff919f7bcf3f28}{sqrt\_}}()\ \{}
\DoxyCodeLine{00598\ \ \ \ \ \ \ \ \ this-\/>\_\_check\_is\_scalar\_type(\textcolor{stringliteral}{"{}Cannot\ get\ the\ exponential\ of\ non\ scalar\ values"{}});}
\DoxyCodeLine{00599\ }
\DoxyCodeLine{00600\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{00601\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{00602\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00603\ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i]\ =\ \textcolor{keyword}{static\_cast<}\mbox{\hyperlink{classtensor_a12614e7ef399b40d0eca22d10360149f}{value\_type}}\textcolor{keyword}{>}(std::exp(\textcolor{keywordtype}{double}(this-\/>\_\_data\_[\_\_i])));}
\DoxyCodeLine{00604\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00605\ \ \ \ \ \}}
\DoxyCodeLine{00606\ }
\DoxyCodeLine{00607\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_af157a541d53f179a11390a5150c8616c}{exp\_}}()\ \{}
\DoxyCodeLine{00608\ \ \ \ \ \ \ \ \ this-\/>\_\_check\_is\_scalar\_type(\textcolor{stringliteral}{"{}Cannot\ get\ the\ exponential\ of\ non\ scalar\ values"{}});}
\DoxyCodeLine{00609\ }
\DoxyCodeLine{00610\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{00611\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{00612\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00613\ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i]\ =\ \textcolor{keyword}{static\_cast<}\mbox{\hyperlink{classtensor_a12614e7ef399b40d0eca22d10360149f}{value\_type}}\textcolor{keyword}{>}(std::exp(\textcolor{keywordtype}{double}(this-\/>\_\_data\_[\_\_i])));}
\DoxyCodeLine{00614\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00615\ \ \ \ \ \}}
\DoxyCodeLine{00616\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_aff085a6faf6db3c4c390076be3b29ef2}{log2\_}}()\ \{}
\DoxyCodeLine{00617\ \ \ \ \ \ \ \ \ this-\/>\_\_check\_is\_integral\_type(\textcolor{stringliteral}{"{}Given\ data\ type\ must\ be\ an\ integral"{}});}
\DoxyCodeLine{00618\ }
\DoxyCodeLine{00619\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{00620\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{00621\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00622\ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i]\ =\ \textcolor{keyword}{static\_cast<}\mbox{\hyperlink{classtensor_a12614e7ef399b40d0eca22d10360149f}{value\_type}}\textcolor{keyword}{>}(std::log2(\textcolor{keywordtype}{double}(this-\/>\_\_data\_[\_\_i])));}
\DoxyCodeLine{00623\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00624\ \ \ \ \ \}}
\DoxyCodeLine{00625\ }
\DoxyCodeLine{00626\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_aa68d8032a606f2001d0730ad6aec7ed7}{log10\_}}()\ \{}
\DoxyCodeLine{00627\ \ \ \ \ \ \ \ \ this-\/>\_\_check\_is\_integral\_type(\textcolor{stringliteral}{"{}Given\ data\ type\ must\ be\ an\ integral"{}});}
\DoxyCodeLine{00628\ }
\DoxyCodeLine{00629\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{00630\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{00631\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00632\ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i]\ =\ \textcolor{keyword}{static\_cast<}\mbox{\hyperlink{classtensor_a12614e7ef399b40d0eca22d10360149f}{value\_type}}\textcolor{keyword}{>}(std::log10(\textcolor{keywordtype}{double}(this-\/>\_\_data\_[\_\_i])));}
\DoxyCodeLine{00633\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00634\ \ \ \ \ \}}
\DoxyCodeLine{00635\ }
\DoxyCodeLine{00636\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_aa9fc20caa8cf9a1a57a44c74edd2be2b}{log\_}}()\ \{}
\DoxyCodeLine{00637\ \ \ \ \ \ \ \ \ this-\/>\_\_check\_is\_integral\_type(\textcolor{stringliteral}{"{}Given\ data\ type\ must\ be\ an\ integral"{}});}
\DoxyCodeLine{00638\ }
\DoxyCodeLine{00639\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{00640\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{00641\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00642\ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i]\ =\ \textcolor{keyword}{static\_cast<}\mbox{\hyperlink{classtensor_a12614e7ef399b40d0eca22d10360149f}{value\_type}}\textcolor{keyword}{>}(std::log(\textcolor{keywordtype}{double}(this-\/>\_\_data\_[\_\_i])));}
\DoxyCodeLine{00643\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00644\ \ \ \ \ \}}
\DoxyCodeLine{00645\ }
\DoxyCodeLine{00646\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_affbb069c3c362649a62f1a71c33a9a21}{frac\_}}()\ \{}
\DoxyCodeLine{00647\ \ \ \ \ \ \ \ \ this-\/>\_\_check\_is\_scalar\_type(\textcolor{stringliteral}{"{}Cannot\ get\ the\ fraction\ of\ a\ non-\/scalar\ type"{}});}
\DoxyCodeLine{00648\ }
\DoxyCodeLine{00649\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{00650\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{00651\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00652\ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i]\ =\ \textcolor{keyword}{static\_cast<}\mbox{\hyperlink{classtensor_a12614e7ef399b40d0eca22d10360149f}{value\_type}}\textcolor{keyword}{>}(this-\/>\_\_frac(this-\/>\_\_data\_[\_\_i]));}
\DoxyCodeLine{00653\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00654\ \ \ \ \ \}}
\DoxyCodeLine{00655\ }
\DoxyCodeLine{00656\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_a55144a057c60a4feae1c4a5d884a6e08}{fmod\_}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other);}
\DoxyCodeLine{00657\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_a0aa2f12fca6336546f5a692cd5fe03a1}{fmod\_}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor_a12614e7ef399b40d0eca22d10360149f}{value\_type}}\ \_\_val);}
\DoxyCodeLine{00658\ }
\DoxyCodeLine{00659\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_aa7466d7c1c7eac81e1500964807c6a87}{cos\_}}()\ \{}
\DoxyCodeLine{00660\ \ \ \ \ \ \ \ \ this-\/>\_\_check\_is\_scalar\_type(\textcolor{stringliteral}{"{}Cannot\ perform\ a\ cosine\ on\ non-\/scalar\ data\ type"{}});}
\DoxyCodeLine{00661\ }
\DoxyCodeLine{00662\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{00663\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{00664\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00665\ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i]\ =}
\DoxyCodeLine{00666\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{static\_cast<}\mbox{\hyperlink{classtensor_a12614e7ef399b40d0eca22d10360149f}{value\_type}}\textcolor{keyword}{>}(std::cos(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(this-\/>\_\_data\_[\_\_i])));}
\DoxyCodeLine{00667\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00668\ \ \ \ \ \}}
\DoxyCodeLine{00669\ }
\DoxyCodeLine{00670\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_a6be46341930fb272ae132eb81cb78e99}{cosh\_}}()\ \{}
\DoxyCodeLine{00671\ \ \ \ \ \ \ \ \ this-\/>\_\_check\_is\_scalar\_type(\textcolor{stringliteral}{"{}Cannot\ perform\ a\ cosh\ on\ non-\/scalar\ data\ type"{}});}
\DoxyCodeLine{00672\ }
\DoxyCodeLine{00673\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{00674\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{00675\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00676\ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i]\ =}
\DoxyCodeLine{00677\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{static\_cast<}\mbox{\hyperlink{classtensor_a12614e7ef399b40d0eca22d10360149f}{value\_type}}\textcolor{keyword}{>}(std::cosh(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(this-\/>\_\_data\_[\_\_i])));}
\DoxyCodeLine{00678\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00679\ \ \ \ \ \}}
\DoxyCodeLine{00680\ }
\DoxyCodeLine{00681\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_af8d95d60da860cd5658c368afbac8382}{acosh\_}}()\ \{}
\DoxyCodeLine{00682\ \ \ \ \ \ \ \ \ this-\/>\_\_check\_is\_scalar\_type(\textcolor{stringliteral}{"{}Cannot\ perform\ a\ acosh\ on\ non-\/scalar\ data\ type"{}});}
\DoxyCodeLine{00683\ }
\DoxyCodeLine{00684\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{00685\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{00686\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00687\ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i]\ =}
\DoxyCodeLine{00688\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{static\_cast<}\mbox{\hyperlink{classtensor_a12614e7ef399b40d0eca22d10360149f}{value\_type}}\textcolor{keyword}{>}(std::acosh(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(this-\/>\_\_data\_[\_\_i])));}
\DoxyCodeLine{00689\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00690\ \ \ \ \ \}}
\DoxyCodeLine{00691\ }
\DoxyCodeLine{00692\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_a6950ceb8984fc959053f113d567b16a5}{sinh\_}}()\ \{}
\DoxyCodeLine{00693\ \ \ \ \ \ \ \ \ this-\/>\_\_check\_is\_scalar\_type(\textcolor{stringliteral}{"{}Cannot\ perform\ a\ sin\ on\ non-\/scalar\ data\ type"{}});}
\DoxyCodeLine{00694\ }
\DoxyCodeLine{00695\ \ \ \ \ \ \ \ \ std::transform(this-\/>\_\_data\_.begin(),\ this-\/>\_\_data\_.end(),\ this-\/>\_\_data\_.begin(),}
\DoxyCodeLine{00696\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [](\mbox{\hyperlink{classtensor_aacd8d62096cc0d502cffd169e25f92f0}{const\_reference}}\ \_\_v)\ \{}
\DoxyCodeLine{00697\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ return\ static\_cast<value\_type>(std::sinh(static\_cast<double>(\_\_v)))}
\DoxyCodeLine{00698\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{00699\ \ \ \ \ \}}
\DoxyCodeLine{00700\ }
\DoxyCodeLine{00701\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_a530fc216c0ba29e0d952e9fb1cce2eae}{asinh\_}}()\ \{}
\DoxyCodeLine{00702\ \ \ \ \ \ \ \ \ this-\/>\_\_check\_is\_scalar\_type(\textcolor{stringliteral}{"{}Cannot\ perform\ asinh\ on\ non-\/scalar\ data\ type"{}});}
\DoxyCodeLine{00703\ }
\DoxyCodeLine{00704\ \ \ \ \ \ \ \ \ std::transform(this-\/>\_\_data\_.begin(),\ this-\/>\_\_data\_.end(),\ this-\/>\_\_data\_.begin(),}
\DoxyCodeLine{00705\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [](\mbox{\hyperlink{classtensor_aacd8d62096cc0d502cffd169e25f92f0}{const\_reference}}\ \_\_v)\ \{}
\DoxyCodeLine{00706\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ return\ static\_cast<value\_type>(std::asinh(static\_cast<double>(\_\_v)))}
\DoxyCodeLine{00707\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{00708\ \ \ \ \ \}}
\DoxyCodeLine{00709\ }
\DoxyCodeLine{00710\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_a8b43919732fd6187b53ff8ddd18ee860}{ceil\_}}()\ \{}
\DoxyCodeLine{00711\ \ \ \ \ \ \ \ \ this-\/>\_\_check\_is\_scalar\_type(\textcolor{stringliteral}{"{}Cannot\ get\ the\ ceiling\ of\ a\ non\ scalar\ value"{}});}
\DoxyCodeLine{00712\ }
\DoxyCodeLine{00713\ \ \ \ \ \ \ \ \ std::transform(this-\/>\_\_data\_.begin(),\ this-\/>\_\_data\_.end(),\ this-\/>\_\_data\_.begin(),}
\DoxyCodeLine{00714\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [](\mbox{\hyperlink{classtensor_aacd8d62096cc0d502cffd169e25f92f0}{const\_reference}}\ \_\_v)\ \{}
\DoxyCodeLine{00715\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ return\ static\_cast<value\_type>(std::ceil(static\_cast<double>(\_\_v)))}
\DoxyCodeLine{00716\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{00717\ \ \ \ \ \}}
\DoxyCodeLine{00718\ }
\DoxyCodeLine{00719\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_a6318a92fdf6474f9b2f8cde820f2230d}{floor\_}}()\ \{}
\DoxyCodeLine{00720\ \ \ \ \ \ \ \ \ this-\/>\_\_check\_is\_scalar\_type(\textcolor{stringliteral}{"{}Cannot\ get\ the\ floor\ of\ a\ non\ scalar\ value"{}});}
\DoxyCodeLine{00721\ }
\DoxyCodeLine{00722\ \ \ \ \ \ \ \ \ std::transform(this-\/>\_\_data\_.begin(),\ this-\/>\_\_data\_.end(),\ this-\/>\_\_data\_.begin(),}
\DoxyCodeLine{00723\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [](\mbox{\hyperlink{classtensor_aacd8d62096cc0d502cffd169e25f92f0}{const\_reference}}\ \_\_v)\ \{}
\DoxyCodeLine{00724\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ return\ static\_cast<value\_type>(std::floor(static\_cast<double>(\_\_v)))}
\DoxyCodeLine{00725\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{00726\ \ \ \ \ \}}
\DoxyCodeLine{00727\ }
\DoxyCodeLine{00728\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_a5d175d2c6884b43e1530fead8df35aed}{sin\_}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00729\ \ \ \ \ \ \ \ \ this-\/>\_\_check\_is\_scalar\_type(\textcolor{stringliteral}{"{}Cannot\ perform\ a\ sin\ on\ non-\/scalar\ data\ type"{}});}
\DoxyCodeLine{00730\ }
\DoxyCodeLine{00731\ \ \ \ \ \ \ \ \ std::transform(this-\/>\_\_data\_.begin(),\ this-\/>\_\_data\_.end(),\ this-\/>\_\_data\_.begin(),}
\DoxyCodeLine{00732\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [](\mbox{\hyperlink{classtensor_aacd8d62096cc0d502cffd169e25f92f0}{const\_reference}}\ \_\_v)\ \{}
\DoxyCodeLine{00733\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ return\ static\_cast<value\_type>(std::sin(static\_cast<double>(\_\_v)))}
\DoxyCodeLine{00734\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{00735\ \ \ \ \ \}}
\DoxyCodeLine{00736\ }
\DoxyCodeLine{00737\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_a0e71c49ca5485d2407842ee72c1e5aad}{relu\_}}();}
\DoxyCodeLine{00738\ }
\DoxyCodeLine{00739\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_a611871f79215f582779adbea1a661882}{clamp\_}}(\mbox{\hyperlink{classtensor_a39d9b723cbcc4fbc18d2d655d1148166}{const\_pointer}}\ \_\_min\_val\ =\ \textcolor{keyword}{nullptr},\ \mbox{\hyperlink{classtensor_a39d9b723cbcc4fbc18d2d655d1148166}{const\_pointer}}\ \_\_max\_val\ =\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{00740\ }
\DoxyCodeLine{00741\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_ac57983dd6df8f7ca1928e163617e3f39}{logical\_not\_}}()\textcolor{keyword}{\ const\ }\{\ this-\/>\mbox{\hyperlink{classtensor_a094082f2e570f061d5ab0286deefd28b}{bitwise\_not\_}}();\ \}}
\DoxyCodeLine{00742\ }
\DoxyCodeLine{00743\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_ac8252b697b080ee7a46df90d49a71cd2}{logical\_or\_}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other);}
\DoxyCodeLine{00744\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_ab32cb8d651eff3944a937a5a44475fa9}{logical\_or\_}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor_a12614e7ef399b40d0eca22d10360149f}{value\_type}}\ \_\_val);}
\DoxyCodeLine{00745\ }
\DoxyCodeLine{00746\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_a49863ae3e46368e7608cfbcc7a6457b4}{logical\_xor\_}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other);}
\DoxyCodeLine{00747\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_a1a295718e73e075331e2b06d666bc134}{logical\_xor\_}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor_a12614e7ef399b40d0eca22d10360149f}{value\_type}}\ \_\_val);}
\DoxyCodeLine{00748\ }
\DoxyCodeLine{00749\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_ac353f80c126101bd565874c2e0f23dfc}{logical\_and\_}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other);}
\DoxyCodeLine{00750\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_a415f1ec4d32aea3314f67b8f33d3e7a2}{logical\_and\_}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor_a12614e7ef399b40d0eca22d10360149f}{value\_type}}\ \_\_val);}
\DoxyCodeLine{00751\ }
\DoxyCodeLine{00752\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_aa15e56eab9d8b11d43850d01fdd092f3}{pow\_}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00753\ }
\DoxyCodeLine{00754\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_a1a3d2d15c484dfbc9c059466f39b2fcb}{pow\_}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor_a12614e7ef399b40d0eca22d10360149f}{value\_type}}\ \_\_val)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00755\ \ \ \ \ \ \ \ \ this-\/>\_\_check\_is\_integral\_type(\textcolor{stringliteral}{"{}cannot\ get\ the\ power\ of\ a\ non\ integral\ value"{}});}
\DoxyCodeLine{00756\ }
\DoxyCodeLine{00757\ \ \ \ \ \ \ \ \ std::transform(this-\/>\_\_data\_.begin(),\ this-\/>\_\_data\_.end(),\ this-\/>\_\_data\_.begin(),}
\DoxyCodeLine{00758\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [\&\_\_val](\mbox{\hyperlink{classtensor_aacd8d62096cc0d502cffd169e25f92f0}{const\_reference}}\ \_\_v)\ \{}
\DoxyCodeLine{00759\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ return\ static\_cast<value\_type>(}
\DoxyCodeLine{00760\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::pow(static\_cast<double>(\_\_v),\ static\_cast<double>(\_\_val)))}
\DoxyCodeLine{00761\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{00762\ \ \ \ \ \}}
\DoxyCodeLine{00763\ }
\DoxyCodeLine{00764\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_a588b233c0544bd96ccadd31159965819}{bitwise\_left\_shift\_}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \_\_amount)\ \{}
\DoxyCodeLine{00765\ \ \ \ \ \ \ \ \ this-\/>\_\_check\_is\_integral\_type(}
\DoxyCodeLine{00766\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Cannot\ perform\ a\ bitwise\ left\ shift\ on\ non-\/integral\ values"{}});}
\DoxyCodeLine{00767\ }
\DoxyCodeLine{00768\ \ \ \ \ \ \ \ \ std::transform(this-\/>\_\_data\_.begin(),\ this-\/>\_\_data\_.end(),\ this-\/>\_\_data\_.begin(),}
\DoxyCodeLine{00769\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [\&\_\_amount](\mbox{\hyperlink{classtensor_aacd8d62096cc0d502cffd169e25f92f0}{const\_reference}}\ \_\_v)\ \{\ return\ \_\_v\ <<=\ \_\_amount;\ \});}
\DoxyCodeLine{00770\ \ \ \ \ \}}
\DoxyCodeLine{00771\ }
\DoxyCodeLine{00772\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_a01b4a1e84d5c98b0e318ba0e6e760a5f}{bitwise\_right\_shift\_}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \_\_amount)\ \{}
\DoxyCodeLine{00773\ \ \ \ \ \ \ \ \ this-\/>\_\_check\_is\_integral\_type(}
\DoxyCodeLine{00774\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Cannot\ perform\ a\ bitwise\ right\ shift\ on\ non-\/integral\ values"{}});}
\DoxyCodeLine{00775\ }
\DoxyCodeLine{00776\ \ \ \ \ \ \ \ \ std::transform(this-\/>\_\_data\_.begin(),\ this-\/>\_\_data\_.end(),\ this-\/>\_\_data\_.begin(),}
\DoxyCodeLine{00777\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [\&\_\_amount](\mbox{\hyperlink{classtensor_aacd8d62096cc0d502cffd169e25f92f0}{const\_reference}}\ \_\_v)\ \{\ return\ \_\_v\ >>=\ amount;\ \});}
\DoxyCodeLine{00778\ \ \ \ \ \}}
\DoxyCodeLine{00779\ }
\DoxyCodeLine{00780\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_a4133a204312218f5808198d560ef5fd9}{bitwise\_and\_}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor_a12614e7ef399b40d0eca22d10360149f}{value\_type}}\ \_\_val);}
\DoxyCodeLine{00781\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_a7c6bc045229a0721f2ba1e4807fb9fc1}{bitwise\_and\_}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other);}
\DoxyCodeLine{00782\ }
\DoxyCodeLine{00783\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_aee01d672a9e2a64a5d0b448e51c5b9e6}{bitwise\_or\_}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor_a12614e7ef399b40d0eca22d10360149f}{value\_type}}\ \_\_val);}
\DoxyCodeLine{00784\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_a316a87bcf02f171ec2c51b06490dd9b1}{bitwise\_or\_}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other);}
\DoxyCodeLine{00785\ }
\DoxyCodeLine{00786\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_aa739b2a5c0e940507c890bdd44f6de61}{bitwise\_xor\_}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor_a12614e7ef399b40d0eca22d10360149f}{value\_type}}\ \_\_val);}
\DoxyCodeLine{00787\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_a46542542550e40fa48d8436b570a0bea}{bitwise\_xor\_}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other);}
\DoxyCodeLine{00788\ }
\DoxyCodeLine{00789\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_a094082f2e570f061d5ab0286deefd28b}{bitwise\_not\_}}();}
\DoxyCodeLine{00790\ }
\DoxyCodeLine{00791\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_a3acb46cbe6fef2c976377230ac7f55af}{view}}(std::initializer\_list<index\_type>\ \_\_new\_sh);}
\DoxyCodeLine{00792\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_a8450490717c0f64e904eb184ea3f95e1}{print}}()\ const\ noexcept;}
\DoxyCodeLine{00793\ }
\DoxyCodeLine{00794\ \ \ \ \ static\ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_a208ccff9884d31ed1039902622e9472e}{zeros}}(const\ \mbox{\hyperlink{classtensor_ab96aa71f8b92cb531a7e258f47315f45}{shape\_type}}\&\ \_\_sh)\ \{}
\DoxyCodeLine{00795\ \ \ \ \ \ \ \ \ \_\_check\_is\_scalar\_type(\textcolor{stringliteral}{"{}template\ type\ must\ be\ a\ scalar\ :\ tensor.zeros()"{}});}
\DoxyCodeLine{00796\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classtensor_a1248d808ef5c7b0f868bfa7c0cc25f59}{data\_t}}\ \_\_d(std::accumulate(\_\_sh.begin(),\ \_\_sh.end(),\ 1,\ std::multiplies<index\_type>()),}
\DoxyCodeLine{00797\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classtensor_a12614e7ef399b40d0eca22d10360149f}{value\_type}}(0));}
\DoxyCodeLine{00798\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classtensor_ad3d7f4f7407f5b9e4db70d2e198b2d27}{\_\_self}}(\_\_d,\ \_\_sh);}
\DoxyCodeLine{00799\ \ \ \ \ \}}
\DoxyCodeLine{00800\ }
\DoxyCodeLine{00801\ \ \ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_a6fde11f54df73f6cf14224471f38f72b}{ones}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor_ab96aa71f8b92cb531a7e258f47315f45}{shape\_type}}\&\ \_\_sh)\ \{}
\DoxyCodeLine{00802\ \ \ \ \ \ \ \ \ \_\_check\_is\_scalar\_type(\textcolor{stringliteral}{"{}template\ type\ must\ be\ a\ scalar\ :\ tensor.ones()"{}});}
\DoxyCodeLine{00803\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classtensor_a1248d808ef5c7b0f868bfa7c0cc25f59}{data\_t}}\ \_\_d(std::accumulate(\_\_sh.begin(),\ \_\_sh.end(),\ 1,\ std::multiplies<index\_type>()),}
\DoxyCodeLine{00804\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classtensor_a12614e7ef399b40d0eca22d10360149f}{value\_type}}(1));}
\DoxyCodeLine{00805\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classtensor_ad3d7f4f7407f5b9e4db70d2e198b2d27}{\_\_self}}(\_\_d,\ \_\_sh);}
\DoxyCodeLine{00806\ \ \ \ \ \}}
\DoxyCodeLine{00807\ }
\DoxyCodeLine{00808\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_ade1cbb40531ba39910276a996ac71171}{zeros\_}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor_ab96aa71f8b92cb531a7e258f47315f45}{shape\_type}}\&\ \_\_sh\ =\ \{\})\ \{}
\DoxyCodeLine{00809\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_\_sh.empty())}
\DoxyCodeLine{00810\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00811\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_sh\ =\ this-\/>\_\_shape\_;}
\DoxyCodeLine{00812\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00813\ }
\DoxyCodeLine{00814\ \ \ \ \ \ \ \ \ this-\/>\_\_data\_\ =}
\DoxyCodeLine{00815\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classtensor_a1248d808ef5c7b0f868bfa7c0cc25f59}{data\_t}}(std::accumulate(\_\_sh.begin(),\ \_\_sh.end(),\ 1,\ std::multiplies<index\_type>()),}
\DoxyCodeLine{00816\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classtensor_a12614e7ef399b40d0eca22d10360149f}{value\_type}}(0));}
\DoxyCodeLine{00817\ \ \ \ \ \}}
\DoxyCodeLine{00818\ }
\DoxyCodeLine{00819\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_af85d365f1742ecfeb53d45078c6bb175}{ones\_}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor_ab96aa71f8b92cb531a7e258f47315f45}{shape\_type}}\&\ \_\_sh\ =\ \{\})\ \{}
\DoxyCodeLine{00820\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_\_sh.empty())}
\DoxyCodeLine{00821\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00822\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_sh\ =\ this-\/>\_\_shape\_;}
\DoxyCodeLine{00823\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00824\ }
\DoxyCodeLine{00825\ \ \ \ \ \ \ \ \ this-\/>\_\_data\_\ =}
\DoxyCodeLine{00826\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classtensor_a1248d808ef5c7b0f868bfa7c0cc25f59}{data\_t}}(std::accumulate(\_\_sh.begin(),\ \_\_sh.end(),\ 1,\ std::multiplies<index\_type>()),}
\DoxyCodeLine{00827\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classtensor_a12614e7ef399b40d0eca22d10360149f}{value\_type}}(0));}
\DoxyCodeLine{00828\ \ \ \ \ \}}
\DoxyCodeLine{00829\ }
\DoxyCodeLine{00830\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_a0206a53b82db00a90635877556a9b987}{randomize}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor_ab96aa71f8b92cb531a7e258f47315f45}{shape\_type}}\&\ \_\_sh,\ \textcolor{keywordtype}{bool}\ \_\_bounded\ =\ \textcolor{keyword}{false});}
\DoxyCodeLine{00831\ \ \ \ \ \textcolor{keywordtype}{void}\ \ \ \mbox{\hyperlink{classtensor_a43f96a71e4140f306bfc89519496b56c}{randomize\_}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor_ab96aa71f8b92cb531a7e258f47315f45}{shape\_type}}\&\ \_\_sh,\ \textcolor{keywordtype}{bool}\ \_\_bounded\ =\ \textcolor{keyword}{false});}
\DoxyCodeLine{00832\ }
\DoxyCodeLine{00833\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor<index\_type>}}\ \mbox{\hyperlink{classtensor_a203dab98de49051f7b975d4ce9b13061}{argmax\_}}(\mbox{\hyperlink{classtensor_aae15c34415ce3896c43cb656ee7e6059}{index\_type}}\ \_\_dim)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00834\ }
\DoxyCodeLine{00835\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor<index\_type>}}\ \mbox{\hyperlink{classtensor_a03ecdc6c4d5aa8e4574db454cc5222f9}{argsort}}(\mbox{\hyperlink{classtensor_aae15c34415ce3896c43cb656ee7e6059}{index\_type}}\ \_\_dim\ =\ -\/1LL,\ \textcolor{keywordtype}{bool}\ \_\_ascending\ =\ \textcolor{keyword}{true})\ \textcolor{keyword}{const};}
\DoxyCodeLine{00836\ }
\DoxyCodeLine{00837\ \ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00838\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ \_\_check\_is\_scalar\_type(\textcolor{keyword}{const}\ std::string\ \_\_msg)\ \{}
\DoxyCodeLine{00839\ \ \ \ \ \ \ \ \ assert(!\_\_msg.empty());}
\DoxyCodeLine{00840\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!std::is\_scalar<value\_type>::value)}
\DoxyCodeLine{00841\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00842\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(\_\_msg);}
\DoxyCodeLine{00843\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00844\ \ \ \ \ \}}
\DoxyCodeLine{00845\ }
\DoxyCodeLine{00846\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ \_\_check\_is\_integral\_type(\textcolor{keyword}{const}\ std::string\ \_\_msg)\ \{}
\DoxyCodeLine{00847\ \ \ \ \ \ \ \ \ assert(!\_\_msg.empty());}
\DoxyCodeLine{00848\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!std::is\_integral<value\_type>::value)}
\DoxyCodeLine{00849\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00850\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(\_\_msg);}
\DoxyCodeLine{00851\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00852\ \ \ \ \ \}}
\DoxyCodeLine{00853\ }
\DoxyCodeLine{00854\ \ \ \ \ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ \_\_t>}
\DoxyCodeLine{00855\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ \_\_check\_is\_same\_type(\textcolor{keyword}{const}\ std::string\ \_\_msg)\ \{}
\DoxyCodeLine{00856\ \ \ \ \ \ \ \ \ assert(!\_\_msg.empty());}
\DoxyCodeLine{00857\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!std::is\_same<value\_type,\ \_\_t>::value)}
\DoxyCodeLine{00858\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00859\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(\_\_msg);}
\DoxyCodeLine{00860\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00861\ \ \ \ \ \}}
\DoxyCodeLine{00862\ }
\DoxyCodeLine{00863\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ \_\_check\_is\_arithmetic\_type(\textcolor{keyword}{const}\ std::string\ \_\_msg)\ \{}
\DoxyCodeLine{00864\ \ \ \ \ \ \ \ \ assert(!\_\_msg.empty());}
\DoxyCodeLine{00865\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!std::is\_arithmetic<value\_type>::value)}
\DoxyCodeLine{00866\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00867\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(\_\_msg);}
\DoxyCodeLine{00868\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00869\ \ \ \ \ \}}
\DoxyCodeLine{00870\ }
\DoxyCodeLine{00871\ \ \ \ \ \textcolor{keywordtype}{void}\ \_\_compute\_strides()\ \{}
\DoxyCodeLine{00872\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (this-\/>\_\_shape\_.empty())}
\DoxyCodeLine{00873\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00874\ \ \ \ \ \ \ \ \ \ \ \ \ std::cerr\ <<\ \textcolor{stringliteral}{"{}Shape\ must\ be\ initialized\ before\ computing\ strides"{}}\ <<\ std::endl;}
\DoxyCodeLine{00875\ \ \ \ \ \ \ \ \ \ \ \ \ std::exit(EXIT\_FAILURE);}
\DoxyCodeLine{00876\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00877\ }
\DoxyCodeLine{00878\ \ \ \ \ \ \ \ \ this-\/>\_\_strides\_\ =\ \mbox{\hyperlink{classtensor_ab96aa71f8b92cb531a7e258f47315f45}{shape\_type}}(this-\/>\_\_shape\_.size(),\ 1);}
\DoxyCodeLine{00879\ }
\DoxyCodeLine{00880\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classtensor_aae15c34415ce3896c43cb656ee7e6059}{index\_type}}\ \_\_st\ =\ 1,\ \_\_i\ =\ this-\/>\_\_shape\_.size()\ -\/\ 1;}
\DoxyCodeLine{00881\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ >=\ 0;\ \_\_i-\/-\/)}
\DoxyCodeLine{00882\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00883\ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>\_\_strides\_[\_\_i]\ =\ \_\_st;}
\DoxyCodeLine{00884\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_st\ *=\ this-\/>\_\_shape\_[\_\_i];}
\DoxyCodeLine{00885\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00886\ \ \ \ \ \}}
\DoxyCodeLine{00887\ }
\DoxyCodeLine{00888\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_compute\_index(\textcolor{keyword}{const}\ std::vector<index\_type>\&\ \_\_idx)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00889\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_\_idx.size()\ !=\ this-\/>\_\_shape\_.size())}
\DoxyCodeLine{00890\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00891\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::out\_of\_range(\textcolor{stringliteral}{"{}input\ indices\ does\ not\ match\ the\ tensor\ \_\_shape\_"{}});}
\DoxyCodeLine{00892\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00893\ }
\DoxyCodeLine{00894\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_index\ =\ 0,\ \_\_i\ =\ 0;}
\DoxyCodeLine{00895\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_shape\_.size();\ \_\_i++)}
\DoxyCodeLine{00896\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00897\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_index\ +=\ \_\_idx[\_\_i]\ *\ this-\/>\_\_strides\_[\_\_i];}
\DoxyCodeLine{00898\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00899\ }
\DoxyCodeLine{00900\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_index;}
\DoxyCodeLine{00901\ \ \ \ \ \}}
\DoxyCodeLine{00902\ }
\DoxyCodeLine{00903\ \ \ \ \ \textcolor{keyword}{static}\ uint64\_t\ \_\_computeSize(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor_ab96aa71f8b92cb531a7e258f47315f45}{shape\_type}}\&\ \_\_dims)\ \{}
\DoxyCodeLine{00904\ \ \ \ \ \ \ \ \ uint64\_t\ \_\_ret\ =\ 1ULL;}
\DoxyCodeLine{00905\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor_aae15c34415ce3896c43cb656ee7e6059}{index\_type}}\&\ \_\_d\ :\ \_\_dims)}
\DoxyCodeLine{00906\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00907\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret\ *=\ \_\_d;}
\DoxyCodeLine{00908\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00909\ }
\DoxyCodeLine{00910\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_ret;}
\DoxyCodeLine{00911\ \ \ \ \ \}}
\DoxyCodeLine{00912\ }
\DoxyCodeLine{00913\ \ \ \ \ uint64\_t\ \_\_compute\_outer\_size(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor_aae15c34415ce3896c43cb656ee7e6059}{index\_type}}\ \_\_dim)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00914\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ just\ a\ placeholder\ for\ now}}
\DoxyCodeLine{00915\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0ULL;}
\DoxyCodeLine{00916\ \ \ \ \ \}}
\DoxyCodeLine{00917\ }
\DoxyCodeLine{00918\ \ \ \ \ \textcolor{keywordtype}{float}\ \_\_frac(\mbox{\hyperlink{classtensor_aacd8d62096cc0d502cffd169e25f92f0}{const\_reference}}\ \_\_scalar)\ \{\ \textcolor{keywordflow}{return}\ std::fmod(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{float}\textcolor{keyword}{>}(\_\_scalar),\ 1.0f);\ \}}
\DoxyCodeLine{00919\ \ \ \ \ \mbox{\hyperlink{classtensor_aae15c34415ce3896c43cb656ee7e6059}{index\_type}}\ \_\_lcm(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor_aae15c34415ce3896c43cb656ee7e6059}{index\_type}}\ \_\_a,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor_aae15c34415ce3896c43cb656ee7e6059}{index\_type}}\ \_\_b)\ \{}
\DoxyCodeLine{00920\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (\_\_a\ *\ \_\_b)\ /\ std::gcd(\_\_a,\ \_\_b);}
\DoxyCodeLine{00921\ \ \ \ \ \}}
\DoxyCodeLine{00922\ \};\ \ \textcolor{comment}{//\ tensor\ class}}
\DoxyCodeLine{00923\ }
\DoxyCodeLine{00924\ }
\DoxyCodeLine{00925\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{00926\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor_afe674f1017845d278d6cbe2641763184}{tensor<\_Tp>::sinh}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00927\ \ \ \ \ this-\/>\_\_check\_is\_scalar\_type(\textcolor{stringliteral}{"{}Cannot\ perform\ a\ sin\ on\ non-\/scalar\ data\ type"{}});}
\DoxyCodeLine{00928\ \ \ \ \ data\_t\ \_\_ret(this-\/>\_\_data\_.size());}
\DoxyCodeLine{00929\ }
\DoxyCodeLine{00930\ \ \ \ \ std::transform(this-\/>\_\_data\_.begin(),\ this-\/>\_\_data\_.end(),\ \_\_ret.begin(),}
\DoxyCodeLine{00931\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [](const\_reference\ \_\_v)\ \{}
\DoxyCodeLine{00932\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ return\ static\_cast<value\_type>(std::sinh(static\_cast<double>(\_\_v)));}
\DoxyCodeLine{00933\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{00934\ }
\DoxyCodeLine{00935\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(\_\_ret,\ this-\/>\_\_shape\_);}
\DoxyCodeLine{00936\ \}}
\DoxyCodeLine{00937\ }
\DoxyCodeLine{00938\ }
\DoxyCodeLine{00939\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{00940\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor_a508054bde4c1ac37263453b019d876ed}{tensor<\_Tp>::sin}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00941\ \ \ \ \ this-\/>\_\_check\_is\_scalar\_type(\textcolor{stringliteral}{"{}Cannot\ perform\ a\ sin\ on\ non-\/scalar\ data\ type"{}});}
\DoxyCodeLine{00942\ \ \ \ \ data\_t\ \_\_ret(this-\/>\_\_data\_.size());}
\DoxyCodeLine{00943\ }
\DoxyCodeLine{00944\ \ \ \ \ std::transform(this-\/>\_\_data\_.begin(),\ this-\/>\_\_data\_.end(),\ \_\_ret.begin(),}
\DoxyCodeLine{00945\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [](const\_reference\ \_\_v)\ \{}
\DoxyCodeLine{00946\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ return\ static\_cast<value\_type>(std::sin(static\_cast<double>(\_\_v)));}
\DoxyCodeLine{00947\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{00948\ }
\DoxyCodeLine{00949\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(\_\_ret,\ this-\/>\_\_shape\_);}
\DoxyCodeLine{00950\ \}}
\DoxyCodeLine{00951\ }
\DoxyCodeLine{00952\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{00953\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor_a8143b6d554738a2476e4ec9f77b0724a}{tensor<\_Tp>::frac}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00954\ \ \ \ \ this-\/>\_\_check\_is\_scalar\_type(\textcolor{stringliteral}{"{}Cannot\ get\ the\ fraction\ of\ a\ non-\/scalar\ type"{}});}
\DoxyCodeLine{00955\ \ \ \ \ data\_t\ \_\_ret(this-\/>\_\_data\_.size());}
\DoxyCodeLine{00956\ }
\DoxyCodeLine{00957\ \ \ \ \ std::transform(}
\DoxyCodeLine{00958\ \ \ \ \ \ \ \ \ this-\/>\_\_data\_.begin(),\ this-\/>\_\_data\_.end(),\ \_\_ret.begin(),}
\DoxyCodeLine{00959\ \ \ \ \ \ \ \ \ [\textcolor{keyword}{this}](const\_reference\ \_\_v)\ \{\ return\ static\_cast<value\_type>(this-\/>\_\_frac(\_\_v));\ \});}
\DoxyCodeLine{00960\ }
\DoxyCodeLine{00961\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(\_\_ret,\ this-\/>\_\_shape\_);}
\DoxyCodeLine{00962\ \}}
\DoxyCodeLine{00963\ }
\DoxyCodeLine{00964\ }
\DoxyCodeLine{00965\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{00966\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor_a8fa5f80cbf67d5ca587a465864dee9c2}{tensor<\_Tp>::cos}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00967\ \ \ \ \ this-\/>\_\_check\_is\_scalar\_type(\textcolor{stringliteral}{"{}Cannot\ perform\ a\ cosine\ on\ non-\/scalar\ data\ type"{}});}
\DoxyCodeLine{00968\ \ \ \ \ data\_t\ \_\_ret(this-\/>\_\_data\_.size());}
\DoxyCodeLine{00969\ }
\DoxyCodeLine{00970\ \ \ \ \ std::transform(this-\/>\_\_data\_.begin(),\ this-\/>\_\_data\_.end(),\ \_\_ret.begin(),}
\DoxyCodeLine{00971\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [](const\_reference\ \_\_v)\ \{}
\DoxyCodeLine{00972\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ return\ static\_cast<value\_type>(std::cos(static\_cast<double>(\_\_v)));}
\DoxyCodeLine{00973\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{00974\ }
\DoxyCodeLine{00975\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(\_\_ret,\ this-\/>\_\_shape\_);}
\DoxyCodeLine{00976\ \}}
\DoxyCodeLine{00977\ }
\DoxyCodeLine{00978\ }
\DoxyCodeLine{00979\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{00980\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor_a4abdae5ad99250f19b77be41b4dc23af}{tensor<\_Tp>::log}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00981\ \ \ \ \ this-\/>\_\_check\_is\_integral\_type(\textcolor{stringliteral}{"{}Given\ data\ type\ must\ be\ an\ integral"{}});}
\DoxyCodeLine{00982\ \ \ \ \ std::vector<value\_type>\ \_\_ret(this-\/>\_\_data\_.size());}
\DoxyCodeLine{00983\ }
\DoxyCodeLine{00984\ \ \ \ \ std::transform(this-\/>\_\_data\_.begin(),\ this-\/>\_\_data\_.end(),\ \_\_ret.begin(),}
\DoxyCodeLine{00985\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [](const\_reference\ \_\_v)\ \{}
\DoxyCodeLine{00986\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ return\ static\_cast<value\_type>(std::log(static\_cast<double>(\_\_v)));}
\DoxyCodeLine{00987\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{00988\ }
\DoxyCodeLine{00989\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(\_\_ret,\ this-\/>\_\_shape\_);}
\DoxyCodeLine{00990\ \}}
\DoxyCodeLine{00991\ }
\DoxyCodeLine{00992\ }
\DoxyCodeLine{00993\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{00994\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor_adfe7048b3f768e46ed347d50161c0dae}{tensor<\_Tp>::asinh}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00995\ \ \ \ \ this-\/>\_\_check\_is\_scalar\_type(\textcolor{stringliteral}{"{}Cannot\ perform\ a\ sin\ on\ non-\/scalar\ data\ type"{}});}
\DoxyCodeLine{00996\ \ \ \ \ data\_t\ \_\_ret(this-\/>\_\_data\_.size());}
\DoxyCodeLine{00997\ }
\DoxyCodeLine{00998\ \ \ \ \ std::transform(this-\/>\_\_data\_.begin(),\ this-\/>\_\_data\_.end(),\ \_\_ret.begin(),}
\DoxyCodeLine{00999\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [](const\_reference\ \_\_v)\ \{}
\DoxyCodeLine{01000\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ return\ static\_cast<value\_type>(std::asinh(static\_cast<double>(\_\_v)));}
\DoxyCodeLine{01001\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{01002\ }
\DoxyCodeLine{01003\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(\_\_ret,\ this-\/>\_\_shape\_);}
\DoxyCodeLine{01004\ \}}
\DoxyCodeLine{01005\ }
\DoxyCodeLine{01006\ }
\DoxyCodeLine{01007\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{01008\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor_a05c63c610aa4fa8f3aabe57e5662477e}{tensor<\_Tp>::cosh}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01009\ \ \ \ \ this-\/>\_\_check\_is\_scalar\_type(\textcolor{stringliteral}{"{}Cannot\ perform\ a\ cosh\ on\ non-\/scalar\ data\ type"{}});}
\DoxyCodeLine{01010\ \ \ \ \ data\_t\ \_\_ret(this-\/>\_\_data\_.size());}
\DoxyCodeLine{01011\ }
\DoxyCodeLine{01012\ \ \ \ \ std::transform(this-\/>\_\_data\_.begin(),\ this-\/>\_\_data\_.end(),\ \_\_ret.begin(),}
\DoxyCodeLine{01013\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [](const\_reference\ \_\_v)\ \{}
\DoxyCodeLine{01014\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ return\ static\_cast<value\_type>(std::cosh(static\_cast<double>(\_\_v)));}
\DoxyCodeLine{01015\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{01016\ }
\DoxyCodeLine{01017\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(\_\_ret,\ this-\/>\_\_shape\_);}
\DoxyCodeLine{01018\ \}}
\DoxyCodeLine{01019\ }
\DoxyCodeLine{01020\ }
\DoxyCodeLine{01021\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{01022\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor_a5ca28d9559d416be2e480bb0b5faf71d}{tensor<\_Tp>::sqrt}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01023\ \ \ \ \ this-\/>\_\_check\_is\_scalar\_type(\textcolor{stringliteral}{"{}Cannot\ get\ the\ square\ root\ of\ non\ scalar\ values"{}});}
\DoxyCodeLine{01024\ \ \ \ \ data\_t\ \_\_ret(this-\/>\_\_data\_.size());}
\DoxyCodeLine{01025\ }
\DoxyCodeLine{01026\ \ \ \ \ std::transform(this-\/>\_\_data\_.begin(),\ this-\/>\_\_data\_.end(),\ \_\_ret.begin(),\ [](\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ value)\ \{}
\DoxyCodeLine{01027\ \ \ \ \ \ \ \ \ return\ static\_cast<value\_type>(std::sqrt(static\_cast<double>(value)));}
\DoxyCodeLine{01028\ \ \ \ \ \});}
\DoxyCodeLine{01029\ }
\DoxyCodeLine{01030\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(\_\_ret,\ this-\/>\_\_shape\_);}
\DoxyCodeLine{01031\ \}}
\DoxyCodeLine{01032\ }
\DoxyCodeLine{01033\ }
\DoxyCodeLine{01034\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{01035\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor_a2d6aaf42a08ff10a3b306c6acf44fe0b}{tensor<\_Tp>::acosh}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01036\ \ \ \ \ this-\/>\_\_check\_is\_scalar\_type(\textcolor{stringliteral}{"{}Cannot\ perform\ a\ acosh\ on\ non-\/scalar\ data\ type"{}});}
\DoxyCodeLine{01037\ \ \ \ \ data\_t\ \_\_ret(this-\/>\_\_data\_.size());}
\DoxyCodeLine{01038\ }
\DoxyCodeLine{01039\ \ \ \ \ std::transform(this-\/>\_\_data\_.begin(),\ this-\/>\_\_data\_.end(),\ \_\_ret.begin(),\ [](\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ value)\ \{}
\DoxyCodeLine{01040\ \ \ \ \ \ \ \ \ return\ static\_cast<value\_type>(std::acosh(static\_cast<double>(value)));}
\DoxyCodeLine{01041\ \ \ \ \ \});}
\DoxyCodeLine{01042\ }
\DoxyCodeLine{01043\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(\_\_ret,\ this-\/>\_\_shape\_);}
\DoxyCodeLine{01044\ \}}
\DoxyCodeLine{01045\ }
\DoxyCodeLine{01046\ }
\DoxyCodeLine{01047\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{01048\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor_ae731c9e97a8bc5818b99d33330467758}{tensor<\_Tp>::log10}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01049\ \ \ \ \ this-\/>\_\_check\_is\_integral\_type(\textcolor{stringliteral}{"{}Given\ data\ type\ must\ be\ an\ integral"{}});}
\DoxyCodeLine{01050\ \ \ \ \ data\_t\ \_\_ret(this-\/>\_\_data\_.size());}
\DoxyCodeLine{01051\ }
\DoxyCodeLine{01052\ \ \ \ \ std::transform(this-\/>\_\_data\_.begin(),\ this-\/>\_\_data\_.end(),\ \_\_ret.begin(),\ [](\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ value)\ \{}
\DoxyCodeLine{01053\ \ \ \ \ \ \ \ \ return\ static\_cast<value\_type>(std::acosh(static\_cast<double>(value)));}
\DoxyCodeLine{01054\ \ \ \ \ \});}
\DoxyCodeLine{01055\ }
\DoxyCodeLine{01056\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(\_\_ret,\ this-\/>\_\_shape\_);}
\DoxyCodeLine{01057\ \}}
\DoxyCodeLine{01058\ }
\DoxyCodeLine{01059\ }
\DoxyCodeLine{01060\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{01061\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor_a6fba338f86ca32decab9a86096fae745}{tensor<\_Tp>::log2}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01062\ \ \ \ \ this-\/>\_\_check\_is\_integral\_type(\textcolor{stringliteral}{"{}Given\ data\ type\ must\ be\ an\ integral"{}});}
\DoxyCodeLine{01063\ \ \ \ \ std::vector<value\_type>\ \_\_ret(this-\/>\_\_data\_.size());}
\DoxyCodeLine{01064\ }
\DoxyCodeLine{01065\ \ \ \ \ std::transform(this-\/>\_\_data\_.begin(),\ this-\/>\_\_data\_.end(),\ \_\_ret.begin(),}
\DoxyCodeLine{01066\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [](const\_reference\ \_\_v)\ \{}
\DoxyCodeLine{01067\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ return\ static\_cast<value\_type>(std::log2(static\_cast<double>(\_\_v)));}
\DoxyCodeLine{01068\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{01069\ }
\DoxyCodeLine{01070\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(\_\_ret,\ this-\/>\_\_shape\_);}
\DoxyCodeLine{01071\ \}}
\DoxyCodeLine{01072\ }
\DoxyCodeLine{01073\ }
\DoxyCodeLine{01074\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{01075\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor_a9966cc57b6cabfd62fc620ff13c7040b}{tensor<\_Tp>::exp}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01076\ \ \ \ \ this-\/>\_\_check\_is\_scalar\_type(\textcolor{stringliteral}{"{}Cannot\ get\ the\ exponential\ of\ non\ scalar\ values"{}});}
\DoxyCodeLine{01077\ \ \ \ \ std::vector<value\_type>\ \_\_ret(this-\/>\_\_data\_.size());}
\DoxyCodeLine{01078\ }
\DoxyCodeLine{01079\ \ \ \ \ std::transform(this-\/>\_\_data\_.begin(),\ this-\/>\_\_data\_.end(),\ \_\_ret.begin(),}
\DoxyCodeLine{01080\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [](const\_reference\ \_\_v)\ \{}
\DoxyCodeLine{01081\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ return\ static\_cast<value\_type>(std::exp(static\_cast<double>(\_\_v)));}
\DoxyCodeLine{01082\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{01083\ }
\DoxyCodeLine{01084\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(\_\_ret,\ this-\/>\_\_shape\_);}
\DoxyCodeLine{01085\ \}}
\DoxyCodeLine{01086\ }
\DoxyCodeLine{01087\ }
\DoxyCodeLine{01088\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{01089\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{classtensor_aae15c34415ce3896c43cb656ee7e6059}{tensor<\_Tp>::index\_type}}\ \mbox{\hyperlink{classtensor_a2110f98d54f02024c7c591fec2967b0e}{tensor<\_Tp>::lcm}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01090\ \ \ \ \ this-\/>\_\_check\_is\_scalar\_type(\textcolor{stringliteral}{"{}Given\ template\ type\ must\ be\ an\ int"{}});}
\DoxyCodeLine{01091\ \ \ \ \ index\_type\ \_\_ret\ =\ \textcolor{keyword}{static\_cast<}index\_type\textcolor{keyword}{>}(this-\/>\_\_data\_[0]);}
\DoxyCodeLine{01092\ }
\DoxyCodeLine{01093\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 1;}
\DoxyCodeLine{01094\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{01095\ \ \ \ \ \{}
\DoxyCodeLine{01096\ \ \ \ \ \ \ \ \ \_\_ret\ =\ this-\/>\_\_lcm(\textcolor{keyword}{static\_cast<}index\_type\textcolor{keyword}{>}(this-\/>\_\_data\_[\_\_i]),\ \_\_ret);}
\DoxyCodeLine{01097\ \ \ \ \ \}}
\DoxyCodeLine{01098\ }
\DoxyCodeLine{01099\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_ret;}
\DoxyCodeLine{01100\ \}}
\DoxyCodeLine{01101\ }
\DoxyCodeLine{01102\ }
\DoxyCodeLine{01103\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{01104\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor_afe674f1017845d278d6cbe2641763184}{tensor<\_Tp>::sinh}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01105\ \ \ \ \ this-\/>\_\_check\_is\_integral\_type(\textcolor{stringliteral}{"{}Given\ template\ type\ must\ be\ integral"{}});}
\DoxyCodeLine{01106\ \ \ \ \ data\_t\ \_\_ret(this-\/>\_\_data\_.size());}
\DoxyCodeLine{01107\ }
\DoxyCodeLine{01108\ \ \ \ \ std::transform(this-\/>\_\_data\_.begin(),\ this-\/>\_\_data\_.end(),\ this-\/>\_\_ret.begin(),}
\DoxyCodeLine{01109\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [](const\_reference\ \_\_v)\ \{}
\DoxyCodeLine{01110\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ return\ static\_cast<value\_type>(std::sinh(static\_cast<double>(\_\_v)));}
\DoxyCodeLine{01111\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{01112\ }
\DoxyCodeLine{01113\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(\_\_ret,\ this-\/>\_\_shape\_);}
\DoxyCodeLine{01114\ \}}
\DoxyCodeLine{01115\ }
\DoxyCodeLine{01116\ }
\DoxyCodeLine{01117\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{01118\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_a48821b85b60d6c1f0be8e42b9a66d788}{tensor<\_Tp>::logical\_or\_}}(\textcolor{keyword}{const}\ value\_type\ \_\_val)\ \{}
\DoxyCodeLine{01119\ \ \ \ \ \textcolor{keywordflow}{if}\ (!std::is\_integral<value\_type>::value\ \&\&\ !std::is\_same<value\_type,\ bool>::value)}
\DoxyCodeLine{01120\ \ \ \ \ \{}
\DoxyCodeLine{01121\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(}
\DoxyCodeLine{01122\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Cannot\ get\ the\ element\ wise\ not\ of\ non-\/integral\ and\ non-\/boolean\ value"{}});}
\DoxyCodeLine{01123\ \ \ \ \ \}}
\DoxyCodeLine{01124\ }
\DoxyCodeLine{01125\ \ \ \ \ std::transform(this-\/>\_\_data\_.begin(),\ this-\/>\_\_data\_.end(),\ this-\/>\_\_data\_.begin(),}
\DoxyCodeLine{01126\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [\&\_\_val](const\_reference\ \_\_v)\ \{\ return\ static\_cast<value\_type>(\_\_v\ ||\ \_\_val);\ \});}
\DoxyCodeLine{01127\ \}}
\DoxyCodeLine{01128\ }
\DoxyCodeLine{01129\ }
\DoxyCodeLine{01130\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{01131\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_a09f18e7b94ea88dc3138b147cba926c2}{tensor<\_Tp>::logical\_xor\_}}(\textcolor{keyword}{const}\ value\_type\ \_\_val)\ \{}
\DoxyCodeLine{01132\ \ \ \ \ \textcolor{keywordflow}{if}\ (!std::is\_integral<value\_type>::value\ \&\&\ !std::is\_same<value\_type,\ bool>::value)}
\DoxyCodeLine{01133\ \ \ \ \ \{}
\DoxyCodeLine{01134\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(}
\DoxyCodeLine{01135\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Cannot\ get\ the\ element\ wise\ xor\ of\ non-\/integral\ and\ non-\/boolean\ value"{}});}
\DoxyCodeLine{01136\ \ \ \ \ \}}
\DoxyCodeLine{01137\ }
\DoxyCodeLine{01138\ \ \ \ \ std::transform(this-\/>\_\_data\_.begin(),\ this-\/>\_\_data\_.end(),\ this-\/>\_\_data\_.begin(),}
\DoxyCodeLine{01139\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [\&\_\_val](const\_reference\ \_\_v)\ \{\ return\ static\_cast<value\_type>(\_\_v\ \string^\ \_\_val);\ \});}
\DoxyCodeLine{01140\ \}}
\DoxyCodeLine{01141\ }
\DoxyCodeLine{01142\ }
\DoxyCodeLine{01143\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{01144\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_a6372653f612ae3268766a0b6a6e9ca30}{tensor<\_Tp>::logical\_and\_}}(\textcolor{keyword}{const}\ value\_type\ \_\_val)\ \{}
\DoxyCodeLine{01145\ \ \ \ \ \textcolor{keywordflow}{if}\ (!std::is\_integral<value\_type>::value\ \&\&\ !std::is\_same<value\_type,\ bool>::value)}
\DoxyCodeLine{01146\ \ \ \ \ \{}
\DoxyCodeLine{01147\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(}
\DoxyCodeLine{01148\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Cannot\ get\ the\ element\ wise\ and\ of\ non-\/integral\ and\ non-\/boolean\ value"{}});}
\DoxyCodeLine{01149\ \ \ \ \ \}}
\DoxyCodeLine{01150\ }
\DoxyCodeLine{01151\ \ \ \ \ std::transform(this-\/>\_\_data\_.begin(),\ this-\/>\_\_data\_.end(),\ this-\/>\_\_data\_.begin(),}
\DoxyCodeLine{01152\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [\&\_\_val](const\_reference\ \_\_v)\ \{\ return\ static\_cast<value\_type>(\_\_v\ \&\&\ \_\_val);\ \});}
\DoxyCodeLine{01153\ \}}
\DoxyCodeLine{01154\ }
\DoxyCodeLine{01155\ }
\DoxyCodeLine{01156\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{01157\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_aa40e092a039ef0ad7c7354b7afd093a2}{tensor<\_Tp>::bitwise\_or\_}}(\textcolor{keyword}{const}\ value\_type\ \_\_val)\ \{}
\DoxyCodeLine{01158\ \ \ \ \ \textcolor{keywordflow}{if}\ (!std::is\_integral<value\_type>::value\ \&\&\ !std::is\_same<value\_type,\ bool>::value)}
\DoxyCodeLine{01159\ \ \ \ \ \{}
\DoxyCodeLine{01160\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(}
\DoxyCodeLine{01161\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Cannot\ perform\ a\ bitwise\ OR\ on\ non-\/integral\ or\ non-\/boolean\ values"{}});}
\DoxyCodeLine{01162\ \ \ \ \ \}}
\DoxyCodeLine{01163\ }
\DoxyCodeLine{01164\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{01165\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{01166\ \ \ \ \ \{}
\DoxyCodeLine{01167\ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i]\ |=\ \_\_val;}
\DoxyCodeLine{01168\ \ \ \ \ \}}
\DoxyCodeLine{01169\ \}}
\DoxyCodeLine{01170\ }
\DoxyCodeLine{01171\ }
\DoxyCodeLine{01172\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{01173\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_a9f73f1a3264e3f3ca69755b68ec1d0df}{tensor<\_Tp>::bitwise\_xor\_}}(\textcolor{keyword}{const}\ value\_type\ \_\_val)\ \{}
\DoxyCodeLine{01174\ \ \ \ \ \textcolor{keywordflow}{if}\ (!std::is\_integral<value\_type>::value\ \&\&\ !std::is\_same<value\_type,\ bool>::value)}
\DoxyCodeLine{01175\ \ \ \ \ \{}
\DoxyCodeLine{01176\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(}
\DoxyCodeLine{01177\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Cannot\ perform\ a\ bitwise\ XOR\ on\ non-\/integral\ or\ non-\/boolean\ values"{}});}
\DoxyCodeLine{01178\ \ \ \ \ \}}
\DoxyCodeLine{01179\ }
\DoxyCodeLine{01180\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{01181\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{01182\ \ \ \ \ \{}
\DoxyCodeLine{01183\ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i]\ \string^=\ \_\_val;}
\DoxyCodeLine{01184\ \ \ \ \ \}}
\DoxyCodeLine{01185\ \}}
\DoxyCodeLine{01186\ }
\DoxyCodeLine{01187\ }
\DoxyCodeLine{01188\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{01189\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_a094082f2e570f061d5ab0286deefd28b}{tensor<\_Tp>::bitwise\_not\_}}()\ \{}
\DoxyCodeLine{01190\ \ \ \ \ \textcolor{keywordflow}{if}\ (!std::is\_integral<value\_type>::value\ \&\&\ !std::is\_same<value\_type,\ bool>::value)}
\DoxyCodeLine{01191\ \ \ \ \ \{}
\DoxyCodeLine{01192\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(\textcolor{stringliteral}{"{}Cannot\ perform\ a\ bitwise\ not\ on\ non\ integral\ or\ boolean\ value"{}});}
\DoxyCodeLine{01193\ \ \ \ \ \}}
\DoxyCodeLine{01194\ }
\DoxyCodeLine{01195\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{01196\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{01197\ \ \ \ \ \{}
\DoxyCodeLine{01198\ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i]\ =\ \string~this-\/>\_\_data\_[\_\_i];}
\DoxyCodeLine{01199\ \ \ \ \ \}}
\DoxyCodeLine{01200\ \}}
\DoxyCodeLine{01201\ }
\DoxyCodeLine{01202\ }
\DoxyCodeLine{01203\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{01204\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_addc040f1f7b20849180f04bcfac0a77c}{tensor<\_Tp>::bitwise\_and\_}}(\textcolor{keyword}{const}\ value\_type\ \_\_val)\ \{}
\DoxyCodeLine{01205\ \ \ \ \ \textcolor{keywordflow}{if}\ (!std::is\_integral<value\_type>::value\ \&\&\ !std::is\_same<value\_type,\ bool>::value)}
\DoxyCodeLine{01206\ \ \ \ \ \{}
\DoxyCodeLine{01207\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(}
\DoxyCodeLine{01208\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Cannot\ perform\ a\ bitwise\ AND\ on\ non-\/integral\ or\ non-\/boolean\ values"{}});}
\DoxyCodeLine{01209\ \ \ \ \ \}}
\DoxyCodeLine{01210\ }
\DoxyCodeLine{01211\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{01212\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{01213\ \ \ \ \ \{}
\DoxyCodeLine{01214\ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i]\ \&=\ \_\_val;}
\DoxyCodeLine{01215\ \ \ \ \ \}}
\DoxyCodeLine{01216\ \}}
\DoxyCodeLine{01217\ }
\DoxyCodeLine{01218\ }
\DoxyCodeLine{01219\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{01220\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\&\ \mbox{\hyperlink{classtensor_ab85b4bd02b93afb9bf6758cec5ee0cf3}{tensor<\_Tp>::operator=}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\ \{}
\DoxyCodeLine{01221\ \ \ \ \ \textcolor{keywordflow}{if}\ (\textcolor{keyword}{this}\ !=\ \&\_\_other)}
\DoxyCodeLine{01222\ \ \ \ \ \{}
\DoxyCodeLine{01223\ \ \ \ \ \ \ \ \ this-\/>\_\_data\_\ \ \ \ =\ \_\_other.\mbox{\hyperlink{classtensor_a4302a45c6c164b54316d6b869affca78}{storage}}();}
\DoxyCodeLine{01224\ \ \ \ \ \ \ \ \ this-\/>\_\_shape\_\ \ \ =\ \_\_other.\mbox{\hyperlink{classtensor_a33e40f89c3247e27e6bd03a992d73868}{shape}}();}
\DoxyCodeLine{01225\ \ \ \ \ \ \ \ \ this-\/>\_\_strides\_\ =\ \_\_other.\mbox{\hyperlink{classtensor_a0c7bf412aa5a913b58b26dd0a1069077}{strides}}();}
\DoxyCodeLine{01226\ \ \ \ \ \}}
\DoxyCodeLine{01227\ }
\DoxyCodeLine{01228\ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{01229\ \}}
\DoxyCodeLine{01230\ }
\DoxyCodeLine{01231\ }
\DoxyCodeLine{01232\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{01233\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\&\ \mbox{\hyperlink{classtensor_ab85b4bd02b93afb9bf6758cec5ee0cf3}{tensor<\_Tp>::operator=}}(\mbox{\hyperlink{classtensor}{tensor}}\&\&\ \_\_other)\ \textcolor{keyword}{noexcept}\ \{}
\DoxyCodeLine{01234\ \ \ \ \ \textcolor{keywordflow}{if}\ (\textcolor{keyword}{this}\ !=\ \&\_\_other)}
\DoxyCodeLine{01235\ \ \ \ \ \{}
\DoxyCodeLine{01236\ \ \ \ \ \ \ \ \ this-\/>\_\_data\_\ \ \ \ =\ std::move(\_\_other.storage());}
\DoxyCodeLine{01237\ \ \ \ \ \ \ \ \ this-\/>\_\_shape\_\ \ \ =\ std::move(\_\_other.shape());}
\DoxyCodeLine{01238\ \ \ \ \ \ \ \ \ this-\/>\_\_strides\_\ =\ std::move(\_\_other.strides());}
\DoxyCodeLine{01239\ \ \ \ \ \}}
\DoxyCodeLine{01240\ }
\DoxyCodeLine{01241\ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{01242\ \}}
\DoxyCodeLine{01243\ }
\DoxyCodeLine{01244\ }
\DoxyCodeLine{01245\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{01246\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_a98ff9eb7aa9a40b88c9a64397238bb5a}{tensor<\_Tp>::print}}()\ const\ noexcept\ \{}
\DoxyCodeLine{01247\ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}Shape:\ ["{}};}
\DoxyCodeLine{01248\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ this-\/>\_\_shape\_.size();\ ++i)}
\DoxyCodeLine{01249\ \ \ \ \ \{}
\DoxyCodeLine{01250\ \ \ \ \ \ \ \ \ std::cout\ <<\ this-\/>\_\_shape\_[i];}
\DoxyCodeLine{01251\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (i\ <\ this-\/>\_\_shape\_.size()\ -\/\ 1)}
\DoxyCodeLine{01252\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01253\ \ \ \ \ \ \ \ \ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{},\ "{}};}
\DoxyCodeLine{01254\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01255\ \ \ \ \ \}}
\DoxyCodeLine{01256\ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}]\(\backslash\)nData:\ "{}};}
\DoxyCodeLine{01257\ \ \ \ \ \textcolor{keywordflow}{if}\ (!this-\/>\_\_data\_.empty())}
\DoxyCodeLine{01258\ \ \ \ \ \{}
\DoxyCodeLine{01259\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ \_\_v\ :\ this-\/>\_\_data\_)}
\DoxyCodeLine{01260\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01261\ \ \ \ \ \ \ \ \ \ \ \ \ std::cout\ <<\ \_\_v\ <<\ \textcolor{stringliteral}{"{}\ "{}};}
\DoxyCodeLine{01262\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01263\ \ \ \ \ \}}
\DoxyCodeLine{01264\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{01265\ \ \ \ \ \{}
\DoxyCodeLine{01266\ \ \ \ \ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}Empty"{}};}
\DoxyCodeLine{01267\ \ \ \ \ \}}
\DoxyCodeLine{01268\ \ \ \ \ std::cout\ <<\ std::endl;}
\DoxyCodeLine{01269\ \}}
\DoxyCodeLine{01270\ }
\DoxyCodeLine{01271\ }
\DoxyCodeLine{01272\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{01273\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{classtensor_a7925293489f3786339e35f136449f9d4}{tensor<\_Tp>::reference}}\ \mbox{\hyperlink{classtensor_ae08663d7fd46cc622f032ae7cac90c5a}{tensor<\_Tp>::at}}(\mbox{\hyperlink{classtensor_ab96aa71f8b92cb531a7e258f47315f45}{tensor<\_Tp>::shape\_type}}\ \_\_idx)\ \{}
\DoxyCodeLine{01274\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_\_idx.\mbox{\hyperlink{classtensor_ab1dc32444636d6005543f47cd07aee56}{empty}}())}
\DoxyCodeLine{01275\ \ \ \ \ \{}
\DoxyCodeLine{01276\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::invalid\_argument(\textcolor{stringliteral}{"{}Passing\ an\ empty\ vector\ as\ indices\ for\ a\ tensor"{}});}
\DoxyCodeLine{01277\ \ \ \ \ \}}
\DoxyCodeLine{01278\ }
\DoxyCodeLine{01279\ \ \ \ \ index\_type\ \_\_i\ =\ this-\/>\_\_compute\_index(\_\_idx);}
\DoxyCodeLine{01280\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_\_i\ <\ 0\ ||\ \_\_i\ >=\ this-\/>\_\_data\_.size())}
\DoxyCodeLine{01281\ \ \ \ \ \{}
\DoxyCodeLine{01282\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::invalid\_argument(\textcolor{stringliteral}{"{}input\ indices\ are\ out\ of\ bounds"{}});}
\DoxyCodeLine{01283\ \ \ \ \ \}}
\DoxyCodeLine{01284\ }
\DoxyCodeLine{01285\ \ \ \ \ \textcolor{keywordflow}{return}\ this-\/>\_\_data\_[\_\_i];}
\DoxyCodeLine{01286\ \}}
\DoxyCodeLine{01287\ }
\DoxyCodeLine{01288\ }
\DoxyCodeLine{01289\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{01290\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{classtensor_aacd8d62096cc0d502cffd169e25f92f0}{tensor<\_Tp>::const\_reference}}\ \mbox{\hyperlink{classtensor_ae08663d7fd46cc622f032ae7cac90c5a}{tensor<\_Tp>::at}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor_ab96aa71f8b92cb531a7e258f47315f45}{tensor<\_Tp>::shape\_type}}\ \_\_idx)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01291\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_\_idx.\mbox{\hyperlink{classtensor_ab1dc32444636d6005543f47cd07aee56}{empty}}())}
\DoxyCodeLine{01292\ \ \ \ \ \{}
\DoxyCodeLine{01293\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::invalid\_argument(\textcolor{stringliteral}{"{}Passing\ an\ empty\ vector\ as\ indices\ for\ a\ tensor"{}});}
\DoxyCodeLine{01294\ \ \ \ \ \}}
\DoxyCodeLine{01295\ }
\DoxyCodeLine{01296\ \ \ \ \ index\_type\ \_\_i\ =\ this-\/>\_\_compute\_index(\_\_idx);}
\DoxyCodeLine{01297\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_\_i\ <\ 0\ ||\ \_\_i\ >=\ this-\/>\_\_data\_.size())}
\DoxyCodeLine{01298\ \ \ \ \ \{}
\DoxyCodeLine{01299\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::invalid\_argument(\textcolor{stringliteral}{"{}input\ indices\ are\ out\ of\ bounds"{}});}
\DoxyCodeLine{01300\ \ \ \ \ \}}
\DoxyCodeLine{01301\ }
\DoxyCodeLine{01302\ \ \ \ \ \textcolor{keywordflow}{return}\ this-\/>\_\_data\_[\_\_i];}
\DoxyCodeLine{01303\ \}}
\DoxyCodeLine{01304\ }
\DoxyCodeLine{01305\ }
\DoxyCodeLine{01306\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{01307\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor_a3b3893269c8e207c05b789e53821ab1e}{tensor<\_Tp>::operator+}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01308\ \ \ \ \ this-\/>\_\_check\_is\_arithmetic\_type(\textcolor{stringliteral}{"{}template\ class\ must\ be\ an\ arithmetic\ type"{}});}
\DoxyCodeLine{01309\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_\_other.\mbox{\hyperlink{classtensor_a33e40f89c3247e27e6bd03a992d73868}{shape}}()\ !=\ this-\/>\_\_shape\_)}
\DoxyCodeLine{01310\ \ \ \ \ \{}
\DoxyCodeLine{01311\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::invalid\_argument(\textcolor{stringliteral}{"{}Cannot\ add\ two\ tensors\ with\ different\ shapes"{}});}
\DoxyCodeLine{01312\ \ \ \ \ \}}
\DoxyCodeLine{01313\ }
\DoxyCodeLine{01314\ \ \ \ \ data\_t\ \_\_d(this-\/>\_\_data\_.size());}
\DoxyCodeLine{01315\ }
\DoxyCodeLine{01316\ \ \ \ \ std::transform(this-\/>\_\_data\_.begin(),\ this-\/>\_\_data\_.end(),\ \_\_other.\mbox{\hyperlink{classtensor_a4302a45c6c164b54316d6b869affca78}{storage}}().begin(),}
\DoxyCodeLine{01317\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_d.begin(),\ [](const\_reference\ \_\_v,\ const\_reference\ \_\_w)\ \{}
\DoxyCodeLine{01318\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ return\ static\_cast<value\_type>(\_\_v\ +\ \_\_w);}
\DoxyCodeLine{01319\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{01320\ }
\DoxyCodeLine{01321\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(\_\_d,\ this-\/>\_\_shape\_);}
\DoxyCodeLine{01322\ \}}
\DoxyCodeLine{01323\ }
\DoxyCodeLine{01324\ }
\DoxyCodeLine{01325\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{01326\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor_a08700f946c6be4444fc5367d18021dc3}{tensor<\_Tp>::operator-\/}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01327\ \ \ \ \ this-\/>\_\_check\_is\_arithmetic\_type(\textcolor{stringliteral}{"{}template\ class\ must\ be\ an\ arithmetic\ type"{}});}
\DoxyCodeLine{01328\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_\_other.\mbox{\hyperlink{classtensor_a33e40f89c3247e27e6bd03a992d73868}{shape}}()\ !=\ this-\/>\_\_shape\_)}
\DoxyCodeLine{01329\ \ \ \ \ \{}
\DoxyCodeLine{01330\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::invalid\_argument(\textcolor{stringliteral}{"{}Cannot\ add\ two\ tensors\ with\ different\ shapes"{}});}
\DoxyCodeLine{01331\ \ \ \ \ \}}
\DoxyCodeLine{01332\ }
\DoxyCodeLine{01333\ \ \ \ \ data\_t\ \_\_d(this-\/>\_\_data\_.size());}
\DoxyCodeLine{01334\ }
\DoxyCodeLine{01335\ \ \ \ \ std::transform(this-\/>\_\_data\_.begin(),\ this-\/>\_\_data\_.end(),\ \_\_other.\mbox{\hyperlink{classtensor_a4302a45c6c164b54316d6b869affca78}{storage}}().begin(),}
\DoxyCodeLine{01336\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_d.begin(),\ [](const\_reference\ \_\_v,\ const\_reference\ \_\_w)\ \{}
\DoxyCodeLine{01337\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ return\ static\_cast<value\_type>(\_\_v\ -\/\ \_\_w);}
\DoxyCodeLine{01338\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{01339\ }
\DoxyCodeLine{01340\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(\_\_d,\ this-\/>\_\_shape\_);}
\DoxyCodeLine{01341\ \}}
\DoxyCodeLine{01342\ }
\DoxyCodeLine{01343\ }
\DoxyCodeLine{01344\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{01345\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor_a3b3893269c8e207c05b789e53821ab1e}{tensor<\_Tp>::operator+}}(\textcolor{keyword}{const}\ value\_type\ \_\_scalar)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01346\ \ \ \ \ this-\/>\_\_check\_is\_arithmetic\_type(\textcolor{stringliteral}{"{}template\ class\ must\ be\ an\ arithmetic\ type"{}});}
\DoxyCodeLine{01347\ }
\DoxyCodeLine{01348\ \ \ \ \ std::transform(}
\DoxyCodeLine{01349\ \ \ \ \ \ \ \ \ this-\/>\_\_data\_.begin(),\ this-\/>\_\_data\_.end(),\ this-\/>\_\_data\_.begin(),}
\DoxyCodeLine{01350\ \ \ \ \ \ \ \ \ [\&\_\_scalar](const\_reference\ \_\_v)\ \{\ return\ static\_cast<value\_type>(\_\_v\ +\ \_\_scalar);\ \});}
\DoxyCodeLine{01351\ }
\DoxyCodeLine{01352\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(*\textcolor{keyword}{this});}
\DoxyCodeLine{01353\ \}}
\DoxyCodeLine{01354\ }
\DoxyCodeLine{01355\ }
\DoxyCodeLine{01356\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{01357\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor_a08700f946c6be4444fc5367d18021dc3}{tensor<\_Tp>::operator-\/}}(\textcolor{keyword}{const}\ value\_type\ \_\_scalar)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01358\ \ \ \ \ this-\/>\_\_check\_is\_arithmetic\_type(\textcolor{stringliteral}{"{}template\ class\ must\ be\ an\ arithmetic\ type"{}});}
\DoxyCodeLine{01359\ }
\DoxyCodeLine{01360\ \ \ \ \ std::transform(}
\DoxyCodeLine{01361\ \ \ \ \ \ \ \ \ this-\/>\_\_data\_.begin(),\ this-\/>\_\_data\_.end(),\ this-\/>\_\_data\_.begin(),}
\DoxyCodeLine{01362\ \ \ \ \ \ \ \ \ [\&\_\_scalar](const\_reference\ \_\_v)\ \{\ return\ static\_cast<value\_type>(\_\_v\ -\/\ \_\_scalar);\ \});}
\DoxyCodeLine{01363\ }
\DoxyCodeLine{01364\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(*\textcolor{keyword}{this});}
\DoxyCodeLine{01365\ \}}
\DoxyCodeLine{01366\ }
\DoxyCodeLine{01367\ }
\DoxyCodeLine{01368\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{01369\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor_a46ca2fdc27adf2fcf91315733d840f88}{tensor<\_Tp>::operator+=}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01370\ \ \ \ \ this-\/>\_\_check\_is\_arithmetic\_type(\textcolor{stringliteral}{"{}template\ class\ must\ be\ an\ arithmetic\ type"{}});}
\DoxyCodeLine{01371\ \ \ \ \ assert(this-\/>\_\_shape\_\ ==\ \_\_other.\mbox{\hyperlink{classtensor_a33e40f89c3247e27e6bd03a992d73868}{shape}}()\ \&\&\ this-\/>\_\_data\_.size()\ ==\ \_\_other.\mbox{\hyperlink{classtensor_a119a24ebef8a13cd8fd262a1c00b48b7}{size}}(0));}
\DoxyCodeLine{01372\ }
\DoxyCodeLine{01373\ \ \ \ \ std::transform(this-\/>\_\_data\_.begin(),\ this-\/>\_\_data\_.end(),\ \_\_other.\mbox{\hyperlink{classtensor_a4302a45c6c164b54316d6b869affca78}{storage}}().begin(),}
\DoxyCodeLine{01374\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>\_\_data\_.begin(),\ [](const\_reference\ \_\_v,\ const\_reference\ \_\_w)\ \{}
\DoxyCodeLine{01375\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ return\ static\_cast<value\_type>(\_\_v\ +\ \_\_w);}
\DoxyCodeLine{01376\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{01377\ }
\DoxyCodeLine{01378\ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{01379\ \}}
\DoxyCodeLine{01380\ }
\DoxyCodeLine{01381\ }
\DoxyCodeLine{01382\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{01383\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor_a46ca2fdc27adf2fcf91315733d840f88}{tensor<\_Tp>::operator+=}}(\mbox{\hyperlink{classtensor_aacd8d62096cc0d502cffd169e25f92f0}{const\_reference}}\ \_\_scalar)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01384\ \ \ \ \ this-\/>\_\_check\_is\_arithmetic\_type(\textcolor{stringliteral}{"{}template\ class\ must\ be\ an\ arithmetic\ type"{}});}
\DoxyCodeLine{01385\ }
\DoxyCodeLine{01386\ \ \ \ \ std::transform(}
\DoxyCodeLine{01387\ \ \ \ \ \ \ \ \ this-\/>\_\_data\_.begin(),\ this-\/>\_\_data\_.end(),\ this-\/>\_\_data\_.begin(),}
\DoxyCodeLine{01388\ \ \ \ \ \ \ \ \ [\&\_\_scalar](\mbox{\hyperlink{classtensor_aacd8d62096cc0d502cffd169e25f92f0}{const\_reference}}\ \_\_v)\ \{\ return\ static\_cast<value\_type>(\_\_v\ +\ \_\_scalar);\ \});}
\DoxyCodeLine{01389\ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{01390\ \}}
\DoxyCodeLine{01391\ }
\DoxyCodeLine{01392\ }
\DoxyCodeLine{01393\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{01394\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor_a29a72fe362d2919b391b19abb8501fc1}{tensor<\_Tp>::operator-\/=}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01395\ \ \ \ \ this-\/>\_\_check\_is\_arithmetic\_type(\textcolor{stringliteral}{"{}template\ class\ must\ be\ an\ arithmetic\ type"{}});}
\DoxyCodeLine{01396\ \ \ \ \ assert(this-\/>\_\_shape\_\ ==\ \_\_other.\mbox{\hyperlink{classtensor_a33e40f89c3247e27e6bd03a992d73868}{shape}}()\ \&\&\ this-\/>\_\_data\_.size()\ ==\ \_\_other.\mbox{\hyperlink{classtensor_a119a24ebef8a13cd8fd262a1c00b48b7}{size}}(0));}
\DoxyCodeLine{01397\ }
\DoxyCodeLine{01398\ \ \ \ \ std::transform(this-\/>\_\_data\_.begin(),\ this-\/>\_\_data\_.end(),\ \_\_other.\mbox{\hyperlink{classtensor_a4302a45c6c164b54316d6b869affca78}{storage}}().begin(),}
\DoxyCodeLine{01399\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>\_\_data\_.begin(),\ [](const\_reference\ \_\_v,\ const\_reference\ \_\_w)\ \{}
\DoxyCodeLine{01400\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ return\ static\_cast<value\_type>(\_\_v\ -\/\ \_\_w);}
\DoxyCodeLine{01401\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{01402\ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{01403\ \}}
\DoxyCodeLine{01404\ }
\DoxyCodeLine{01405\ }
\DoxyCodeLine{01406\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{01407\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor_a49c9436fd5ca973697d23f7ee522dc19}{tensor<\_Tp>::operator*=}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01408\ \ \ \ \ this-\/>\_\_check\_is\_arithmetic\_type(\textcolor{stringliteral}{"{}template\ class\ must\ be\ an\ arithmetic\ type"{}});}
\DoxyCodeLine{01409\ \ \ \ \ assert(this-\/>\_\_shape\_\ ==\ \_\_other.\mbox{\hyperlink{classtensor_a33e40f89c3247e27e6bd03a992d73868}{shape}}()\ \&\&\ this-\/>\_\_data\_.size()\ ==\ \_\_other.\mbox{\hyperlink{classtensor_a119a24ebef8a13cd8fd262a1c00b48b7}{size}}(0));}
\DoxyCodeLine{01410\ }
\DoxyCodeLine{01411\ \ \ \ \ std::transform(this-\/>\_\_data\_.begin(),\ this-\/>\_\_data\_.end(),\ \_\_other.\mbox{\hyperlink{classtensor_a4302a45c6c164b54316d6b869affca78}{storage}}().begin(),}
\DoxyCodeLine{01412\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>\_\_data\_.begin(),\ [](const\_reference\ \_\_v,\ const\_reference\ \_\_w)\ \{}
\DoxyCodeLine{01413\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ return\ static\_cast<value\_type>(\_\_v\ *\ \_\_w);}
\DoxyCodeLine{01414\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{01415\ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{01416\ \}}
\DoxyCodeLine{01417\ }
\DoxyCodeLine{01418\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{01419\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor_a49c9436fd5ca973697d23f7ee522dc19}{tensor<\_Tp>::operator*=}}(\mbox{\hyperlink{classtensor_aacd8d62096cc0d502cffd169e25f92f0}{const\_reference}}\ \_\_scalar)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01420\ \ \ \ \ this-\/>\_\_check\_is\_arithmetic\_type(\textcolor{stringliteral}{"{}template\ class\ must\ be\ an\ arithmetic\ type"{}});}
\DoxyCodeLine{01421\ }
\DoxyCodeLine{01422\ \ \ \ \ std::transform(this-\/>\_\_data\_.begin(),\ this-\/>\_\_data\_.end(),\ this-\/>\_\_data\_.begin(),}
\DoxyCodeLine{01423\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [](\mbox{\hyperlink{classtensor_aacd8d62096cc0d502cffd169e25f92f0}{const\_reference}}\ \_\_v)\ \{\ return\ static\_cast<value\_type>(\_\_v\ *\ \_\_scalar);\ \});}
\DoxyCodeLine{01424\ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{01425\ \}}
\DoxyCodeLine{01426\ }
\DoxyCodeLine{01427\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{01428\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor_a98997813fec16f4b37cbcf1220801c2f}{tensor<\_Tp>::operator/=}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01429\ \ \ \ \ this-\/>\_\_check\_is\_arithmetic\_type(\textcolor{stringliteral}{"{}template\ class\ must\ be\ an\ arithmetic\ type"{}});}
\DoxyCodeLine{01430\ \ \ \ \ assert(this-\/>\_\_shape\_\ ==\ \_\_other.\mbox{\hyperlink{classtensor_a33e40f89c3247e27e6bd03a992d73868}{shape}}()\ \&\&\ this-\/>\_\_data\_.size()\ ==\ \_\_other.\mbox{\hyperlink{classtensor_a119a24ebef8a13cd8fd262a1c00b48b7}{size}}(0));}
\DoxyCodeLine{01431\ }
\DoxyCodeLine{01432\ \ \ \ \ std::transform(this-\/>\_\_data\_.begin(),\ this-\/>\_\_data\_.end(),\ \_\_other.\mbox{\hyperlink{classtensor_a4302a45c6c164b54316d6b869affca78}{storage}}().begin(),}
\DoxyCodeLine{01433\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>\_\_data\_.begin(),\ [](\mbox{\hyperlink{classtensor_aacd8d62096cc0d502cffd169e25f92f0}{const\_reference}}\ \_\_v,\ \mbox{\hyperlink{classtensor_aacd8d62096cc0d502cffd169e25f92f0}{const\_reference}}\ \_\_w)\ \{}
\DoxyCodeLine{01434\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ return\ static\_cast<value\_type>(\_\_v\ /\ \_\_w);}
\DoxyCodeLine{01435\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{01436\ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{01437\ \}}
\DoxyCodeLine{01438\ }
\DoxyCodeLine{01439\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{01440\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor_a98997813fec16f4b37cbcf1220801c2f}{tensor<\_Tp>::operator/=}}(\mbox{\hyperlink{classtensor_aacd8d62096cc0d502cffd169e25f92f0}{const\_reference}}\ \_\_scalar)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01441\ \ \ \ \ this-\/>\_\_check\_is\_arithmetic\_type(\textcolor{stringliteral}{"{}template\ class\ must\ be\ an\ arithmetic\ type"{}});}
\DoxyCodeLine{01442\ }
\DoxyCodeLine{01443\ \ \ \ \ std::transform(this-\/>\_\_data\_.begin(),\ this-\/>\_\_data\_.end(),\ this-\/>\_\_data\_.begin(),}
\DoxyCodeLine{01444\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [](\mbox{\hyperlink{classtensor_aacd8d62096cc0d502cffd169e25f92f0}{const\_reference}}\ \_\_v)\ \{\ return\ static\_cast<value\_type>(\_\_v\ /\ \_\_scalar);\ \});}
\DoxyCodeLine{01445\ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{01446\ \}}
\DoxyCodeLine{01447\ }
\DoxyCodeLine{01448\ }
\DoxyCodeLine{01449\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{01450\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor_a29a72fe362d2919b391b19abb8501fc1}{tensor<\_Tp>::operator-\/=}}(\mbox{\hyperlink{classtensor_aacd8d62096cc0d502cffd169e25f92f0}{const\_reference}}\ \_\_scalar)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01451\ \ \ \ \ this-\/>\_\_check\_is\_arithmetic\_type(\textcolor{stringliteral}{"{}template\ class\ must\ be\ an\ arithmetic\ type"{}});}
\DoxyCodeLine{01452\ }
\DoxyCodeLine{01453\ \ \ \ \ std::transform(this-\/>\_\_data\_.begin(),\ this-\/>\_\_data\_.end(),\ this-\/>\_\_data\_.begin(),}
\DoxyCodeLine{01454\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [](\mbox{\hyperlink{classtensor_aacd8d62096cc0d502cffd169e25f92f0}{const\_reference}}\ \_\_v,\ \mbox{\hyperlink{classtensor_aacd8d62096cc0d502cffd169e25f92f0}{const\_reference}}\ \_\_w)\ \{}
\DoxyCodeLine{01455\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ return\ static\_cast<value\_type>(\_\_v\ -\/\ \_\_w);}
\DoxyCodeLine{01456\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{01457\ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{01458\ \}}
\DoxyCodeLine{01459\ }
\DoxyCodeLine{01460\ }
\DoxyCodeLine{01461\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{01462\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor_a0206a53b82db00a90635877556a9b987}{tensor<\_Tp>::randomize}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor_ab96aa71f8b92cb531a7e258f47315f45}{shape\_type}}\&\ \_\_sh,\ \textcolor{keywordtype}{bool}\ \_\_bounded)\ \{}
\DoxyCodeLine{01463\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classtensor}{\_\_self}}(*this).\mbox{\hyperlink{classtensor_a43f96a71e4140f306bfc89519496b56c}{randomize\_}}(\_\_sh,\ \_\_bounded);}
\DoxyCodeLine{01464\ \}}
\DoxyCodeLine{01465\ }
\DoxyCodeLine{01466\ }
\DoxyCodeLine{01467\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{01468\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_a43f96a71e4140f306bfc89519496b56c}{tensor<\_Tp>::randomize\_}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor_ab96aa71f8b92cb531a7e258f47315f45}{shape\_type}}\&\ \_\_sh,\ \textcolor{keywordtype}{bool}\ \_\_bounded)\ \{}
\DoxyCodeLine{01469\ \ \ \ \ this-\/>\_\_check\_is\_scalar\_type(\textcolor{stringliteral}{"{}template\ class\ must\ be\ a\ scalar\ type"{}});}
\DoxyCodeLine{01470\ }
\DoxyCodeLine{01471\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_s;}
\DoxyCodeLine{01472\ \ \ \ \ \textcolor{keywordflow}{if}\ (this-\/>\_\_shape\_\ !=\ \_\_sh)}
\DoxyCodeLine{01473\ \ \ \ \ \{}
\DoxyCodeLine{01474\ \ \ \ \ \ \ \ \ \_\_s\ =\ this-\/>\_\_computeSize(\_\_sh);}
\DoxyCodeLine{01475\ \ \ \ \ \}}
\DoxyCodeLine{01476\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{01477\ \ \ \ \ \{}
\DoxyCodeLine{01478\ \ \ \ \ \ \ \ \ \_\_s\ =\ this-\/>\_\_data\_.size();}
\DoxyCodeLine{01479\ \ \ \ \ \}}
\DoxyCodeLine{01480\ }
\DoxyCodeLine{01481\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_\_s\ !=\ this-\/>\_\_data\_.size())}
\DoxyCodeLine{01482\ \ \ \ \ \{}
\DoxyCodeLine{01483\ \ \ \ \ \ \ \ \ this-\/>\_\_data\_.resize(\_\_s);}
\DoxyCodeLine{01484\ \ \ \ \ \}}
\DoxyCodeLine{01485\ }
\DoxyCodeLine{01486\ \ \ \ \ std::random\_device\ rd;}
\DoxyCodeLine{01487\ \ \ \ \ std::mt19937\ \ \ \ \ \ \ gen(rd());}
\DoxyCodeLine{01488\ }
\DoxyCodeLine{01489\ \ \ \ \ std::uniform\_real\_distribution<float>\ bounded\_dist(0.0f,\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{float}\textcolor{keyword}{>}(RAND\_MAX));}
\DoxyCodeLine{01490\ \ \ \ \ std::uniform\_real\_distribution<float>\ unbounded\_dist(0.0f,\ 1.0f);}
\DoxyCodeLine{01491\ }
\DoxyCodeLine{01492\ \ \ \ \ \mbox{\hyperlink{classtensor_aae15c34415ce3896c43cb656ee7e6059}{index\_type}}\ \_\_i\ =\ 0;}
\DoxyCodeLine{01493\ }
\DoxyCodeLine{01494\ \textcolor{preprocessor}{\#if\ defined(\_\_AVX\_\_)}}
\DoxyCodeLine{01495\ \ \ \ \ \textcolor{keyword}{const}\ \_\_m256\ scale\ =\ \_mm256\_set1\_ps(\_\_bounded\ ?\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{float}\textcolor{keyword}{>}(RAND\_MAX)\ :\ 1.0f);}
\DoxyCodeLine{01496\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ +\ 8\ <=\ \textcolor{keyword}{static\_cast<}\mbox{\hyperlink{classtensor_aae15c34415ce3896c43cb656ee7e6059}{index\_type}}\textcolor{keyword}{>}(\_\_s);\ \_\_i\ +=\ 8)}
\DoxyCodeLine{01497\ \ \ \ \ \{}
\DoxyCodeLine{01498\ \ \ \ \ \ \ \ \ \_\_m256\ random\_values\ =\ \_mm256\_setr\_ps(}
\DoxyCodeLine{01499\ \ \ \ \ \ \ \ \ \ \ \ \ bounded\_dist(gen),\ bounded\_dist(gen),\ bounded\_dist(gen),\ bounded\_dist(gen),}
\DoxyCodeLine{01500\ \ \ \ \ \ \ \ \ \ \ \ \ bounded\_dist(gen),\ bounded\_dist(gen),\ bounded\_dist(gen),\ bounded\_dist(gen));}
\DoxyCodeLine{01501\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\_\_bounded)}
\DoxyCodeLine{01502\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01503\ \ \ \ \ \ \ \ \ \ \ \ \ random\_values\ =\ \_mm256\_div\_ps(random\_values,\ scale);}
\DoxyCodeLine{01504\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01505\ \ \ \ \ \ \ \ \ \_mm256\_storeu\_ps(\&this-\/>\_\_data\_[\_\_i],\ random\_values);}
\DoxyCodeLine{01506\ \ \ \ \ \}}
\DoxyCodeLine{01507\ \textcolor{preprocessor}{\#elif\ defined(\_\_SSE\_\_)}}
\DoxyCodeLine{01508\ \ \ \ \ \textcolor{keyword}{const}\ \_\_m128\ scale\ =\ \_mm\_set1\_ps(\_\_bounded\ ?\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{float}\textcolor{keyword}{>}(RAND\_MAX)\ :\ 1.0f);}
\DoxyCodeLine{01509\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ +\ 4\ <=\ \textcolor{keyword}{static\_cast<}\mbox{\hyperlink{classtensor_aae15c34415ce3896c43cb656ee7e6059}{index\_type}}\textcolor{keyword}{>}(\_\_s);\ \_\_i\ +=\ 4)}
\DoxyCodeLine{01510\ \ \ \ \ \{}
\DoxyCodeLine{01511\ \ \ \ \ \ \ \ \ \_\_m128\ random\_values\ =}
\DoxyCodeLine{01512\ \ \ \ \ \ \ \ \ \ \ \ \ \_mm\_setr\_ps(bounded\_dist(gen),\ bounded\_dist(gen),\ bounded\_dist(gen),\ bounded\_dist(gen));}
\DoxyCodeLine{01513\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\_\_bounded)}
\DoxyCodeLine{01514\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01515\ \ \ \ \ \ \ \ \ \ \ \ \ random\_values\ =\ \_mm\_div\_ps(random\_values,\ scale);}
\DoxyCodeLine{01516\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01517\ \ \ \ \ \ \ \ \ \_mm\_storeu\_ps(\&this-\/>\_\_data\_[\_\_i],\ random\_values);}
\DoxyCodeLine{01518\ \ \ \ \ \}}
\DoxyCodeLine{01519\ \textcolor{preprocessor}{\#elif\ defined(\_\_ARM\_NEON)}}
\DoxyCodeLine{01520\ \ \ \ \ \textcolor{keyword}{const}\ float32x4\_t\ scale\ =\ vdupq\_n\float32_t(\_\_bounded\ ?\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{float}\textcolor{keyword}{>}(RAND\_MAX)\ :\ 1.0f);}
\DoxyCodeLine{01521\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ +\ 4\ <=\ \textcolor{keyword}{static\_cast<}\mbox{\hyperlink{classtensor_aae15c34415ce3896c43cb656ee7e6059}{index\_type}}\textcolor{keyword}{>}(\_\_s);\ \_\_i\ +=\ 4)}
\DoxyCodeLine{01522\ \ \ \ \ \{}
\DoxyCodeLine{01523\ \ \ \ \ \ \ \ \ float32x4\_t\ random\_values\ =}
\DoxyCodeLine{01524\ \ \ \ \ \ \ \ \ \ \ \ \ vsetq\float32_t(bounded\_dist(gen),\ bounded\_dist(gen),\ bounded\_dist(gen),\ bounded\_dist(gen));}
\DoxyCodeLine{01525\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\_\_bounded)}
\DoxyCodeLine{01526\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01527\ \ \ \ \ \ \ \ \ \ \ \ \ random\_values\ =\ vmulq\float32_t(random\_values,\ vrecpeq\float32_t(scale));}
\DoxyCodeLine{01528\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01529\ \ \ \ \ \ \ \ \ vst1q\float32_t(\&this-\/>\_\_data\_[\_\_i],\ random\_values);}
\DoxyCodeLine{01530\ \ \ \ \ \}}
\DoxyCodeLine{01531\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01532\ }
\DoxyCodeLine{01533\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ static\_cast<index\_type>(\_\_s);\ \_\_i++)}
\DoxyCodeLine{01534\ \ \ \ \ \{}
\DoxyCodeLine{01535\ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i]\ =\ \mbox{\hyperlink{classtensor_a12614e7ef399b40d0eca22d10360149f}{value\_type}}(\_\_bounded\ ?\ bounded\_dist(gen)\ :\ unbounded\_dist(gen));}
\DoxyCodeLine{01536\ \ \ \ \ \}}
\DoxyCodeLine{01537\ \}}
\DoxyCodeLine{01538\ }
\DoxyCodeLine{01539\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{01540\ \mbox{\hyperlink{classtensor}{tensor<typename\ tensor<\_Tp>::index\_type}}>\ \mbox{\hyperlink{classtensor_ad56d35a65d0417510a087e55fd35ab0a}{tensor<\_Tp>::argmax\_}}(index\_type\ \_\_dim)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01541\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_\_dim\ <\ 0\ ||\ \_\_dim\ >=\ this-\/>\_\_shape\_.size())}
\DoxyCodeLine{01542\ \ \ \ \ \{}
\DoxyCodeLine{01543\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::out\_of\_range(\textcolor{stringliteral}{"{}Dimension\ out\ of\ range\ in\ argmax"{}});}
\DoxyCodeLine{01544\ \ \ \ \ \}}
\DoxyCodeLine{01545\ }
\DoxyCodeLine{01546\ \ \ \ \ shape\_type\ \_\_ret\_sh\ =\ this-\/>\_\_shape\_;}
\DoxyCodeLine{01547\ \ \ \ \ \_\_ret\_sh.erase(\_\_ret\_sh.begin()\ +\ \_\_dim);}
\DoxyCodeLine{01548\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor<index\_type>}}\ \_\_ret;}
\DoxyCodeLine{01549\ \ \ \ \ \_\_ret.\_\_shape\_\ =\ \_\_ret\_sh;}
\DoxyCodeLine{01550\ \ \ \ \ \_\_ret.\_\_data\_.resize(this-\/>\_\_computeSize(\_\_ret\_sh),\ 0);}
\DoxyCodeLine{01551\ }
\DoxyCodeLine{01552\ \ \ \ \ index\_type\ \_\_outer\_size\ =\ 1LL;}
\DoxyCodeLine{01553\ \ \ \ \ index\_type\ \_\_inner\_size\ =\ 1LL;}
\DoxyCodeLine{01554\ }
\DoxyCodeLine{01555\ \ \ \ \ index\_type\ \_\_i\ =\ 0;}
\DoxyCodeLine{01556\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ \_\_dim;\ \_\_i++)}
\DoxyCodeLine{01557\ \ \ \ \ \{}
\DoxyCodeLine{01558\ \ \ \ \ \ \ \ \ \_\_outer\_size\ *=\ this-\/>\_\_shape\_[\_\_i];}
\DoxyCodeLine{01559\ \ \ \ \ \}}
\DoxyCodeLine{01560\ }
\DoxyCodeLine{01561\ \ \ \ \ \textcolor{keywordflow}{for}\ (\_\_i\ =\ \_\_dim\ +\ 1;\ \_\_i\ <\ this-\/>\_\_shape\_.size();\ \_\_i++)}
\DoxyCodeLine{01562\ \ \ \ \ \{}
\DoxyCodeLine{01563\ \ \ \ \ \ \ \ \ \_\_inner\_size\ *=\ this-\/>\_\_shape\_[\_\_i];}
\DoxyCodeLine{01564\ \ \ \ \ \}}
\DoxyCodeLine{01565\ }
\DoxyCodeLine{01566\ \textcolor{preprocessor}{\#if\ defined(\_\_AVX2\_\_)}}
\DoxyCodeLine{01567\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_same\_v<\_Tp,\ float>)}
\DoxyCodeLine{01568\ \ \ \ \ \{}
\DoxyCodeLine{01569\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\_\_i\ =\ 0;\ \_\_i\ <\ \_\_outer\_size;\ \_\_i++)}
\DoxyCodeLine{01570\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01571\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (index\_type\ \_\_j\ =\ 0;\ \_\_j\ <\ \_\_inner\_size;\ \_\_j++)}
\DoxyCodeLine{01572\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01573\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_m256\ \ \_\_max\_vec\ \ \ \ \ \ \ =\ \_mm256\_set1\_ps(-\/std::numeric\_limits<float>::infinity());}
\DoxyCodeLine{01574\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_m256i\ \_\_index\_vec\ \ \ \ \ =\ \_mm256\_setzero\_si256();}
\DoxyCodeLine{01575\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_m256i\ \_\_increment\ \ \ \ \ =\ \_mm256\_set1\_epi32(1);}
\DoxyCodeLine{01576\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_m256i\ \_\_current\_index\ =\ \_mm256\_setr\_epi32(0,\ 1,\ 2,\ 3,\ 4,\ 5,\ 6,\ 7);}
\DoxyCodeLine{01577\ }
\DoxyCodeLine{01578\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ index\_type\ \_\_k\ =\ 0;}
\DoxyCodeLine{01579\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_k\ +\ 8\ <=\ this-\/>\_\_shape\_[\_\_dim];\ \_\_k\ +=\ 8)}
\DoxyCodeLine{01580\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01581\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_m256\ \_\_data\_vec\ =\ \_mm256\_loadu\_ps(}
\DoxyCodeLine{01582\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&this-\/>\_\_data\_[(\_\_i\ *\ this-\/>\_\_shape\_[\_\_dim]\ +\ \_\_k)\ *\ \_\_inner\_size\ +\ \_\_j]);}
\DoxyCodeLine{01583\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_m256\ \_\_mask\ \ \ =\ \_mm256\_cmp\_ps(\_\_data\_vec,\ \_\_max\_vec,\ \_CMP\_GT\_OQ);}
\DoxyCodeLine{01584\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_max\_vec\ \ \ \ \ \ \ =\ \_mm256\_blendv\_ps(\_\_max\_vec,\ \_\_data\_vec,\ \_\_mask);}
\DoxyCodeLine{01585\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_index\_vec\ \ \ \ \ =\ \_mm256\_blendv\_epi8(\_\_index\_vec,\ \_\_current\_index,}
\DoxyCodeLine{01586\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_mm256\_castps\_si256(\_\_mask));}
\DoxyCodeLine{01587\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_current\_index\ =\ \_mm256\_add\_epi32(\_\_current\_index,\ \_\_increment);}
\DoxyCodeLine{01588\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01589\ }
\DoxyCodeLine{01590\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ \ \ \_\_max\_values[8];}
\DoxyCodeLine{01591\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ int32\_t\ \_\_indices[8];}
\DoxyCodeLine{01592\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_mm256\_storeu\_ps(\_\_max\_values,\ \_\_max\_vec);}
\DoxyCodeLine{01593\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_mm256\_storeu\_si256((\_\_m256i*)\ \_\_indices,\ \_\_index\_vec);}
\DoxyCodeLine{01594\ }
\DoxyCodeLine{01595\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ \ \ \ \ \ \_\_max\_value\ =\ \_\_max\_values[0];}
\DoxyCodeLine{01596\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ index\_type\ \_\_max\_index\ =\ \_\_indices[0];}
\DoxyCodeLine{01597\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ \_\_i\ =\ 1;\ \_\_i\ <\ 8;\ \_\_i++)}
\DoxyCodeLine{01598\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01599\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_\_max\_values[\_\_i]\ >\ \_\_max\_value)}
\DoxyCodeLine{01600\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01601\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_max\_value\ =\ \_\_max\_values[i];}
\DoxyCodeLine{01602\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_max\_index\ =\ \_\_indices[i];}
\DoxyCodeLine{01603\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01604\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01605\ }
\DoxyCodeLine{01606\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_k\ <\ this-\/>\_\_shape\_[\_\_dim];\ \_\_k++)}
\DoxyCodeLine{01607\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01608\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ \_\_v\ =}
\DoxyCodeLine{01609\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[(\_\_i\ *\ this-\/>\_\_shape\_[\_\_dim]\ +\ \_\_k)\ *\ \_\_inner\_size\ +\ \_\_j];}
\DoxyCodeLine{01610\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_\_v\ >\ \_\_max\_value)}
\DoxyCodeLine{01611\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01612\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_max\_value\ =\ \_\_v;}
\DoxyCodeLine{01613\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_max\_index\ =\ \_\_k;}
\DoxyCodeLine{01614\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01615\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01616\ }
\DoxyCodeLine{01617\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret.\_\_data\_[\_\_i\ *\ \_\_inner\_size\ +\ \_\_j]\ =\ max\_index;}
\DoxyCodeLine{01618\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01619\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01620\ \ \ \ \ \}}
\DoxyCodeLine{01621\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{01622\ \textcolor{preprocessor}{\#elif\ defined(\_\_ARM\_NEON)}}
\DoxyCodeLine{01623\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_same\_v<\_Tp,\ float>)}
\DoxyCodeLine{01624\ \ \ \ \ \{}
\DoxyCodeLine{01625\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\_\_i\ =\ 0;\ \_\_i\ <\ \_\_outer\_size;\ \_\_i++)}
\DoxyCodeLine{01626\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01627\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (index\_type\ \_\_j\ =\ 0;\ \_\_j\ <\ \_\_inner\_size;\ \_\_j++)}
\DoxyCodeLine{01628\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01629\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ float32x4\_t\ max\_vec\ \ \ \ \ \ \ =\ vdupq\_n\float32_t(-\/std::numeric\_limits<float>::infinity());}
\DoxyCodeLine{01630\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ uint32x4\_t\ \ index\_vec\ \ \ \ \ =\ vdupq\_n\_u32(0);}
\DoxyCodeLine{01631\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ uint32x4\_t\ \ increment\ \ \ \ \ =\ vdupq\_n\_u32(1);}
\DoxyCodeLine{01632\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ uint32x4\_t\ \ current\_index\ =\ \{0,\ 1,\ 2,\ 3\};}
\DoxyCodeLine{01633\ }
\DoxyCodeLine{01634\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ index\_type\ \_\_k\ =\ 0;}
\DoxyCodeLine{01635\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_k\ +\ 4\ <=\ this-\/>\_\_shape\_[\_\_dim];\ \_\_k\ +=\ 4)}
\DoxyCodeLine{01636\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01637\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ float32x4\_t\ data\_vec\ =\ vld1q\float32_t(}
\DoxyCodeLine{01638\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&this-\/>\_\_data\_[(\_\_i\ *\ this-\/>\_\_shape\_[\_\_dim]\ +\ \_\_k)\ *\ \_\_inner\_size\ +\ \_\_j]);}
\DoxyCodeLine{01639\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ uint32x4\_t\ mask\ =\ vcgtq\float32_t(data\_vec,\ max\_vec);}
\DoxyCodeLine{01640\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ max\_vec\ \ \ \ \ \ \ \ \ =\ vbslq\float32_t(mask,\ data\_vec,\ max\_vec);}
\DoxyCodeLine{01641\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ index\_vec\ \ \ \ \ \ \ =\ vbslq\_u32(mask,\ current\_index,\ index\_vec);}
\DoxyCodeLine{01642\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ current\_index\ \ \ =\ vaddq\_u32(current\_index,\ increment);}
\DoxyCodeLine{01643\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01644\ }
\DoxyCodeLine{01645\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ \ \ \ max\_values[4];}
\DoxyCodeLine{01646\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ uint32\_t\ indices[4];}
\DoxyCodeLine{01647\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ vst1q\float32_t(max\_values,\ max\_vec);}
\DoxyCodeLine{01648\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ vst1q\_u32(indices,\ index\_vec);}
\DoxyCodeLine{01649\ }
\DoxyCodeLine{01650\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ \ \ \ \ \ max\_value\ =\ max\_values[0];}
\DoxyCodeLine{01651\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ index\_type\ max\_index\ =\ indices[0];}
\DoxyCodeLine{01652\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 1;\ i\ <\ 4;\ ++i)}
\DoxyCodeLine{01653\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01654\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (max\_values[i]\ >\ max\_value)}
\DoxyCodeLine{01655\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01656\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ max\_value\ =\ max\_values[i];}
\DoxyCodeLine{01657\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ max\_index\ =\ indices[i];}
\DoxyCodeLine{01658\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01659\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01660\ }
\DoxyCodeLine{01661\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_k\ <\ this-\/>\_\_shape\_[\_\_dim];\ \_\_k++)}
\DoxyCodeLine{01662\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01663\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ \_\_v\ =}
\DoxyCodeLine{01664\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[(\_\_i\ *\ this-\/>\_\_shape\_[\_\_dim]\ +\ \_\_k)\ *\ \_\_inner\_size\ +\ \_\_j];}
\DoxyCodeLine{01665\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_\_v\ >\ max\_value)}
\DoxyCodeLine{01666\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01667\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ max\_value\ =\ \_\_v;}
\DoxyCodeLine{01668\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ max\_index\ =\ \_\_k;}
\DoxyCodeLine{01669\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01670\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01671\ }
\DoxyCodeLine{01672\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret.\_\_data\_[\_\_i\ *\ \_\_inner\_size\ +\ \_\_j]\ =\ max\_index;}
\DoxyCodeLine{01673\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01674\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01675\ \ \ \ \ \}}
\DoxyCodeLine{01676\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{01677\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01678\ \ \ \ \ \{}
\DoxyCodeLine{01679\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\_\_i\ =\ 0;\ \_\_i\ <\ \_\_outer\_size;\ \_\_i++)}
\DoxyCodeLine{01680\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01681\ \ \ \ \ \ \ \ \ \ \ \ \ index\_type\ \_\_j\ =\ 0;}
\DoxyCodeLine{01682\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_j\ <\ \_\_inner\_size;\ \_\_j++)}
\DoxyCodeLine{01683\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01684\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ index\_type\ \_\_max\_index\ =\ 0;}
\DoxyCodeLine{01685\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ value\_type\ \_\_max\_value\ =}
\DoxyCodeLine{01686\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i\ *\ this-\/>\_\_shape\_[\_\_dim]\ *\ \_\_inner\_size\ +\ \_\_j];}
\DoxyCodeLine{01687\ }
\DoxyCodeLine{01688\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ index\_type\ \_\_k\ =\ 1;}
\DoxyCodeLine{01689\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_k\ <\ this-\/>\_\_shape\_[\_\_dim];\ \_\_k++)}
\DoxyCodeLine{01690\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01691\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ value\_type\ \_\_v\ =}
\DoxyCodeLine{01692\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[(\_\_i\ *\ this-\/>\_\_shape\_[\_\_dim]\ +\ \_\_k)\ *\ \_\_inner\_size\ +\ \_\_j];}
\DoxyCodeLine{01693\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_\_v\ >\ \_\_max\_value)}
\DoxyCodeLine{01694\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01695\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_max\_value\ =\ \_\_v;}
\DoxyCodeLine{01696\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_max\_index\ =\ \_\_k;}
\DoxyCodeLine{01697\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01698\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01699\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret.\_\_data\_[\_\_i\ *\ \_\_inner\_size\ +\ \_\_j]\ =\ \_\_max\_index;}
\DoxyCodeLine{01700\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01701\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01702\ \ \ \ \ \}}
\DoxyCodeLine{01703\ }
\DoxyCodeLine{01704\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_ret;}
\DoxyCodeLine{01705\ \}}
\DoxyCodeLine{01706\ }
\DoxyCodeLine{01707\ }
\DoxyCodeLine{01708\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{01709\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor_af8ff9002a615c25b587b2de6d75dc206}{tensor<\_Tp>::argmax}}(index\_type\ \_\_dim)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01710\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_\_dim\ <\ 0\ ||\ \_\_dim\ >=\ this-\/>\_\_shape\_.size())}
\DoxyCodeLine{01711\ \ \ \ \ \{}
\DoxyCodeLine{01712\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::out\_of\_range(\textcolor{stringliteral}{"{}Dimension\ out\ of\ range\ in\ argmax"{}});}
\DoxyCodeLine{01713\ \ \ \ \ \}}
\DoxyCodeLine{01714\ }
\DoxyCodeLine{01715\ \ \ \ \ shape\_type\ \_\_ret\_sh\ =\ this-\/>\_\_shape\_;}
\DoxyCodeLine{01716\ \ \ \ \ \_\_ret\_sh.erase(\_\_ret\_sh.begin()\ +\ \_\_dim);}
\DoxyCodeLine{01717\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \_\_ret;}
\DoxyCodeLine{01718\ \ \ \ \ \_\_ret.\_\_shape\_\ =\ \_\_ret\_sh;}
\DoxyCodeLine{01719\ \ \ \ \ \_\_ret.\_\_data\_.resize(this-\/>\_\_computeSize(\_\_ret\_sh),\ value\_type(0));}
\DoxyCodeLine{01720\ }
\DoxyCodeLine{01721\ \ \ \ \ index\_type\ \_\_outer\_size\ =\ 1;}
\DoxyCodeLine{01722\ \ \ \ \ index\_type\ \_\_inner\_size\ =\ 1;}
\DoxyCodeLine{01723\ }
\DoxyCodeLine{01724\ \ \ \ \ index\_type\ \_\_i\ =\ 0;}
\DoxyCodeLine{01725\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ \_\_dim;\ \_\_i++)}
\DoxyCodeLine{01726\ \ \ \ \ \{}
\DoxyCodeLine{01727\ \ \ \ \ \ \ \ \ \_\_outer\_size\ *=\ this-\/>\_\_shape\_[\_\_i];}
\DoxyCodeLine{01728\ \ \ \ \ \}}
\DoxyCodeLine{01729\ }
\DoxyCodeLine{01730\ \ \ \ \ \textcolor{keywordflow}{for}\ (\_\_i\ =\ \_\_dim\ +\ 1;\ \_\_i\ <\ static\_cast<index\_type>(this-\/>\_\_shape\_.size());\ \_\_i++)}
\DoxyCodeLine{01731\ \ \ \ \ \{}
\DoxyCodeLine{01732\ \ \ \ \ \ \ \ \ \_\_inner\_size\ *=\ this-\/>\_\_shape\_[\_\_i];}
\DoxyCodeLine{01733\ \ \ \ \ \}}
\DoxyCodeLine{01734\ }
\DoxyCodeLine{01735\ \textcolor{preprocessor}{\#if\ defined(\_\_AVX2\_\_)}}
\DoxyCodeLine{01736\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_same\_v<\_Tp,\ float>)}
\DoxyCodeLine{01737\ \ \ \ \ \{}
\DoxyCodeLine{01738\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\_\_i\ =\ 0;\ \_\_i\ <\ \_\_outer\_size;\ \_\_i++)}
\DoxyCodeLine{01739\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01740\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (index\_type\ \_\_j\ =\ 0;\ \_\_j\ <\ \_\_inner\_size;\ \_\_j++)}
\DoxyCodeLine{01741\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01742\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_m256\ \ \ \ \ max\_vec\ =\ \_mm256\_set1\_ps(-\/std::numeric\_limits<float>::infinity());}
\DoxyCodeLine{01743\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ index\_type\ \_\_k\ \ \ \ \ =\ 0;}
\DoxyCodeLine{01744\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_k\ +\ 8\ <=\ this-\/>\_\_shape\_[\_\_dim];\ \_\_k\ +=\ 8)}
\DoxyCodeLine{01745\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01746\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_m256\ data\_vec\ =\ \_mm256\_loadu\_ps(}
\DoxyCodeLine{01747\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&this-\/>\_\_data\_[(\_\_i\ *\ this-\/>\_\_shape\_[\_\_dim]\ +\ \_\_k)\ *\ \_\_inner\_size\ +\ \_\_j]);}
\DoxyCodeLine{01748\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ max\_vec\ =\ \_mm256\_max\_ps(max\_vec,\ data\_vec);}
\DoxyCodeLine{01749\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01750\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ max\_value\ =\ \_mm256\_reduce\_max\_ps(max\_vec);}
\DoxyCodeLine{01751\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_k\ <\ this-\/>\_\_shape\_[\_\_dim];\ \_\_k++)}
\DoxyCodeLine{01752\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01753\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ \_\_v\ =}
\DoxyCodeLine{01754\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[(\_\_i\ *\ this-\/>\_\_shape\_[\_\_dim]\ +\ \_\_k)\ *\ \_\_inner\_size\ +\ \_\_j];}
\DoxyCodeLine{01755\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ max\_value\ =\ std::max(max\_value,\ \_\_v);}
\DoxyCodeLine{01756\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01757\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret.\_\_data\_[\_\_i\ *\ \_\_inner\_size\ +\ \_\_j]\ =\ max\_value;}
\DoxyCodeLine{01758\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01759\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01760\ \ \ \ \ \}}
\DoxyCodeLine{01761\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{01762\ \textcolor{preprocessor}{\#elif\ defined(\_\_ARM\_NEON)}}
\DoxyCodeLine{01763\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_same\_v<\_Tp,\ float>)}
\DoxyCodeLine{01764\ \ \ \ \ \{}
\DoxyCodeLine{01765\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\_\_i\ =\ 0;\ \_\_i\ <\ \_\_outer\_size;\ \_\_i++)}
\DoxyCodeLine{01766\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01767\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (index\_type\ \_\_j\ =\ 0;\ \_\_j\ <\ \_\_inner\_size;\ \_\_j++)}
\DoxyCodeLine{01768\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01769\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ float32x4\_t\ max\_vec\ =\ vdupq\_n\float32_t(-\/std::numeric\_limits<float>::infinity());}
\DoxyCodeLine{01770\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ index\_type\ \ \_\_k\ \ \ \ \ =\ 0;}
\DoxyCodeLine{01771\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_k\ +\ 4\ <=\ this-\/>\_\_shape\_[\_\_dim];\ \_\_k\ +=\ 4)}
\DoxyCodeLine{01772\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01773\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ float32x4\_t\ data\_vec\ =\ vld1q\float32_t(}
\DoxyCodeLine{01774\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&this-\/>\_\_data\_[(\_\_i\ *\ this-\/>\_\_shape\_[\_\_dim]\ +\ \_\_k)\ *\ \_\_inner\_size\ +\ \_\_j]);}
\DoxyCodeLine{01775\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ max\_vec\ =\ vmaxq\float32_t(max\_vec,\ data\_vec);}
\DoxyCodeLine{01776\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01777\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ max\_value\ =\ vmaxvq\float32_t(max\_vec);}
\DoxyCodeLine{01778\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_k\ <\ this-\/>\_\_shape\_[\_\_dim];\ \_\_k++)}
\DoxyCodeLine{01779\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01780\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ \_\_v\ =}
\DoxyCodeLine{01781\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[(\_\_i\ *\ this-\/>\_\_shape\_[\_\_dim]\ +\ \_\_k)\ *\ \_\_inner\_size\ +\ \_\_j];}
\DoxyCodeLine{01782\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ max\_value\ =\ std::max(max\_value,\ \_\_v);}
\DoxyCodeLine{01783\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01784\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret.\_\_data\_[\_\_i\ *\ \_\_inner\_size\ +\ \_\_j]\ =\ max\_value;}
\DoxyCodeLine{01785\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01786\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01787\ \ \ \ \ \}}
\DoxyCodeLine{01788\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{01789\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01790\ \ \ \ \ \{}
\DoxyCodeLine{01791\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\_\_i\ =\ 0;\ \_\_i\ <\ \_\_outer\_size;\ \_\_i++)}
\DoxyCodeLine{01792\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01793\ \ \ \ \ \ \ \ \ \ \ \ \ index\_type\ \_\_j\ =\ 0;}
\DoxyCodeLine{01794\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_j\ <\ \_\_inner\_size;\ \_\_j++)}
\DoxyCodeLine{01795\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01796\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ value\_type\ \_\_max\_value\ =}
\DoxyCodeLine{01797\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i\ *\ this-\/>\_\_shape\_[\_\_dim]\ *\ \_\_inner\_size\ +\ \_\_j];}
\DoxyCodeLine{01798\ }
\DoxyCodeLine{01799\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ index\_type\ \_\_k\ =\ 1;}
\DoxyCodeLine{01800\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_k\ <\ this-\/>\_\_shape\_[\_\_dim];\ \_\_k++)}
\DoxyCodeLine{01801\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01802\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ value\_type\ \_\_v\ =}
\DoxyCodeLine{01803\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[(\_\_i\ *\ this-\/>\_\_shape\_[\_\_dim]\ +\ \_\_k)\ *\ \_\_inner\_size\ +\ \_\_j];}
\DoxyCodeLine{01804\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_\_v\ >\ \_\_max\_value)}
\DoxyCodeLine{01805\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01806\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_max\_value\ =\ \_\_v;}
\DoxyCodeLine{01807\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01808\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01809\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret.\_\_data\_[\_\_i\ *\ \_\_inner\_size\ +\ \_\_j]\ =\ \_\_max\_value;}
\DoxyCodeLine{01810\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01811\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01812\ \ \ \ \ \}}
\DoxyCodeLine{01813\ }
\DoxyCodeLine{01814\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_ret;}
\DoxyCodeLine{01815\ \}}
\DoxyCodeLine{01816\ }
\DoxyCodeLine{01817\ }
\DoxyCodeLine{01818\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{01819\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor_adf1ab2fa12dbb55524289f2de928ad35}{tensor<\_Tp>::unsqueeze}}(index\_type\ \_\_dim)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01820\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_\_dim\ <\ 0\ ||\ \_\_dim\ >\ \textcolor{keyword}{static\_cast<}index\_type\textcolor{keyword}{>}(this-\/>\_\_shape\_.size()))}
\DoxyCodeLine{01821\ \ \ \ \ \{}
\DoxyCodeLine{01822\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::out\_of\_range(\textcolor{stringliteral}{"{}Dimension\ out\ of\ range\ in\ unsqueeze"{}});}
\DoxyCodeLine{01823\ \ \ \ \ \}}
\DoxyCodeLine{01824\ }
\DoxyCodeLine{01825\ \ \ \ \ shape\_type\ \_\_s\ =\ this-\/>\_\_shape\_;}
\DoxyCodeLine{01826\ \ \ \ \ \_\_s.insert(\_\_s.begin()\ +\ \_\_dim,\ 1);}
\DoxyCodeLine{01827\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \_\_ret;}
\DoxyCodeLine{01828\ \ \ \ \ \_\_ret.\_\_shape\_\ =\ \_\_s;}
\DoxyCodeLine{01829\ \ \ \ \ \_\_ret.\_\_data\_\ \ =\ this-\/>\_\_data\_;}
\DoxyCodeLine{01830\ }
\DoxyCodeLine{01831\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_ret;}
\DoxyCodeLine{01832\ \}}
\DoxyCodeLine{01833\ }
\DoxyCodeLine{01834\ }
\DoxyCodeLine{01835\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{01836\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_a763bcc5fef28ac840b848b65d63ca1ed}{tensor<\_Tp>::view}}(std::initializer\_list<index\_type>\ \_\_sh)\ \{}
\DoxyCodeLine{01837\ \ \ \ \ index\_type\ \_\_s\ =\ this-\/>\_\_computeSize(\_\_sh);}
\DoxyCodeLine{01838\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_\_s\ !=\ this-\/>\_\_data\_.size())}
\DoxyCodeLine{01839\ \ \ \ \ \{}
\DoxyCodeLine{01840\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::invalid\_argument(\textcolor{stringliteral}{"{}Total\ elements\ do\ not\ match\ for\ new\ shape"{}});}
\DoxyCodeLine{01841\ \ \ \ \ \}}
\DoxyCodeLine{01842\ \ \ \ \ this-\/>\_\_shape\_\ =\ \_\_sh;}
\DoxyCodeLine{01843\ \ \ \ \ this-\/>\_\_compute\_strides();}
\DoxyCodeLine{01844\ \}}
\DoxyCodeLine{01845\ }
\DoxyCodeLine{01846\ }
\DoxyCodeLine{01847\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{01848\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor_ac40335f8961d05a0a4c4ec306dcd0dbd}{tensor<\_Tp>::cat}}(\textcolor{keyword}{const}\ std::vector<\mbox{\hyperlink{classtensor}{tensor<\_Tp>}}>\&\ \_\_others,\ index\_type\ \_\_dim)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01849\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_t\ :\ \_\_others)}
\DoxyCodeLine{01850\ \ \ \ \ \{}
\DoxyCodeLine{01851\ \ \ \ \ \ \ \ \ index\_type\ \_\_i\ =\ 0;}
\DoxyCodeLine{01852\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_shape\_.size();\ \_\_i++)}
\DoxyCodeLine{01853\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01854\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_\_i\ !=\ \_\_dim\ \&\&\ this-\/>\_\_shape\_[\_\_i]\ !=\ \_\_t.\_\_shape\_[\_\_i])}
\DoxyCodeLine{01855\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01856\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::invalid\_argument(}
\DoxyCodeLine{01857\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Cannot\ concatenate\ tensors\ with\ different\ shapes\ along\ non-\/concatenation\ dimensions"{}});}
\DoxyCodeLine{01858\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01859\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01860\ \ \ \ \ \}}
\DoxyCodeLine{01861\ }
\DoxyCodeLine{01862\ \ \ \ \ shape\_type\ \_\_ret\_sh\ =\ this-\/>\_\_shape\_;}
\DoxyCodeLine{01863\ }
\DoxyCodeLine{01864\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_t\ :\ \_\_others)}
\DoxyCodeLine{01865\ \ \ \ \ \{}
\DoxyCodeLine{01866\ \ \ \ \ \ \ \ \ \_\_ret\_sh[\_\_dim]\ +=\ \_\_t.\_\_shape\_[\_\_dim];}
\DoxyCodeLine{01867\ \ \ \ \ \}}
\DoxyCodeLine{01868\ }
\DoxyCodeLine{01869\ \ \ \ \ data\_t\ \_\_c;}
\DoxyCodeLine{01870\ \ \ \ \ \_\_c.reserve(this-\/>\_\_data\_.size());}
\DoxyCodeLine{01871\ \ \ \ \ \_\_c.insert(\_\_c.end(),\ this-\/>\_\_data\_.begin(),\ this-\/>\_\_data\_.end());}
\DoxyCodeLine{01872\ }
\DoxyCodeLine{01873\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_t\ :\ \_\_others)}
\DoxyCodeLine{01874\ \ \ \ \ \{}
\DoxyCodeLine{01875\ \ \ \ \ \ \ \ \ \_\_c.insert(\_\_c.end(),\ \_\_t.\_\_data\_.begin(),\ \_\_t.\_\_data\_.end());}
\DoxyCodeLine{01876\ \ \ \ \ \}}
\DoxyCodeLine{01877\ }
\DoxyCodeLine{01878\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(\_\_c,\ \_\_ret\_sh);}
\DoxyCodeLine{01879\ \}}
\DoxyCodeLine{01880\ }
\DoxyCodeLine{01881\ }
\DoxyCodeLine{01882\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{01883\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor_a949fa89abc9832f91f7ba551dd641d22}{tensor<\_Tp>::cumprod}}(index\_type\ \_\_dim)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01884\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_\_dim\ ==\ -\/1)}
\DoxyCodeLine{01885\ \ \ \ \ \{}
\DoxyCodeLine{01886\ \ \ \ \ \ \ \ \ data\_t\ \_\_flat\ =\ this-\/>\_\_data\_;}
\DoxyCodeLine{01887\ \ \ \ \ \ \ \ \ data\_t\ \_\_ret(\_\_flat.size());}
\DoxyCodeLine{01888\ \ \ \ \ \ \ \ \ \_\_ret[0]\ =\ \_\_flat[0];}
\DoxyCodeLine{01889\ }
\DoxyCodeLine{01890\ \textcolor{preprocessor}{\#if\ defined(\_\_AVX2\_\_)}}
\DoxyCodeLine{01891\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_same\_v<\_Tp,\ float>)}
\DoxyCodeLine{01892\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01893\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 1;}
\DoxyCodeLine{01894\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ +\ 8\ <=\ \_\_flat.size();\ \_\_i\ +=\ 8)}
\DoxyCodeLine{01895\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01896\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_m256\ prev\ \ \ =\ \_mm256\_loadu\_ps(\&\_\_ret[\_\_i\ -\/\ 1]);}
\DoxyCodeLine{01897\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_m256\ curr\ \ \ =\ \_mm256\_loadu\_ps(\&\_\_flat[\_\_i]);}
\DoxyCodeLine{01898\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_m256\ result\ =\ \_mm256\_mul\_ps(prev,\ curr);}
\DoxyCodeLine{01899\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_mm256\_storeu\_ps(\&\_\_ret[\_\_i],\ result);}
\DoxyCodeLine{01900\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01901\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ \_\_flat.size();\ \_\_i++)}
\DoxyCodeLine{01902\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01903\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_i]\ =\ \_\_ret[\_\_i\ -\/\ 1]\ *\ \_\_flat[\_\_i];}
\DoxyCodeLine{01904\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01905\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01906\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{01907\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01908\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 1;}
\DoxyCodeLine{01909\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ \_\_flat.size();\ \_\_i++)}
\DoxyCodeLine{01910\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01911\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_i]\ =\ \_\_ret[\_\_i\ -\/\ 1]\ *\ \_\_flat[\_\_i];}
\DoxyCodeLine{01912\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01913\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01914\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{01915\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 1;}
\DoxyCodeLine{01916\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ \_\_flat.size();\ \_\_i++)}
\DoxyCodeLine{01917\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01918\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_i]\ =\ \_\_ret[\_\_i\ -\/\ 1]\ *\ \_\_flat[\_\_i];}
\DoxyCodeLine{01919\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01920\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01921\ }
\DoxyCodeLine{01922\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(\_\_ret,\ \{\_\_flat.size()\});}
\DoxyCodeLine{01923\ \ \ \ \ \}}
\DoxyCodeLine{01924\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{01925\ \ \ \ \ \{}
\DoxyCodeLine{01926\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_\_dim\ <\ 0\ ||\ \_\_dim\ >=\ \textcolor{keyword}{static\_cast<}index\_type\textcolor{keyword}{>}(this-\/>\_\_shape\_.size()))}
\DoxyCodeLine{01927\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01928\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::invalid\_argument(\textcolor{stringliteral}{"{}Invalid\ dimension\ provided."{}});}
\DoxyCodeLine{01929\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01930\ }
\DoxyCodeLine{01931\ \ \ \ \ \ \ \ \ data\_t\ \_\_ret(this-\/>\_\_data\_);}
\DoxyCodeLine{01932\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ TODO\ :\ compute\_outer\_size()\ implementation}}
\DoxyCodeLine{01933\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_outer\_size\ =\ this-\/>\_\_compute\_outer\_size(\_\_dim);}
\DoxyCodeLine{01934\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_inner\_size\ =\ this-\/>\_\_shape\_[\_\_dim];}
\DoxyCodeLine{01935\ }
\DoxyCodeLine{01936\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_st\ =\ this-\/>\_\_strides\_[\_\_dim];}
\DoxyCodeLine{01937\ }
\DoxyCodeLine{01938\ \textcolor{preprocessor}{\#if\ defined(\_\_AVX2\_\_)}}
\DoxyCodeLine{01939\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_same\_v<\_Tp,\ float>)}
\DoxyCodeLine{01940\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01941\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;\ \_\_i\ <\ \_\_outer\_size;\ ++\_\_i)}
\DoxyCodeLine{01942\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01943\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_base\ =\ \_\_i\ *\ \_\_st;}
\DoxyCodeLine{01944\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_base]\ =\ \_\_data\_[\_\_base];}
\DoxyCodeLine{01945\ }
\DoxyCodeLine{01946\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_j\ =\ 1;}
\DoxyCodeLine{01947\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_j\ +\ 8\ <=\ \_\_inner\_size;\ \_\_j\ +=\ 8)}
\DoxyCodeLine{01948\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01949\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_m256\ prev\ \ \ =\ \_mm256\_loadu\_ps(\&\_\_ret[\_\_base\ +\ \_\_j\ -\/\ 1]);}
\DoxyCodeLine{01950\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_m256\ curr\ \ \ =\ \_mm256\_loadu\_ps(\&\_\_data\_[\_\_base\ +\ \_\_j]);}
\DoxyCodeLine{01951\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_m256\ result\ =\ \_mm256\_mul\_ps(prev,\ curr);}
\DoxyCodeLine{01952\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_mm256\_storeu\_ps(\&\_\_ret[\_\_base\ +\ \_\_j],\ result);}
\DoxyCodeLine{01953\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01954\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_j\ <\ \_\_inner\_size;\ \_\_j++)}
\DoxyCodeLine{01955\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01956\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_curr\ =\ \_\_base\ +\ \_\_j;}
\DoxyCodeLine{01957\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_curr]\ =\ \_\_ret[\_\_base\ +\ \_\_j\ -\/\ 1]\ *\ \_\_data\_[\_\_curr];}
\DoxyCodeLine{01958\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01959\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01960\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01961\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{01962\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01963\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;\ \_\_i\ <\ \_\_outer\_size;\ ++\_\_i)}
\DoxyCodeLine{01964\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01965\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_base\ =\ \_\_i\ *\ \_\_st;}
\DoxyCodeLine{01966\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_base]\ =\ \_\_data\_[\_\_base];}
\DoxyCodeLine{01967\ }
\DoxyCodeLine{01968\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ \_\_j\ =\ 1;\ \_\_j\ <\ \_\_inner\_size;\ \_\_j++)}
\DoxyCodeLine{01969\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01970\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_curr\ =\ \_\_base\ +\ \_\_j;}
\DoxyCodeLine{01971\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_curr]\ =\ \_\_ret[\_\_base\ +\ \_\_j\ -\/\ 1]\ *\ \_\_data\_[\_\_curr];}
\DoxyCodeLine{01972\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01973\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01974\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01975\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{01976\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{01977\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ \_\_outer\_size;\ ++\_\_i)}
\DoxyCodeLine{01978\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01979\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_base\ =\ \_\_i\ *\ \_\_st;}
\DoxyCodeLine{01980\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_base]\ =\ \_\_data\_[\_\_base];}
\DoxyCodeLine{01981\ }
\DoxyCodeLine{01982\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_j\ =\ 1;}
\DoxyCodeLine{01983\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_j\ <\ \_\_inner\_size;\ \_\_j++)}
\DoxyCodeLine{01984\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01985\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_curr\ =\ \_\_base\ +\ \_\_j;}
\DoxyCodeLine{01986\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_curr]\ =\ \_\_ret[\_\_base\ +\ \_\_j\ -\/\ 1]\ *\ \_\_data\_[\_\_curr];}
\DoxyCodeLine{01987\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01988\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01989\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01990\ }
\DoxyCodeLine{01991\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(\_\_ret,\ this-\/>\_\_shape\_);}
\DoxyCodeLine{01992\ \ \ \ \ \}}
\DoxyCodeLine{01993\ \}}
\DoxyCodeLine{01994\ }
\DoxyCodeLine{01995\ }
\DoxyCodeLine{01996\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{01997\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor_a76c0a553a8d693702352808474007f50}{tensor<\_Tp>::slice}}(index\_type\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_dim,}
\DoxyCodeLine{01998\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::optional<index\_type>\ \_\_start,}
\DoxyCodeLine{01999\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::optional<index\_type>\ \_\_end,}
\DoxyCodeLine{02000\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ index\_type\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_step)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02001\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_\_dim\ <\ 0ULL\ ||\ \_\_dim\ >=\ \textcolor{keyword}{static\_cast<}index\_type\textcolor{keyword}{>}(this-\/>\_\_shape\_.size()))}
\DoxyCodeLine{02002\ \ \ \ \ \{}
\DoxyCodeLine{02003\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::out\_of\_range(\textcolor{stringliteral}{"{}Dimension\ out\ of\ range."{}});}
\DoxyCodeLine{02004\ \ \ \ \ \}}
\DoxyCodeLine{02005\ }
\DoxyCodeLine{02006\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \_\_ret;}
\DoxyCodeLine{02007\ }
\DoxyCodeLine{02008\ \ \ \ \ index\_type\ \_\_s\ \ \ \ \ \ \ =\ this-\/>\_\_shape\_[\_\_dim];}
\DoxyCodeLine{02009\ \ \ \ \ index\_type\ \_\_start\_i\ =\ \_\_start.value\_or(0ULL);}
\DoxyCodeLine{02010\ \ \ \ \ index\_type\ \_\_end\_i\ \ \ =\ \_\_end.value\_or(\_\_s);}
\DoxyCodeLine{02011\ }
\DoxyCodeLine{02012\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_\_start\_i\ <\ 0ULL)}
\DoxyCodeLine{02013\ \ \ \ \ \{}
\DoxyCodeLine{02014\ \ \ \ \ \ \ \ \ \_\_start\_i\ +=\ \_\_s;}
\DoxyCodeLine{02015\ \ \ \ \ \}}
\DoxyCodeLine{02016\ }
\DoxyCodeLine{02017\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_\_end\_i\ <\ 0ULL)}
\DoxyCodeLine{02018\ \ \ \ \ \{}
\DoxyCodeLine{02019\ \ \ \ \ \ \ \ \ \_\_end\_i\ +=\ \_\_s;}
\DoxyCodeLine{02020\ \ \ \ \ \}}
\DoxyCodeLine{02021\ }
\DoxyCodeLine{02022\ \ \ \ \ \_\_start\_i\ =\ std::max(index\_type(0ULL),\ std::min(\_\_start\_i,\ \_\_s));}
\DoxyCodeLine{02023\ \ \ \ \ \_\_end\_i\ \ \ =\ std::max(index\_type(0ULL),\ std::min(\_\_end\_i,\ \_\_s));}
\DoxyCodeLine{02024\ }
\DoxyCodeLine{02025\ \ \ \ \ index\_type\ \_\_slice\_size\ =\ (\_\_end\_i\ -\/\ \_\_start\_i\ +\ \_\_step\ -\/\ 1)\ /\ \_\_step;}
\DoxyCodeLine{02026\ \ \ \ \ shape\_type\ \_\_ret\_dims\ \ \ =\ this-\/>\_\_shape\_;}
\DoxyCodeLine{02027\ \ \ \ \ \_\_ret\_dims[-\/\_\_dim]\ \ \ \ \ \ =\ \_\_slice\_size;}
\DoxyCodeLine{02028\ \ \ \ \ \_\_ret\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ \mbox{\hyperlink{classtensor}{tensor}}(\_\_ret\_dims);}
\DoxyCodeLine{02029\ }
\DoxyCodeLine{02030\ \textcolor{preprocessor}{\#if\ defined(\_\_CUDACC\_\_)}}
\DoxyCodeLine{02031\ \ \ \ \ \textcolor{keywordflow}{if}\ (this-\/>\_\_data\_.size()\ >=\ 1024)}
\DoxyCodeLine{02032\ \ \ \ \ \{}
\DoxyCodeLine{02033\ \ \ \ \ \ \ \ \ \_Tp*\ d\_input;}
\DoxyCodeLine{02034\ \ \ \ \ \ \ \ \ \_Tp*\ d\_output;}
\DoxyCodeLine{02035\ \ \ \ \ \ \ \ \ cudaMalloc(\&d\_input,\ this-\/>\_\_data\_.size()\ *\ \textcolor{keyword}{sizeof}(\_Tp));}
\DoxyCodeLine{02036\ \ \ \ \ \ \ \ \ cudaMalloc(\&d\_output,\ \_\_ret.\_\_data\_.size()\ *\ \textcolor{keyword}{sizeof}(\_Tp));}
\DoxyCodeLine{02037\ }
\DoxyCodeLine{02038\ \ \ \ \ \ \ \ \ cudaMemcpy(d\_input,\ this-\/>\_\_data\_.data(),\ this-\/>\_\_data\_.size()\ *\ \textcolor{keyword}{sizeof}(\_Tp),}
\DoxyCodeLine{02039\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cudaMemcpyHostToDevice);}
\DoxyCodeLine{02040\ }
\DoxyCodeLine{02041\ \ \ \ \ \ \ \ \ dim3\ block(256);}
\DoxyCodeLine{02042\ \ \ \ \ \ \ \ \ dim3\ grid(((\_\_slice\_size\ +\ block.x\ -\/\ 1)\ /\ block.x));}
\DoxyCodeLine{02043\ \ \ \ \ \ \ \ \ slice\_kernel<<<grid,\ block>>>(d\_input,\ d\_output,\ \_\_start\_i,\ \_\_end\_i,\ \_\_step,\ \_\_slice\_size);}
\DoxyCodeLine{02044\ }
\DoxyCodeLine{02045\ \ \ \ \ \ \ \ \ cudaMemcpy(\_\_ret.\_\_data\_.data(),\ d\_output,\ \_\_ret.\_\_data\_.size()\ *\ \textcolor{keyword}{sizeof}(\_Tp),}
\DoxyCodeLine{02046\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cudaMemcpyDeviceToHost);}
\DoxyCodeLine{02047\ }
\DoxyCodeLine{02048\ \ \ \ \ \ \ \ \ cudaFree(d\_input);}
\DoxyCodeLine{02049\ \ \ \ \ \ \ \ \ cudaFree(d\_output);}
\DoxyCodeLine{02050\ \ \ \ \ \}}
\DoxyCodeLine{02051\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{02052\ \ \ \ \ \{}
\DoxyCodeLine{02053\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02054\ }
\DoxyCodeLine{02055\ \textcolor{preprocessor}{\#if\ defined(\_\_ARM\_NEON)}}
\DoxyCodeLine{02056\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_same\_v<\_Tp,\ float>\ \&\&\ \_\_step\ ==\ 1)}
\DoxyCodeLine{02057\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02058\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \ vector\_size\ =\ 4;}
\DoxyCodeLine{02059\ \ \ \ \ \ \ \ \ \ \ \ \ index\_type\ vector\_end\ =\ \_\_start\_i\ +\ ((\_\_end\_i\ -\/\ \_\_start\_i)\ /\ vector\_size)\ *\ vector\_size;}
\DoxyCodeLine{02060\ }
\DoxyCodeLine{02061\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (index\_type\ i\ =\ \_\_start\_i,\ j\ =\ 0;\ i\ <\ vector\_end;}
\DoxyCodeLine{02062\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ i\ +=\ vector\_size,\ j\ +=\ vector\_size)}
\DoxyCodeLine{02063\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02064\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ float32x4\_t\ vec\ =\ vld1q\float32_t(\&(this-\/>\_\_data\_[i]));}
\DoxyCodeLine{02065\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ vst1q\float32_t(\&(\_\_ret.\_\_data\_[j]),\ vec);}
\DoxyCodeLine{02066\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02067\ }
\DoxyCodeLine{02068\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (index\_type\ i\ =\ vector\_end,\ j\ =\ vector\_end\ -\/\ \_\_start\_i;\ i\ <\ \_\_end\_i;\ ++i,\ ++j)}
\DoxyCodeLine{02069\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02070\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret.\_\_data\_[j]\ =\ this-\/>\_\_data\_[i];}
\DoxyCodeLine{02071\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02072\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02073\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{02074\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02075\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02076\ \ \ \ \ \ \ \ \ \ \ \ \ index\_type\ \_\_i\ =\ \_\_start\_i,\ \_\_j\ =\ 0ULL;}
\DoxyCodeLine{02077\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ \_\_end\_i;\ \_\_i\ +=\ \_\_step,\ \_\_j++)}
\DoxyCodeLine{02078\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02079\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret(\{\_\_j\})\ =\ this-\/>at(\{\_\_i\});}
\DoxyCodeLine{02080\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02081\ \textcolor{preprocessor}{\#if\ defined(\_\_ARM\_NEON)}}
\DoxyCodeLine{02082\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02083\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02084\ }
\DoxyCodeLine{02085\ \textcolor{preprocessor}{\#if\ defined(\_\_CUDACC\_\_)}}
\DoxyCodeLine{02086\ \ \ \ \ \}}
\DoxyCodeLine{02087\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02088\ }
\DoxyCodeLine{02089\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_ret;}
\DoxyCodeLine{02090\ \}}
\DoxyCodeLine{02091\ }
\DoxyCodeLine{02092\ }
\DoxyCodeLine{02093\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{02094\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor_a20da53aa9024aff12cc0d640c42069a1}{tensor<\_Tp>::fmod}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\&\ \_\_other)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02095\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(*this).\mbox{\hyperlink{classtensor_a0aa2f12fca6336546f5a692cd5fe03a1}{fmod\_}}(\_\_other);}
\DoxyCodeLine{02096\ \}}
\DoxyCodeLine{02097\ }
\DoxyCodeLine{02098\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{02099\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor_a20da53aa9024aff12cc0d640c42069a1}{tensor<\_Tp>::fmod}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor_a12614e7ef399b40d0eca22d10360149f}{value\_type}}\ \_\_val)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02100\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classtensor}{\_\_self}}(*this).\mbox{\hyperlink{classtensor_a0aa2f12fca6336546f5a692cd5fe03a1}{fmod\_}}(\_\_val);}
\DoxyCodeLine{02101\ \}}
\DoxyCodeLine{02102\ }
\DoxyCodeLine{02103\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{02104\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_a0aa2f12fca6336546f5a692cd5fe03a1}{tensor<\_Tp>::fmod\_}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor_a12614e7ef399b40d0eca22d10360149f}{value\_type}}\ \_\_val)\ \{}
\DoxyCodeLine{02105\ \ \ \ \ this-\/>\_\_check\_is\_scalar\_type(\textcolor{stringliteral}{"{}Cannot\ divide\ a\ non\ scalar\ type"{}});}
\DoxyCodeLine{02106\ \textcolor{preprocessor}{\#if\ defined(\_\_ARM\_NEON)}}
\DoxyCodeLine{02107\ \ \ \ \ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{size\_t}\ simd\_size\ =\ 4;}
\DoxyCodeLine{02108\ \ \ \ \ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{size\_t}\ simd\_end\ \ =\ this-\/>\_\_data\_.size()\ -\/\ (this-\/>\_\_data\_.size()\ -\/\ simd\_size);}
\DoxyCodeLine{02109\ }
\DoxyCodeLine{02110\ \ \ \ \ float32x4\_t\ \_\_b\ =\ vdupq\_n\float32_t(\textcolor{keyword}{static\_cast<}float32\_t\textcolor{keyword}{>}(\_\_val));}
\DoxyCodeLine{02111\ }
\DoxyCodeLine{02112\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{02113\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ simd\_end;\ \_\_i\ +=\ simd\_size)}
\DoxyCodeLine{02114\ \ \ \ \ \{}
\DoxyCodeLine{02115\ \ \ \ \ \ \ \ \ float32x4\_t\ \_\_a\ \ \ \ \ \ \ \ \ =\ vld1q\float32_t(\&this-\/>\_\_data\_[\_\_i]);}
\DoxyCodeLine{02116\ \ \ \ \ \ \ \ \ float32x4\_t\ \_\_div\ \ \ \ \ \ \ =\ vdivq\float32_t(\_\_a,\ \_\_b);}
\DoxyCodeLine{02117\ \ \ \ \ \ \ \ \ float32x4\_t\ \_\_floor\_div\ =\ vrndq\float32_t(\_\_div);}
\DoxyCodeLine{02118\ \ \ \ \ \ \ \ \ float32x4\_t\ \_\_mult\ \ \ \ \ \ =\ vmulq\float32_t(\_\_floor\_div,\ \_\_b);}
\DoxyCodeLine{02119\ \ \ \ \ \ \ \ \ float32x4\_t\ \_\_mod\ \ \ \ \ \ \ =\ vsubq\float32_t(\_\_a,\ \_\_mult);}
\DoxyCodeLine{02120\ }
\DoxyCodeLine{02121\ \ \ \ \ \ \ \ \ vst1q\float32_t(\&this-\/>\_\_data\_[\_\_i],\ \_\_mod);}
\DoxyCodeLine{02122\ \ \ \ \ \}}
\DoxyCodeLine{02123\ }
\DoxyCodeLine{02124\ }
\DoxyCodeLine{02125\ \ \ \ \ \_\_i\ =\ simd\_end;}
\DoxyCodeLine{02126\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{02127\ \ \ \ \ \{}
\DoxyCodeLine{02128\ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i]\ =\ std::fmod(this-\/>\_\_data\_[\_\_i],\ \_\_val);}
\DoxyCodeLine{02129\ \ \ \ \ \}}
\DoxyCodeLine{02130\ }
\DoxyCodeLine{02131\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{02132\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{02133\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{02134\ \ \ \ \ \{}
\DoxyCodeLine{02135\ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i]\ =\ \textcolor{keyword}{static\_cast<}\mbox{\hyperlink{classtensor_a12614e7ef399b40d0eca22d10360149f}{value\_type}}\textcolor{keyword}{>}(}
\DoxyCodeLine{02136\ \ \ \ \ \ \ \ \ \ \ \ \ std::fmod(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(this-\/>\_\_data\_[\_\_i]),\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(\_\_val)));}
\DoxyCodeLine{02137\ \ \ \ \ \}}
\DoxyCodeLine{02138\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02139\ \}}
\DoxyCodeLine{02140\ }
\DoxyCodeLine{02141\ }
\DoxyCodeLine{02142\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{02143\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_a0aa2f12fca6336546f5a692cd5fe03a1}{tensor<\_Tp>::fmod\_}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\&\ \_\_other)\ \{}
\DoxyCodeLine{02144\ \ \ \ \ this-\/>\_\_check\_is\_scalar\_type(\textcolor{stringliteral}{"{}Cannot\ divide\ non\ scalar\ values"{}});}
\DoxyCodeLine{02145\ \ \ \ \ \textcolor{keywordflow}{if}\ (this-\/>\_\_shape\_\ !=\ \_\_other.\mbox{\hyperlink{classtensor_a33e40f89c3247e27e6bd03a992d73868}{shape}}()\ ||\ this-\/>\_\_data\_.size()\ !=\ \_\_other.\mbox{\hyperlink{classtensor_a119a24ebef8a13cd8fd262a1c00b48b7}{size}}(0))}
\DoxyCodeLine{02146\ \ \ \ \ \{}
\DoxyCodeLine{02147\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::invalid\_argument(\textcolor{stringliteral}{"{}Cannot\ divide\ two\ tensors\ of\ different\ shapes\ :\ fmax"{}});}
\DoxyCodeLine{02148\ \ \ \ \ \}}
\DoxyCodeLine{02149\ \textcolor{preprocessor}{\#if\ defined(\_\_ARM\_NEON)}}
\DoxyCodeLine{02150\ \ \ \ \ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{size\_t}\ simd\_size\ =\ 4;}
\DoxyCodeLine{02151\ \ \ \ \ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{size\_t}\ simd\_end\ \ =\ this-\/>\_\_data\_.size()\ -\/\ (this-\/>\_\_data\_.size()\ \%\ simd\_size);}
\DoxyCodeLine{02152\ }
\DoxyCodeLine{02153\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{02154\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ simd\_end;\ \_\_i\ +=\ simd\_size)}
\DoxyCodeLine{02155\ \ \ \ \ \{}
\DoxyCodeLine{02156\ \ \ \ \ \ \ \ \ float32x4\_t\ \_\_a\ \ \ \ \ \ \ \ \ =\ vld1q\float32_t(\&this-\/>\_\_data\_[\_\_i]);}
\DoxyCodeLine{02157\ \ \ \ \ \ \ \ \ float32x4\_t\ \_\_b\ \ \ \ \ \ \ \ \ =\ vld1q\float32_t(\&\_\_other[\_\_i]);}
\DoxyCodeLine{02158\ \ \ \ \ \ \ \ \ float32x4\_t\ \_\_div\ \ \ \ \ \ \ =\ vdivq\float32_t(\_\_a,\ \_\_b);}
\DoxyCodeLine{02159\ \ \ \ \ \ \ \ \ float32x4\_t\ \_\_floor\_div\ =\ vrndq\float32_t(\_\_div);}
\DoxyCodeLine{02160\ \ \ \ \ \ \ \ \ float32x4\_t\ \_\_mult\ \ \ \ \ \ =\ vmulq\float32_t(\_\_floor\_div,\ \_\_b);}
\DoxyCodeLine{02161\ \ \ \ \ \ \ \ \ float32x4\_t\ \_\_mod\ \ \ \ \ \ \ =\ vsubq\float32_t(\_\_a,\ \_\_mult);}
\DoxyCodeLine{02162\ }
\DoxyCodeLine{02163\ \ \ \ \ \ \ \ \ vst1q\float32_t(\&this-\/>\_\_data\_[\_\_i],\ \_\_mod);}
\DoxyCodeLine{02164\ \ \ \ \ \}}
\DoxyCodeLine{02165\ \ \ \ \ \_\_i\ =\ simd\_end;}
\DoxyCodeLine{02166\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{02167\ \ \ \ \ \{}
\DoxyCodeLine{02168\ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i]\ =\ std::fmod(this-\/>\_\_data\_[\_\_i],\ \_\_other[\_\_i]);}
\DoxyCodeLine{02169\ \ \ \ \ \}}
\DoxyCodeLine{02170\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{02171\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{02172\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{02173\ \ \ \ \ \{}
\DoxyCodeLine{02174\ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i]\ =\ \textcolor{keyword}{static\_cast<}value\_type\textcolor{keyword}{>}(}
\DoxyCodeLine{02175\ \ \ \ \ \ \ \ \ \ \ \ \ std::fmod(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(this-\/>\_\_data\_[\_\_i]),\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(\_\_other[\_\_i])));}
\DoxyCodeLine{02176\ \ \ \ \ \}}
\DoxyCodeLine{02177\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02178\ \}}
\DoxyCodeLine{02179\ }
\DoxyCodeLine{02180\ }
\DoxyCodeLine{02181\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{02182\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor_a58d80942a05a2ccd93a1ae69b0c3812e}{tensor<\_Tp>::fmax}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02183\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(*this).\mbox{\hyperlink{classtensor_a50fcf3eb344fc6566d95db639681cada}{fmax\_}}(\_\_other);}
\DoxyCodeLine{02184\ \}}
\DoxyCodeLine{02185\ }
\DoxyCodeLine{02186\ }
\DoxyCodeLine{02187\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{02188\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor_a58d80942a05a2ccd93a1ae69b0c3812e}{tensor<\_Tp>::fmax}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor_a12614e7ef399b40d0eca22d10360149f}{value\_type}}\ \_\_val)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02189\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classtensor}{\_\_self}}(*this).\mbox{\hyperlink{classtensor_a50fcf3eb344fc6566d95db639681cada}{fmax\_}}(\_\_val);}
\DoxyCodeLine{02190\ \}}
\DoxyCodeLine{02191\ }
\DoxyCodeLine{02192\ }
\DoxyCodeLine{02193\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{02194\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_a50fcf3eb344fc6566d95db639681cada}{tensor<\_Tp>::fmax\_}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor_a12614e7ef399b40d0eca22d10360149f}{value\_type}}\ \_\_val)\ \{}
\DoxyCodeLine{02195\ \textcolor{preprocessor}{\#if\ defined(\_\_ARM\_NEON)}}
\DoxyCodeLine{02196\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ simd\_size\ =\ 4;}
\DoxyCodeLine{02197\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ simd\_end\ \ =\ this-\/>\_\_data\_.size()\ -\/\ (this-\/>\_\_data\_.size()\ \%\ simd\_size);}
\DoxyCodeLine{02198\ }
\DoxyCodeLine{02199\ \ \ \ \ float32x4\_t\ scalar\_val\ =\ vdupq\_n\float32_t(\_\_val);}
\DoxyCodeLine{02200\ }
\DoxyCodeLine{02201\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;\ \_\_i\ <\ simd\_end;\ \_\_i\ +=\ simd\_size)}
\DoxyCodeLine{02202\ \ \ \ \ \{}
\DoxyCodeLine{02203\ \ \ \ \ \ \ \ \ float32x4\_t\ \_\_a\ \ \ \ \ \ \ =\ vld1q\float32_t(\&this-\/>\_\_data\_[\_\_i]);}
\DoxyCodeLine{02204\ \ \ \ \ \ \ \ \ float32x4\_t\ \_\_max\_val\ =\ vmaxq\float32_t(\_\_a,\ scalar\_val);}
\DoxyCodeLine{02205\ \ \ \ \ \ \ \ \ vst1q\float32_t(\&this-\/>\_\_data\_[\_\_i],\ \_\_max\_val);}
\DoxyCodeLine{02206\ \ \ \ \ \}}
\DoxyCodeLine{02207\ }
\DoxyCodeLine{02208\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ \_\_i\ =\ simd\_end;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{02209\ \ \ \ \ \{}
\DoxyCodeLine{02210\ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i]\ =\ std::fmax(this-\/>\_\_data\_[\_\_i],\ \_\_val);}
\DoxyCodeLine{02211\ \ \ \ \ \}}
\DoxyCodeLine{02212\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{02213\ \ \ \ \ std::transform(this-\/>\_\_data\_.begin(),\ this-\/>\_\_data\_.end(),\ this-\/>\_\_data\_.begin(),}
\DoxyCodeLine{02214\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [\&\_\_val](\mbox{\hyperlink{classtensor_aacd8d62096cc0d502cffd169e25f92f0}{const\_reference}}\ \_\_v)\ \{\ return\ std::fmax(\_\_v,\ \_\_val);\ \});}
\DoxyCodeLine{02215\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02216\ \}}
\DoxyCodeLine{02217\ }
\DoxyCodeLine{02218\ }
\DoxyCodeLine{02219\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{02220\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_a50fcf3eb344fc6566d95db639681cada}{tensor<\_Tp>::fmax\_}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor<value\_type>}}\&\ \_\_other)\ \{}
\DoxyCodeLine{02221\ \ \ \ \ assert(this-\/>\_\_shape\_\ ==\ \_\_other.\mbox{\hyperlink{classtensor_a33e40f89c3247e27e6bd03a992d73868}{shape}}()\ \&\&\ this-\/>\_\_data\_.size()\ ==\ \_\_other.\mbox{\hyperlink{classtensor_a119a24ebef8a13cd8fd262a1c00b48b7}{size}}(0));}
\DoxyCodeLine{02222\ \textcolor{preprocessor}{\#if\ defined(\_\_ARM\_NEON)}}
\DoxyCodeLine{02223\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ simd\_size\ =\ 4;}
\DoxyCodeLine{02224\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ simd\_end\ \ =\ this-\/>\_\_data\_.size()\ -\/\ (this-\/>\_\_data\_.size()\ \%\ simd\_size);}
\DoxyCodeLine{02225\ }
\DoxyCodeLine{02226\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;\ \_\_i\ <\ simd\_end;\ \_\_i\ +=\ simd\_size)}
\DoxyCodeLine{02227\ \ \ \ \ \{}
\DoxyCodeLine{02228\ \ \ \ \ \ \ \ \ float32x4\_t\ \_\_a\ \ \ \ \ \ \ =\ vld1q\float32_t(\&this-\/>\_\_data\_[\_\_i]);}
\DoxyCodeLine{02229\ \ \ \ \ \ \ \ \ float32x4\_t\ \_\_b\ \ \ \ \ \ \ =\ vld1q\float32_t(\&(\_\_other[\_\_i]));}
\DoxyCodeLine{02230\ \ \ \ \ \ \ \ \ float32x4\_t\ \_\_max\_val\ =\ vmaxq\float32_t(\_\_a,\ \_\_b);}
\DoxyCodeLine{02231\ \ \ \ \ \ \ \ \ vst1q\float32_t(\&this-\/>\_\_data\_[\_\_i],\ \_\_max\_val);}
\DoxyCodeLine{02232\ \ \ \ \ \}}
\DoxyCodeLine{02233\ }
\DoxyCodeLine{02234\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ \_\_i\ =\ simd\_end;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{02235\ \ \ \ \ \{}
\DoxyCodeLine{02236\ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i]\ =\ std::fmax(this-\/>\_\_data\_[\_\_i],\ \_\_other[\_\_i]);}
\DoxyCodeLine{02237\ \ \ \ \ \}}
\DoxyCodeLine{02238\ }
\DoxyCodeLine{02239\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{02240\ \ \ \ \ std::transform(this-\/>\_\_data.begin(),\ this-\/>\_\_data\_.end(),\ \_\_other.\mbox{\hyperlink{classtensor_a52d5b20bef2ffe824342736d731f1002}{begin}}(),\ this-\/>\_\_data.begin(),}
\DoxyCodeLine{02241\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [](\mbox{\hyperlink{classtensor_aacd8d62096cc0d502cffd169e25f92f0}{const\_reference}}\ \_\_v,\ \mbox{\hyperlink{classtensor_aacd8d62096cc0d502cffd169e25f92f0}{const\_reference}}\ \_\_w)\ \{\ return\ std::fmax(\_\_v,\ \_\_w);\ \});}
\DoxyCodeLine{02242\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02243\ \}}
\DoxyCodeLine{02244\ }
\DoxyCodeLine{02245\ }
\DoxyCodeLine{02246\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{02247\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classtensor_a45218616edeefdc8558691ad83ebe1bc}{tensor<\_Tp>::count\_nonzero}}(index\_type\ \_\_dim)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02248\ \ \ \ \ this-\/>\_\_check\_is\_scalar\_type(\textcolor{stringliteral}{"{}Cannot\ compare\ a\ non-\/scalar\ value\ to\ zero"{}});}
\DoxyCodeLine{02249\ }
\DoxyCodeLine{02250\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_c\ =\ 0;}
\DoxyCodeLine{02251\ }
\DoxyCodeLine{02252\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_\_dim\ ==\ -\/1)}
\DoxyCodeLine{02253\ \ \ \ \ \{}
\DoxyCodeLine{02254\ \textcolor{preprocessor}{\#pragma\ omp\ parallel}}
\DoxyCodeLine{02255\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02256\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ local\_count\ =\ 0;}
\DoxyCodeLine{02257\ }
\DoxyCodeLine{02258\ \textcolor{preprocessor}{\#ifdef\ \_\_AVX\_\_}}
\DoxyCodeLine{02259\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_same\_v<value\_type,\ float>)}
\DoxyCodeLine{02260\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02261\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ size\ =\ this-\/>\_\_data\_.size();}
\DoxyCodeLine{02262\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ i\ \ \ \ =\ 0;}
\DoxyCodeLine{02263\ }
\DoxyCodeLine{02264\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ i\ +\ 8\ <=\ size;\ i\ +=\ 8)}
\DoxyCodeLine{02265\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02266\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_m256\ vec\ \ \ \ \ \ \ \ \ \ =\ \_mm256\_loadu\_ps(\&this-\/>\_\_data\_[i]);}
\DoxyCodeLine{02267\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_m256\ nonzero\_mask\ =\ \_mm256\_cmp\_ps(vec,\ \_mm256\_setzero\_ps(),\ \_CMP\_NEQ\_OQ);}
\DoxyCodeLine{02268\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ local\_count\ +=\ \_mm256\_movemask\_ps(nonzero\_mask);}
\DoxyCodeLine{02269\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02270\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02271\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02272\ \textcolor{preprocessor}{\#ifdef\ \_\_ARM\_NEON}}
\DoxyCodeLine{02273\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_same\_v<value\_type,\ float>)}
\DoxyCodeLine{02274\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02275\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ size\ =\ this-\/>\_\_data\_.size();}
\DoxyCodeLine{02276\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ i\ \ \ \ =\ 0;}
\DoxyCodeLine{02277\ }
\DoxyCodeLine{02278\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ i\ +\ 4\ <=\ size;\ i\ +=\ 4)}
\DoxyCodeLine{02279\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02280\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ float32x4\_t\ vec\ \ \ \ \ \ \ \ \ \ =\ vld1q\float32_t(\&this-\/>\_\_data\_[i]);}
\DoxyCodeLine{02281\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ uint32x4\_t\ \ nonzero\_mask\ =\ vcgtq\float32_t(vec,\ vdupq\_n\float32_t(0.0f));}
\DoxyCodeLine{02282\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ local\_count\ +=\ vaddvq\_u32(nonzero\_mask);}
\DoxyCodeLine{02283\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02284\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02285\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02286\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ j\ =\ i;\ j\ <\ this-\/>\_\_data\_.size();\ j++)}
\DoxyCodeLine{02287\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02288\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (this-\/>\_\_data\_[j]\ !=\ 0)}
\DoxyCodeLine{02289\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02290\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ local\_count++;}
\DoxyCodeLine{02291\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02292\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02293\ }
\DoxyCodeLine{02294\ \textcolor{preprocessor}{\#pragma\ omp\ atomic}}
\DoxyCodeLine{02295\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_c\ +=\ local\_count;}
\DoxyCodeLine{02296\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02297\ \ \ \ \ \}}
\DoxyCodeLine{02298\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{02299\ \ \ \ \ \{}
\DoxyCodeLine{02300\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_\_dim\ <\ 0\ ||\ \_\_dim\ >=\ \textcolor{keyword}{static\_cast<}index\_type\textcolor{keyword}{>}(\_\_shape\_.size()))}
\DoxyCodeLine{02301\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02302\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::invalid\_argument(\textcolor{stringliteral}{"{}Invalid\ dimension\ provided."{}});}
\DoxyCodeLine{02303\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02304\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(\textcolor{stringliteral}{"{}Dimension-\/specific\ non-\/zero\ counting\ is\ not\ implemented\ yet."{}});}
\DoxyCodeLine{02305\ \ \ \ \ \}}
\DoxyCodeLine{02306\ }
\DoxyCodeLine{02307\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_c;}
\DoxyCodeLine{02308\ \}}
\DoxyCodeLine{02309\ }
\DoxyCodeLine{02310\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{02311\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor_a4b6d934fc3b4ff83203af2a01329bc08}{tensor<\_Tp>::matmul}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02312\ \ \ \ \ \textcolor{keywordflow}{if}\ (this-\/>\_\_shape\_.size()\ !=\ 2\ ||\ \_\_other.\mbox{\hyperlink{classtensor_a33e40f89c3247e27e6bd03a992d73868}{shape}}().size()\ !=\ 2)}
\DoxyCodeLine{02313\ \ \ \ \ \{}
\DoxyCodeLine{02314\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::invalid\_argument(\textcolor{stringliteral}{"{}matmul\ is\ only\ supported\ for\ 2D\ tensors"{}});}
\DoxyCodeLine{02315\ \ \ \ \ \}}
\DoxyCodeLine{02316\ }
\DoxyCodeLine{02317\ \ \ \ \ \textcolor{keywordflow}{if}\ (this-\/>\_\_shape\_[1]\ !=\ \_\_other.\mbox{\hyperlink{classtensor_a33e40f89c3247e27e6bd03a992d73868}{shape}}()[0])}
\DoxyCodeLine{02318\ \ \ \ \ \{}
\DoxyCodeLine{02319\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::invalid\_argument(\textcolor{stringliteral}{"{}Shape\ mismatch\ for\ matrix\ multiplication"{}});}
\DoxyCodeLine{02320\ \ \ \ \ \}}
\DoxyCodeLine{02321\ }
\DoxyCodeLine{02322\ \ \ \ \ shape\_type\ \_\_ret\_sh\ =\ \{this-\/>\_\_shape\_[0],\ \_\_other.\mbox{\hyperlink{classtensor_a33e40f89c3247e27e6bd03a992d73868}{shape}}()[1]\};}
\DoxyCodeLine{02323\ \ \ \ \ data\_t\ \ \ \ \ \_\_ret\_d(\_\_ret\_sh[0]\ *\ \_\_ret\_sh[1],\ 0);}
\DoxyCodeLine{02324\ }
\DoxyCodeLine{02325\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ blockSize\ =\ 64;}
\DoxyCodeLine{02326\ }
\DoxyCodeLine{02327\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \_\_ret\_sh[0];\ i\ +=\ blockSize)}
\DoxyCodeLine{02328\ \ \ \ \ \{}
\DoxyCodeLine{02329\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \_\_ret\_sh[1];\ j\ +=\ blockSize)}
\DoxyCodeLine{02330\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02331\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ 0;\ k\ <\ this-\/>\_\_shape\_[1];\ k\ +=\ blockSize)}
\DoxyCodeLine{02332\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02333\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ ii\ =\ i;\ ii\ <\ std::min(static\_cast<index\_type>(i\ +\ blockSize),\ \_\_ret\_sh[0]);}
\DoxyCodeLine{02334\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ii++)}
\DoxyCodeLine{02335\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02336\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ jj\ =\ j;}
\DoxyCodeLine{02337\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ jj\ <\ std::min(static\_cast<index\_type>(j\ +\ blockSize),\ \_\_ret\_sh[1]);\ jj++)}
\DoxyCodeLine{02338\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02339\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ value\_type\ \_\_sum\ =\ 0;}
\DoxyCodeLine{02340\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ kk\ =\ k;\ kk\ <\ std::min(static\_cast<index\_type>(k\ +\ blockSize),}
\DoxyCodeLine{02341\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>\_\_shape\_[1]);}
\DoxyCodeLine{02342\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ kk++)}
\DoxyCodeLine{02343\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02344\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_sum\ +=\ this-\/>at(\{ii,\ kk\})\ *\ \_\_other.\mbox{\hyperlink{classtensor_ae08663d7fd46cc622f032ae7cac90c5a}{at}}(\{kk,\ jj\});}
\DoxyCodeLine{02345\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02346\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret\_d[ii\ *\ \_\_ret\_sh[1]\ +\ jj]\ +=\ \_\_sum;}
\DoxyCodeLine{02347\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02348\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02349\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02350\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02351\ \ \ \ \ \}}
\DoxyCodeLine{02352\ }
\DoxyCodeLine{02353\ \textcolor{preprocessor}{\#ifdef\ \_\_ARM\_NEON}}
\DoxyCodeLine{02354\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ neonBlockSize\ =\ 4;}
\DoxyCodeLine{02355\ }
\DoxyCodeLine{02356\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \_\_ret\_sh[0];\ i\ +=\ neonBlockSize)}
\DoxyCodeLine{02357\ \ \ \ \ \{}
\DoxyCodeLine{02358\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \_\_ret\_sh[1];\ j\ +=\ neonBlockSize)}
\DoxyCodeLine{02359\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02360\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ 0;\ k\ <\ this-\/>\_\_shape\_[1];\ k\ +=\ neonBlockSize)}
\DoxyCodeLine{02361\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02362\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ ii\ =\ i;}
\DoxyCodeLine{02363\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ii\ <\ std::min(static\_cast<index\_type>(i\ +\ neonBlockSize),\ \_\_ret\_sh[0]);\ ii++)}
\DoxyCodeLine{02364\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02365\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ jj\ =\ j;}
\DoxyCodeLine{02366\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ jj\ <\ std::min(static\_cast<index\_type>(j\ +\ neonBlockSize),\ \_\_ret\_sh[1]);}
\DoxyCodeLine{02367\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ jj++)}
\DoxyCodeLine{02368\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02369\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ float32x4\_t\ sum\_vec\ =\ vdupq\_n\float32_t(0);}
\DoxyCodeLine{02370\ }
\DoxyCodeLine{02371\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ kk\ =\ k;\ kk\ <\ std::min(static\_cast<index\_type>(k\ +\ neonBlockSize),}
\DoxyCodeLine{02372\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>\_\_shape\_[1]);}
\DoxyCodeLine{02373\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ kk\ +=\ 4)}
\DoxyCodeLine{02374\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02375\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ float32x4\_t\ a\_vec\ =}
\DoxyCodeLine{02376\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ vld1q\float32_t(\&this-\/>\_\_data\_[ii\ *\ this-\/>\_\_shape\_[1]\ +\ kk]);}
\DoxyCodeLine{02377\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ float32x4\_t\ b\_vec\ =}
\DoxyCodeLine{02378\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ vld1q\float32_t(\&\_\_other.\_\_data\_[kk\ *\ \_\_other.\mbox{\hyperlink{classtensor_a33e40f89c3247e27e6bd03a992d73868}{shape}}()[1]\ +\ jj]);}
\DoxyCodeLine{02379\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sum\_vec\ =\ vmlaq\float32_t(sum\_vec,\ a\_vec,\ b\_vec);}
\DoxyCodeLine{02380\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02381\ }
\DoxyCodeLine{02382\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ float32x2\_t\ sum\_low\ \ =\ vget\_low\float32_t(sum\_vec);}
\DoxyCodeLine{02383\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ float32x2\_t\ sum\_high\ =\ vget\_high\float32_t(sum\_vec);}
\DoxyCodeLine{02384\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sum\_low\ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ vadd\float32_t(sum\_low,\ sum\_high);}
\DoxyCodeLine{02385\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ float32x2\_t\ sum\_dup\ \ =\ vpadd\float32_t(sum\_low,\ sum\_low);}
\DoxyCodeLine{02386\ }
\DoxyCodeLine{02387\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret\_d[ii\ *\ \_\_ret\_sh[1]\ +\ jj]\ +=\ vget\_lane\float32_t(sum\_dup,\ 0);}
\DoxyCodeLine{02388\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02389\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02390\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02391\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02392\ \ \ \ \ \}}
\DoxyCodeLine{02393\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02394\ }
\DoxyCodeLine{02395\ \textcolor{preprocessor}{\#ifdef\ \_\_CUDACC\_\_}}
\DoxyCodeLine{02396\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ threadsPerBlock\ =\ 256;}
\DoxyCodeLine{02397\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ blocksPerGrid\ \ \ =\ (\_\_ret\_sh[0]\ *\ \_\_ret\_sh[1]\ +\ threadsPerBlock\ -\/\ 1)\ /\ threadsPerBlock;}
\DoxyCodeLine{02398\ }
\DoxyCodeLine{02399\ \ \ \ \ \_Tp\ *d\_a,\ *d\_b,\ *d\_c;}
\DoxyCodeLine{02400\ \ \ \ \ cudaMalloc(\&d\_a,\ this-\/>\_\_data\_.size()\ *\ \textcolor{keyword}{sizeof}(\_Tp));}
\DoxyCodeLine{02401\ \ \ \ \ cudaMalloc(\&d\_b,\ \_\_other.\_\_data\_.size()\ *\ \textcolor{keyword}{sizeof}(\_Tp));}
\DoxyCodeLine{02402\ \ \ \ \ cudaMalloc(\&d\_c,\ \_\_ret\_d.size()\ *\ \textcolor{keyword}{sizeof}(\_Tp));}
\DoxyCodeLine{02403\ }
\DoxyCodeLine{02404\ \ \ \ \ cudaMemcpy(d\_a,\ this-\/>\_\_data\_.data(),\ this-\/>\_\_data\_.size()\ *\ \textcolor{keyword}{sizeof}(\_Tp),}
\DoxyCodeLine{02405\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cudaMemcpyHostToDevice);}
\DoxyCodeLine{02406\ \ \ \ \ cudaMemcpy(d\_b,\ \_\_other.\_\_data\_.data(),\ \_\_other.\_\_data\_.size()\ *\ \textcolor{keyword}{sizeof}(\_Tp),}
\DoxyCodeLine{02407\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cudaMemcpyHostToDevice);}
\DoxyCodeLine{02408\ }
\DoxyCodeLine{02409\ \ \ \ \ matmul\_kernel<<<blocksPerGrid,\ threadsPerBlock>>>(d\_a,\ d\_b,\ d\_c,\ this-\/>\_\_shape\_[0],}
\DoxyCodeLine{02410\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>\_\_shape\_[1],\ \_\_other.\mbox{\hyperlink{classtensor_a33e40f89c3247e27e6bd03a992d73868}{shape}}()[1]);}
\DoxyCodeLine{02411\ }
\DoxyCodeLine{02412\ \ \ \ \ cudaMemcpy(\_\_ret\_d.data(),\ d\_c,\ \_\_ret\_d.size()\ *\ \textcolor{keyword}{sizeof}(\_Tp),\ cudaMemcpyDeviceToHost);}
\DoxyCodeLine{02413\ }
\DoxyCodeLine{02414\ \ \ \ \ cudaFree(d\_a);}
\DoxyCodeLine{02415\ \ \ \ \ cudaFree(d\_b);}
\DoxyCodeLine{02416\ \ \ \ \ cudaFree(d\_c);}
\DoxyCodeLine{02417\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02418\ }
\DoxyCodeLine{02419\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(\_\_ret\_d,\ \_\_ret\_sh);}
\DoxyCodeLine{02420\ \}}
\DoxyCodeLine{02421\ }
\DoxyCodeLine{02422\ }
\DoxyCodeLine{02423\ \textcolor{preprocessor}{\#ifdef\ \_\_CUDACC\_\_}}
\DoxyCodeLine{02424\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{02425\ \_\_global\_\_\ \textcolor{keywordtype}{void}\ matmul\_kernel(\_Tp*\ a,\ \_Tp*\ b,\ \_Tp*\ c,\ \textcolor{keywordtype}{int}\ m,\ \textcolor{keywordtype}{int}\ n,\ \textcolor{keywordtype}{int}\ k)\ \{}
\DoxyCodeLine{02426\ \ \ \ \ \textcolor{keywordtype}{int}\ row\ =\ blockIdx.y\ *\ blockDim.y\ +\ threadIdx.y;}
\DoxyCodeLine{02427\ \ \ \ \ \textcolor{keywordtype}{int}\ col\ =\ blockIdx.x\ *\ blockDim.x\ +\ threadIdx.x;}
\DoxyCodeLine{02428\ }
\DoxyCodeLine{02429\ \ \ \ \ \textcolor{keywordflow}{if}\ (row\ <\ m\ \&\&\ col\ <\ k)}
\DoxyCodeLine{02430\ \ \ \ \ \{}
\DoxyCodeLine{02431\ \ \ \ \ \ \ \ \ \_Tp\ sum\ =\ 0;}
\DoxyCodeLine{02432\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ n;\ i++)}
\DoxyCodeLine{02433\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02434\ \ \ \ \ \ \ \ \ \ \ \ \ sum\ +=\ a[row\ *\ n\ +\ i]\ *\ b[i\ *\ k\ +\ col];}
\DoxyCodeLine{02435\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02436\ }
\DoxyCodeLine{02437\ \ \ \ \ \ \ \ \ c[row\ *\ k\ +\ col]\ =\ sum;}
\DoxyCodeLine{02438\ \ \ \ \ \}}
\DoxyCodeLine{02439\ \}}
\DoxyCodeLine{02440\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02441\ }
\DoxyCodeLine{02442\ }
\DoxyCodeLine{02443\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{02444\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor_af80b79db3a2ac60e6cae9a419040a612}{tensor<\_Tp>::reshape}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor_ab96aa71f8b92cb531a7e258f47315f45}{shape\_type}}\ \_\_sh)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02445\ \ \ \ \ \mbox{\hyperlink{classtensor_a1248d808ef5c7b0f868bfa7c0cc25f59}{data\_t}}\ \_\_d\ =\ this-\/>\_\_data\_;}
\DoxyCodeLine{02446\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_s\ =\ this-\/>\_\_computeSize(\_\_sh);}
\DoxyCodeLine{02447\ }
\DoxyCodeLine{02448\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_\_s\ !=\ this-\/>\_\_data\_.size())}
\DoxyCodeLine{02449\ \ \ \ \ \{}
\DoxyCodeLine{02450\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::invalid\_argument(}
\DoxyCodeLine{02451\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}input\ shape\ must\ have\ size\ of\ elements\ equal\ to\ the\ current\ number\ of\ elements\ in\ the\ tensor\ data"{}});}
\DoxyCodeLine{02452\ \ \ \ \ \}}
\DoxyCodeLine{02453\ }
\DoxyCodeLine{02454\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classtensor}{\_\_self}}(\_\_d,\ \_\_sh);}
\DoxyCodeLine{02455\ \}}
\DoxyCodeLine{02456\ }
\DoxyCodeLine{02457\ }
\DoxyCodeLine{02458\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{02459\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor_a8ec46219b01d394ec7fb5f1e4af168c2}{tensor<\_Tp>::cross\_product}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02460\ \ \ \ \ this-\/>\_\_check\_is\_arithmetic\_type(\textcolor{stringliteral}{"{}Cannot\ perform\ a\ cross\ product\ on\ non-\/scalar\ data\ types"{}});}
\DoxyCodeLine{02461\ \ \ \ \ \textcolor{keywordflow}{if}\ (this-\/>empty()\ ||\ \_\_other.\mbox{\hyperlink{classtensor_ab1dc32444636d6005543f47cd07aee56}{empty}}())}
\DoxyCodeLine{02462\ \ \ \ \ \{}
\DoxyCodeLine{02463\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::invalid\_argument(\textcolor{stringliteral}{"{}Cannot\ cross\ product\ an\ empty\ vector"{}});}
\DoxyCodeLine{02464\ \ \ \ \ \}}
\DoxyCodeLine{02465\ }
\DoxyCodeLine{02466\ \ \ \ \ \textcolor{keywordflow}{if}\ (this-\/>shape()\ !=\ std::vector<int>\{3\}\ ||\ \_\_other.\mbox{\hyperlink{classtensor_a33e40f89c3247e27e6bd03a992d73868}{shape}}()\ !=\ std::vector<int>\{3\})}
\DoxyCodeLine{02467\ \ \ \ \ \{}
\DoxyCodeLine{02468\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::invalid\_argument(\textcolor{stringliteral}{"{}Cross\ product\ can\ only\ be\ performed\ on\ 3-\/element\ vectors"{}});}
\DoxyCodeLine{02469\ \ \ \ \ \}}
\DoxyCodeLine{02470\ }
\DoxyCodeLine{02471\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \_\_ret(\{3\});}
\DoxyCodeLine{02472\ }
\DoxyCodeLine{02473\ \textcolor{preprocessor}{\#if\ defined(\_\_ARM\_NEON)\ \&\&\ defined(\_\_aarch64\_\_)}}
\DoxyCodeLine{02474\ \ \ \ \ float32x4\_t\ \_\_a\ =\ vld1q\float32_t(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }\textcolor{keywordtype}{float}*\textcolor{keyword}{>}(this-\/>\_\_data\_.data()));}
\DoxyCodeLine{02475\ \ \ \ \ float32x4\_t\ \_\_b\ =\ vld1q\float32_t(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }\textcolor{keywordtype}{float}*\textcolor{keyword}{>}(\_\_other.\mbox{\hyperlink{classtensor_a4302a45c6c164b54316d6b869affca78}{storage}}().data()));}
\DoxyCodeLine{02476\ }
\DoxyCodeLine{02477\ \ \ \ \ float32x4\_t\ \_\_a\_yzx\ =\ vextq\float32_t(\_\_a,\ \_\_a,\ 1);}
\DoxyCodeLine{02478\ \ \ \ \ float32x4\_t\ \_\_b\_yzx\ =\ vextq\float32_t(\_\_b,\ \_\_b,\ 1);}
\DoxyCodeLine{02479\ }
\DoxyCodeLine{02480\ \ \ \ \ float32x4\_t\ \_\_result\ =\ vsubq\float32_t(vmulq\float32_t(\_\_a\_yzx,\ \_\_b),\ vmulq\float32_t(\_\_a,\ \_\_b\_yzx));}
\DoxyCodeLine{02481\ }
\DoxyCodeLine{02482\ \ \ \ \ \_\_result\ =\ vextq\float32_t(\_\_result,\ \_\_result,\ 3);}
\DoxyCodeLine{02483\ }
\DoxyCodeLine{02484\ \ \ \ \ vst1q\float32_t(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keywordtype}{float}*\textcolor{keyword}{>}(\_\_ret.\mbox{\hyperlink{classtensor_a4302a45c6c164b54316d6b869affca78}{storage}}().data()),\ \_\_result);}
\DoxyCodeLine{02485\ \textcolor{preprocessor}{\#elif\ defined(\_\_CUDACC\_\_)}}
\DoxyCodeLine{02486\ \ \ \ \ pointer\ \_\_d\_a;}
\DoxyCodeLine{02487\ \ \ \ \ pointer\ \_\_d\_b;}
\DoxyCodeLine{02488\ \ \ \ \ pointer\ \_\_d\_c;}
\DoxyCodeLine{02489\ }
\DoxyCodeLine{02490\ \ \ \ \ cudaMalloc(\&\_\_d\_a,\ 3\ *\ \textcolor{keyword}{sizeof}(value\_type));}
\DoxyCodeLine{02491\ \ \ \ \ cudaMalloc(\&\_\_d\_b,\ 3\ *\ \textcolor{keyword}{sizeof}(value\_type));}
\DoxyCodeLine{02492\ \ \ \ \ cudaMalloc(\&\_\_d\_c,\ 3\ *\ \textcolor{keyword}{sizeof}(value\_type));}
\DoxyCodeLine{02493\ }
\DoxyCodeLine{02494\ \ \ \ \ cudaMemcpy(\_\_d\_a,\ this-\/>\_\_data\_.data(),\ 3\ *\ \textcolor{keyword}{sizeof}(value\_type),\ cudaMemcpyHostToDevice);}
\DoxyCodeLine{02495\ \ \ \ \ cudaMemcpy(\_\_d\_b,\ \_\_other.\mbox{\hyperlink{classtensor_a4302a45c6c164b54316d6b869affca78}{storage}}().data(),\ 3\ *\ \textcolor{keyword}{sizeof}(value\_type),\ cudaMemcpyHostToDevice);}
\DoxyCodeLine{02496\ }
\DoxyCodeLine{02497\ \ \ \ \ dim3\ block(1);}
\DoxyCodeLine{02498\ \ \ \ \ dim3\ grid(1);}
\DoxyCodeLine{02499\ \ \ \ \ cross\_product\_kernel<<<grid,\ block>>>(\_\_d\_a,\ \_\_d\_b,\ \_\_d\_c);}
\DoxyCodeLine{02500\ }
\DoxyCodeLine{02501\ \ \ \ \ cudaMemcpy(\_\_ret.\mbox{\hyperlink{classtensor_a4302a45c6c164b54316d6b869affca78}{storage}}().data(),\ \_\_d\_c,\ 3\ *\ \textcolor{keyword}{sizeof}(value\_type),\ cudaMemcpyDeviceToHost);}
\DoxyCodeLine{02502\ }
\DoxyCodeLine{02503\ \ \ \ \ cudaFree(\_\_d\_a);}
\DoxyCodeLine{02504\ \ \ \ \ cudaFree(\_\_d\_b);}
\DoxyCodeLine{02505\ \ \ \ \ cudaFree(\_\_d\_c);}
\DoxyCodeLine{02506\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{02507\ \ \ \ \ const\_reference\ \_\_a1\ =\ this-\/>\_\_data\_[0];}
\DoxyCodeLine{02508\ \ \ \ \ const\_reference\ \_\_a2\ =\ this-\/>\_\_data\_[1];}
\DoxyCodeLine{02509\ \ \ \ \ const\_reference\ \_\_a3\ =\ this-\/>\_\_data\_[2];}
\DoxyCodeLine{02510\ }
\DoxyCodeLine{02511\ \ \ \ \ const\_reference\ \_\_b1\ =\ \_\_other[0];}
\DoxyCodeLine{02512\ \ \ \ \ const\_reference\ \_\_b2\ =\ \_\_other[1];}
\DoxyCodeLine{02513\ \ \ \ \ const\_reference\ \_\_b3\ =\ \_\_other[2];}
\DoxyCodeLine{02514\ }
\DoxyCodeLine{02515\ \ \ \ \ \_\_ret[0]\ =\ \_\_a2\ *\ \_\_b3\ -\/\ \_\_a3\ *\ \_\_b2;}
\DoxyCodeLine{02516\ \ \ \ \ \_\_ret[1]\ =\ \_\_a3\ *\ \_\_b1\ -\/\ \_\_a1\ *\ \_\_b3;}
\DoxyCodeLine{02517\ \ \ \ \ \_\_ret[2]\ =\ \_\_a1\ *\ \_\_b2\ -\/\ \_\_a2\ *\ \_\_b1;}
\DoxyCodeLine{02518\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02519\ \textcolor{preprocessor}{\#if\ defined(\_\_AVX2\_\_)}}
\DoxyCodeLine{02520\ \ \ \ \ \_\_m256\ \_\_a\ =\ \_mm256\_loadu\_ps(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }\textcolor{keywordtype}{float}*\textcolor{keyword}{>}(this-\/>\_\_data\_.data()));}
\DoxyCodeLine{02521\ \ \ \ \ \_\_m256\ \_\_b\ =\ \_mm256\_loadu\_ps(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }\textcolor{keywordtype}{float}*\textcolor{keyword}{>}(\_\_other.\mbox{\hyperlink{classtensor_a4302a45c6c164b54316d6b869affca78}{storage}}().data()));}
\DoxyCodeLine{02522\ }
\DoxyCodeLine{02523\ \ \ \ \ \_\_m256\ \_\_a\_yzx\ =\ \_mm256\_permute\_ps(\_\_a,\ \_MM\_SHUFFLE(3,\ 0,\ 2,\ 1));}
\DoxyCodeLine{02524\ \ \ \ \ \_\_m256\ \_\_b\_yzx\ =\ \_mm256\_permute\_ps(\_\_b,\ \_MM\_SHUFFLE(3,\ 0,\ 2,\ 1));}
\DoxyCodeLine{02525\ }
\DoxyCodeLine{02526\ \ \ \ \ \_\_m256\ \_\_result\ =\ \_mm256\_sub\_ps(\_mm256\_mul\_ps(\_\_a\_yzx,\ \_\_b),\ \_mm256\_mul\_ps(\_\_a,\ \_\_b\_yzx));}
\DoxyCodeLine{02527\ }
\DoxyCodeLine{02528\ \ \ \ \ \_\_result\ =\ \_mm256\_permute\_ps(\_\_result,\ \_MM\_SHUFFLE(3,\ 0,\ 2,\ 1));}
\DoxyCodeLine{02529\ }
\DoxyCodeLine{02530\ \ \ \ \ \_mm256\_storeu\_ps(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keywordtype}{float}*\textcolor{keyword}{>}(\_\_ret.\mbox{\hyperlink{classtensor_a4302a45c6c164b54316d6b869affca78}{storage}}().data()),\ \_\_result);}
\DoxyCodeLine{02531\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02532\ \textcolor{preprocessor}{\#if\ defined(\_\_SSE\_\_)}}
\DoxyCodeLine{02533\ \ \ \ \ \_\_m128\ \_\_a\ =\ \_mm\_loadu\_ps(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }\textcolor{keywordtype}{float}*\textcolor{keyword}{>}(this-\/>\_\_data\_.data()));}
\DoxyCodeLine{02534\ \ \ \ \ \_\_m128\ \_\_b\ =\ \_mm\_loadu\_ps(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }\textcolor{keywordtype}{float}*\textcolor{keyword}{>}(\_\_other.\mbox{\hyperlink{classtensor_a4302a45c6c164b54316d6b869affca78}{storage}}().data()));}
\DoxyCodeLine{02535\ }
\DoxyCodeLine{02536\ \ \ \ \ \_\_m128\ \_\_a\_yzx\ =\ \_mm\_shuffle\_ps(\_\_a,\ \_\_a,\ \_MM\_SHUFFLE(3,\ 0,\ 2,\ 1));}
\DoxyCodeLine{02537\ \ \ \ \ \_\_m128\ \_\_b\_yzx\ =\ \_mm\_shuffle\_ps(\_\_b,\ \_\_b,\ \_MM\_SHUFFLE(3,\ 0,\ 2,\ 1));}
\DoxyCodeLine{02538\ }
\DoxyCodeLine{02539\ \ \ \ \ \_\_m128\ \_\_result\ =\ \_mm\_sub\_ps(\_mm\_mul\_ps(\_\_a\_yzx,\ \_\_b),\ \_mm\_mul\_ps(\_\_a,\ \_\_b\_yzx));}
\DoxyCodeLine{02540\ }
\DoxyCodeLine{02541\ \ \ \ \ \_\_result\ =\ \_mm\_shuffle\_ps(\_\_result,\ \_\_result,\ \_MM\_SHUFFLE(3,\ 0,\ 2,\ 1));}
\DoxyCodeLine{02542\ }
\DoxyCodeLine{02543\ \ \ \ \ \_mm\_storeu\_ps(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keywordtype}{float}*\textcolor{keyword}{>}(\_\_ret.\mbox{\hyperlink{classtensor_a4302a45c6c164b54316d6b869affca78}{storage}}().data()),\ \_\_result);}
\DoxyCodeLine{02544\ }
\DoxyCodeLine{02545\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02546\ }
\DoxyCodeLine{02547\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_ret;}
\DoxyCodeLine{02548\ \}}
\DoxyCodeLine{02549\ }
\DoxyCodeLine{02550\ \textcolor{preprocessor}{\#ifdef\ \_\_CUDACC\_\_}}
\DoxyCodeLine{02551\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{02552\ \_\_global\_\_\ \textcolor{keywordtype}{void}\ cross\_product\_kernel(\_Tp*\ a,\ \_Tp*\ b,\ \_Tp*\ c)\ \{}
\DoxyCodeLine{02553\ \ \ \ \ c[0]\ =\ a[1]\ *\ b[2]\ -\/\ a[2]\ *\ b[1];}
\DoxyCodeLine{02554\ \ \ \ \ c[1]\ =\ a[2]\ *\ b[0]\ -\/\ a[0]\ *\ b[2];}
\DoxyCodeLine{02555\ \ \ \ \ c[2]\ =\ a[0]\ *\ b[1]\ -\/\ a[1]\ *\ b[0];}
\DoxyCodeLine{02556\ \}}
\DoxyCodeLine{02557\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02558\ }
\DoxyCodeLine{02559\ }
\DoxyCodeLine{02560\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{02561\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor_a74176f5911b900cec9c36673b4ff8f7e}{tensor<\_Tp>::absolute}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_tensor)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02562\ \ \ \ \ this-\/>\_\_check\_is\_scalar\_type(\textcolor{stringliteral}{"{}Cannot\ call\ absolute\ on\ non-\/scalar\ value"{}});}
\DoxyCodeLine{02563\ }
\DoxyCodeLine{02564\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_s\ =\ \_\_tensor.\mbox{\hyperlink{classtensor_a4302a45c6c164b54316d6b869affca78}{storage}}().size();}
\DoxyCodeLine{02565\ \ \ \ \ data\_t\ \_\_a;}
\DoxyCodeLine{02566\ }
\DoxyCodeLine{02567\ \ \ \ \ \_\_a.reserve(\_\_s);}
\DoxyCodeLine{02568\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{02569\ }
\DoxyCodeLine{02570\ \textcolor{preprocessor}{\#ifdef\ \_\_AVX\_\_}}
\DoxyCodeLine{02571\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_same\_v<value\_type,\ float>)}
\DoxyCodeLine{02572\ \ \ \ \ \{}
\DoxyCodeLine{02573\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ +\ 8\ <=\ \_\_s;\ \_\_i\ +=\ 8)}
\DoxyCodeLine{02574\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02575\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_m256\ input\ \ \ \ \ =\ \_mm256\_loadu\_ps(\&\_\_tensor.\mbox{\hyperlink{classtensor_a4302a45c6c164b54316d6b869affca78}{storage}}()[\_\_i]);}
\DoxyCodeLine{02576\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_m256\ abs\_value\ =\ \_mm256\_abs\_ps(input);}
\DoxyCodeLine{02577\ \ \ \ \ \ \ \ \ \ \ \ \ \_mm256\_storeu\_ps(\&\_\_a[\_\_i],\ abs\_value);}
\DoxyCodeLine{02578\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02579\ \ \ \ \ \}}
\DoxyCodeLine{02580\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02581\ }
\DoxyCodeLine{02582\ \textcolor{preprocessor}{\#if\ defined(\_\_SSE\_\_)}}
\DoxyCodeLine{02583\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_same\_v<value\_type,\ float>)}
\DoxyCodeLine{02584\ \ \ \ \ \{}
\DoxyCodeLine{02585\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ +\ 4\ <=\ \_\_s;\ \_\_i\ +=\ 4)}
\DoxyCodeLine{02586\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02587\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_m128\ input\ \ \ \ \ =\ \_mm\_loadu\_ps(\&\_\_tensor.\mbox{\hyperlink{classtensor_a4302a45c6c164b54316d6b869affca78}{storage}}()[\_\_i]);}
\DoxyCodeLine{02588\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_m128\ abs\_value\ =\ \_mm\_abs\_ps(input);}
\DoxyCodeLine{02589\ \ \ \ \ \ \ \ \ \ \ \ \ \_mm\_storeu\_ps(\&\_\_a[\_\_i],\ abs\_value);}
\DoxyCodeLine{02590\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02591\ \ \ \ \ \}}
\DoxyCodeLine{02592\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02593\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ \_\_s;\ \_\_i++)}
\DoxyCodeLine{02594\ \ \ \ \ \{}
\DoxyCodeLine{02595\ \ \ \ \ \ \ \ \ \_\_a.push\_back(\textcolor{keyword}{static\_cast<}value\_type\textcolor{keyword}{>}(std::fabs(\textcolor{keywordtype}{float}(\_\_tensor.\mbox{\hyperlink{classtensor_a4302a45c6c164b54316d6b869affca78}{storage}}()[\_\_i]))));}
\DoxyCodeLine{02596\ \ \ \ \ \}}
\DoxyCodeLine{02597\ }
\DoxyCodeLine{02598\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(\_\_a,\ \_\_tensor.\_\_shape\_);}
\DoxyCodeLine{02599\ \}}
\DoxyCodeLine{02600\ }
\DoxyCodeLine{02601\ }
\DoxyCodeLine{02602\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{02603\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor_a22993114d4bb3c73f7e1165be394a4be}{tensor<\_Tp>::dot}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02604\ \ \ \ \ this-\/>\_\_check\_is\_scalar\_type(\textcolor{stringliteral}{"{}Cannot\ perform\ a\ dot\ product\ on\ non\ scalar\ data\ types"{}});}
\DoxyCodeLine{02605\ \ \ \ \ \textcolor{keywordflow}{if}\ (this-\/>empty()\ ||\ \_\_other.\mbox{\hyperlink{classtensor_ab1dc32444636d6005543f47cd07aee56}{empty}}())}
\DoxyCodeLine{02606\ \ \ \ \ \{}
\DoxyCodeLine{02607\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::invalid\_argument(\textcolor{stringliteral}{"{}Cannot\ dot\ product\ an\ empty\ vector"{}});}
\DoxyCodeLine{02608\ \ \ \ \ \}}
\DoxyCodeLine{02609\ }
\DoxyCodeLine{02610\ \ \ \ \ \textcolor{keywordflow}{if}\ (this-\/>\_\_shape\_.size()\ ==\ 1\ \&\&\ \_\_other.\mbox{\hyperlink{classtensor_a33e40f89c3247e27e6bd03a992d73868}{shape}}().size()\ ==\ 1)}
\DoxyCodeLine{02611\ \ \ \ \ \{}
\DoxyCodeLine{02612\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (this-\/>\_\_shape\_[0]\ !=\ \_\_other.\mbox{\hyperlink{classtensor_a33e40f89c3247e27e6bd03a992d73868}{shape}}()[0])}
\DoxyCodeLine{02613\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02614\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::invalid\_argument(\textcolor{stringliteral}{"{}Vectors\ must\ have\ the\ same\ size\ for\ dot\ product"{}});}
\DoxyCodeLine{02615\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02616\ }
\DoxyCodeLine{02617\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}*\ \_\_this\_data\ \ =\ this-\/>\_\_data\_.data();}
\DoxyCodeLine{02618\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}*\ \_\_other\_data\ =\ \_\_other.\mbox{\hyperlink{classtensor_a4302a45c6c164b54316d6b869affca78}{storage}}().data();}
\DoxyCodeLine{02619\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ \ \_\_size\ \ \ \ \ \ \ =\ this-\/>\_\_data\_.size();}
\DoxyCodeLine{02620\ }
\DoxyCodeLine{02621\ \ \ \ \ \ \ \ \ value\_type\ \_\_ret\ =\ 0;}
\DoxyCodeLine{02622\ }
\DoxyCodeLine{02623\ \textcolor{preprocessor}{\#ifdef\ \_\_CUDACC\_\_}}
\DoxyCodeLine{02624\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (this-\/>\_\_is\_cuda\_tensor\ \&\&\ \_\_other.\_\_is\_cuda\_tensor)}
\DoxyCodeLine{02625\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02626\ \ \ \ \ \ \ \ \ \ \ \ \ thrust::device\_vector<value\_type>\ d\_result(1);}
\DoxyCodeLine{02627\ \ \ \ \ \ \ \ \ \ \ \ \ thrust::transform(thrust::device,\ \_\_this\_data,\ \_\_this\_data\ +\ \_\_size,\ \_\_other\_data,}
\DoxyCodeLine{02628\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ d\_result.begin(),\ thrust::multiplies<value\_type>());}
\DoxyCodeLine{02629\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret\ =\ thrust::reduce(d\_result.begin(),\ d\_result.end());}
\DoxyCodeLine{02630\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02631\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{02632\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02633\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02634\ \textcolor{preprocessor}{\#if\ defined(\_\_AVX\_\_)}}
\DoxyCodeLine{02635\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_same\_v<value\_type,\ float>\ \&\&\ \_\_size\ >=\ 8)}
\DoxyCodeLine{02636\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02637\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_m256\ sum\ =\ \_mm256\_setzero\_ps();}
\DoxyCodeLine{02638\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ \_\_size\ -\/\ 7;\ i\ +=\ 8)}
\DoxyCodeLine{02639\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02640\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_m256\ a\ =\ \_mm256\_loadu\_ps(\_\_this\_data\ +\ i);}
\DoxyCodeLine{02641\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_m256\ b\ =\ \_mm256\_loadu\_ps(\_\_other\_data\ +\ i);}
\DoxyCodeLine{02642\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sum\ \ \ \ \ \ =\ \_mm256\_add\_ps(sum,\ \_mm256\_mul\_ps(a,\ b));}
\DoxyCodeLine{02643\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02644\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret\ =\ \_mm256\_reduce\_add\_ps(sum);}
\DoxyCodeLine{02645\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ \_\_size\ -\/\ (\_\_size\ \%\ 8);\ i\ <\ \_\_size;\ i++)}
\DoxyCodeLine{02646\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02647\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret\ +=\ \_\_this\_data[i]\ *\ \_\_other\_data[i];}
\DoxyCodeLine{02648\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02649\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02650\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{02651\ \textcolor{preprocessor}{\#elif\ defined(\_\_SSE\_\_)}}
\DoxyCodeLine{02652\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_same\_v<value\_type,\ float>\ \&\&\ \_\_size\ >=\ 4)}
\DoxyCodeLine{02653\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02654\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_m128\ sum\ =\ \_mm\_setzero\_ps();}
\DoxyCodeLine{02655\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ \_\_size\ -\/\ 3;\ i\ +=\ 4)}
\DoxyCodeLine{02656\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02657\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_m128\ a\ =\ \_mm\_loadu\_ps(\_\_this\_data\ +\ i);}
\DoxyCodeLine{02658\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_m128\ b\ =\ \_mm\_loadu\_ps(\_\_other\_data\ +\ i);}
\DoxyCodeLine{02659\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sum\ \ \ \ \ \ =\ \_mm\_add\_ps(sum,\ \_mm\_mul\_ps(a,\ b));}
\DoxyCodeLine{02660\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02661\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret\ =\ \_mm\_reduce\_add\_ps(sum);}
\DoxyCodeLine{02662\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ \_\_size\ -\/\ (\_\_size\ \%\ 4);\ i\ <\ \_\_size;\ i++)}
\DoxyCodeLine{02663\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02664\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret\ +=\ \_\_this\_data[i]\ *\ \_\_other\_data[i];}
\DoxyCodeLine{02665\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02666\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02667\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{02668\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02669\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02670\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret\ =\ std::inner\_product(\_\_this\_data,\ \_\_this\_data\ +\ \_\_size,\ \_\_other\_data,}
\DoxyCodeLine{02671\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ value\_type(0));}
\DoxyCodeLine{02672\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02673\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02674\ }
\DoxyCodeLine{02675\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(\{\_\_ret\},\ \{1\});}
\DoxyCodeLine{02676\ \ \ \ \ \}}
\DoxyCodeLine{02677\ }
\DoxyCodeLine{02678\ \ \ \ \ \textcolor{keywordflow}{if}\ (this-\/>\_\_shape\_.size()\ ==\ 2\ \&\&\ \_\_other.\mbox{\hyperlink{classtensor_a33e40f89c3247e27e6bd03a992d73868}{shape}}().size()\ ==\ 2)}
\DoxyCodeLine{02679\ \ \ \ \ \{}
\DoxyCodeLine{02680\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ this-\/>matmul(\_\_other);}
\DoxyCodeLine{02681\ \ \ \ \ \}}
\DoxyCodeLine{02682\ }
\DoxyCodeLine{02683\ \ \ \ \ \textcolor{keywordflow}{if}\ (this-\/>\_\_shape\_.size()\ ==\ 3\ \&\&\ \_\_other.\mbox{\hyperlink{classtensor_a33e40f89c3247e27e6bd03a992d73868}{shape}}().size()\ ==\ 3)}
\DoxyCodeLine{02684\ \ \ \ \ \{}
\DoxyCodeLine{02685\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ this-\/>cross\_product(\_\_other);}
\DoxyCodeLine{02686\ \ \ \ \ \}}
\DoxyCodeLine{02687\ }
\DoxyCodeLine{02688\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self();}
\DoxyCodeLine{02689\ \}}
\DoxyCodeLine{02690\ }
\DoxyCodeLine{02691\ }
\DoxyCodeLine{02692\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{02693\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor_a4d690db0fb6abfd5492d46819dc4e51e}{tensor<\_Tp>::relu}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02694\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(*this).\mbox{\hyperlink{classtensor_a0e71c49ca5485d2407842ee72c1e5aad}{relu\_}}();}
\DoxyCodeLine{02695\ \}}
\DoxyCodeLine{02696\ }
\DoxyCodeLine{02697\ }
\DoxyCodeLine{02698\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{02699\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_a0e71c49ca5485d2407842ee72c1e5aad}{tensor<\_Tp>::relu\_}}()\ \{}
\DoxyCodeLine{02700\ \ \ \ \ this-\/>\_\_check\_is\_scalar\_type(\textcolor{stringliteral}{"{}Cannot\ relu\ non-\/scalar\ type"{}});}
\DoxyCodeLine{02701\ }
\DoxyCodeLine{02702\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_s\ =\ this-\/>\_\_data\_.size();}
\DoxyCodeLine{02703\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{02704\ }
\DoxyCodeLine{02705\ \textcolor{preprocessor}{\#ifdef\ \_\_CUDACC\_\_}}
\DoxyCodeLine{02706\ \ \ \ \ \textcolor{keywordflow}{if}\ (this-\/>\_\_is\_cuda\_tensor)}
\DoxyCodeLine{02707\ \ \ \ \ \{}
\DoxyCodeLine{02708\ \ \ \ \ \ \ \ \ value\_type*\ d\_data\ =\ thrust::raw\_pointer\_cast(this-\/>\_\_data\_.data());}
\DoxyCodeLine{02709\ \ \ \ \ \ \ \ \ thrust::transform(thrust::device,\ d\_data,\ d\_data\ +\ \_\_s,\ d\_data,}
\DoxyCodeLine{02710\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ []\ \_\_device\_\_(value\_type\ x)\ \{\ \textcolor{keywordflow}{return}\ max(x,\ value\_type(0));\ \});}
\DoxyCodeLine{02711\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{02712\ \ \ \ \ \}}
\DoxyCodeLine{02713\ \textcolor{preprocessor}{\#elif\ defined(\_\_SSE\_\_)}}
\DoxyCodeLine{02714\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_same\_v<value\_type,\ float>)}
\DoxyCodeLine{02715\ \ \ \ \ \{}
\DoxyCodeLine{02716\ \ \ \ \ \ \ \ \ \_\_m128\ zero\ =\ \_mm\_setzero\_ps();}
\DoxyCodeLine{02717\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ +\ 4\ <=\ \_\_s;\ \_\_i\ +=\ 4)}
\DoxyCodeLine{02718\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02719\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_m128\ \_\_x\ \ \ \ =\ \_mm\_loadu\_ps(\&this-\/>\_\_data\_[\_\_i]);}
\DoxyCodeLine{02720\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_m128\ result\ =\ \_mm\_max\_ps(\_\_x,\ zero);}
\DoxyCodeLine{02721\ \ \ \ \ \ \ \ \ \ \ \ \ \_mm\_storeu\_ps(\&this-\/>\_\_data\_[\_\_i],\ result);}
\DoxyCodeLine{02722\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02723\ \ \ \ \ \}}
\DoxyCodeLine{02724\ \textcolor{preprocessor}{\#elif\ defined(\_\_AVX\_\_)}}
\DoxyCodeLine{02725\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_same\_v<value\_type,\ float>)}
\DoxyCodeLine{02726\ \ \ \ \ \{}
\DoxyCodeLine{02727\ \ \ \ \ \ \ \ \ \_\_m256\ zero\ =\ \_mm256\_setzero\_ps();}
\DoxyCodeLine{02728\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ +\ 8\ <=\ \_\_s;\ \_\_i\ +=\ 8)}
\DoxyCodeLine{02729\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02730\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_m256\ \_\_x\ \ \ \ =\ \_mm256\_loadu\_ps(\&this-\/>\_\_data\_[\_\_i]);}
\DoxyCodeLine{02731\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_m256\ result\ =\ \_mm256\_max\_ps(\_\_x,\ zero);}
\DoxyCodeLine{02732\ \ \ \ \ \ \ \ \ \ \ \ \ \_mm256\_storeu\_ps(\&this-\/>\_\_data\_[\_\_i],\ result);}
\DoxyCodeLine{02733\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02734\ \ \ \ \ \}}
\DoxyCodeLine{02735\ \textcolor{preprocessor}{\#elif\ \_\_ARM\_NEON}}
\DoxyCodeLine{02736\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_same\_v<value\_type,\ float>)}
\DoxyCodeLine{02737\ \ \ \ \ \{}
\DoxyCodeLine{02738\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ float32x4\_t\ vZero\ =\ vdupq\_n\float32_t(0.0f);}
\DoxyCodeLine{02739\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ +\ 4\ <=\ \_\_s;\ \_\_i\ +=\ 4)}
\DoxyCodeLine{02740\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02741\ \ \ \ \ \ \ \ \ \ \ \ \ float32x4\_t\ \_\_v\ =\ vld1q\float32_t(\&this-\/>\_\_data\_[\_\_i]);}
\DoxyCodeLine{02742\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_v\ \ \ \ \ \ \ \ \ \ \ \ \ =\ vmaxq\float32_t(\_\_v,\ vZero);}
\DoxyCodeLine{02743\ \ \ \ \ \ \ \ \ \ \ \ \ vst1q\float32_t(\&this-\/>\_\_data\_[\_\_i],\ \_\_v);}
\DoxyCodeLine{02744\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02745\ \ \ \ \ \}}
\DoxyCodeLine{02746\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_same\_v<value\_type,\ int32\_t>)}
\DoxyCodeLine{02747\ \ \ \ \ \{}
\DoxyCodeLine{02748\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ int32x4\_t\ vZero\ =\ vdupq\_n\uint32_t(0);}
\DoxyCodeLine{02749\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ +\ 4\ <=\ \_\_s;\ \_\_i\ +=\ 4)}
\DoxyCodeLine{02750\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02751\ \ \ \ \ \ \ \ \ \ \ \ \ int32x4\_t\ \_\_v\ =\ vld1q\uint32_t(\&this-\/>\_\_data\_[\_\_i]);}
\DoxyCodeLine{02752\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_v\ \ \ \ \ \ \ \ \ \ \ =\ vmaxq\uint32_t(\_\_v,\ vZero);}
\DoxyCodeLine{02753\ \ \ \ \ \ \ \ \ \ \ \ \ vst1q\uint32_t(\&this-\/>\_\_data\_[\_\_i],\ \_\_v);}
\DoxyCodeLine{02754\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02755\ \ \ \ \ \}}
\DoxyCodeLine{02756\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{02757\ \ \ \ \ \textcolor{keywordflow}{for}\ (\_\_i\ =\ 0;\ \_\_i\ <\ \_\_s;\ \_\_i++)}
\DoxyCodeLine{02758\ \ \ \ \ \{}
\DoxyCodeLine{02759\ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i]\ =\ std::max(this-\/>\_\_data\_[\_\_i],\ value\_type(0));}
\DoxyCodeLine{02760\ \ \ \ \ \}}
\DoxyCodeLine{02761\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02762\ \}}
\DoxyCodeLine{02763\ }
\DoxyCodeLine{02764\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{02765\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor_ad7baf3a8a2c4a9ad44ba04132454590e}{tensor<\_Tp>::transpose}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02766\ \ \ \ \ \textcolor{keywordflow}{if}\ (this-\/>\_\_shape\_.size()\ !=\ 2)}
\DoxyCodeLine{02767\ \ \ \ \ \{}
\DoxyCodeLine{02768\ \ \ \ \ \ \ \ \ std::cerr\ <<\ \textcolor{stringliteral}{"{}Matrix\ transposition\ can\ only\ be\ done\ on\ 2D\ tensors"{}}\ <<\ std::endl;}
\DoxyCodeLine{02769\ \ \ \ \ \ \ \ \ std::exit(EXIT\_FAILURE);}
\DoxyCodeLine{02770\ \ \ \ \ \}}
\DoxyCodeLine{02771\ }
\DoxyCodeLine{02772\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \_\_ret(\{this-\/>\_\_shape\_[1],\ this-\/>\_\_shape\_[0]\});}
\DoxyCodeLine{02773\ }
\DoxyCodeLine{02774\ \ \ \ \ \textcolor{keyword}{const}\ index\_type\ rows\ =\ this-\/>\_\_shape\_[0];}
\DoxyCodeLine{02775\ \ \ \ \ \textcolor{keyword}{const}\ index\_type\ cols\ =\ this-\/>\_\_shape\_[1];}
\DoxyCodeLine{02776\ }
\DoxyCodeLine{02777\ \textcolor{preprocessor}{\#ifdef\ \_\_CUDACC\_\_}}
\DoxyCodeLine{02778\ \ \ \ \ \textcolor{keywordflow}{if}\ (this-\/>\_\_is\_cuda\_tensor)}
\DoxyCodeLine{02779\ \ \ \ \ \{}
\DoxyCodeLine{02780\ \ \ \ \ \ \ \ \ dim3\ blockDim(16,\ 16);}
\DoxyCodeLine{02781\ \ \ \ \ \ \ \ \ dim3\ gridDim((cols\ +\ blockDim.x\ -\/\ 1)\ /\ blockDim.x,\ (rows\ +\ blockDim.y\ -\/\ 1)\ /\ blockDim.y);}
\DoxyCodeLine{02782\ }
\DoxyCodeLine{02783\ \ \ \ \ \ \ \ \ transpose\_kernel<<<gridDim,\ blockDim>>>(thrust::raw\_pointer\_cast(this-\/>\_\_data\_.data()),}
\DoxyCodeLine{02784\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ thrust::raw\_pointer\_cast(\_\_ret.\_\_data\_.data()),}
\DoxyCodeLine{02785\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ rows,\ cols);}
\DoxyCodeLine{02786\ \ \ \ \ \ \ \ \ cudaDeviceSynchronize();}
\DoxyCodeLine{02787\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_ret;}
\DoxyCodeLine{02788\ \ \ \ \ \}}
\DoxyCodeLine{02789\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02790\ }
\DoxyCodeLine{02791\ \textcolor{preprocessor}{\#ifdef\ \_\_ARM\_NEON}}
\DoxyCodeLine{02792\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_same\_v<\_Tp,\ float>)}
\DoxyCodeLine{02793\ \ \ \ \ \{}
\DoxyCodeLine{02794\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (index\_type\ i\ =\ 0;\ i\ <\ rows;\ i\ +=\ 4)}
\DoxyCodeLine{02795\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02796\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (index\_type\ j\ =\ 0;\ j\ <\ cols;\ j\ +=\ 4)}
\DoxyCodeLine{02797\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02798\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (i\ +\ 4\ <=\ rows\ \&\&\ j\ +\ 4\ <=\ cols)}
\DoxyCodeLine{02799\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02800\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ float32x4x4\_t\ input;}
\DoxyCodeLine{02801\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ 0;\ k\ <\ 4;\ k++)}
\DoxyCodeLine{02802\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02803\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ input.value[k]\ =\ vld1q\float32_t(\&this-\/>\_\_data\_[(i\ +\ k)\ *\ cols\ +\ j]);}
\DoxyCodeLine{02804\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02805\ }
\DoxyCodeLine{02806\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ float32x4x4\_t\ output\ =\ vld4q\float32_t(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }\textcolor{keywordtype}{float}*\textcolor{keyword}{>}(\&input));}
\DoxyCodeLine{02807\ }
\DoxyCodeLine{02808\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ 0;\ k\ <\ 4;\ k++)}
\DoxyCodeLine{02809\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02810\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ vst1q\float32_t(\&\_\_ret.\_\_data\_[(j\ +\ k)\ *\ rows\ +\ i],\ output.value[k]);}
\DoxyCodeLine{02811\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02812\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02813\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{02814\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02815\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (index\_type\ ii\ =\ i;\ ii\ <\ std::min(i\ +\ 4,\ rows);\ ii++)}
\DoxyCodeLine{02816\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02817\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (index\_type\ jj\ =\ j;\ jj\ <\ std::min(j\ +\ 4,\ cols);\ jj++)}
\DoxyCodeLine{02818\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02819\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret.at(\{jj,\ ii\})\ =\ this-\/>at(\{ii,\ jj\});}
\DoxyCodeLine{02820\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02821\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02822\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02823\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02824\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02825\ \ \ \ \ \}}
\DoxyCodeLine{02826\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{02827\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02828\ \ \ \ \ \{}
\DoxyCodeLine{02829\ \ \ \ \ \ \ \ \ index\_type\ \_\_i\ =\ 0;}
\DoxyCodeLine{02830\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ rows;\ \_\_i++)}
\DoxyCodeLine{02831\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02832\ \ \ \ \ \ \ \ \ \ \ \ \ index\_type\ \_\_j\ =\ 0;}
\DoxyCodeLine{02833\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_j\ <\ cols;\ \_\_j++)}
\DoxyCodeLine{02834\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02835\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret.at(\{\_\_j,\ \_\_i\})\ =\ this-\/>at(\{\_\_i,\ \_\_j\});}
\DoxyCodeLine{02836\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02837\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02838\ \ \ \ \ \}}
\DoxyCodeLine{02839\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_ret;}
\DoxyCodeLine{02840\ \}}
\DoxyCodeLine{02841\ }
\DoxyCodeLine{02842\ \textcolor{preprocessor}{\#ifdef\ \_\_CUDACC\_\_}}
\DoxyCodeLine{02843\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{02844\ \_\_global\_\_\ \textcolor{keywordtype}{void}\ transpose\_kernel(\_Tp*\ input,\ \_Tp*\ output,\ \textcolor{keywordtype}{int}\ rows,\ \textcolor{keywordtype}{int}\ cols)\ \{}
\DoxyCodeLine{02845\ \ \ \ \ \textcolor{keywordtype}{int}\ i\ =\ blockIdx.y\ *\ blockDim.y\ +\ threadIdx.y;}
\DoxyCodeLine{02846\ \ \ \ \ \textcolor{keywordtype}{int}\ j\ =\ blockIdx.x\ *\ blockDim.x\ +\ threadIdx.x;}
\DoxyCodeLine{02847\ }
\DoxyCodeLine{02848\ \ \ \ \ \textcolor{keywordflow}{if}\ (i\ <\ rows\ \&\&\ j\ <\ cols)}
\DoxyCodeLine{02849\ \ \ \ \ \{}
\DoxyCodeLine{02850\ \ \ \ \ \ \ \ \ output[j\ *\ rows\ +\ i]\ =\ input[i\ *\ cols\ +\ j];}
\DoxyCodeLine{02851\ \ \ \ \ \}}
\DoxyCodeLine{02852\ \}}
\DoxyCodeLine{02853\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02854\ }
\DoxyCodeLine{02855\ }
\DoxyCodeLine{02856\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{02857\ \mbox{\hyperlink{classtensor}{tensor<typename\ tensor<\_Tp>::index\_type}}>\ \mbox{\hyperlink{classtensor_a841f49974f95a3e39c71b04f8a748218}{tensor<\_Tp>::argsort}}(index\_type\ \_\_d,}
\DoxyCodeLine{02858\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ \ \ \ \ \ \ \_\_ascending)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02859\ \ \ \ \ index\_type\ \_\_adjusted\ =\ (\_\_d\ <\ 0LL)\ ?\ \_\_d\ +\ this-\/>\_\_data\_.\mbox{\hyperlink{classtensor_a119a24ebef8a13cd8fd262a1c00b48b7}{size}}()\ :\ \_\_d;}
\DoxyCodeLine{02860\ }
\DoxyCodeLine{02861\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_\_adjusted\ !=\ 0LL)}
\DoxyCodeLine{02862\ \ \ \ \ \{}
\DoxyCodeLine{02863\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::out\_of\_range(\textcolor{stringliteral}{"{}Invalid\ dimension\ for\ argsort:\ only\ 1D\ tensors\ are\ supported"{}});}
\DoxyCodeLine{02864\ \ \ \ \ \}}
\DoxyCodeLine{02865\ }
\DoxyCodeLine{02866\ \ \ \ \ index\_type\ \ \ \ \ \ \ \ \ \ \ \ \ \ size\ =\ \textcolor{keyword}{static\_cast<}index\_type\textcolor{keyword}{>}(this-\/>\_\_data\_.size());}
\DoxyCodeLine{02867\ \ \ \ \ std::vector<index\_type>\ \_\_indices(size);}
\DoxyCodeLine{02868\ \ \ \ \ std::iota(\_\_indices.begin(),\ \_\_indices.end(),\ 0);}
\DoxyCodeLine{02869\ }
\DoxyCodeLine{02870\ \ \ \ \ std::sort(\_\_indices.begin(),\ \_\_indices.end(),\ [\&](index\_type\ \_\_a,\ index\_type\ \_\_b)\ \{}
\DoxyCodeLine{02871\ \ \ \ \ \ \ \ \ return\ \_\_ascending\ ?\ this-\/>\_\_data\_[\_\_a]\ <\ this-\/>\_\_data\_[\_\_b]}
\DoxyCodeLine{02872\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ this-\/>\_\_data\_[\_\_a]\ >\ this-\/>\_\_data\_[\_\_b];}
\DoxyCodeLine{02873\ \ \ \ \ \});}
\DoxyCodeLine{02874\ }
\DoxyCodeLine{02875\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classtensor}{tensor<index\_type>}}(\_\_indices);}
\DoxyCodeLine{02876\ \}}
\DoxyCodeLine{02877\ }
\DoxyCodeLine{02878\ }
\DoxyCodeLine{02879\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{02880\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor_ad70d7b170b910e960bf857e46c28e8af}{tensor<\_Tp>::bitwise\_left\_shift}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \_\_amount)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02881\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(*this).\mbox{\hyperlink{classtensor_aaac594832e9bc8e55a2493f61ef3705e}{bitwise\_right\_shift\_}}(\_\_amount);}
\DoxyCodeLine{02882\ \}}
\DoxyCodeLine{02883\ }
\DoxyCodeLine{02884\ }
\DoxyCodeLine{02885\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{02886\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor_a97fdba6da40a710924ad6b896f2a002a}{tensor<\_Tp>::bitwise\_xor}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02887\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(*this).\mbox{\hyperlink{classtensor_a9f73f1a3264e3f3ca69755b68ec1d0df}{bitwise\_xor\_}}(\_\_other);}
\DoxyCodeLine{02888\ \}}
\DoxyCodeLine{02889\ }
\DoxyCodeLine{02890\ }
\DoxyCodeLine{02891\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{02892\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor_a33b542481b4ed30f21c745735f1f2efd}{tensor<\_Tp>::bitwise\_right\_shift}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \_\_amount)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02893\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(*this).\mbox{\hyperlink{classtensor_aaac594832e9bc8e55a2493f61ef3705e}{bitwise\_right\_shift\_}}(\_\_amount);}
\DoxyCodeLine{02894\ \}}
\DoxyCodeLine{02895\ }
\DoxyCodeLine{02896\ }
\DoxyCodeLine{02897\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{02898\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_addc040f1f7b20849180f04bcfac0a77c}{tensor<\_Tp>::bitwise\_and\_}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\ \{}
\DoxyCodeLine{02899\ \ \ \ \ \textcolor{keywordflow}{if}\ (!std::is\_integral<value\_type>::value\ \&\&\ !std::is\_same<value\_type,\ bool>::value)}
\DoxyCodeLine{02900\ \ \ \ \ \{}
\DoxyCodeLine{02901\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(}
\DoxyCodeLine{02902\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Cannot\ perform\ a\ bitwise\ AND\ on\ non-\/integral\ or\ non-\/boolean\ values"{}});}
\DoxyCodeLine{02903\ \ \ \ \ \}}
\DoxyCodeLine{02904\ }
\DoxyCodeLine{02905\ \ \ \ \ assert(this-\/>\_\_shape\_\ ==\ \_\_other.\mbox{\hyperlink{classtensor_a33e40f89c3247e27e6bd03a992d73868}{shape}}()\ \&\&\ this-\/>size(0)\ ==\ \_\_other.\mbox{\hyperlink{classtensor_a119a24ebef8a13cd8fd262a1c00b48b7}{size}}(0));}
\DoxyCodeLine{02906\ \textcolor{preprocessor}{\#ifdef\ \_\_ARM\_NEON}}
\DoxyCodeLine{02907\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ simd\_size\ =\ 4;}
\DoxyCodeLine{02908\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ simd\_end\ \ =\ this-\/>\_\_data\_.size()\ -\/\ (this-\/>\_\_data\_.size()\ \%\ simd\_size);}
\DoxyCodeLine{02909\ }
\DoxyCodeLine{02910\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;\ \_\_i\ <\ simd\_end;\ \_\_i\ +=\ simd\_size)}
\DoxyCodeLine{02911\ \ \ \ \ \{}
\DoxyCodeLine{02912\ \ \ \ \ \ \ \ \ uint32x4\_t\ data\_vec\ \ =\ vld1q\_u32(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }uint32\_t*\textcolor{keyword}{>}(\&this-\/>\_\_data\_[\_\_i]));}
\DoxyCodeLine{02913\ \ \ \ \ \ \ \ \ uint32x4\_t\ other\_vec\ =\ vld1q\_u32(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }uint32\_t*\textcolor{keyword}{>}(\&\_\_other[\_\_i]));}
\DoxyCodeLine{02914\ }
\DoxyCodeLine{02915\ \ \ \ \ \ \ \ \ uint32x4\_t\ xor\_vec\ =\ vandq\_u32(data\_vec,\ other\_vec);}
\DoxyCodeLine{02916\ }
\DoxyCodeLine{02917\ \ \ \ \ \ \ \ \ vst1q\_u32(\textcolor{keyword}{reinterpret\_cast<}uint32\_t*\textcolor{keyword}{>}(\&this-\/>\_\_data\_[\_\_i]),\ xor\_vec);}
\DoxyCodeLine{02918\ \ \ \ \ \}}
\DoxyCodeLine{02919\ }
\DoxyCodeLine{02920\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ \_\_i\ =\ simd\_end;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{02921\ \ \ \ \ \{}
\DoxyCodeLine{02922\ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i]\ \&=\ (\_\_other[\_\_i]);}
\DoxyCodeLine{02923\ \ \ \ \ \}}
\DoxyCodeLine{02924\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{02925\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{02926\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{02927\ \ \ \ \ \{}
\DoxyCodeLine{02928\ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i]\ \&=\ \_\_other[\_\_i];}
\DoxyCodeLine{02929\ \ \ \ \ \}}
\DoxyCodeLine{02930\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02931\ \}}
\DoxyCodeLine{02932\ }
\DoxyCodeLine{02933\ }
\DoxyCodeLine{02934\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{02935\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_aa40e092a039ef0ad7c7354b7afd093a2}{tensor<\_Tp>::bitwise\_or\_}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\ \{}
\DoxyCodeLine{02936\ \ \ \ \ \textcolor{keywordflow}{if}\ (!std::is\_integral<value\_type>::value\ \&\&\ !std::is\_same<value\_type,\ bool>::value)}
\DoxyCodeLine{02937\ \ \ \ \ \{}
\DoxyCodeLine{02938\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(}
\DoxyCodeLine{02939\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Cannot\ perform\ a\ bitwise\ OR\ on\ non-\/integral\ or\ non-\/boolean\ values"{}});}
\DoxyCodeLine{02940\ \ \ \ \ \}}
\DoxyCodeLine{02941\ }
\DoxyCodeLine{02942\ \ \ \ \ assert(this-\/>\_\_shape\_\ ==\ \_\_other.\mbox{\hyperlink{classtensor_a33e40f89c3247e27e6bd03a992d73868}{shape}}()\ \&\&\ this-\/>size(0)\ ==\ \_\_other.\mbox{\hyperlink{classtensor_a119a24ebef8a13cd8fd262a1c00b48b7}{size}}(0));}
\DoxyCodeLine{02943\ \textcolor{preprocessor}{\#ifdef\ \_\_ARM\_NEON}}
\DoxyCodeLine{02944\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ simd\_size\ =\ 4;}
\DoxyCodeLine{02945\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ simd\_end\ \ =\ this-\/>\_\_data\_.size()\ -\/\ (this-\/>\_\_data\_.size()\ \%\ simd\_size);}
\DoxyCodeLine{02946\ }
\DoxyCodeLine{02947\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;\ \_\_i\ <\ simd\_end;\ \_\_i\ +=\ simd\_size)}
\DoxyCodeLine{02948\ \ \ \ \ \{}
\DoxyCodeLine{02949\ \ \ \ \ \ \ \ \ uint32x4\_t\ data\_vec\ \ =\ vld1q\_u32(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }uint32\_t*\textcolor{keyword}{>}(\&this-\/>\_\_data\_[\_\_i]));}
\DoxyCodeLine{02950\ \ \ \ \ \ \ \ \ uint32x4\_t\ other\_vec\ =\ vld1q\_u32(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }uint32\_t*\textcolor{keyword}{>}(\&\_\_other[\_\_i]));}
\DoxyCodeLine{02951\ }
\DoxyCodeLine{02952\ \ \ \ \ \ \ \ \ uint32x4\_t\ xor\_vec\ =\ vornq\_u32(data\_vec,\ other\_vec);}
\DoxyCodeLine{02953\ }
\DoxyCodeLine{02954\ \ \ \ \ \ \ \ \ vst1q\_u32(\textcolor{keyword}{reinterpret\_cast<}uint32\_t*\textcolor{keyword}{>}(\&this-\/>\_\_data\_[\_\_i]),\ xor\_vec);}
\DoxyCodeLine{02955\ \ \ \ \ \}}
\DoxyCodeLine{02956\ }
\DoxyCodeLine{02957\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ \_\_i\ =\ simd\_end;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{02958\ \ \ \ \ \{}
\DoxyCodeLine{02959\ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i]\ |=\ (\_\_other[\_\_i]);}
\DoxyCodeLine{02960\ \ \ \ \ \}}
\DoxyCodeLine{02961\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{02962\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{02963\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{02964\ \ \ \ \ \{}
\DoxyCodeLine{02965\ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i]\ |=\ \_\_other[\_\_i];}
\DoxyCodeLine{02966\ \ \ \ \ \}}
\DoxyCodeLine{02967\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02968\ \}}
\DoxyCodeLine{02969\ }
\DoxyCodeLine{02970\ }
\DoxyCodeLine{02971\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{02972\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_a9f73f1a3264e3f3ca69755b68ec1d0df}{tensor<\_Tp>::bitwise\_xor\_}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\ \{}
\DoxyCodeLine{02973\ \ \ \ \ \textcolor{keywordflow}{if}\ (!std::is\_integral<value\_type>::value\ \&\&\ !std::is\_same<value\_type,\ bool>::value)}
\DoxyCodeLine{02974\ \ \ \ \ \{}
\DoxyCodeLine{02975\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(}
\DoxyCodeLine{02976\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Cannot\ perform\ a\ bitwise\ XOR\ on\ non-\/integral\ or\ non-\/boolean\ values"{}});}
\DoxyCodeLine{02977\ \ \ \ \ \}}
\DoxyCodeLine{02978\ }
\DoxyCodeLine{02979\ \ \ \ \ assert(this-\/>\_\_shape\_\ ==\ \_\_other.\mbox{\hyperlink{classtensor_a33e40f89c3247e27e6bd03a992d73868}{shape}}()\ \&\&\ this-\/>size(0)\ ==\ \_\_other.\mbox{\hyperlink{classtensor_a119a24ebef8a13cd8fd262a1c00b48b7}{size}}(0));}
\DoxyCodeLine{02980\ \textcolor{preprocessor}{\#ifdef\ \_\_ARM\_NEON}}
\DoxyCodeLine{02981\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ simd\_size\ =\ 4;}
\DoxyCodeLine{02982\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ simd\_end\ \ =\ this-\/>\_\_data\_.size()\ -\/\ (this-\/>\_\_data\_.size()\ \%\ simd\_size);}
\DoxyCodeLine{02983\ }
\DoxyCodeLine{02984\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;\ \_\_i\ <\ simd\_end;\ \_\_i\ +=\ simd\_size)}
\DoxyCodeLine{02985\ \ \ \ \ \{}
\DoxyCodeLine{02986\ \ \ \ \ \ \ \ \ uint32x4\_t\ data\_vec\ \ =\ vld1q\_u32(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }uint32\_t*\textcolor{keyword}{>}(\&this-\/>\_\_data\_[\_\_i]));}
\DoxyCodeLine{02987\ \ \ \ \ \ \ \ \ uint32x4\_t\ other\_vec\ =\ vld1q\_u32(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }uint32\_t*\textcolor{keyword}{>}(\&\_\_other[\_\_i]));}
\DoxyCodeLine{02988\ }
\DoxyCodeLine{02989\ \ \ \ \ \ \ \ \ uint32x4\_t\ xor\_vec\ =\ veorq\_u32(data\_vec,\ other\_vec);}
\DoxyCodeLine{02990\ }
\DoxyCodeLine{02991\ \ \ \ \ \ \ \ \ vst1q\_u32(\textcolor{keyword}{reinterpret\_cast<}uint32\_t*\textcolor{keyword}{>}(\&this-\/>\_\_data\_[\_\_i]),\ xor\_vec);}
\DoxyCodeLine{02992\ \ \ \ \ \}}
\DoxyCodeLine{02993\ }
\DoxyCodeLine{02994\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ \_\_i\ =\ simd\_end;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{02995\ \ \ \ \ \{}
\DoxyCodeLine{02996\ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i]\ \string^=\ (\_\_other[\_\_i]);}
\DoxyCodeLine{02997\ \ \ \ \ \}}
\DoxyCodeLine{02998\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{02999\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{03000\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{03001\ \ \ \ \ \{}
\DoxyCodeLine{03002\ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i]\ \string^=\ \_\_other[\_\_i];}
\DoxyCodeLine{03003\ \ \ \ \ \}}
\DoxyCodeLine{03004\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03005\ \}}
\DoxyCodeLine{03006\ }
\DoxyCodeLine{03007\ }
\DoxyCodeLine{03008\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{03009\ \mbox{\hyperlink{classtensor}{tensor<bool>}}\ \mbox{\hyperlink{classtensor_a96c722c8d9061c254da18c193a158014}{tensor<\_Tp>::logical\_not}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{03010\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(*this).\mbox{\hyperlink{classtensor_ac57983dd6df8f7ca1928e163617e3f39}{logical\_not\_}}();}
\DoxyCodeLine{03011\ \}}
\DoxyCodeLine{03012\ }
\DoxyCodeLine{03013\ }
\DoxyCodeLine{03014\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{03015\ \mbox{\hyperlink{classtensor}{tensor<bool>}}\ \mbox{\hyperlink{classtensor_a92e2e2c55765f5b3f64de8f105c0d1a5}{tensor<\_Tp>::logical\_or}}(\textcolor{keyword}{const}\ value\_type\ \_\_val)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{03016\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(*this).\mbox{\hyperlink{classtensor_a48821b85b60d6c1f0be8e42b9a66d788}{logical\_or\_}}(\_\_val);}
\DoxyCodeLine{03017\ \}}
\DoxyCodeLine{03018\ }
\DoxyCodeLine{03019\ }
\DoxyCodeLine{03020\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{03021\ \mbox{\hyperlink{classtensor}{tensor<bool>}}\ \mbox{\hyperlink{classtensor_a92e2e2c55765f5b3f64de8f105c0d1a5}{tensor<\_Tp>::logical\_or}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\&\ \_\_other)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{03022\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(*this).\mbox{\hyperlink{classtensor_a48821b85b60d6c1f0be8e42b9a66d788}{logical\_or\_}}(\_\_other);}
\DoxyCodeLine{03023\ \}}
\DoxyCodeLine{03024\ }
\DoxyCodeLine{03025\ }
\DoxyCodeLine{03026\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{03027\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor_a3a5c80da988c106ff3162d7b97c5a724}{tensor<\_Tp>::logical\_xor}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{03028\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(*this).\mbox{\hyperlink{classtensor_a09f18e7b94ea88dc3138b147cba926c2}{logical\_xor\_}}(\_\_other);}
\DoxyCodeLine{03029\ \}}
\DoxyCodeLine{03030\ }
\DoxyCodeLine{03031\ }
\DoxyCodeLine{03032\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{03033\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor_a3a5c80da988c106ff3162d7b97c5a724}{tensor<\_Tp>::logical\_xor}}(\textcolor{keyword}{const}\ value\_type\ \_\_val)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{03034\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(*this).\mbox{\hyperlink{classtensor_a09f18e7b94ea88dc3138b147cba926c2}{logical\_xor\_}}(\_\_val);}
\DoxyCodeLine{03035\ \}}
\DoxyCodeLine{03036\ }
\DoxyCodeLine{03037\ }
\DoxyCodeLine{03038\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{03039\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor_a77404d7822e3893f6336345c3165874b}{tensor<\_Tp>::logical\_and}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{03040\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(*this).\mbox{\hyperlink{classtensor_a6372653f612ae3268766a0b6a6e9ca30}{logical\_and\_}}(\_\_other);}
\DoxyCodeLine{03041\ \}}
\DoxyCodeLine{03042\ }
\DoxyCodeLine{03043\ }
\DoxyCodeLine{03044\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{03045\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor_a77404d7822e3893f6336345c3165874b}{tensor<\_Tp>::logical\_and}}(\textcolor{keyword}{const}\ value\_type\ \_\_val)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{03046\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(*this).\mbox{\hyperlink{classtensor_a6372653f612ae3268766a0b6a6e9ca30}{logical\_and\_}}(\_\_val);}
\DoxyCodeLine{03047\ \}}
\DoxyCodeLine{03048\ }
\DoxyCodeLine{03049\ }
\DoxyCodeLine{03050\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{03051\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_a48821b85b60d6c1f0be8e42b9a66d788}{tensor<\_Tp>::logical\_or\_}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\&\ \_\_other)\ \{}
\DoxyCodeLine{03052\ \ \ \ \ \textcolor{keywordflow}{if}\ (!std::is\_integral<value\_type>::value\ \&\&\ !std::is\_same<value\_type,\ bool>::value)}
\DoxyCodeLine{03053\ \ \ \ \ \{}
\DoxyCodeLine{03054\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(}
\DoxyCodeLine{03055\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Cannot\ get\ the\ element\ wise\ not\ of\ non-\/integral\ and\ non-\/boolean\ value"{}});}
\DoxyCodeLine{03056\ \ \ \ \ \}}
\DoxyCodeLine{03057\ }
\DoxyCodeLine{03058\ \ \ \ \ assert(this-\/>\_\_shape\_\ ==\ \_\_other.\mbox{\hyperlink{classtensor_a33e40f89c3247e27e6bd03a992d73868}{shape}}());}
\DoxyCodeLine{03059\ \textcolor{preprocessor}{\#ifdef\ \_\_ARM\_NEON}}
\DoxyCodeLine{03060\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ simd\_size\ =\ 4;}
\DoxyCodeLine{03061\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ simd\_end\ \ =\ this-\/>\_\_data\_.size()\ -\/\ (this-\/>\_\_data\_.size()\ \%\ simd\_size);}
\DoxyCodeLine{03062\ }
\DoxyCodeLine{03063\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;\ \_\_i\ <\ simd\_end;\ \_\_i\ +=\ simd\_size)}
\DoxyCodeLine{03064\ \ \ \ \ \{}
\DoxyCodeLine{03065\ \ \ \ \ \ \ \ \ uint32x4\_t\ data\_vec\ \ =\ vld1q\_u32(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }uint32\_t*\textcolor{keyword}{>}(\&this-\/>\_\_data\_[\_\_i]));}
\DoxyCodeLine{03066\ \ \ \ \ \ \ \ \ uint32x4\_t\ other\_vec\ =\ vld1q\_u32(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }uint32\_t*\textcolor{keyword}{>}(\&this-\/>\_\_other[\_\_i]));}
\DoxyCodeLine{03067\ }
\DoxyCodeLine{03068\ \ \ \ \ \ \ \ \ uint32x4\_t\ or\_vec\ =\ vornq\_u32(data\_vec,\ other\_vec);}
\DoxyCodeLine{03069\ }
\DoxyCodeLine{03070\ \ \ \ \ \ \ \ \ vst1q\_u32(\textcolor{keyword}{reinterpret\_cast<}uint32\_t*\textcolor{keyword}{>}(\&this-\/>\_\_data\_[\_\_i]),\ or\_vec);}
\DoxyCodeLine{03071\ \ \ \ \ \}}
\DoxyCodeLine{03072\ }
\DoxyCodeLine{03073\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ \_\_i\ =\ simd\_end;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{03074\ \ \ \ \ \{}
\DoxyCodeLine{03075\ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i]\ =\ (this-\/>\_\_data\_[\_\_i]\ ||\ \_\_other[\_\_i]);}
\DoxyCodeLine{03076\ \ \ \ \ \}}
\DoxyCodeLine{03077\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{03078\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{03079\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{03080\ \ \ \ \ \{}
\DoxyCodeLine{03081\ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i]\ =\ (this-\/>\_\_data\_[\_\_i]\ ||\ \_\_other[\_\_i]);}
\DoxyCodeLine{03082\ \ \ \ \ \}}
\DoxyCodeLine{03083\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03084\ \}}
\DoxyCodeLine{03085\ }
\DoxyCodeLine{03086\ }
\DoxyCodeLine{03087\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{03088\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_a09f18e7b94ea88dc3138b147cba926c2}{tensor<\_Tp>::logical\_xor\_}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\&\ \_\_other)\ \{}
\DoxyCodeLine{03089\ \ \ \ \ \textcolor{keywordflow}{if}\ (!std::is\_integral<value\_type>::value\ \&\&\ !std::is\_same<value\_type,\ bool>::value)}
\DoxyCodeLine{03090\ \ \ \ \ \{}
\DoxyCodeLine{03091\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(}
\DoxyCodeLine{03092\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Cannot\ get\ the\ element\ wise\ xor\ of\ non-\/integral\ and\ non-\/boolean\ value"{}});}
\DoxyCodeLine{03093\ \ \ \ \ \}}
\DoxyCodeLine{03094\ }
\DoxyCodeLine{03095\ \ \ \ \ assert(this-\/>\_\_shape\_\ ==\ \_\_other.\mbox{\hyperlink{classtensor_a33e40f89c3247e27e6bd03a992d73868}{shape}}());}
\DoxyCodeLine{03096\ \textcolor{preprocessor}{\#ifdef\ \_\_ARM\_NEON}}
\DoxyCodeLine{03097\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ simd\_size\ =\ 4;}
\DoxyCodeLine{03098\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ simd\_end\ \ =\ this-\/>\_\_data\_.size()\ -\/\ (this-\/>\_\_data\_.size()\ \%\ simd\_size);}
\DoxyCodeLine{03099\ }
\DoxyCodeLine{03100\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;\ \_\_i\ <\ simd\_end;\ \_\_i\ +=\ simd\_size)}
\DoxyCodeLine{03101\ \ \ \ \ \{}
\DoxyCodeLine{03102\ \ \ \ \ \ \ \ \ uint32x4\_t\ data\_vec\ \ =\ vld1q\_u32(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }uint32\_t*\textcolor{keyword}{>}(\&this-\/>\_\_data\_[\_\_i]));}
\DoxyCodeLine{03103\ \ \ \ \ \ \ \ \ uint32x4\_t\ other\_vec\ =\ vld1q\_u32(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }uint32\_t*\textcolor{keyword}{>}(\&\_\_other[\_\_i]));}
\DoxyCodeLine{03104\ }
\DoxyCodeLine{03105\ \ \ \ \ \ \ \ \ uint32x4\_t\ xor\_vec\ =\ veorq\_u32(data\_vec,\ other\_vec);}
\DoxyCodeLine{03106\ }
\DoxyCodeLine{03107\ \ \ \ \ \ \ \ \ vst1q\_u32(\textcolor{keyword}{reinterpret\_cast<}uint32\_t*\textcolor{keyword}{>}(\&this-\/>\_\_data\_[\_\_i]),\ xor\_vec);}
\DoxyCodeLine{03108\ \ \ \ \ \}}
\DoxyCodeLine{03109\ }
\DoxyCodeLine{03110\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ \_\_i\ =\ simd\_end;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{03111\ \ \ \ \ \{}
\DoxyCodeLine{03112\ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i]\ =\ (this-\/>\_\_data\_[\_\_i]\ \&\&\ \_\_other[\_\_i]);}
\DoxyCodeLine{03113\ \ \ \ \ \}}
\DoxyCodeLine{03114\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{03115\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{03116\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{03117\ \ \ \ \ \{}
\DoxyCodeLine{03118\ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i]\ =\ (this-\/>\_\_data\_[\_\_i]\ \string^\ \_\_other[\_\_i]);}
\DoxyCodeLine{03119\ \ \ \ \ \}}
\DoxyCodeLine{03120\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03121\ \}}
\DoxyCodeLine{03122\ }
\DoxyCodeLine{03123\ }
\DoxyCodeLine{03124\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{03125\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_a6372653f612ae3268766a0b6a6e9ca30}{tensor<\_Tp>::logical\_and\_}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\&\ \_\_other)\ \{}
\DoxyCodeLine{03126\ \ \ \ \ \textcolor{keywordflow}{if}\ (!std::is\_integral<value\_type>::value\ \&\&\ !std::is\_same<value\_type,\ bool>::value)}
\DoxyCodeLine{03127\ \ \ \ \ \{}
\DoxyCodeLine{03128\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(}
\DoxyCodeLine{03129\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Cannot\ get\ the\ element-\/wise\ and\ of\ non-\/integral\ and\ non-\/boolean\ value"{}});}
\DoxyCodeLine{03130\ \ \ \ \ \}}
\DoxyCodeLine{03131\ }
\DoxyCodeLine{03132\ \ \ \ \ assert(this-\/>\_\_shape\_\ ==\ \_\_other.\mbox{\hyperlink{classtensor_a33e40f89c3247e27e6bd03a992d73868}{shape}}());}
\DoxyCodeLine{03133\ }
\DoxyCodeLine{03134\ \textcolor{preprocessor}{\#ifdef\ \_\_ARM\_NEON}}
\DoxyCodeLine{03135\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ simd\_size\ =\ 4;}
\DoxyCodeLine{03136\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ simd\_end\ \ =\ this-\/>\_\_data\_.size()\ -\/\ (this-\/>\_\_data\_.size()\ \%\ simd\_size);}
\DoxyCodeLine{03137\ }
\DoxyCodeLine{03138\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;\ \_\_i\ <\ simd\_end;\ \_\_i\ +=\ simd\_size)}
\DoxyCodeLine{03139\ \ \ \ \ \{}
\DoxyCodeLine{03140\ \ \ \ \ \ \ \ \ uint32x4\_t\ data\_vec\ \ =\ vld1q\_u32(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }uint32\_t*\textcolor{keyword}{>}(\&this-\/>\_\_data\_[\_\_i]));}
\DoxyCodeLine{03141\ \ \ \ \ \ \ \ \ uint32x4\_t\ other\_vec\ =\ vld1q\_u32(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }uint32\_t*\textcolor{keyword}{>}(\&\_\_other[\_\_i]));}
\DoxyCodeLine{03142\ }
\DoxyCodeLine{03143\ \ \ \ \ \ \ \ \ uint32x4\_t\ and\_vec\ =\ vandq\_u32(data\_vec,\ other\_vec);}
\DoxyCodeLine{03144\ }
\DoxyCodeLine{03145\ \ \ \ \ \ \ \ \ vst1q\_u32(\textcolor{keyword}{reinterpret\_cast<}uint32\_t*\textcolor{keyword}{>}(\&this-\/>\_\_data\_[\_\_i]),\ and\_vec);}
\DoxyCodeLine{03146\ \ \ \ \ \}}
\DoxyCodeLine{03147\ }
\DoxyCodeLine{03148\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ \_\_i\ =\ simd\_end;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{03149\ \ \ \ \ \{}
\DoxyCodeLine{03150\ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i]\ =\ (this-\/>\_\_data\_[\_\_i]\ \&\&\ \_\_other[\_\_i]);}
\DoxyCodeLine{03151\ \ \ \ \ \}}
\DoxyCodeLine{03152\ }
\DoxyCodeLine{03153\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{03154\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{03155\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{03156\ \ \ \ \ \{}
\DoxyCodeLine{03157\ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i]\ =\ (this-\/>\_\_data\_[\_\_i]\ \&\&\ \_\_other[\_\_i]);}
\DoxyCodeLine{03158\ \ \ \ \ \}}
\DoxyCodeLine{03159\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03160\ \}}
\DoxyCodeLine{03161\ }
\DoxyCodeLine{03162\ }
\DoxyCodeLine{03163\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{03164\ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{classtensor_ad42a4223b51afd28b81182034b0abe1d}{tensor<\_Tp>::mean}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{03165\ \ \ \ \ this-\/>\_\_check\_is\_integral\_type(\textcolor{stringliteral}{"{}input\ must\ be\ of\ integral\ type\ to\ get\ the\ mean\ average"{}});}
\DoxyCodeLine{03166\ \ \ \ \ \textcolor{keywordtype}{double}\ \_\_m\ =\ 0.0f;}
\DoxyCodeLine{03167\ }
\DoxyCodeLine{03168\ \ \ \ \ \textcolor{keywordflow}{if}\ (this-\/>empty())}
\DoxyCodeLine{03169\ \ \ \ \ \{}
\DoxyCodeLine{03170\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0.0f;}
\DoxyCodeLine{03171\ \ \ \ \ \}}
\DoxyCodeLine{03172\ }
\DoxyCodeLine{03173\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{03174\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{03175\ \ \ \ \ \{}
\DoxyCodeLine{03176\ \ \ \ \ \ \ \ \ \_\_m\ +=\ this-\/>\_\_data\_[\_\_i];}
\DoxyCodeLine{03177\ \ \ \ \ \}}
\DoxyCodeLine{03178\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(\_\_m\ /\ double(this-\/>\_\_data\_.size()));}
\DoxyCodeLine{03179\ \}}
\DoxyCodeLine{03180\ }
\DoxyCodeLine{03181\ }
\DoxyCodeLine{03182\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{03183\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor_a78676cccd7482013cc9ff4e2e7e409de}{tensor<\_Tp>::pow}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{03184\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(*this).\mbox{\hyperlink{classtensor_a9948794b20f5511a51072ec98ecc2c0e}{pow\_}}(\_\_other);}
\DoxyCodeLine{03185\ \}}
\DoxyCodeLine{03186\ }
\DoxyCodeLine{03187\ }
\DoxyCodeLine{03188\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{03189\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor_a78676cccd7482013cc9ff4e2e7e409de}{tensor<\_Tp>::pow}}(\textcolor{keyword}{const}\ value\_type\ \_\_val)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{03190\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(*this).\mbox{\hyperlink{classtensor_a9948794b20f5511a51072ec98ecc2c0e}{pow\_}}(\_\_val);}
\DoxyCodeLine{03191\ \}}
\DoxyCodeLine{03192\ }
\DoxyCodeLine{03193\ }
\DoxyCodeLine{03194\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{03195\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_a9948794b20f5511a51072ec98ecc2c0e}{tensor<\_Tp>::pow\_}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{03196\ \ \ \ \ this-\/>\_\_check\_is\_integral\_type(\textcolor{stringliteral}{"{}cannot\ get\ the\ power\ of\ a\ non\ integral\ value"{}});}
\DoxyCodeLine{03197\ }
\DoxyCodeLine{03198\ \ \ \ \ assert(this-\/>\_\_shape\_\ ==\ \_\_other.\mbox{\hyperlink{classtensor_a33e40f89c3247e27e6bd03a992d73868}{shape}}()\ \&\&\ this-\/>\_\_data\_.size()\ ==\ \_\_other.\mbox{\hyperlink{classtensor_a119a24ebef8a13cd8fd262a1c00b48b7}{size}}(0));}
\DoxyCodeLine{03199\ \textcolor{preprocessor}{\#ifdef\ \_\_ARM\_NEON}}
\DoxyCodeLine{03200\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ simd\_size\ =\ 4;}
\DoxyCodeLine{03201\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ simd\_end\ \ =\ this-\/>\_\_data\_.size()\ -\/\ (this-\/>\_\_data\_.size()\ \%\ simd\_size);}
\DoxyCodeLine{03202\ }
\DoxyCodeLine{03203\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;\ \_\_i\ <\ simd\_end;\ \_\_i\ +=\ simd\_size)}
\DoxyCodeLine{03204\ \ \ \ \ \{}
\DoxyCodeLine{03205\ \ \ \ \ \ \ \ \ float32x4\_t\ base\_vec\ =\ vld1q\float32_t(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }\textcolor{keywordtype}{float}*\textcolor{keyword}{>}(\&this-\/>\_\_data\_[\_\_i]));}
\DoxyCodeLine{03206\ \ \ \ \ \ \ \ \ float32x4\_t\ exp\_vec\ \ =\ vld1q\float32_t(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }\textcolor{keywordtype}{float}*\textcolor{keyword}{>}(\&\_\_other[\_\_i]));}
\DoxyCodeLine{03207\ }
\DoxyCodeLine{03208\ \ \ \ \ \ \ \ \ float32x4\_t\ result\_vec\ =\ \{}
\DoxyCodeLine{03209\ \ \ \ \ \ \ \ \ \ \ \ \ std::pow(vgetq\_lane\float32_t(base\_vec,\ 0),\ vgetq\_lane\float32_t(exp\_vec,\ 0)),}
\DoxyCodeLine{03210\ \ \ \ \ \ \ \ \ \ \ \ \ std::pow(vgetq\_lane\float32_t(base\_vec,\ 1),\ vgetq\_lane\float32_t(exp\_vec,\ 1)),}
\DoxyCodeLine{03211\ \ \ \ \ \ \ \ \ \ \ \ \ std::pow(vgetq\_lane\float32_t(base\_vec,\ 2),\ vgetq\_lane\float32_t(exp\_vec,\ 2)),}
\DoxyCodeLine{03212\ \ \ \ \ \ \ \ \ \ \ \ \ std::pow(vgetq\_lane\float32_t(base\_vec,\ 3),\ vgetq\_lane\float32_t(exp\_vec,\ 3))\};}
\DoxyCodeLine{03213\ }
\DoxyCodeLine{03214\ \ \ \ \ \ \ \ \ vst1q\float32_t(\&this-\/>\_\_data\_[\_\_i],\ result\_vec);}
\DoxyCodeLine{03215\ \ \ \ \ \}}
\DoxyCodeLine{03216\ }
\DoxyCodeLine{03217\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ \_\_i\ =\ simd\_end;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{03218\ \ \ \ \ \{}
\DoxyCodeLine{03219\ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i]\ =\ \textcolor{keyword}{static\_cast<}value\_type\textcolor{keyword}{>}(}
\DoxyCodeLine{03220\ \ \ \ \ \ \ \ \ \ \ \ \ std::pow(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(this-\/>\_\_data\_[\_\_i]),\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(\_\_other[\_\_i])));}
\DoxyCodeLine{03221\ \ \ \ \ \}}
\DoxyCodeLine{03222\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{03223\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{03224\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{03225\ \ \ \ \ \{}
\DoxyCodeLine{03226\ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i]\ =}
\DoxyCodeLine{03227\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{static\_cast<}value\_type\textcolor{keyword}{>}(std::pow(\textcolor{keywordtype}{double}(this-\/>\_\_data\_[\_\_i]),\ \textcolor{keywordtype}{double}(\_\_other[\_\_i])));}
\DoxyCodeLine{03228\ \ \ \ \ \}}
\DoxyCodeLine{03229\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03230\ \}}
\DoxyCodeLine{03231\ }
\DoxyCodeLine{03232\ }
\DoxyCodeLine{03233\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{03234\ \mbox{\hyperlink{classtensor}{tensor<bool>}}\ \mbox{\hyperlink{classtensor_a5c8e449d77ffc41ca8528e5c5238efc0}{tensor<\_Tp>::less\_equal}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{03235\ \ \ \ \ \textcolor{keywordflow}{if}\ (!std::is\_integral<value\_type>::value\ \&\&\ !std::is\_scalar<value\_type>::value)}
\DoxyCodeLine{03236\ \ \ \ \ \{}
\DoxyCodeLine{03237\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(\textcolor{stringliteral}{"{}Cannot\ compare\ non-\/integral\ or\ scalar\ value"{}});}
\DoxyCodeLine{03238\ \ \ \ \ \}}
\DoxyCodeLine{03239\ }
\DoxyCodeLine{03240\ \ \ \ \ assert(this-\/>\_\_shape\_\ ==\ \_\_other.\mbox{\hyperlink{classtensor_a33e40f89c3247e27e6bd03a992d73868}{shape}}()\ \&\&\ this-\/>size(0)\ ==\ \_\_other.\mbox{\hyperlink{classtensor_a119a24ebef8a13cd8fd262a1c00b48b7}{size}}(0));}
\DoxyCodeLine{03241\ }
\DoxyCodeLine{03242\ \ \ \ \ std::vector<bool>\ \_\_ret(this-\/>\_\_data\_.size());}
\DoxyCodeLine{03243\ \textcolor{preprocessor}{\#ifdef\ \_\_ARM\_NEON}}
\DoxyCodeLine{03244\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_same\_v<\_Tp,\ float>)}
\DoxyCodeLine{03245\ \ \ \ \ \{}
\DoxyCodeLine{03246\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ vec\_size\ \ \ \ =\ 4;}
\DoxyCodeLine{03247\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ num\_vectors\ =\ this-\/>\_\_data\_.size()\ /\ vec\_size;}
\DoxyCodeLine{03248\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ remaining\ \ \ =\ this-\/>\_\_data\_.size()\ \%\ vec\_size;}
\DoxyCodeLine{03249\ }
\DoxyCodeLine{03250\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{03251\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ num\_vectors\ *\ vec\_size;\ \_\_i\ +=\ vec\_size)}
\DoxyCodeLine{03252\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03253\ \ \ \ \ \ \ \ \ \ \ \ \ float32x4\_t\ data\_vec1\ \ =\ vld1q\float32_t(\&this-\/>\_\_data\_[\_\_i]);}
\DoxyCodeLine{03254\ \ \ \ \ \ \ \ \ \ \ \ \ float32x4\_t\ data\_vec2\ \ =\ vld1q\float32_t(\&\_\_other.\_\_data\_[\_\_i]);}
\DoxyCodeLine{03255\ \ \ \ \ \ \ \ \ \ \ \ \ uint32x4\_t\ \ cmp\_result\ =\ vcleq\float32_t(data\_vec1,\ data\_vec2);}
\DoxyCodeLine{03256\ \ \ \ \ \ \ \ \ \ \ \ \ uint32\_t\ \ \ \ mask\ \ \ \ \ \ \ =\ vaddvq\_u32(cmp\_result);}
\DoxyCodeLine{03257\ }
\DoxyCodeLine{03258\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_i]\ \ \ \ \ =\ mask\ \&\ 1;}
\DoxyCodeLine{03259\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_i\ +\ 1]\ =\ (mask\ >>\ 8)\ \&\ 1;}
\DoxyCodeLine{03260\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_i\ +\ 2]\ =\ (mask\ >>\ 16)\ \&\ 1;}
\DoxyCodeLine{03261\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_i\ +\ 3]\ =\ (mask\ >>\ 24)\ \&\ 1;}
\DoxyCodeLine{03262\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03263\ }
\DoxyCodeLine{03264\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{03265\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03266\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_i]\ =\ (this-\/>\_\_data\_[\_\_i]\ <=\ \_\_other.\_\_data\_[\_\_i]);}
\DoxyCodeLine{03267\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03268\ \ \ \ \ \}}
\DoxyCodeLine{03269\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{03270\ \ \ \ \ \{}
\DoxyCodeLine{03271\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{03272\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{03273\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03274\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_i]\ =\ (this-\/>\_\_data\_[\_\_i]\ <=\ \_\_other.\_\_data\_[\_\_i]);}
\DoxyCodeLine{03275\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03276\ \ \ \ \ \}}
\DoxyCodeLine{03277\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{03278\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{03279\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{03280\ \ \ \ \ \{}
\DoxyCodeLine{03281\ \ \ \ \ \ \ \ \ \_\_ret[\_\_i]\ =\ (this-\/>\_\_data\_[\_\_i]\ <=\ \_\_other[\_\_i])\ ?\ \textcolor{keyword}{true}\ :\ false;}
\DoxyCodeLine{03282\ \ \ \ \ \}}
\DoxyCodeLine{03283\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03284\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classtensor}{tensor<bool>}}(\_\_ret,\ this-\/>\_\_shape\_);}
\DoxyCodeLine{03285\ \}}
\DoxyCodeLine{03286\ }
\DoxyCodeLine{03287\ }
\DoxyCodeLine{03288\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{03289\ \mbox{\hyperlink{classtensor}{tensor<bool>}}\ \mbox{\hyperlink{classtensor_a5c8e449d77ffc41ca8528e5c5238efc0}{tensor<\_Tp>::less\_equal}}(\textcolor{keyword}{const}\ value\_type\ \_\_val)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{03290\ \ \ \ \ \textcolor{keywordflow}{if}\ (!std::is\_integral<value\_type>::value\ \&\&\ !std::is\_scalar<value\_type>::value)}
\DoxyCodeLine{03291\ \ \ \ \ \{}
\DoxyCodeLine{03292\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(\textcolor{stringliteral}{"{}Cannot\ compare\ non-\/integral\ or\ scalar\ value"{}});}
\DoxyCodeLine{03293\ \ \ \ \ \}}
\DoxyCodeLine{03294\ }
\DoxyCodeLine{03295\ \ \ \ \ std::vector<bool>\ \_\_ret(this-\/>\_\_data\_.size());}
\DoxyCodeLine{03296\ }
\DoxyCodeLine{03297\ \textcolor{preprocessor}{\#ifdef\ \_\_ARM\_NEON}}
\DoxyCodeLine{03298\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_same\_v<\_Tp,\ float>)}
\DoxyCodeLine{03299\ \ \ \ \ \{}
\DoxyCodeLine{03300\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ vec\_size\ \ \ \ =\ 4;}
\DoxyCodeLine{03301\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ num\_vectors\ =\ this-\/>\_\_data\_.size()\ /\ vec\_size;}
\DoxyCodeLine{03302\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ remaining\ \ \ =\ this-\/>\_\_data\_.size()\ \%\ vec\_size;}
\DoxyCodeLine{03303\ }
\DoxyCodeLine{03304\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{03305\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ num\_vectors\ *\ vec\_size;\ \_\_i\ +=\ vec\_size)}
\DoxyCodeLine{03306\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03307\ \ \ \ \ \ \ \ \ \ \ \ \ float32x4\_t\ data\_vec\ \ \ =\ vld1q\float32_t(\&this-\/>\_\_data\_[\_\_i]);}
\DoxyCodeLine{03308\ \ \ \ \ \ \ \ \ \ \ \ \ float32x4\_t\ value\_vec\ \ \ \ =\ vdupq\_n\float32_t(\_\_val);}
\DoxyCodeLine{03309\ \ \ \ \ \ \ \ \ \ \ \ \ uint32x4\_t\ \ cmp\_result\ =\ vcleq\float32_t(data\_vec,\ value\_vec);}
\DoxyCodeLine{03310\ \ \ \ \ \ \ \ \ \ \ \ \ uint32\_t\ \ \ \ mask\ \ \ \ \ \ \ =\ vaddvq\_u32(cmp\_result);}
\DoxyCodeLine{03311\ }
\DoxyCodeLine{03312\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_i]\ \ \ \ \ =\ mask\ \&\ 1;}
\DoxyCodeLine{03313\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_i\ +\ 1]\ =\ (mask\ >>\ 8)\ \&\ 1;}
\DoxyCodeLine{03314\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_i\ +\ 2]\ =\ (mask\ >>\ 16)\ \&\ 1;}
\DoxyCodeLine{03315\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_i\ +\ 3]\ =\ (mask\ >>\ 24)\ \&\ 1;}
\DoxyCodeLine{03316\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03317\ }
\DoxyCodeLine{03318\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{03319\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03320\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_i]\ =\ (this-\/>\_\_data\_[\_\_i]\ <=\ \_\_val);}
\DoxyCodeLine{03321\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03322\ \ \ \ \ \}}
\DoxyCodeLine{03323\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{03324\ \ \ \ \ \{}
\DoxyCodeLine{03325\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{03326\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{03327\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03328\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_i]\ =\ (this-\/>\_\_data\_[\_\_i]\ <=\ \_\_val);}
\DoxyCodeLine{03329\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03330\ \ \ \ \ \}}
\DoxyCodeLine{03331\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{03332\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{03333\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{03334\ \ \ \ \ \{}
\DoxyCodeLine{03335\ \ \ \ \ \ \ \ \ \_\_ret[\_\_i]\ =\ (this-\/>\_\_data\_[\_\_i]\ <=\ \_\_val)\ ?\ \textcolor{keyword}{true}\ :\ false;}
\DoxyCodeLine{03336\ \ \ \ \ \}}
\DoxyCodeLine{03337\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03338\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classtensor}{tensor<bool>}}(\_\_ret,\ this-\/>\_\_shape\_);}
\DoxyCodeLine{03339\ \}}
\DoxyCodeLine{03340\ }
\DoxyCodeLine{03341\ }
\DoxyCodeLine{03342\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{03343\ \mbox{\hyperlink{classtensor}{tensor<bool>}}\ \mbox{\hyperlink{classtensor_a666f0d3aa2b9769cf4fcc7614addefd7}{tensor<\_Tp>::greater\_equal}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{03344\ \ \ \ \ \textcolor{keywordflow}{if}\ (!std::is\_integral<value\_type>::value\ \&\&\ !std::is\_scalar<value\_type>::value)}
\DoxyCodeLine{03345\ \ \ \ \ \{}
\DoxyCodeLine{03346\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(\textcolor{stringliteral}{"{}Cannot\ compare\ non-\/integral\ or\ scalar\ value"{}});}
\DoxyCodeLine{03347\ \ \ \ \ \}}
\DoxyCodeLine{03348\ }
\DoxyCodeLine{03349\ \ \ \ \ assert(this-\/>\_\_shape\_\ ==\ \_\_other.\mbox{\hyperlink{classtensor_a33e40f89c3247e27e6bd03a992d73868}{shape}}()\ \&\&\ this-\/>size(0)\ ==\ \_\_other.\mbox{\hyperlink{classtensor_a119a24ebef8a13cd8fd262a1c00b48b7}{size}}(0));}
\DoxyCodeLine{03350\ }
\DoxyCodeLine{03351\ \ \ \ \ std::vector<bool>\ \_\_ret(this-\/>\_\_data\_.size());}
\DoxyCodeLine{03352\ \textcolor{preprocessor}{\#ifdef\ \_\_ARM\_NEON}}
\DoxyCodeLine{03353\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_same\_v<\_Tp,\ float>)}
\DoxyCodeLine{03354\ \ \ \ \ \{}
\DoxyCodeLine{03355\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ vec\_size\ \ \ \ =\ 4;}
\DoxyCodeLine{03356\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ num\_vectors\ =\ this-\/>\_\_data\_.size()\ /\ vec\_size;}
\DoxyCodeLine{03357\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ remaining\ \ \ =\ this-\/>\_\_data\_.size()\ \%\ vec\_size;}
\DoxyCodeLine{03358\ }
\DoxyCodeLine{03359\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{03360\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ num\_vectors\ *\ vec\_size;\ \_\_i\ +=\ vec\_size)}
\DoxyCodeLine{03361\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03362\ \ \ \ \ \ \ \ \ \ \ \ \ float32x4\_t\ data\_vec1\ \ =\ vld1q\float32_t(\&this-\/>\_\_data\_[\_\_i]);}
\DoxyCodeLine{03363\ \ \ \ \ \ \ \ \ \ \ \ \ float32x4\_t\ data\_vec2\ \ =\ vld1q\float32_t(\&\_\_other.\_\_data\_[\_\_i]);}
\DoxyCodeLine{03364\ \ \ \ \ \ \ \ \ \ \ \ \ uint32x4\_t\ \ cmp\_result\ =\ vcgeq\float32_t(data\_vec1,\ data\_vec2);}
\DoxyCodeLine{03365\ \ \ \ \ \ \ \ \ \ \ \ \ uint32\_t\ \ \ \ mask\ \ \ \ \ \ \ =\ vaddvq\_u32(cmp\_result);}
\DoxyCodeLine{03366\ }
\DoxyCodeLine{03367\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_i]\ \ \ \ \ =\ mask\ \&\ 1;}
\DoxyCodeLine{03368\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_i\ +\ 1]\ =\ (mask\ >>\ 8)\ \&\ 1;}
\DoxyCodeLine{03369\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_i\ +\ 2]\ =\ (mask\ >>\ 16)\ \&\ 1;}
\DoxyCodeLine{03370\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_i\ +\ 3]\ =\ (mask\ >>\ 24)\ \&\ 1;}
\DoxyCodeLine{03371\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03372\ }
\DoxyCodeLine{03373\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{03374\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03375\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_i]\ =\ (this-\/>\_\_data\_[\_\_i]\ >=\ \_\_other.\_\_data\_[\_\_i]);}
\DoxyCodeLine{03376\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03377\ \ \ \ \ \}}
\DoxyCodeLine{03378\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{03379\ \ \ \ \ \{}
\DoxyCodeLine{03380\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{03381\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{03382\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03383\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_i]\ =\ (this-\/>\_\_data\_[\_\_i]\ >=\ \_\_other.\_\_data\_[\_\_i]);}
\DoxyCodeLine{03384\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03385\ \ \ \ \ \}}
\DoxyCodeLine{03386\ }
\DoxyCodeLine{03387\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{03388\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{03389\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{03390\ \ \ \ \ \{}
\DoxyCodeLine{03391\ \ \ \ \ \ \ \ \ \_\_ret[\_\_i]\ =\ (this-\/>\_\_data\_[\_\_i]\ >=\ \_\_other[\_\_i])\ ?\ \textcolor{keyword}{true}\ :\ false;}
\DoxyCodeLine{03392\ \ \ \ \ \}}
\DoxyCodeLine{03393\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03394\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classtensor}{tensor<bool>}}(\_\_ret,\ this-\/>\_\_shape\_);}
\DoxyCodeLine{03395\ \}}
\DoxyCodeLine{03396\ }
\DoxyCodeLine{03397\ }
\DoxyCodeLine{03398\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{03399\ \mbox{\hyperlink{classtensor}{tensor<bool>}}\ \mbox{\hyperlink{classtensor_a666f0d3aa2b9769cf4fcc7614addefd7}{tensor<\_Tp>::greater\_equal}}(\textcolor{keyword}{const}\ value\_type\ \_\_val)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{03400\ \ \ \ \ \textcolor{keywordflow}{if}\ (!std::is\_integral<value\_type>::value\ \&\&\ !std::is\_scalar<value\_type>::value)}
\DoxyCodeLine{03401\ \ \ \ \ \{}
\DoxyCodeLine{03402\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(\textcolor{stringliteral}{"{}Cannot\ compare\ non-\/integral\ or\ scalar\ value"{}});}
\DoxyCodeLine{03403\ \ \ \ \ \}}
\DoxyCodeLine{03404\ }
\DoxyCodeLine{03405\ \ \ \ \ std::vector<bool>\ \_\_ret(this-\/>\_\_data\_.size());}
\DoxyCodeLine{03406\ \textcolor{preprocessor}{\#ifdef\ \_\_ARM\_NEON}}
\DoxyCodeLine{03407\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_same\_v<\_Tp,\ float>)}
\DoxyCodeLine{03408\ \ \ \ \ \{}
\DoxyCodeLine{03409\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ vec\_size\ \ \ \ =\ 4;}
\DoxyCodeLine{03410\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ num\_vectors\ =\ this-\/>\_\_data\_.size()\ /\ vec\_size;}
\DoxyCodeLine{03411\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ remaining\ \ \ =\ this-\/>\_\_data\_.size()\ \%\ vec\_size;}
\DoxyCodeLine{03412\ }
\DoxyCodeLine{03413\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \ \ \ \ \ \_\_i\ \ \ \ \ =\ 0;}
\DoxyCodeLine{03414\ \ \ \ \ \ \ \ \ float32x4\_t\ value\_vec\ =\ vdupq\_n\float32_t(\_\_val);}
\DoxyCodeLine{03415\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ num\_vectors\ *\ vec\_size;\ \_\_i\ +=\ vec\_size)}
\DoxyCodeLine{03416\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03417\ \ \ \ \ \ \ \ \ \ \ \ \ float32x4\_t\ data\_vec\ \ \ =\ vld1q\float32_t(\&this-\/>\_\_data\_[\_\_i]);}
\DoxyCodeLine{03418\ \ \ \ \ \ \ \ \ \ \ \ \ uint32x4\_t\ \ cmp\_result\ =\ vcgeq\float32_t(data\_vec,\ value\_vec);}
\DoxyCodeLine{03419\ \ \ \ \ \ \ \ \ \ \ \ \ uint32\_t\ \ \ \ mask\ \ \ \ \ \ \ =\ vaddvq\_u32(cmp\_result);}
\DoxyCodeLine{03420\ }
\DoxyCodeLine{03421\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_i]\ \ \ \ \ =\ mask\ \&\ 1;}
\DoxyCodeLine{03422\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_i\ +\ 1]\ =\ (mask\ >>\ 8)\ \&\ 1;}
\DoxyCodeLine{03423\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_i\ +\ 2]\ =\ (mask\ >>\ 16)\ \&\ 1;}
\DoxyCodeLine{03424\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_i\ +\ 3]\ =\ (mask\ >>\ 24)\ \&\ 1;}
\DoxyCodeLine{03425\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03426\ }
\DoxyCodeLine{03427\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{03428\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03429\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_i]\ =\ (this-\/>\_\_data\_[\_\_i]\ >=\ \_\_val);}
\DoxyCodeLine{03430\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03431\ \ \ \ \ \}}
\DoxyCodeLine{03432\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{03433\ \ \ \ \ \{}
\DoxyCodeLine{03434\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{03435\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{03436\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03437\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_i]\ =\ (this-\/>\_\_data\_[\_\_i]\ >=\ \_\_val);}
\DoxyCodeLine{03438\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03439\ \ \ \ \ \}}
\DoxyCodeLine{03440\ }
\DoxyCodeLine{03441\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{03442\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{03443\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{03444\ \ \ \ \ \{}
\DoxyCodeLine{03445\ \ \ \ \ \ \ \ \ \_\_ret[\_\_i]\ =\ (this-\/>\_\_data\_[\_\_i]\ >=\ \_\_val)\ ?\ \textcolor{keyword}{true}\ :\ false;}
\DoxyCodeLine{03446\ \ \ \ \ \}}
\DoxyCodeLine{03447\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03448\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classtensor}{tensor<bool>}}(\_\_ret,\ this-\/>\_\_shape\_);}
\DoxyCodeLine{03449\ \}}
\DoxyCodeLine{03450\ }
\DoxyCodeLine{03451\ }
\DoxyCodeLine{03452\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{03453\ \mbox{\hyperlink{classtensor}{tensor<bool>}}\ \mbox{\hyperlink{classtensor_a196183ab50b3d7a78de0da02e7fac6e1}{tensor<\_Tp>::equal}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{03454\ \ \ \ \ \textcolor{keywordflow}{if}\ (!std::is\_integral<value\_type>::value\ \&\&\ !std::is\_scalar<value\_type>::value)}
\DoxyCodeLine{03455\ \ \ \ \ \{}
\DoxyCodeLine{03456\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(\textcolor{stringliteral}{"{}Cannot\ compare\ non-\/integral\ or\ scalar\ value"{}});}
\DoxyCodeLine{03457\ \ \ \ \ \}}
\DoxyCodeLine{03458\ }
\DoxyCodeLine{03459\ \ \ \ \ assert(this-\/>\_\_shape\_\ ==\ \_\_other.\mbox{\hyperlink{classtensor_a33e40f89c3247e27e6bd03a992d73868}{shape}}()\ \&\&\ this-\/>size(0)\ ==\ \_\_other.\mbox{\hyperlink{classtensor_a119a24ebef8a13cd8fd262a1c00b48b7}{size}}(0));}
\DoxyCodeLine{03460\ }
\DoxyCodeLine{03461\ \ \ \ \ std::vector<bool>\ \_\_ret(this-\/>\_\_data\_.size());}
\DoxyCodeLine{03462\ \textcolor{preprocessor}{\#ifdef\ \_\_ARM\_NEON}}
\DoxyCodeLine{03463\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_same\_v<\_Tp,\ float>)}
\DoxyCodeLine{03464\ \ \ \ \ \{}
\DoxyCodeLine{03465\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ vec\_size\ \ \ \ =\ 4;}
\DoxyCodeLine{03466\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ num\_vectors\ =\ this-\/>\_\_data\_.size()\ /\ vec\_size;}
\DoxyCodeLine{03467\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ remaining\ \ \ =\ this-\/>\_\_data\_.size()\ \%\ vec\_size;}
\DoxyCodeLine{03468\ }
\DoxyCodeLine{03469\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{03470\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ num\_vectors\ *\ vec\_size;\ \_\_i\ +=\ vec\_size)}
\DoxyCodeLine{03471\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03472\ \ \ \ \ \ \ \ \ \ \ \ \ float32x4\_t\ data\_vec1\ \ =\ vld1q\float32_t(\&this-\/>\_\_data\_[\_\_i]);}
\DoxyCodeLine{03473\ \ \ \ \ \ \ \ \ \ \ \ \ float32x4\_t\ data\_vec2\ \ =\ vld1q\float32_t(\&\_\_other.\_\_data\_[\_\_i]);}
\DoxyCodeLine{03474\ \ \ \ \ \ \ \ \ \ \ \ \ uint32x4\_t\ \ cmp\_result\ =\ vceqq\float32_t(data\_vec1,\ data\_vec2);}
\DoxyCodeLine{03475\ \ \ \ \ \ \ \ \ \ \ \ \ uint32\_t\ \ \ \ mask\ \ \ \ \ \ \ =\ vaddvq\_u32(cmp\_result);}
\DoxyCodeLine{03476\ }
\DoxyCodeLine{03477\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_i]\ \ \ \ \ =\ mask\ \&\ 1;}
\DoxyCodeLine{03478\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_i\ +\ 1]\ =\ (mask\ >>\ 8)\ \&\ 1;}
\DoxyCodeLine{03479\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_i\ +\ 2]\ =\ (mask\ >>\ 16)\ \&\ 1;}
\DoxyCodeLine{03480\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_i\ +\ 3]\ =\ (mask\ >>\ 24)\ \&\ 1;}
\DoxyCodeLine{03481\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03482\ }
\DoxyCodeLine{03483\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{03484\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03485\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_i]\ =\ (this-\/>\_\_data\_[\_\_i]\ ==\ \_\_other.\_\_data\_[\_\_i]);}
\DoxyCodeLine{03486\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03487\ \ \ \ \ \}}
\DoxyCodeLine{03488\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{03489\ \ \ \ \ \{}
\DoxyCodeLine{03490\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{03491\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{03492\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03493\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_i]\ =\ (this-\/>\_\_data\_[\_\_i]\ ==\ \_\_other.\_\_data\_[\_\_i]);}
\DoxyCodeLine{03494\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03495\ \ \ \ \ \}}
\DoxyCodeLine{03496\ }
\DoxyCodeLine{03497\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{03498\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{03499\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{03500\ \ \ \ \ \{}
\DoxyCodeLine{03501\ \ \ \ \ \ \ \ \ \_\_ret[\_\_i]\ =\ (this-\/>\_\_data\_[\_\_i]\ ==\ \_\_other[\_\_i])\ ?\ \textcolor{keyword}{true}\ :\ false;}
\DoxyCodeLine{03502\ \ \ \ \ \}}
\DoxyCodeLine{03503\ }
\DoxyCodeLine{03504\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03505\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classtensor}{tensor<bool>}}(\_\_ret,\ this-\/>\_\_shape\_);}
\DoxyCodeLine{03506\ \}}
\DoxyCodeLine{03507\ }
\DoxyCodeLine{03508\ }
\DoxyCodeLine{03509\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{03510\ \mbox{\hyperlink{classtensor}{tensor<bool>}}\ \mbox{\hyperlink{classtensor_a196183ab50b3d7a78de0da02e7fac6e1}{tensor<\_Tp>::equal}}(\textcolor{keyword}{const}\ value\_type\ \_\_val)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{03511\ \ \ \ \ \textcolor{keywordflow}{if}\ (!std::is\_integral<value\_type>::value\ \&\&\ !std::is\_scalar<value\_type>::value)}
\DoxyCodeLine{03512\ \ \ \ \ \{}
\DoxyCodeLine{03513\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(\textcolor{stringliteral}{"{}Cannot\ compare\ non-\/integral\ or\ scalar\ value"{}});}
\DoxyCodeLine{03514\ \ \ \ \ \}}
\DoxyCodeLine{03515\ \ \ \ \ std::vector<bool>\ \_\_ret(this-\/>\_\_data\_.size());}
\DoxyCodeLine{03516\ \textcolor{preprocessor}{\#ifdef\ \_\_ARM\_NEON}}
\DoxyCodeLine{03517\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_same\_v<\_Tp,\ float>)}
\DoxyCodeLine{03518\ \ \ \ \ \{}
\DoxyCodeLine{03519\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ vec\_size\ \ \ \ =\ 4;}
\DoxyCodeLine{03520\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ num\_vectors\ =\ this-\/>\_\_data\_.size()\ /\ vec\_size;}
\DoxyCodeLine{03521\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ remaining\ \ \ =\ this-\/>\_\_data\_.size()\ \%\ vec\_size;}
\DoxyCodeLine{03522\ }
\DoxyCodeLine{03523\ \ \ \ \ \ \ \ \ float32x4\_t\ value\_vec\ =\ vdupq\_n\float32_t(\_\_val);}
\DoxyCodeLine{03524\ }
\DoxyCodeLine{03525\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{03526\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ num\_vectors\ *\ vec\_size;\ \_\_i\ +=\ vec\_size)}
\DoxyCodeLine{03527\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03528\ \ \ \ \ \ \ \ \ \ \ \ \ float32x4\_t\ data\_vec\ \ \ =\ vld1q\float32_t(\&this-\/>\_\_data\_[\_\_i]);}
\DoxyCodeLine{03529\ \ \ \ \ \ \ \ \ \ \ \ \ uint32x4\_t\ \ cmp\_result\ =\ vceqq\float32_t(data\_vec,\ value\_vec);}
\DoxyCodeLine{03530\ \ \ \ \ \ \ \ \ \ \ \ \ uint32\_t\ \ \ \ mask\ \ \ \ \ \ \ =\ vaddvq\_u32(cmp\_result);}
\DoxyCodeLine{03531\ }
\DoxyCodeLine{03532\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_i]\ \ \ \ \ =\ mask\ \&\ 1;}
\DoxyCodeLine{03533\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_i\ +\ 1]\ =\ (mask\ >>\ 8)\ \&\ 1;}
\DoxyCodeLine{03534\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_i\ +\ 2]\ =\ (mask\ >>\ 16)\ \&\ 1;}
\DoxyCodeLine{03535\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_i\ +\ 3]\ =\ (mask\ >>\ 24)\ \&\ 1;}
\DoxyCodeLine{03536\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03537\ }
\DoxyCodeLine{03538\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{03539\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03540\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_i]\ =\ (this-\/>\_\_data\_[\_\_i]\ ==\ \_\_val);}
\DoxyCodeLine{03541\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03542\ \ \ \ \ \}}
\DoxyCodeLine{03543\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{03544\ \ \ \ \ \{}
\DoxyCodeLine{03545\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{03546\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{03547\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03548\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_i]\ =\ (this-\/>\_\_data\_[\_\_i]\ ==\ \_\_val);}
\DoxyCodeLine{03549\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03550\ \ \ \ \ \}}
\DoxyCodeLine{03551\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{03552\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{03553\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{03554\ \ \ \ \ \{}
\DoxyCodeLine{03555\ \ \ \ \ \ \ \ \ \_\_ret[\_\_i]\ =\ (this-\/>\_\_data\_[\_\_i]\ >=\ \_\_val)\ ?\ \textcolor{keyword}{true}\ :\ false;}
\DoxyCodeLine{03556\ \ \ \ \ \}}
\DoxyCodeLine{03557\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03558\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classtensor}{tensor<bool>}}(\_\_ret,\ this-\/>\_\_shape\_);}
\DoxyCodeLine{03559\ \}}
\DoxyCodeLine{03560\ }
\DoxyCodeLine{03561\ }
\DoxyCodeLine{03562\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{03563\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor_a521640ea7d5e3549f376612ec7aaf335}{tensor<\_Tp>::sum}}(\textcolor{keyword}{const}\ index\_type\ \_\_axis)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{03564\ \ \ \ \ this-\/>\_\_check\_is\_scalar\_type(\textcolor{stringliteral}{"{}Cannot\ reduce\ tensor\ with\ non\ scalar\ type"{}});}
\DoxyCodeLine{03565\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_\_axis\ <\ 0LL\ ||\ \_\_axis\ >=\ \textcolor{keyword}{static\_cast<}index\_type\textcolor{keyword}{>}(this-\/>\_\_shape\_.size()))}
\DoxyCodeLine{03566\ \ \ \ \ \{}
\DoxyCodeLine{03567\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::invalid\_argument(\textcolor{stringliteral}{"{}Invalid\ axis\ for\ sum"{}});}
\DoxyCodeLine{03568\ \ \ \ \ \}}
\DoxyCodeLine{03569\ }
\DoxyCodeLine{03570\ \ \ \ \ shape\_type\ \_\_ret\_sh\ =\ this-\/>\_\_shape\_;}
\DoxyCodeLine{03571\ \ \ \ \ \_\_ret\_sh[\_\_axis]\ \ \ \ =\ 1LL;}
\DoxyCodeLine{03572\ }
\DoxyCodeLine{03573\ \ \ \ \ index\_type\ \_\_ret\_size\ =}
\DoxyCodeLine{03574\ \ \ \ \ \ \ \ \ std::accumulate(\_\_ret\_sh.begin(),\ \_\_ret\_sh.end(),\ 1,\ std::multiplies<index\_type>());}
\DoxyCodeLine{03575\ \ \ \ \ data\_t\ \_\_ret\_data(\_\_ret\_size,\ value\_type(0.0f));}
\DoxyCodeLine{03576\ }
\DoxyCodeLine{03577\ \textcolor{preprocessor}{\#if\ defined(\_\_ARM\_NEON)}}
\DoxyCodeLine{03578\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_same\_v<\_Tp,\ float>)}
\DoxyCodeLine{03579\ \ \ \ \ \{}
\DoxyCodeLine{03580\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ index\_type\ \_\_axis\_size\ \ =\ this-\/>\_\_shape\_[\_\_axis];}
\DoxyCodeLine{03581\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ index\_type\ \_\_outer\_size\ =\ this-\/>\_\_compute\_outer\_size(\_\_axis);}
\DoxyCodeLine{03582\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ index\_type\ \_\_inner\_size\ =\ this-\/>size(0)\ /\ (\_\_outer\_size\ *\ \_\_axis\_size);}
\DoxyCodeLine{03583\ }
\DoxyCodeLine{03584\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (index\_type\ \_\_outer\ =\ 0;\ \_\_outer\ <\ \_\_outer\_size;\ \_\_outer++)}
\DoxyCodeLine{03585\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03586\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (index\_type\ \_\_inner\ =\ 0;\ \_\_inner\ <\ \_\_inner\_size;\ \_\_inner++)}
\DoxyCodeLine{03587\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03588\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ float32x4\_t\ sum\_vec\ =\ vdupq\_n\float32_t(0.0f);}
\DoxyCodeLine{03589\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ index\_type\ \ \_\_i\ \ \ \ \ =\ \_\_outer\ *\ \_\_axis\_size\ *\ \_\_inner\_size\ +\ \_\_inner;}
\DoxyCodeLine{03590\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ index\_type\ \ \_\_j\ \ \ \ \ =\ 0;}
\DoxyCodeLine{03591\ }
\DoxyCodeLine{03592\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_j\ +\ 4\ <=\ \_\_axis\_size;\ \_\_j\ +=\ 4)}
\DoxyCodeLine{03593\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03594\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ float32x4\_t\ data\_vec\ =\ vld1q\float32_t(\&this-\/>\_\_data\_[\_\_i]);}
\DoxyCodeLine{03595\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sum\_vec\ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ vaddq\float32_t(sum\_vec,\ data\_vec);}
\DoxyCodeLine{03596\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_i\ +=\ \_\_inner\_size\ *\ 4;}
\DoxyCodeLine{03597\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03598\ }
\DoxyCodeLine{03599\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ sum\ =\ vaddvq\float32_t(sum\_vec);}
\DoxyCodeLine{03600\ }
\DoxyCodeLine{03601\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_j\ <\ \_\_axis\_size;\ \_\_j++)}
\DoxyCodeLine{03602\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03603\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sum\ +=\ this-\/>\_\_data\_[\_\_i];}
\DoxyCodeLine{03604\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_i\ +=\ \_\_inner\_size;}
\DoxyCodeLine{03605\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03606\ }
\DoxyCodeLine{03607\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret\_data[\_\_outer\ *\ \_\_inner\_size\ +\ \_\_inner]\ =\ sum;}
\DoxyCodeLine{03608\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03609\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03610\ \ \ \ \ \}}
\DoxyCodeLine{03611\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{03612\ \ \ \ \ \{}
\DoxyCodeLine{03613\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03614\ \ \ \ \ \ \ \ \ index\_type\ \_\_i\ =\ 0;}
\DoxyCodeLine{03615\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ static\_cast<index\_type>(this-\/>\_\_data\_.size());\ \_\_i++)}
\DoxyCodeLine{03616\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03617\ \ \ \ \ \ \ \ \ \ \ \ \ std::vector<index\_type>\ \_\_orig(this-\/>\_\_shape\_.size());}
\DoxyCodeLine{03618\ \ \ \ \ \ \ \ \ \ \ \ \ index\_type\ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_index\ =\ \_\_i;}
\DoxyCodeLine{03619\ }
\DoxyCodeLine{03620\ \ \ \ \ \ \ \ \ \ \ \ \ index\_type\ \_\_j\ =\ \textcolor{keyword}{static\_cast<}index\_type\textcolor{keyword}{>}(this-\/>\_\_shape\_.size())\ -\/\ 1;}
\DoxyCodeLine{03621\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_j\ >=\ 0;\ \_\_j-\/-\/)}
\DoxyCodeLine{03622\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03623\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_orig[\_\_j]\ =\ \_\_index\ \%\ this-\/>\_\_shape\_[\_\_j];}
\DoxyCodeLine{03624\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_index\ /=\ this-\/>\_\_shape\_[\_\_j];}
\DoxyCodeLine{03625\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03626\ }
\DoxyCodeLine{03627\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_orig[\_\_axis]\ \ \ \ \ \ \ \ \ =\ 0LL;}
\DoxyCodeLine{03628\ \ \ \ \ \ \ \ \ \ \ \ \ index\_type\ \_\_ret\_index\ =\ 0LL;}
\DoxyCodeLine{03629\ \ \ \ \ \ \ \ \ \ \ \ \ index\_type\ \_\_st\ \ \ \ \ \ \ \ =\ 1LL;}
\DoxyCodeLine{03630\ }
\DoxyCodeLine{03631\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\_\_j\ =\ \textcolor{keyword}{static\_cast<}index\_type\textcolor{keyword}{>}(this-\/>\_\_shape\_.size())\ -\/\ 1;\ \_\_j\ >=\ 0;\ \_\_j-\/-\/)}
\DoxyCodeLine{03632\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03633\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret\_index\ +=\ \_\_orig[\_\_j]\ *\ \_\_st;}
\DoxyCodeLine{03634\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_st\ *=\ \_\_ret\_sh[\_\_j];}
\DoxyCodeLine{03635\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03636\ }
\DoxyCodeLine{03637\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret\_data[\_\_ret\_index]\ +=\ this-\/>\_\_data\_[\_\_i];}
\DoxyCodeLine{03638\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03639\ \textcolor{preprocessor}{\#if\ defined(\_\_ARM\_NEON)}}
\DoxyCodeLine{03640\ \ \ \ \ \}}
\DoxyCodeLine{03641\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03642\ }
\DoxyCodeLine{03643\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(\_\_ret\_data,\ \_\_ret\_sh);}
\DoxyCodeLine{03644\ \}}
\DoxyCodeLine{03645\ }
\DoxyCodeLine{03646\ }
\DoxyCodeLine{03647\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{03648\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor_a8e7e1aa11f5bc41d0f25ecf915c152a0}{tensor<\_Tp>::row}}(\textcolor{keyword}{const}\ index\_type\ \_\_index)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{03649\ \ \ \ \ \textcolor{keywordflow}{if}\ (this-\/>\_\_shape\_.size()\ !=\ 2)}
\DoxyCodeLine{03650\ \ \ \ \ \{}
\DoxyCodeLine{03651\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(\textcolor{stringliteral}{"{}Cannot\ get\ a\ row\ from\ a\ non\ two\ dimensional\ tensor"{}});}
\DoxyCodeLine{03652\ \ \ \ \ \}}
\DoxyCodeLine{03653\ }
\DoxyCodeLine{03654\ \ \ \ \ \textcolor{keywordflow}{if}\ (this-\/>\_\_shape\_[0]\ <=\ \_\_index\ ||\ \_\_index\ <\ 0LL)}
\DoxyCodeLine{03655\ \ \ \ \ \{}
\DoxyCodeLine{03656\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::invalid\_argument(\textcolor{stringliteral}{"{}Index\ input\ is\ out\ of\ range"{}});}
\DoxyCodeLine{03657\ \ \ \ \ \}}
\DoxyCodeLine{03658\ }
\DoxyCodeLine{03659\ \ \ \ \ data\_t\ \_\_r(this-\/>\_\_data\_.begin()\ +\ (this-\/>\_\_shape\_[1]\ *\ \_\_index),}
\DoxyCodeLine{03660\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>\_\_data\_.begin()\ +\ (this-\/>\_\_shape\_[1]\ *\ \_\_index\ +\ this-\/>\_\_shape\_[1]));}
\DoxyCodeLine{03661\ }
\DoxyCodeLine{03662\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(\_\_r,\ \{this-\/>\_\_shape\_[1]\});}
\DoxyCodeLine{03663\ \}}
\DoxyCodeLine{03664\ }
\DoxyCodeLine{03665\ }
\DoxyCodeLine{03666\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{03667\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor_a33f95c40071191f85037dc5ea6c51961}{tensor<\_Tp>::col}}(\textcolor{keyword}{const}\ index\_type\ \_\_index)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{03668\ \ \ \ \ \textcolor{keywordflow}{if}\ (this-\/>\_\_shape\_.size()\ !=\ 2)}
\DoxyCodeLine{03669\ \ \ \ \ \{}
\DoxyCodeLine{03670\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(\textcolor{stringliteral}{"{}Cannot\ get\ a\ column\ from\ a\ non\ two\ dimensional\ tensor"{}});}
\DoxyCodeLine{03671\ \ \ \ \ \}}
\DoxyCodeLine{03672\ }
\DoxyCodeLine{03673\ \ \ \ \ \textcolor{keywordflow}{if}\ (this-\/>\_\_shape\_[1]\ <=\ \_\_index\ ||\ \_\_index\ <\ 0LL)}
\DoxyCodeLine{03674\ \ \ \ \ \{}
\DoxyCodeLine{03675\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::invalid\_argument(\textcolor{stringliteral}{"{}Index\ input\ out\ of\ range"{}});}
\DoxyCodeLine{03676\ \ \ \ \ \}}
\DoxyCodeLine{03677\ }
\DoxyCodeLine{03678\ \ \ \ \ data\_t\ \_\_c;}
\DoxyCodeLine{03679\ }
\DoxyCodeLine{03680\ \ \ \ \ index\_type\ \_\_i\ =\ 0;}
\DoxyCodeLine{03681\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_shape\_[0];\ \_\_i++)}
\DoxyCodeLine{03682\ \ \ \ \ \{}
\DoxyCodeLine{03683\ \ \ \ \ \ \ \ \ \_\_c.push\_back(this-\/>\_\_data\_[this-\/>\_\_compute\_index(\{\_\_i,\ \_\_index\})]);}
\DoxyCodeLine{03684\ \ \ \ \ \}}
\DoxyCodeLine{03685\ }
\DoxyCodeLine{03686\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(\_\_c,\ \{this-\/>\_\_shape\_[0]\});}
\DoxyCodeLine{03687\ \}}
\DoxyCodeLine{03688\ }
\DoxyCodeLine{03689\ }
\DoxyCodeLine{03690\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{03691\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor_a3062f36e627469c71bce1a4e268cdf95}{tensor<\_Tp>::ceil}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{03692\ \ \ \ \ this-\/>\_\_check\_is\_scalar\_type(\textcolor{stringliteral}{"{}Cannot\ get\ the\ ceiling\ of\ a\ non\ scalar\ value"{}});}
\DoxyCodeLine{03693\ \ \ \ \ data\_t\ \_\_ret(this-\/>\_\_data\_.size());}
\DoxyCodeLine{03694\ }
\DoxyCodeLine{03695\ \textcolor{preprocessor}{\#ifdef\ \_\_ARM\_NEON}}
\DoxyCodeLine{03696\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ simd\_size\ =\ 4;}
\DoxyCodeLine{03697\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ simd\_end\ \ =\ this-\/>\_\_data\_.size()\ -\/\ (this-\/>\_\_data\_.size()\ \%\ simd\_size);}
\DoxyCodeLine{03698\ }
\DoxyCodeLine{03699\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;\ \_\_i\ <\ simd\_end;\ \_\_i\ +=\ simd\_size)}
\DoxyCodeLine{03700\ \ \ \ \ \{}
\DoxyCodeLine{03701\ \ \ \ \ \ \ \ \ float32x4\_t\ data\ \ \ =\ vld1q\float32_t(\&this-\/>\_\_data\_[\_\_i]);}
\DoxyCodeLine{03702\ \ \ \ \ \ \ \ \ float32x4\_t\ ceiled\ =\ vrndpq\float32_t(data);}
\DoxyCodeLine{03703\ \ \ \ \ \ \ \ \ vst1q\float32_t(\&\_\_ret[\_\_i],\ ceiled);}
\DoxyCodeLine{03704\ \ \ \ \ \}}
\DoxyCodeLine{03705\ }
\DoxyCodeLine{03706\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ \_\_i\ =\ simd\_end;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{03707\ \ \ \ \ \{}
\DoxyCodeLine{03708\ \ \ \ \ \ \ \ \ \_\_ret[\_\_i]\ =\ std::ceil(this-\/>\_\_data\_[\_\_i]);}
\DoxyCodeLine{03709\ \ \ \ \ \}}
\DoxyCodeLine{03710\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{03711\ }
\DoxyCodeLine{03712\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{03713\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{03714\ \ \ \ \ \{}
\DoxyCodeLine{03715\ \ \ \ \ \ \ \ \ \_\_ret[\_\_i]\ =\ std::ceil(this-\/>\_\_data\_[\_\_i]);}
\DoxyCodeLine{03716\ \ \ \ \ \}}
\DoxyCodeLine{03717\ }
\DoxyCodeLine{03718\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03719\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(\_\_ret,\ this-\/>\_\_shape\_);}
\DoxyCodeLine{03720\ \}}
\DoxyCodeLine{03721\ }
\DoxyCodeLine{03722\ }
\DoxyCodeLine{03723\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{03724\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor_a8f7be6564c752719db37e23ad4960c8f}{tensor<\_Tp>::floor}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{03725\ \ \ \ \ this-\/>\_\_check\_is\_scalar\_type(\textcolor{stringliteral}{"{}Cannot\ get\ the\ floor\ of\ a\ non\ scalar\ value"{}});}
\DoxyCodeLine{03726\ \ \ \ \ data\_t\ \_\_ret(this-\/>\_\_data\_.size());}
\DoxyCodeLine{03727\ }
\DoxyCodeLine{03728\ \textcolor{preprocessor}{\#ifdef\ \_\_ARM\_NEON}}
\DoxyCodeLine{03729\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ simd\_size\ =\ 4;}
\DoxyCodeLine{03730\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ simd\_end\ \ =\ this-\/>\_\_data\_.size()\ -\/\ (this-\/>\_\_data\_.size()\ \%\ simd\_size);}
\DoxyCodeLine{03731\ }
\DoxyCodeLine{03732\ \ \ \ \ float32x4\_t\ zero\ =\ vdupq\_n\float32_t(0.0f);}
\DoxyCodeLine{03733\ }
\DoxyCodeLine{03734\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;\ \_\_i\ <\ simd\_end;\ \_\_i\ +=\ simd\_size)}
\DoxyCodeLine{03735\ \ \ \ \ \{}
\DoxyCodeLine{03736\ \ \ \ \ \ \ \ \ float32x4\_t\ data\ \ \ \ =\ vld1q\float32_t(\&this-\/>\_\_data\_[\_\_i]);}
\DoxyCodeLine{03737\ \ \ \ \ \ \ \ \ float32x4\_t\ floored\ =\ vrndmq\float32_t(data);}
\DoxyCodeLine{03738\ \ \ \ \ \ \ \ \ vst1q\float32_t(\&\_\_ret[\_\_i],\ floored);}
\DoxyCodeLine{03739\ \ \ \ \ \}}
\DoxyCodeLine{03740\ }
\DoxyCodeLine{03741\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ \_\_i\ =\ simd\_end;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{03742\ \ \ \ \ \{}
\DoxyCodeLine{03743\ \ \ \ \ \ \ \ \ \_\_ret[\_\_i]\ =\ std::floor(this-\/>\_\_data\_[\_\_i]);}
\DoxyCodeLine{03744\ \ \ \ \ \}}
\DoxyCodeLine{03745\ }
\DoxyCodeLine{03746\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{03747\ }
\DoxyCodeLine{03748\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{03749\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{03750\ \ \ \ \ \{}
\DoxyCodeLine{03751\ \ \ \ \ \ \ \ \ \_\_ret[\_\_i]\ =\ std::floor(this-\/>\_\_data\_[\_\_i]);}
\DoxyCodeLine{03752\ \ \ \ \ \}}
\DoxyCodeLine{03753\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03754\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(\_\_ret,\ this-\/>\_\_shape\_);}
\DoxyCodeLine{03755\ \}}
\DoxyCodeLine{03756\ }
\DoxyCodeLine{03757\ }
\DoxyCodeLine{03758\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{03759\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor_ae3c45dc71c1090025661005112a1f834}{tensor<\_Tp>::clamp}}(\mbox{\hyperlink{classtensor_a39d9b723cbcc4fbc18d2d655d1148166}{const\_pointer}}\ \_\_min\_val,\ \mbox{\hyperlink{classtensor_a39d9b723cbcc4fbc18d2d655d1148166}{const\_pointer}}\ \_\_max\_val)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{03760\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor<value\_type>}}\ \_\_t\ =\ \mbox{\hyperlink{classtensor}{\_\_self}}(*\textcolor{keyword}{this});}
\DoxyCodeLine{03761\ \ \ \ \ \_\_t.\mbox{\hyperlink{classtensor_a611871f79215f582779adbea1a661882}{clamp\_}}(\_\_min\_val,\ \_\_max\_val);}
\DoxyCodeLine{03762\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_t;}
\DoxyCodeLine{03763\ \}}
\DoxyCodeLine{03764\ }
\DoxyCodeLine{03765\ }
\DoxyCodeLine{03766\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{03767\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_a611871f79215f582779adbea1a661882}{tensor<\_Tp>::clamp\_}}(\mbox{\hyperlink{classtensor_a39d9b723cbcc4fbc18d2d655d1148166}{const\_pointer}}\ \_\_min\_val,\ \mbox{\hyperlink{classtensor_a39d9b723cbcc4fbc18d2d655d1148166}{const\_pointer}}\ \_\_max\_val)\ \{}
\DoxyCodeLine{03768\ \textcolor{preprocessor}{\#if\ defined(\_\_AVX2\_\_)}}
\DoxyCodeLine{03769\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ simd\_size\ =\ 8;}
\DoxyCodeLine{03770\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ simd\_end\ \ =\ this-\/>\_\_data\_.\mbox{\hyperlink{classtensor_a119a24ebef8a13cd8fd262a1c00b48b7}{size}}()\ -\/\ (this-\/>\_\_data\_.size()\ \%\ simd\_size);}
\DoxyCodeLine{03771\ }
\DoxyCodeLine{03772\ \ \ \ \ \_\_m256\ min\_vec\ =\ \_mm256\_set1\_ps(\_\_min\_val\ ?\ *\_\_min\_val\ :\ std::numeric\_limits<\_Tp>::lowest());}
\DoxyCodeLine{03773\ \ \ \ \ \_\_m256\ max\_vec\ =\ \_mm256\_set1\_ps(\_\_max\_val\ ?\ *\_\_max\_val\ :\ std::numeric\_limits<\_Tp>::max());}
\DoxyCodeLine{03774\ }
\DoxyCodeLine{03775\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;\ \_\_i\ <\ simd\_end;\ \_\_i\ +=\ simd\_size)}
\DoxyCodeLine{03776\ \ \ \ \ \{}
\DoxyCodeLine{03777\ \ \ \ \ \ \ \ \ \_\_m256\ data\_vec\ =\ \_mm256\_loadu\_ps(\&this-\/>\_\_data\_[\_\_i]);}
\DoxyCodeLine{03778\ \ \ \ \ \ \ \ \ \_\_m256\ clamped\ \ =\ \_mm256\_min\_ps(\_mm256\_max\_ps(data\_vec,\ min\_vec),\ max\_vec);}
\DoxyCodeLine{03779\ \ \ \ \ \ \ \ \ \_mm256\_storeu\_ps(\&this-\/>\_\_data\_[\_\_i],\ clamped);}
\DoxyCodeLine{03780\ \ \ \ \ \}}
\DoxyCodeLine{03781\ }
\DoxyCodeLine{03782\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ \_\_i\ =\ simd\_end;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{03783\ \ \ \ \ \{}
\DoxyCodeLine{03784\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_\_min\_val)}
\DoxyCodeLine{03785\ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i]\ =\ std::max(*\_\_min\_val,\ this-\/>\_\_data\_[\_\_i]);}
\DoxyCodeLine{03786\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_\_max\_val)}
\DoxyCodeLine{03787\ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i]\ =\ std::min(*\_\_max\_val,\ this-\/>\_\_data\_[\_\_i]);}
\DoxyCodeLine{03788\ \ \ \ \ \}}
\DoxyCodeLine{03789\ \textcolor{preprocessor}{\#elif\ defined(\_\_ARM\_NEON)}}
\DoxyCodeLine{03790\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ simd\_size\ =\ 4;}
\DoxyCodeLine{03791\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ simd\_end\ \ =\ this-\/>\_\_data\_.size()\ -\/\ (this-\/>\_\_data\_.size()\ \%\ simd\_size);}
\DoxyCodeLine{03792\ }
\DoxyCodeLine{03793\ \ \ \ \ float32x4\_t\ min\_vec\ =\ vdupq\_n\float32_t(\_\_min\_val\ ?\ *\_\_min\_val\ :\ std::numeric\_limits<\_Tp>::lowest());}
\DoxyCodeLine{03794\ \ \ \ \ float32x4\_t\ max\_vec\ =\ vdupq\_n\float32_t(\_\_max\_val\ ?\ *\_\_max\_val\ :\ std::numeric\_limits<\_Tp>::max());}
\DoxyCodeLine{03795\ }
\DoxyCodeLine{03796\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;\ \_\_i\ <\ simd\_end;\ \_\_i\ +=\ simd\_size)}
\DoxyCodeLine{03797\ \ \ \ \ \{}
\DoxyCodeLine{03798\ \ \ \ \ \ \ \ \ float32x4\_t\ data\_vec\ =\ vld1q\float32_t(\&this-\/>\_\_data\_[\_\_i]);}
\DoxyCodeLine{03799\ \ \ \ \ \ \ \ \ float32x4\_t\ clamped\ \ =\ vminq\float32_t(vmaxq\float32_t(data\_vec,\ min\_vec),\ max\_vec);}
\DoxyCodeLine{03800\ \ \ \ \ \ \ \ \ vst1q\float32_t(\&this-\/>\_\_data\_[\_\_i],\ clamped);}
\DoxyCodeLine{03801\ \ \ \ \ \}}
\DoxyCodeLine{03802\ }
\DoxyCodeLine{03803\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ \_\_i\ =\ simd\_end;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{03804\ \ \ \ \ \{}
\DoxyCodeLine{03805\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_\_min\_val)}
\DoxyCodeLine{03806\ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i]\ =\ std::max(*\_\_min\_val,\ this-\/>\_\_data\_[\_\_i]);}
\DoxyCodeLine{03807\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_\_max\_val)}
\DoxyCodeLine{03808\ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i]\ =\ std::min(*\_\_max\_val,\ this-\/>\_\_data\_[\_\_i]);}
\DoxyCodeLine{03809\ \ \ \ \ \}}
\DoxyCodeLine{03810\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{03811\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{03812\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{03813\ \ \ \ \ \{}
\DoxyCodeLine{03814\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_\_min\_val)}
\DoxyCodeLine{03815\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03816\ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i]\ =\ std::max(*\_\_min\_val,\ this-\/>\_\_data\_[\_\_i]);}
\DoxyCodeLine{03817\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03818\ }
\DoxyCodeLine{03819\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_\_max\_val)}
\DoxyCodeLine{03820\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03821\ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i]\ =\ std::min(*\_\_max\_val,\ this-\/>\_\_data\_[\_\_i]);}
\DoxyCodeLine{03822\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03823\ \ \ \ \ \}}
\DoxyCodeLine{03824\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03825\ \}}

\end{DoxyCode}
