\doxysection{tensor.\+hpp}
\hypertarget{tensor_8hpp_source}{}\label{tensor_8hpp_source}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#include\ <iostream>}}
\DoxyCodeLine{00002\ \textcolor{preprocessor}{\#include\ <stdexcept>}}
\DoxyCodeLine{00003\ \textcolor{preprocessor}{\#include\ <random>}}
\DoxyCodeLine{00004\ \textcolor{preprocessor}{\#include\ <cassert>}}
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#include\ <vector>}}
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#include\ <algorithm>}}
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#include\ <cstdint>}}
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#include\ <cmath>}}
\DoxyCodeLine{00009\ \textcolor{preprocessor}{\#include\ <array>}}
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#include\ <arm\_neon.h>}}
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#include\ <type\_traits>}}
\DoxyCodeLine{00012\ \textcolor{preprocessor}{\#include\ <immintrin.h>}}
\DoxyCodeLine{00013\ \textcolor{preprocessor}{\#include\ <omp.h>}}
\DoxyCodeLine{00014\ }
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ <\_\_iterator/iterator\_traits.h>}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ <\_\_iterator/reverse\_iterator.h>}}
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#include\ <\_\_iterator/wrap\_iter.h>}}
\DoxyCodeLine{00018\ }
\DoxyCodeLine{00019\ }
\DoxyCodeLine{00020\ \textcolor{comment}{/*}}
\DoxyCodeLine{00021\ \textcolor{comment}{\ \ tensor\ synopsis}}
\DoxyCodeLine{00022\ \textcolor{comment}{}}
\DoxyCodeLine{00023\ \textcolor{comment}{template<class\ \_Tp>}}
\DoxyCodeLine{00024\ \textcolor{comment}{class\ tensor}}
\DoxyCodeLine{00025\ \textcolor{comment}{\{}}
\DoxyCodeLine{00026\ \textcolor{comment}{\ \ \ public:}}
\DoxyCodeLine{00027\ \textcolor{comment}{\ \ \ \ typedef\ tensor\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_self;}}
\DoxyCodeLine{00028\ \textcolor{comment}{\ \ \ \ typedef\ \_Tp\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ value\_type;}}
\DoxyCodeLine{00029\ \textcolor{comment}{\ \ \ \ typedef\ int64\_t\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ index\_type;}}
\DoxyCodeLine{00030\ \textcolor{comment}{\ \ \ \ typedef\ std::vector<index\_type>\ shape\_type;}}
\DoxyCodeLine{00031\ \textcolor{comment}{\ \ \ \ typedef\ value\_type\&\ \ \ \ \ \ \ \ \ \ \ \ \ reference;}}
\DoxyCodeLine{00032\ \textcolor{comment}{\ \ \ \ typedef\ const\ value\_type\&\ \ \ \ \ \ \ const\_reference;}}
\DoxyCodeLine{00033\ \textcolor{comment}{\ \ \ \ typedef\ value\_type*\ \ \ \ \ \ \ \ \ \ \ \ \ pointer;}}
\DoxyCodeLine{00034\ \textcolor{comment}{\ \ \ \ typedef\ const\ pointer\ \ \ \ \ \ \ \ \ \ \ const\_pointer;}}
\DoxyCodeLine{00035\ \textcolor{comment}{\ \ \ \ typedef\ std::vector<value\_type>\ data\_t;}}
\DoxyCodeLine{00036\ \textcolor{comment}{\ \ \ \ typedef\ const\ data\_t\ \ \ \ \ \ \ \ \ \ \ \ const\_data\_container;}}
\DoxyCodeLine{00037\ \textcolor{comment}{}}
\DoxyCodeLine{00038\ \textcolor{comment}{\ \ \ \ typedef\ std::\_\_wrap\_iter<typename\ std::allocator\_traits<std::allocator<\_Tp>>::pointer>}}
\DoxyCodeLine{00039\ \textcolor{comment}{\ \ \ \ \ \ \ \ \_\_iterator;}}
\DoxyCodeLine{00040\ \textcolor{comment}{\ \ \ \ typedef\ std::\_\_wrap\_iter<typename\ std::allocator\_traits<std::allocator<\_Tp>>::const\_pointer>}}
\DoxyCodeLine{00041\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_const\_iterator;}}
\DoxyCodeLine{00042\ \textcolor{comment}{\ \ \ \ typedef\ std::reverse\_iterator<\_\_iterator>\ \ \ \ \ \ \ reverse\_iterator;}}
\DoxyCodeLine{00043\ \textcolor{comment}{\ \ \ \ typedef\ std::reverse\_iterator<\_\_const\_iterator>\ const\_reverse\_iterator;}}
\DoxyCodeLine{00044\ \textcolor{comment}{}}
\DoxyCodeLine{00045\ \textcolor{comment}{}}
\DoxyCodeLine{00046\ \textcolor{comment}{\ \ \ private:}}
\DoxyCodeLine{00047\ \textcolor{comment}{\ \ \ \ data\_t\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_data\_;}}
\DoxyCodeLine{00048\ \textcolor{comment}{\ \ \ \ shape\_type\ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_shape\_;}}
\DoxyCodeLine{00049\ \textcolor{comment}{\ \ \ \ std::vector<index\_type>\ \_\_strides\_;}}
\DoxyCodeLine{00050\ \textcolor{comment}{}}
\DoxyCodeLine{00051\ \textcolor{comment}{\ \ \ public:}}
\DoxyCodeLine{00052\ \textcolor{comment}{\ \ \ \ tensor()\ =\ default;}}
\DoxyCodeLine{00053\ \textcolor{comment}{}}
\DoxyCodeLine{00054\ \textcolor{comment}{\ \ \ \ explicit\ tensor(const\ shape\_type\ \_\_sh,\ const\ value\_type\ \_\_v);}}
\DoxyCodeLine{00055\ \textcolor{comment}{\ \ \ \ explicit\ tensor(const\ shape\_type\ \_\_sh);}}
\DoxyCodeLine{00056\ \textcolor{comment}{\ \ \ \ explicit\ tensor(const\ data\_t\ \_\_d,\ const\ shape\_type\ \_\_sh);}}
\DoxyCodeLine{00057\ \textcolor{comment}{\ \ \ \ explicit\ tensor(const\ tensor\&\ \_\_t);}}
\DoxyCodeLine{00058\ \textcolor{comment}{}}
\DoxyCodeLine{00059\ \textcolor{comment}{\ \ \ \ tensor(tensor\&\&\ \_\_t)\ noexcept;}}
\DoxyCodeLine{00060\ \textcolor{comment}{\ \ \ \ tensor(const\ shape\_type\ \_\_sh,\ std::initializer\_list<value\_type>\ init\_list);}}
\DoxyCodeLine{00061\ \textcolor{comment}{\ \ \ \ tensor(const\ shape\_type\&\ \_\_sh,\ const\ tensor\&\ \_\_other);}}
\DoxyCodeLine{00062\ \textcolor{comment}{}}
\DoxyCodeLine{00063\ \textcolor{comment}{\ \ \ private:}}
\DoxyCodeLine{00064\ \textcolor{comment}{\ \ \ \ class\ \_\_destroy\_tensor}}
\DoxyCodeLine{00065\ \textcolor{comment}{\ \ \ \ \{}}
\DoxyCodeLine{00066\ \textcolor{comment}{\ \ \ \ \ \ \ public:}}
\DoxyCodeLine{00067\ \textcolor{comment}{\ \ \ \ \ \ \ \ \_\_destroy\_tensor(tensor\&\ \_\_tens);}}
\DoxyCodeLine{00068\ \textcolor{comment}{\ \ \ \ \ \ \ \ void\ operator()();}}
\DoxyCodeLine{00069\ \textcolor{comment}{}}
\DoxyCodeLine{00070\ \textcolor{comment}{\ \ \ \ \ \ \ private:}}
\DoxyCodeLine{00071\ \textcolor{comment}{\ \ \ \ \ \ \ \ tensor\&\ \_\_tens\_;}}
\DoxyCodeLine{00072\ \textcolor{comment}{\ \ \ \ \};}}
\DoxyCodeLine{00073\ \textcolor{comment}{}}
\DoxyCodeLine{00074\ \textcolor{comment}{\ \ \ public:}}
\DoxyCodeLine{00075\ \textcolor{comment}{\ \ \ \ \string~tensor();}}
\DoxyCodeLine{00076\ \textcolor{comment}{}}
\DoxyCodeLine{00077\ \textcolor{comment}{\ \ \ \ tensor\&\ operator=(const\ tensor\&\ \_\_other);}}
\DoxyCodeLine{00078\ \textcolor{comment}{\ \ \ \ tensor\&\ operator=(tensor\&\&\ \_\_other)\ noexcept;}}
\DoxyCodeLine{00079\ \textcolor{comment}{}}
\DoxyCodeLine{00080\ \textcolor{comment}{\ \ \ \ \_\_const\_iterator\ begin()\ const;}}
\DoxyCodeLine{00081\ \textcolor{comment}{\ \ \ \ \_\_const\_iterator\ end()\ const;}}
\DoxyCodeLine{00082\ \textcolor{comment}{}}
\DoxyCodeLine{00083\ \textcolor{comment}{\ \ \ \ const\_reverse\_iterator\ rbegin()\ const;}}
\DoxyCodeLine{00084\ \textcolor{comment}{\ \ \ \ const\_reverse\_iterator\ rend()\ const;}}
\DoxyCodeLine{00085\ \textcolor{comment}{}}
\DoxyCodeLine{00086\ \textcolor{comment}{\ \ \ \ data\_t\ \ \ \ \ storage()\ const;}}
\DoxyCodeLine{00087\ \textcolor{comment}{\ \ \ \ shape\_type\ shape()\ const;}}
\DoxyCodeLine{00088\ \textcolor{comment}{\ \ \ \ shape\_type\ strides()\ const;}}
\DoxyCodeLine{00089\ \textcolor{comment}{\ \ \ \ size\_t\ \ \ \ \ n\_dims()\ const;}}
\DoxyCodeLine{00090\ \textcolor{comment}{}}
\DoxyCodeLine{00091\ \textcolor{comment}{\ \ \ \ size\_t\ size(const\ index\_type\ \_\_dim)\ const;}}
\DoxyCodeLine{00092\ \textcolor{comment}{}}
\DoxyCodeLine{00093\ \textcolor{comment}{\ \ \ \ size\_t\ \ \ \ \ \ \ \ \ \ capacity()\ const\ noexcept;}}
\DoxyCodeLine{00094\ \textcolor{comment}{\ \ \ \ reference\ \ \ \ \ \ \ at(shape\_type\ \_\_idx);}}
\DoxyCodeLine{00095\ \textcolor{comment}{\ \ \ \ const\_reference\ at(const\ shape\_type\ \_\_idx)\ const;}}
\DoxyCodeLine{00096\ \textcolor{comment}{}}
\DoxyCodeLine{00097\ \textcolor{comment}{\ \ \ \ reference\ operator[](const\ size\_t\ \_\_in);}}
\DoxyCodeLine{00098\ \textcolor{comment}{}}
\DoxyCodeLine{00099\ \textcolor{comment}{\ \ \ \ const\_reference\ operator[](const\ size\_t\ \_\_in)\ const;}}
\DoxyCodeLine{00100\ \textcolor{comment}{}}
\DoxyCodeLine{00101\ \textcolor{comment}{\ \ \ \ tensor\ operator+(const\ tensor\&\ \_\_other)\ const;}}
\DoxyCodeLine{00102\ \textcolor{comment}{\ \ \ \ tensor\ operator-\/(const\ tensor\&\ \_\_other)\ const;}}
\DoxyCodeLine{00103\ \textcolor{comment}{\ \ \ \ tensor\ operator-\/=(const\ tensor\&\ \_\_other)\ const;}}
\DoxyCodeLine{00104\ \textcolor{comment}{\ \ \ \ tensor\ operator+=(const\ tensor\&\ \_\_other)\ const;}}
\DoxyCodeLine{00105\ \textcolor{comment}{\ \ \ \ tensor\ operator+(const\ value\_type\ \_scalar)\ const;}}
\DoxyCodeLine{00106\ \textcolor{comment}{\ \ \ \ tensor\ operator-\/(const\ value\_type\ \_scalar)\ const;}}
\DoxyCodeLine{00107\ \textcolor{comment}{\ \ \ \ tensor\ operator+=(const\_reference\ \_\_scalar)\ const;}}
\DoxyCodeLine{00108\ \textcolor{comment}{\ \ \ \ tensor\ operator-\/=(const\_reference\ \_\_scalar)\ const;}}
\DoxyCodeLine{00109\ \textcolor{comment}{}}
\DoxyCodeLine{00110\ \textcolor{comment}{\ \ \ \ bool\ operator==(const\ tensor\&\ \_\_other)\ const;}}
\DoxyCodeLine{00111\ \textcolor{comment}{\ \ \ \ bool\ operator!=(const\ tensor\&\ \_\_other)\ const\ \{\ return\ !(*this\ ==\ \_\_other);\ \}}}
\DoxyCodeLine{00112\ \textcolor{comment}{}}
\DoxyCodeLine{00113\ \textcolor{comment}{\ \ \ \ bool\ empty()\ const\ \{\ return\ this-\/>\_\_data\_.empty();\ \}}}
\DoxyCodeLine{00114\ \textcolor{comment}{}}
\DoxyCodeLine{00115\ \textcolor{comment}{\ \ \ \ double\ mean()\ const;}}
\DoxyCodeLine{00116\ \textcolor{comment}{}}
\DoxyCodeLine{00117\ \textcolor{comment}{\ \ \ \ tensor<bool>\ logical\_not()\ const;}}
\DoxyCodeLine{00118\ \textcolor{comment}{\ \ \ \ tensor<bool>\ logical\_or(const\ value\_type\ \_\_val)\ const;}}
\DoxyCodeLine{00119\ \textcolor{comment}{\ \ \ \ tensor<bool>\ logical\_or(const\ tensor\&\ \_\_other)\ const;}}
\DoxyCodeLine{00120\ \textcolor{comment}{}}
\DoxyCodeLine{00121\ \textcolor{comment}{\ \ \ \ tensor<bool>\ less\_equal(const\ tensor\&\ \_\_other)\ const;}}
\DoxyCodeLine{00122\ \textcolor{comment}{\ \ \ \ tensor<bool>\ less\_equal(const\ value\_type\ \_\_val)\ const;}}
\DoxyCodeLine{00123\ \textcolor{comment}{}}
\DoxyCodeLine{00124\ \textcolor{comment}{\ \ \ \ tensor<bool>\ greater\_equal(const\ tensor\&\ \_\_other)\ const;}}
\DoxyCodeLine{00125\ \textcolor{comment}{\ \ \ \ tensor<bool>\ greater\_equal(const\ value\_type\ \_\_val)\ const;}}
\DoxyCodeLine{00126\ \textcolor{comment}{}}
\DoxyCodeLine{00127\ \textcolor{comment}{\ \ \ \ tensor<bool>\ equal(const\ tensor\&\ \_\_other)\ const;}}
\DoxyCodeLine{00128\ \textcolor{comment}{\ \ \ \ tensor<bool>\ equal(const\ value\_type\ \_\_val)\ const;}}
\DoxyCodeLine{00129\ \textcolor{comment}{}}
\DoxyCodeLine{00130\ \textcolor{comment}{\ \ \ \ size\_t\ count\_nonzero(index\_type\ \_\_dim\ =\ -\/1LL)\ const;}}
\DoxyCodeLine{00131\ \textcolor{comment}{}}
\DoxyCodeLine{00132\ \textcolor{comment}{\ \ \ \ tensor\ slice(index\_type\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_dim,}}
\DoxyCodeLine{00133\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::optional<index\_type>\ \_\_start,}}
\DoxyCodeLine{00134\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::optional<index\_type>\ \_\_end,}}
\DoxyCodeLine{00135\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ index\_type\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_step)\ const;}}
\DoxyCodeLine{00136\ \textcolor{comment}{}}
\DoxyCodeLine{00137\ \textcolor{comment}{\ \ \ \ tensor\ fmax(const\ tensor\&\ \_\_other)\ const;}}
\DoxyCodeLine{00138\ \textcolor{comment}{\ \ \ \ tensor\ fmod(const\ tensor\&\ \_\_other)\ const;}}
\DoxyCodeLine{00139\ \textcolor{comment}{}}
\DoxyCodeLine{00140\ \textcolor{comment}{\ \ \ \ tensor\ frac()\ const;}}
\DoxyCodeLine{00141\ \textcolor{comment}{\ \ \ \ tensor\ log()\ const;}}
\DoxyCodeLine{00142\ \textcolor{comment}{\ \ \ \ tensor\ log10()\ const;}}
\DoxyCodeLine{00143\ \textcolor{comment}{\ \ \ \ tensor\ log2()\ const;}}
\DoxyCodeLine{00144\ \textcolor{comment}{}}
\DoxyCodeLine{00145\ \textcolor{comment}{\ \ \ \ tensor\ exp()\ const;}}
\DoxyCodeLine{00146\ \textcolor{comment}{}}
\DoxyCodeLine{00147\ \textcolor{comment}{\ \ \ \ tensor\ sqrt()\ const;}}
\DoxyCodeLine{00148\ \textcolor{comment}{}}
\DoxyCodeLine{00149\ \textcolor{comment}{\ \ \ \ tensor\ sum(const\ index\_type\ \_\_axis)\ const;}}
\DoxyCodeLine{00150\ \textcolor{comment}{}}
\DoxyCodeLine{00151\ \textcolor{comment}{\ \ \ \ tensor\ row(const\ index\_type\ \_\_index)\ const;}}
\DoxyCodeLine{00152\ \textcolor{comment}{\ \ \ \ tensor\ col(const\ index\_type\ \_\_index)\ const;}}
\DoxyCodeLine{00153\ \textcolor{comment}{}}
\DoxyCodeLine{00154\ \textcolor{comment}{\ \ \ \ tensor\ ceil()\ const;}}
\DoxyCodeLine{00155\ \textcolor{comment}{\ \ \ \ tensor\ floor()\ const;}}
\DoxyCodeLine{00156\ \textcolor{comment}{}}
\DoxyCodeLine{00157\ \textcolor{comment}{\ \ \ \ tensor\ clone()\ const;}}
\DoxyCodeLine{00158\ \textcolor{comment}{}}
\DoxyCodeLine{00159\ \textcolor{comment}{\ \ \ \ tensor\ clamp(const\_pointer\ \_\_min\_val\ =\ nullptr,\ const\_pointer\ \_\_max\_val\ =\ nullptr)\ const;}}
\DoxyCodeLine{00160\ \textcolor{comment}{}}
\DoxyCodeLine{00161\ \textcolor{comment}{\ \ \ \ tensor\ cos()\ const;}}
\DoxyCodeLine{00162\ \textcolor{comment}{\ \ \ \ tensor\ sin()\ const;}}
\DoxyCodeLine{00163\ \textcolor{comment}{\ \ \ \ tensor\ sinh()\ const;}}
\DoxyCodeLine{00164\ \textcolor{comment}{\ \ \ \ tensor\ asinh()\ const;}}
\DoxyCodeLine{00165\ \textcolor{comment}{\ \ \ \ tensor\ cosh()\ const;}}
\DoxyCodeLine{00166\ \textcolor{comment}{\ \ \ \ tensor\ acosh()\ const;}}
\DoxyCodeLine{00167\ \textcolor{comment}{}}
\DoxyCodeLine{00168\ \textcolor{comment}{\ \ \ \ tensor\ logical\_xor(const\ tensor\&\ \_\_other)\ const;}}
\DoxyCodeLine{00169\ \textcolor{comment}{\ \ \ \ tensor\ logical\_xor(const\ value\_type\ \_\_val)\ const;}}
\DoxyCodeLine{00170\ \textcolor{comment}{}}
\DoxyCodeLine{00171\ \textcolor{comment}{\ \ \ \ tensor\ logical\_and(const\ tensor\&\ \_\_other)\ const;}}
\DoxyCodeLine{00172\ \textcolor{comment}{\ \ \ \ tensor\ logical\_and(const\ value\_type\ \_\_val)\ const;}}
\DoxyCodeLine{00173\ \textcolor{comment}{}}
\DoxyCodeLine{00174\ \textcolor{comment}{\ \ \ \ tensor\ bitwise\_not()\ const;}}
\DoxyCodeLine{00175\ \textcolor{comment}{}}
\DoxyCodeLine{00176\ \textcolor{comment}{\ \ \ \ tensor\ bitwise\_and(const\ value\_type\ \_\_val)\ const;}}
\DoxyCodeLine{00177\ \textcolor{comment}{\ \ \ \ tensor\ bitwise\_and(const\ tensor\&\ \_\_other)\ const;}}
\DoxyCodeLine{00178\ \textcolor{comment}{}}
\DoxyCodeLine{00179\ \textcolor{comment}{\ \ \ \ tensor\ bitwise\_or(const\ value\_type\ \_\_val)\ const;}}
\DoxyCodeLine{00180\ \textcolor{comment}{\ \ \ \ tensor\ bitwise\_or(const\ tensor\&\ \_\_other)\ const;}}
\DoxyCodeLine{00181\ \textcolor{comment}{}}
\DoxyCodeLine{00182\ \textcolor{comment}{\ \ \ \ tensor\ bitwise\_xor(const\ value\_type\ \_\_val)\ const;}}
\DoxyCodeLine{00183\ \textcolor{comment}{\ \ \ \ tensor\ bitwise\_xor(const\ tensor\&\ \_\_other)\ const;}}
\DoxyCodeLine{00184\ \textcolor{comment}{}}
\DoxyCodeLine{00185\ \textcolor{comment}{\ \ \ \ tensor\ bitwise\_left\_shift(const\ int\ \_\_amount)\ const;}}
\DoxyCodeLine{00186\ \textcolor{comment}{\ \ \ \ tensor\ bitwise\_right\_shift(const\ int\ \_\_amount)\ const;}}
\DoxyCodeLine{00187\ \textcolor{comment}{}}
\DoxyCodeLine{00188\ \textcolor{comment}{\ \ \ \ tensor\ matmul(const\ tensor\&\ \_\_other)\ const;}}
\DoxyCodeLine{00189\ \textcolor{comment}{}}
\DoxyCodeLine{00190\ \textcolor{comment}{\ \ \ \ tensor\ reshape(const\ shape\_type\ \_\_shape)\ const;}}
\DoxyCodeLine{00191\ \textcolor{comment}{\ \ \ \ tensor\ reshape\_as(const\ tensor\&\ \_\_other)\ \{\ return\ this-\/>reshape(\_\_other.\_\_shape\_);\ \}}}
\DoxyCodeLine{00192\ \textcolor{comment}{}}
\DoxyCodeLine{00193\ \textcolor{comment}{\ \ \ \ tensor\ cross\_product(const\ tensor\&\ \_\_other)\ const;}}
\DoxyCodeLine{00194\ \textcolor{comment}{}}
\DoxyCodeLine{00195\ \textcolor{comment}{\ \ \ \ tensor\ absolute(const\ tensor\&\ \_\_tensor)\ const;}}
\DoxyCodeLine{00196\ \textcolor{comment}{}}
\DoxyCodeLine{00197\ \textcolor{comment}{\ \ \ \ tensor\ dot(const\ tensor\&\ \_\_other)\ const;}}
\DoxyCodeLine{00198\ \textcolor{comment}{}}
\DoxyCodeLine{00199\ \textcolor{comment}{\ \ \ \ tensor\ relu()\ const;}}
\DoxyCodeLine{00200\ \textcolor{comment}{}}
\DoxyCodeLine{00201\ \textcolor{comment}{\ \ \ \ tensor\ transpose()\ const;}}
\DoxyCodeLine{00202\ \textcolor{comment}{}}
\DoxyCodeLine{00203\ \textcolor{comment}{\ \ \ \ tensor\ pow(const\ tensor\&\ \_\_other)\ const;}}
\DoxyCodeLine{00204\ \textcolor{comment}{\ \ \ \ tensor\ pow(const\ value\_type\ \_\_val)\ const;}}
\DoxyCodeLine{00205\ \textcolor{comment}{}}
\DoxyCodeLine{00206\ \textcolor{comment}{\ \ \ \ tensor\ cumprod(index\_type\ \_\_dim\ =\ -\/1)\ const;}}
\DoxyCodeLine{00207\ \textcolor{comment}{}}
\DoxyCodeLine{00208\ \textcolor{comment}{\ \ \ \ tensor\ cat(const\ std::vector<tensor>\&\ \_others,\ index\_type\ \_dim)\ const;}}
\DoxyCodeLine{00209\ \textcolor{comment}{}}
\DoxyCodeLine{00210\ \textcolor{comment}{\ \ \ \ tensor\ argmax(index\_type\ \_\_dim)\ const;}}
\DoxyCodeLine{00211\ \textcolor{comment}{}}
\DoxyCodeLine{00212\ \textcolor{comment}{\ \ \ \ tensor\ unsqueeze(index\_type\ \_\_dim)\ const;}}
\DoxyCodeLine{00213\ \textcolor{comment}{}}
\DoxyCodeLine{00214\ \textcolor{comment}{\ \ \ \ index\_type\ lcm()\ const;}}
\DoxyCodeLine{00215\ \textcolor{comment}{}}
\DoxyCodeLine{00216\ \textcolor{comment}{\ \ \ \ void\ sqrt\_();}}
\DoxyCodeLine{00217\ \textcolor{comment}{}}
\DoxyCodeLine{00218\ \textcolor{comment}{\ \ \ \ void\ exp\_();}}
\DoxyCodeLine{00219\ \textcolor{comment}{}}
\DoxyCodeLine{00220\ \textcolor{comment}{\ \ \ \ void\ log2\_();}}
\DoxyCodeLine{00221\ \textcolor{comment}{\ \ \ \ void\ log10\_();}}
\DoxyCodeLine{00222\ \textcolor{comment}{\ \ \ \ void\ log\_();}}
\DoxyCodeLine{00223\ \textcolor{comment}{}}
\DoxyCodeLine{00224\ \textcolor{comment}{\ \ \ \ void\ frac\_();}}
\DoxyCodeLine{00225\ \textcolor{comment}{}}
\DoxyCodeLine{00226\ \textcolor{comment}{\ \ \ \ void\ fmod\_(const\ tensor\&\ \_\_other);}}
\DoxyCodeLine{00227\ \textcolor{comment}{}}
\DoxyCodeLine{00228\ \textcolor{comment}{\ \ \ \ void\ cos\_();}}
\DoxyCodeLine{00229\ \textcolor{comment}{\ \ \ \ void\ cosh\_();}}
\DoxyCodeLine{00230\ \textcolor{comment}{\ \ \ \ void\ acosh\_();}}
\DoxyCodeLine{00231\ \textcolor{comment}{\ \ \ \ void\ sin\_()\ const;}}
\DoxyCodeLine{00232\ \textcolor{comment}{\ \ \ \ void\ sinh\_();}}
\DoxyCodeLine{00233\ \textcolor{comment}{\ \ \ \ void\ asinh\_();}}
\DoxyCodeLine{00234\ \textcolor{comment}{}}
\DoxyCodeLine{00235\ \textcolor{comment}{\ \ \ \ void\ ceil\_();}}
\DoxyCodeLine{00236\ \textcolor{comment}{\ \ \ \ void\ floor\_();}}
\DoxyCodeLine{00237\ \textcolor{comment}{}}
\DoxyCodeLine{00238\ \textcolor{comment}{\ \ \ \ void\ relu\_();}}
\DoxyCodeLine{00239\ \textcolor{comment}{}}
\DoxyCodeLine{00240\ \textcolor{comment}{\ \ \ \ void\ clamp\_(const\_pointer\ \_\_min\_val\ =\ nullptr,\ const\_pointer\ \_\_max\_val\ =\ nullptr);}}
\DoxyCodeLine{00241\ \textcolor{comment}{}}
\DoxyCodeLine{00242\ \textcolor{comment}{\ \ \ \ void\ logical\_not\_()\ const;}}
\DoxyCodeLine{00243\ \textcolor{comment}{}}
\DoxyCodeLine{00244\ \textcolor{comment}{\ \ \ \ void\ logical\_or\_(const\ tensor\&\ \_\_other);}}
\DoxyCodeLine{00245\ \textcolor{comment}{\ \ \ \ void\ logical\_or\_(const\ value\_type\ \_\_val);}}
\DoxyCodeLine{00246\ \textcolor{comment}{}}
\DoxyCodeLine{00247\ \textcolor{comment}{\ \ \ \ void\ logical\_xor\_(const\ tensor\&\ \_\_other);}}
\DoxyCodeLine{00248\ \textcolor{comment}{\ \ \ \ void\ logical\_xor\_(const\ value\_type\ \_\_val);}}
\DoxyCodeLine{00249\ \textcolor{comment}{}}
\DoxyCodeLine{00250\ \textcolor{comment}{\ \ \ \ void\ logical\_and\_(const\ tensor\&\ \_\_other);}}
\DoxyCodeLine{00251\ \textcolor{comment}{\ \ \ \ void\ logical\_and\_(const\ value\_type\ \_\_val);}}
\DoxyCodeLine{00252\ \textcolor{comment}{}}
\DoxyCodeLine{00253\ \textcolor{comment}{\ \ \ \ void\ pow\_(const\ tensor\&\ \_\_other)\ const;}}
\DoxyCodeLine{00254\ \textcolor{comment}{\ \ \ \ void\ pow\_(const\ value\_type\ \_\_val)\ const;}}
\DoxyCodeLine{00255\ \textcolor{comment}{}}
\DoxyCodeLine{00256\ \textcolor{comment}{\ \ \ \ void\ bitwise\_left\_shift\_(const\ int\ \_\_amount);}}
\DoxyCodeLine{00257\ \textcolor{comment}{\ \ \ \ void\ bitwise\_right\_shift\_(const\ int\ \_\_amount);}}
\DoxyCodeLine{00258\ \textcolor{comment}{}}
\DoxyCodeLine{00259\ \textcolor{comment}{\ \ \ \ void\ bitwise\_and\_(const\ value\_type\ \_\_val);}}
\DoxyCodeLine{00260\ \textcolor{comment}{\ \ \ \ void\ bitwise\_and\_(const\ tensor\&\ \_\_other);}}
\DoxyCodeLine{00261\ \textcolor{comment}{}}
\DoxyCodeLine{00262\ \textcolor{comment}{\ \ \ \ void\ bitwise\_or\_(const\ value\_type\ \_\_val);}}
\DoxyCodeLine{00263\ \textcolor{comment}{\ \ \ \ void\ bitwise\_or\_(const\ tensor\&\ \_\_other);}}
\DoxyCodeLine{00264\ \textcolor{comment}{}}
\DoxyCodeLine{00265\ \textcolor{comment}{\ \ \ \ void\ bitwise\_xor\_(const\ value\_type\ \_\_val);}}
\DoxyCodeLine{00266\ \textcolor{comment}{\ \ \ \ void\ bitwise\_xor\_(const\ tensor\&\ \_\_other);}}
\DoxyCodeLine{00267\ \textcolor{comment}{}}
\DoxyCodeLine{00268\ \textcolor{comment}{\ \ \ \ void\ bitwise\_not\_();}}
\DoxyCodeLine{00269\ \textcolor{comment}{}}
\DoxyCodeLine{00270\ \textcolor{comment}{\ \ \ \ void\ view(std::initializer\_list<index\_type>\ \_\_new\_sh);}}
\DoxyCodeLine{00271\ \textcolor{comment}{}}
\DoxyCodeLine{00272\ \textcolor{comment}{\ \ \ \ void\ print()\ const\ noexcept;}}
\DoxyCodeLine{00273\ \textcolor{comment}{}}
\DoxyCodeLine{00274\ \textcolor{comment}{\ \ \ \ static\ tensor\ zeros(const\ shape\_type\&\ \_\_sh);}}
\DoxyCodeLine{00275\ \textcolor{comment}{}}
\DoxyCodeLine{00276\ \textcolor{comment}{\ \ \ \ static\ tensor\ ones(const\ shape\_type\&\ \_\_sh);}}
\DoxyCodeLine{00277\ \textcolor{comment}{}}
\DoxyCodeLine{00278\ \textcolor{comment}{\ \ \ \ static\ tensor\ randomize(const\ shape\_type\&\ \_\_sh,\ bool\ \_\_bounded\ =\ false);}}
\DoxyCodeLine{00279\ \textcolor{comment}{}}
\DoxyCodeLine{00280\ \textcolor{comment}{\ \ \ \ tensor<index\_type>\ argmax\_(index\_type\ \_\_dim)\ const;}}
\DoxyCodeLine{00281\ \textcolor{comment}{\ \ \ \ tensor<index\_type>\ argsort(index\_type\ \_\_dim\ =\ -\/1LL,\ bool\ \_\_ascending\ =\ true)\ const;}}
\DoxyCodeLine{00282\ \textcolor{comment}{}}
\DoxyCodeLine{00283\ \textcolor{comment}{\ \ \ private:}}
\DoxyCodeLine{00284\ \textcolor{comment}{\ \ \ \ static\ void\ \_\_check\_is\_scalar\_type(const\ std::string\ \_\_msg);}}
\DoxyCodeLine{00285\ \textcolor{comment}{}}
\DoxyCodeLine{00286\ \textcolor{comment}{\ \ \ \ static\ void\ \_\_check\_is\_integral\_type(const\ std::string\ \_\_msg);}}
\DoxyCodeLine{00287\ \textcolor{comment}{}}
\DoxyCodeLine{00288\ \textcolor{comment}{\ \ \ \ template<typename\ \_\_t>}}
\DoxyCodeLine{00289\ \textcolor{comment}{\ \ \ \ static\ void\ \_\_check\_is\_same\_type(const\ std::string\ \_\_msg);}}
\DoxyCodeLine{00290\ \textcolor{comment}{\ \ \ \ static\ void\ \_\_check\_is\_arithmetic\_type(const\ std::string\ \_\_msg);}}
\DoxyCodeLine{00291\ \textcolor{comment}{\ \ \ \ void\ \ \ \ \ \ \ \ \_\_compute\_strides();}}
\DoxyCodeLine{00292\ \textcolor{comment}{\ \ \ \ size\_t\ \ \ \ \ \ \_\_compute\_index(const\ std::vector<index\_type>\&\ \_\_idx)\ const;}}
\DoxyCodeLine{00293\ \textcolor{comment}{\ \ \ \ uint64\_t\ \ \ \ \_\_computeSize(const\ shape\_type\&\ \_\_dims)\ const;}}
\DoxyCodeLine{00294\ \textcolor{comment}{\ \ \ \ uint64\_t\ \ \ \ \_\_compute\_outer\_size(const\ index\_type\ \_\_dim)\ const;}}
\DoxyCodeLine{00295\ \textcolor{comment}{\ \ \ \ float\ \ \ \ \ \ \ \_\_frac(const\_reference\ \_\_scalar);}}
\DoxyCodeLine{00296\ \textcolor{comment}{\ \ \ \ index\_type\ \ \_\_lcm(const\ index\_type\ \_\_a,\ const\ index\_type\ \_\_b);}}
\DoxyCodeLine{00297\ \textcolor{comment}{\};\ \ //\ tensor\ class}}
\DoxyCodeLine{00298\ \textcolor{comment}{*/}}
\DoxyCodeLine{00299\ }
\DoxyCodeLine{00300\ \textcolor{keyword}{enum\ class}\ Device\ \{}
\DoxyCodeLine{00301\ \ \ \ \ CPU,}
\DoxyCodeLine{00302\ \ \ \ \ CUDA}
\DoxyCodeLine{00303\ \};}
\DoxyCodeLine{00304\ }
\DoxyCodeLine{00305\ \textcolor{comment}{/*tensor\ implementation*/}}
\DoxyCodeLine{00306\ }
\DoxyCodeLine{00307\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{00308\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classtensor}{tensor}}}
\DoxyCodeLine{00309\ \{}
\DoxyCodeLine{00310\ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00311\ \ \ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{classtensor}{tensor}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_self;}
\DoxyCodeLine{00312\ \ \ \ \ \textcolor{keyword}{typedef}\ \_Tp\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ value\_type;}
\DoxyCodeLine{00313\ \ \ \ \ \textcolor{keyword}{typedef}\ int64\_t\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ index\_type;}
\DoxyCodeLine{00314\ \ \ \ \ \textcolor{keyword}{typedef}\ std::vector<index\_type>\ shape\_type;}
\DoxyCodeLine{00315\ \ \ \ \ \textcolor{keyword}{typedef}\ value\_type\&\ \ \ \ \ \ \ \ \ \ \ \ \ reference;}
\DoxyCodeLine{00316\ \ \ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{const}\ value\_type\&\ \ \ \ \ \ \ const\_reference;}
\DoxyCodeLine{00317\ \ \ \ \ \textcolor{keyword}{typedef}\ value\_type*\ \ \ \ \ \ \ \ \ \ \ \ \ pointer;}
\DoxyCodeLine{00318\ \ \ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{const}\ value\_type*\ \ \ \ \ \ \ const\_pointer;}
\DoxyCodeLine{00319\ \ \ \ \ \textcolor{keyword}{typedef}\ std::vector<value\_type>\ data\_t;}
\DoxyCodeLine{00320\ \ \ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{const}\ data\_t\ \ \ \ \ \ \ \ \ \ \ \ const\_data\_container;}
\DoxyCodeLine{00321\ }
\DoxyCodeLine{00322\ \ \ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ data\_t::iterator\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ iterator;}
\DoxyCodeLine{00323\ \ \ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ data\_t::const\_iterator\ \ \ \ \ \ \ \ \ const\_iterator;}
\DoxyCodeLine{00324\ \ \ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ data\_t::reverse\_iterator\ \ \ \ \ \ \ reverse\_iterator;}
\DoxyCodeLine{00325\ \ \ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ data\_t::const\_reverse\_iterator\ const\_reverse\_iterator;}
\DoxyCodeLine{00326\ }
\DoxyCodeLine{00327\ }
\DoxyCodeLine{00328\ \ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00329\ \ \ \ \ data\_t\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_data\_;}
\DoxyCodeLine{00330\ \ \ \ \ shape\_type\ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_shape\_;}
\DoxyCodeLine{00331\ \ \ \ \ std::vector<index\_type>\ \_\_strides\_;}
\DoxyCodeLine{00332\ \ \ \ \ Device\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_device\_;}
\DoxyCodeLine{00333\ }
\DoxyCodeLine{00334\ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00335\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}()\ =\ \textcolor{keywordflow}{default};}
\DoxyCodeLine{00336\ }
\DoxyCodeLine{00337\ \ \ \ \ \textcolor{keyword}{explicit}\ \mbox{\hyperlink{classtensor}{tensor}}(\textcolor{keyword}{const}\ shape\_type\&\ \_\_sh,\ \textcolor{keyword}{const}\ value\_type\&\ \_\_v,\ Device\ \_\_d\ =\ Device::CPU)\ :}
\DoxyCodeLine{00338\ \ \ \ \ \ \ \ \ \_\_shape\_(\_\_sh),}
\DoxyCodeLine{00339\ \ \ \ \ \ \ \ \ \_\_data\_(this-\/>\_\_computeSize(\_\_sh),\ \_\_v),}
\DoxyCodeLine{00340\ \ \ \ \ \ \ \ \ \_\_device\_(\_\_d)\ \{}
\DoxyCodeLine{00341\ \ \ \ \ \ \ \ \ this-\/>\_\_compute\_strides();}
\DoxyCodeLine{00342\ \ \ \ \ \}}
\DoxyCodeLine{00343\ }
\DoxyCodeLine{00344\ \ \ \ \ \textcolor{keyword}{explicit}\ \mbox{\hyperlink{classtensor}{tensor}}(\textcolor{keyword}{const}\ shape\_type\&\ \_\_sh,\ Device\ \_\_d\ =\ Device::CPU)\ :}
\DoxyCodeLine{00345\ \ \ \ \ \ \ \ \ \_\_shape\_(\_\_sh),}
\DoxyCodeLine{00346\ \ \ \ \ \ \ \ \ \_\_device\_(\_\_d)\ \{}
\DoxyCodeLine{00347\ \ \ \ \ \ \ \ \ index\_type\ \_\_s\ =\ this-\/>\_\_computeSize(\_\_sh);}
\DoxyCodeLine{00348\ \ \ \ \ \ \ \ \ this-\/>\_\_data\_\ \ =\ data\_t(\_\_s);}
\DoxyCodeLine{00349\ \ \ \ \ \ \ \ \ this-\/>\_\_compute\_strides();}
\DoxyCodeLine{00350\ \ \ \ \ \}}
\DoxyCodeLine{00351\ }
\DoxyCodeLine{00352\ \ \ \ \ \textcolor{keyword}{explicit}\ \mbox{\hyperlink{classtensor}{tensor}}(\textcolor{keyword}{const}\ data\_t\&\ \_\_d,\ \textcolor{keyword}{const}\ shape\_type\&\ \_\_sh,\ Device\ \_\_dev\ =\ Device::CPU)\ :}
\DoxyCodeLine{00353\ \ \ \ \ \ \ \ \ \_\_data\_(\_\_d),}
\DoxyCodeLine{00354\ \ \ \ \ \ \ \ \ \_\_shape\_(\_\_sh),}
\DoxyCodeLine{00355\ \ \ \ \ \ \ \ \ \_\_device\_(\_\_dev)\ \{}
\DoxyCodeLine{00356\ \ \ \ \ \ \ \ \ this-\/>\_\_compute\_strides();}
\DoxyCodeLine{00357\ \ \ \ \ \}}
\DoxyCodeLine{00358\ }
\DoxyCodeLine{00359\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_t)\ :}
\DoxyCodeLine{00360\ \ \ \ \ \ \ \ \ \_\_data\_(\_\_t.storage()),}
\DoxyCodeLine{00361\ \ \ \ \ \ \ \ \ \_\_shape\_(\_\_t.shape()),}
\DoxyCodeLine{00362\ \ \ \ \ \ \ \ \ \_\_strides\_(\_\_t.strides()),}
\DoxyCodeLine{00363\ \ \ \ \ \ \ \ \ \_\_device\_(\_\_t.\mbox{\hyperlink{classtensor_a1ee059dcb01e158f4975fc692b0ce497}{device}}())\ \{\}}
\DoxyCodeLine{00364\ }
\DoxyCodeLine{00365\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}(\mbox{\hyperlink{classtensor}{tensor}}\&\&\ \_\_t)\ noexcept\ :}
\DoxyCodeLine{00366\ \ \ \ \ \ \ \ \ \_\_data\_(std::move(\_\_t.storage())),}
\DoxyCodeLine{00367\ \ \ \ \ \ \ \ \ \_\_shape\_(std::move(\_\_t.shape())),}
\DoxyCodeLine{00368\ \ \ \ \ \ \ \ \ \_\_strides\_(std::move(\_\_t.strides())),}
\DoxyCodeLine{00369\ \ \ \ \ \ \ \ \ \_\_device\_(std::move(\_\_t.device()))\ \{\}}
\DoxyCodeLine{00370\ }
\DoxyCodeLine{00371\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}(\textcolor{keyword}{const}\ shape\_type\&\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_sh,}
\DoxyCodeLine{00372\ \ \ \ \ \ \ \ \ \ \ \ std::initializer\_list<value\_type>\ init\_list,}
\DoxyCodeLine{00373\ \ \ \ \ \ \ \ \ \ \ \ Device\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_d\ =\ Device::CPU)\ :}
\DoxyCodeLine{00374\ \ \ \ \ \ \ \ \ \_\_shape\_(\_\_sh),}
\DoxyCodeLine{00375\ \ \ \ \ \ \ \ \ \_\_device\_(\_\_d)\ \{}
\DoxyCodeLine{00376\ \ \ \ \ \ \ \ \ index\_type\ \_\_s\ =\ this-\/>\_\_computeSize(\_\_sh);}
\DoxyCodeLine{00377\ \ \ \ \ \ \ \ \ assert(init\_list.size()\ ==\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{size\_t}\textcolor{keyword}{>}(\_\_s)}
\DoxyCodeLine{00378\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\&\ \textcolor{stringliteral}{"{}Initializer\ list\ size\ must\ match\ tensor\ size"{}});}
\DoxyCodeLine{00379\ \ \ \ \ \ \ \ \ this-\/>\_\_data\_\ =\ data\_t(init\_list);}
\DoxyCodeLine{00380\ \ \ \ \ \ \ \ \ this-\/>\_\_compute\_strides();}
\DoxyCodeLine{00381\ \ \ \ \ \}}
\DoxyCodeLine{00382\ }
\DoxyCodeLine{00383\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}(\textcolor{keyword}{const}\ shape\_type\&\ \_\_sh,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\ :}
\DoxyCodeLine{00384\ \ \ \ \ \ \ \ \ \_\_data\_(\_\_other.storage()),}
\DoxyCodeLine{00385\ \ \ \ \ \ \ \ \ \_\_shape\_(\_\_sh),}
\DoxyCodeLine{00386\ \ \ \ \ \ \ \ \ \_\_device\_(\_\_other.\mbox{\hyperlink{classtensor_a1ee059dcb01e158f4975fc692b0ce497}{device}}())\ \{}
\DoxyCodeLine{00387\ \ \ \ \ \ \ \ \ this-\/>\_\_compute\_strides();}
\DoxyCodeLine{00388\ \ \ \ \ \}}
\DoxyCodeLine{00389\ }
\DoxyCodeLine{00390\ \ \ \ \ \textcolor{keywordtype}{bool}\ \_\_is\_cuda\_device\ =\ this-\/>\_\_device\_\ ==\ Device::CUDA\ ?\ true\ :\ \textcolor{keyword}{false};}
\DoxyCodeLine{00391\ }
\DoxyCodeLine{00392\ \ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00393\ \ \ \ \ \textcolor{keyword}{class\ }\_\_destroy\_tensor}
\DoxyCodeLine{00394\ \ \ \ \ \{}
\DoxyCodeLine{00395\ \ \ \ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00396\ \ \ \ \ \ \ \ \ \textcolor{keyword}{explicit}\ \_\_destroy\_tensor(\mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_tens)\ :}
\DoxyCodeLine{00397\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_tens\_(\_\_tens)\ \{\}}
\DoxyCodeLine{00398\ }
\DoxyCodeLine{00399\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ operator()()\ \{\}}
\DoxyCodeLine{00400\ }
\DoxyCodeLine{00401\ \ \ \ \ \ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00402\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_tens\_;}
\DoxyCodeLine{00403\ \ \ \ \ \};}
\DoxyCodeLine{00404\ }
\DoxyCodeLine{00405\ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00406\ \ \ \ \ \mbox{\hyperlink{classtensor}{\string~tensor}}()\ \{\ \_\_destroy\_tensor\ (*\textcolor{keyword}{this})();\ \}}
\DoxyCodeLine{00407\ }
\DoxyCodeLine{00408\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\&\ operator=(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other);}
\DoxyCodeLine{00409\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\&\ operator=(\mbox{\hyperlink{classtensor}{tensor}}\&\&\ \_\_other)\ \textcolor{keyword}{noexcept};}
\DoxyCodeLine{00410\ }
\DoxyCodeLine{00411\ \ \ \ \ const\_iterator\ begin()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ this-\/>\_\_data\_.begin();\ \}}
\DoxyCodeLine{00412\ \ \ \ \ const\_iterator\ end()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ this-\/>\_\_data\_.end();\ \}}
\DoxyCodeLine{00413\ }
\DoxyCodeLine{00414\ \ \ \ \ const\_reverse\_iterator\ rbegin()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ const\_reverse\_iterator(end());\ \}}
\DoxyCodeLine{00415\ \ \ \ \ const\_reverse\_iterator\ rend()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ const\_reverse\_iterator(begin());\ \}}
\DoxyCodeLine{00416\ }
\DoxyCodeLine{00421\ \ \ \ \ data\_t\ \mbox{\hyperlink{classtensor_a72e61a1ae3a8be0bf05a2c70ae87e07a}{storage}}()\ const\ noexcept\ \{\ \textcolor{keywordflow}{return}\ this-\/>\_\_data\_;\ \}}
\DoxyCodeLine{00426\ \ \ \ \ shape\_type\ \mbox{\hyperlink{classtensor_af4b56559e27899b16f97f893789eba1e}{shape}}()\ const\ noexcept\ \{\ \textcolor{keywordflow}{return}\ this-\/>\_\_shape\_;\ \}}
\DoxyCodeLine{00431\ \ \ \ \ shape\_type\ \mbox{\hyperlink{classtensor_a413d1d32f53e498286b6635a27027852}{strides}}()\ const\ noexcept\ \{\ \textcolor{keywordflow}{return}\ this-\/>\_\_strides\_;\ \}}
\DoxyCodeLine{00436\ \ \ \ \ Device\ \mbox{\hyperlink{classtensor_a1ee059dcb01e158f4975fc692b0ce497}{device}}()\ const\ noexcept\ \{\ \textcolor{keywordflow}{return}\ this-\/>\_\_device\_;\ \}}
\DoxyCodeLine{00441\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classtensor_a5ca3eb4e8f9e1fb6a12a84bb2ea8a88c}{n\_dims}}()\ const\ noexcept\ \{\ \textcolor{keywordflow}{return}\ this-\/>\_\_shape\_.size();\ \}}
\DoxyCodeLine{00442\ }
\DoxyCodeLine{00448\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classtensor_aea1ca9c0bbcbfc682b0f533c435ca9e9}{size}}(\textcolor{keyword}{const}\ index\_type\ \_\_dim)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00449\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_\_dim\ <\ 0\ ||\ \_\_dim\ >=\ \textcolor{keyword}{static\_cast<}index\_type\textcolor{keyword}{>}(this-\/>\_\_shape\_.size()))}
\DoxyCodeLine{00450\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00451\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::invalid\_argument(\textcolor{stringliteral}{"{}dimension\ input\ is\ out\ of\ range"{}});}
\DoxyCodeLine{00452\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00453\ }
\DoxyCodeLine{00454\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_\_dim\ ==\ 0)}
\DoxyCodeLine{00455\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00456\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ this-\/>\_\_computeSize(this-\/>\_\_shape\_);}
\DoxyCodeLine{00457\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00458\ }
\DoxyCodeLine{00459\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ this-\/>\_\_shape\_[\_\_dim];}
\DoxyCodeLine{00460\ \ \ \ \ \}}
\DoxyCodeLine{00461\ }
\DoxyCodeLine{00466\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classtensor_ab39a76ae4819e472970b6238a701e3cd}{capacity}}()\ const\ noexcept\ \{\ \textcolor{keywordflow}{return}\ this-\/>\_\_data\_.capacity();\ \}}
\DoxyCodeLine{00472\ \ \ \ \ reference\ \mbox{\hyperlink{classtensor_a2d8579b56377185e357d7845c8f5790d}{at}}(shape\_type\ \_\_idx);}
\DoxyCodeLine{00478\ \ \ \ \ const\_reference\ \mbox{\hyperlink{classtensor_ae13f75b1d5aede44026ef6460c299133}{at}}(\textcolor{keyword}{const}\ shape\_type\ \_\_idx)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00479\ }
\DoxyCodeLine{00485\ \ \ \ \ reference\ \mbox{\hyperlink{classtensor_a9e64aa84cd5cf6b5ad6557bb7ace206b}{operator[]}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ \_\_in)\ \{}
\DoxyCodeLine{00486\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_\_in\ >=\ this-\/>\_\_data\_.size()\ ||\ \_\_in\ <\ 0)}
\DoxyCodeLine{00487\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00488\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::out\_of\_range(\textcolor{stringliteral}{"{}Access\ index\ is\ out\ of\ range"{}});}
\DoxyCodeLine{00489\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00490\ }
\DoxyCodeLine{00491\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ this-\/>\_\_data\_[\_\_in];}
\DoxyCodeLine{00492\ \ \ \ \ \}}
\DoxyCodeLine{00493\ }
\DoxyCodeLine{00499\ \ \ \ \ const\_reference\ \mbox{\hyperlink{classtensor_a1d799d7498f5aa7cc6bc14cd89811736}{operator[]}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ \_\_in)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00500\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_\_in\ >=\ this-\/>\_\_data\_.size()\ ||\ \_\_in\ <\ 0)}
\DoxyCodeLine{00501\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00502\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::out\_of\_range(\textcolor{stringliteral}{"{}Access\ index\ is\ out\ of\ range"{}});}
\DoxyCodeLine{00503\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00504\ }
\DoxyCodeLine{00505\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ this-\/>\_\_data\_[\_\_in];}
\DoxyCodeLine{00506\ \ \ \ \ \}}
\DoxyCodeLine{00507\ }
\DoxyCodeLine{00513\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_a6b36211a42d25c7fcbdc420951ef3980}{operator+}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00519\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_af1cebd26ef00087d8c73e2e36101e513}{operator-\/}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00520\ }
\DoxyCodeLine{00526\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_ad92011956b17f6958aefeac943dfafee}{operator-\/=}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00532\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_a43fb9006c48d0f8b6ff83c515f49f2ed}{operator+=}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00538\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_a1eff5b2ee067c2b9b5d8ef6edd072460}{operator*=}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00544\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_a98997813fec16f4b37cbcf1220801c2f}{operator/=}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00550\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_a625983cd49950299596f8b4f355101b0}{operator+}}(\textcolor{keyword}{const}\ value\_type\ \_scalar)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00556\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_a65bed1140148583c2632450421bddcdb}{operator-\/}}(\textcolor{keyword}{const}\ value\_type\ \_\_scalar)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00557\ }
\DoxyCodeLine{00563\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ operator+=(const\_reference\ \_\_scalar)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00569\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ operator-\/=(const\_reference\ \_\_scalar)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00575\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_a98997813fec16f4b37cbcf1220801c2f}{operator/=}}(const\_reference\ \_\_scalar)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00581\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ operator*=(const\_reference\ \_\_scalar)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00582\ }
\DoxyCodeLine{00588\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classtensor_ad5f18cd6977c492f2d40c074c36456e1}{operator==}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00589\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((this-\/>\_\_shape\_\ !=\ \_\_other.shape())\ \&\&\ (this-\/>\_\_strides\_\ !=\ \_\_other.strides()))}
\DoxyCodeLine{00590\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00591\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00592\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00593\ }
\DoxyCodeLine{00594\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ this-\/>\_\_data\_\ ==\ \_\_other.storage();}
\DoxyCodeLine{00595\ \ \ \ \ \}}
\DoxyCodeLine{00596\ }
\DoxyCodeLine{00602\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classtensor_a52525f73888a2a980485aae22a4a3cb6}{operator!=}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ !(*\textcolor{keyword}{this}\ ==\ \_\_other);\ \}}
\DoxyCodeLine{00603\ }
\DoxyCodeLine{00608\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classtensor_a6001b8b369081b7cdeaed39304c165bf}{empty}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ this-\/>\_\_data\_.empty();\ \}}
\DoxyCodeLine{00609\ }
\DoxyCodeLine{00614\ \ \ \ \ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{classtensor_ad42a4223b51afd28b81182034b0abe1d}{mean}}()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00615\ }
\DoxyCodeLine{00620\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor<bool>}}\ \mbox{\hyperlink{classtensor_a96c722c8d9061c254da18c193a158014}{logical\_not}}()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00626\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor<bool>}}\ \mbox{\hyperlink{classtensor_a3ac04456abf5a11ea70c1d87d8f75f13}{logical\_or}}(\textcolor{keyword}{const}\ value\_type\ \_\_val)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00632\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor<bool>}}\ \mbox{\hyperlink{classtensor_a0dc360aa827e1525156c4b4a5de011c8}{logical\_or}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00633\ }
\DoxyCodeLine{00642\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor<bool>}}\ \mbox{\hyperlink{classtensor_a373dc75f35870b9e2c6a9f3531ac951f}{less\_equal}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00643\ }
\DoxyCodeLine{00650\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor<bool>}}\ \mbox{\hyperlink{classtensor_a602d92df2b3622eee910a65021789821}{less\_equal}}(\textcolor{keyword}{const}\ value\_type\ \_\_val)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00651\ }
\DoxyCodeLine{00660\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor<bool>}}\ \mbox{\hyperlink{classtensor_a3037229a04911fdb49bf3d630d2ff9e8}{greater\_equal}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00661\ }
\DoxyCodeLine{00668\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor<bool>}}\ \mbox{\hyperlink{classtensor_a617bac518334dd51278fb4bc02a2b300}{greater\_equal}}(\textcolor{keyword}{const}\ value\_type\ \_\_val)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00669\ }
\DoxyCodeLine{00678\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor<bool>}}\ \mbox{\hyperlink{classtensor_a8c769dc59060620bd81c9e3b3846f694}{equal}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00679\ }
\DoxyCodeLine{00686\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor<bool>}}\ \mbox{\hyperlink{classtensor_aa4e11be82e26420084e5c631a6ac877c}{equal}}(\textcolor{keyword}{const}\ value\_type\ \_\_val)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00687\ }
\DoxyCodeLine{00696\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classtensor_a9e5024764efa18a9e882706d0d778821}{count\_nonzero}}(index\_type\ \_\_dim\ =\ -\/1LL)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00697\ }
\DoxyCodeLine{00709\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_a4b4e2d39e238aa3593cf23ca2f26e718}{slice}}(index\_type\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_dim,}
\DoxyCodeLine{00710\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::optional<index\_type>\ \_\_start,}
\DoxyCodeLine{00711\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::optional<index\_type>\ \_\_end,}
\DoxyCodeLine{00712\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ index\_type\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_step)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00713\ }
\DoxyCodeLine{00722\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_a52752e0a9df45ae4789a7aeffb5a3886}{fmax}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00723\ }
\DoxyCodeLine{00730\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ fmax(\textcolor{keyword}{const}\ value\_type\ \_\_val)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00731\ }
\DoxyCodeLine{00739\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_a50fcf3eb344fc6566d95db639681cada}{fmax\_}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other);}
\DoxyCodeLine{00740\ }
\DoxyCodeLine{00746\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_a50fcf3eb344fc6566d95db639681cada}{fmax\_}}(\textcolor{keyword}{const}\ value\_type\ \_\_val);}
\DoxyCodeLine{00747\ }
\DoxyCodeLine{00756\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_afc4bd671a73337612886d180e1474a3d}{fmod}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00757\ }
\DoxyCodeLine{00764\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ fmod(\textcolor{keyword}{const}\ value\_type\ \_\_val)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00765\ }
\DoxyCodeLine{00773\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_a5160fd8a033949c11118968da884dc7b}{frac}}()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00774\ }
\DoxyCodeLine{00780\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_a3ea7dfde40f9c6770dc29c44056a2156}{log}}()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00781\ }
\DoxyCodeLine{00787\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_a602d6324093f123101cc7db2ba668469}{log10}}()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00788\ }
\DoxyCodeLine{00794\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_a3d32095f1a209c6f14791ff52b17ef36}{log2}}()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00795\ }
\DoxyCodeLine{00801\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_a875a2e416207ab7d21d7280f319d2811}{exp}}()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00802\ }
\DoxyCodeLine{00808\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_a1d77db1bf021441a3def40f465aff222}{sqrt}}()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00809\ }
\DoxyCodeLine{00816\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_a5e940a029c93f209885546325cd40137}{sum}}(\textcolor{keyword}{const}\ index\_type\ \_\_axis)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00817\ }
\DoxyCodeLine{00824\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_af49007c641b05b186ed0194af4f34dfb}{row}}(\textcolor{keyword}{const}\ index\_type\ \_\_index)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00825\ }
\DoxyCodeLine{00832\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_a445a4b1ac467bcf53bb5066f2d30ac4b}{col}}(\textcolor{keyword}{const}\ index\_type\ \_\_index)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00833\ }
\DoxyCodeLine{00841\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_aa95b96a066fd7c9fdf8b9544d073d240}{ceil}}()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00842\ }
\DoxyCodeLine{00850\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_afcd98fdb4626e08981f63a424f4415e7}{floor}}()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00851\ }
\DoxyCodeLine{00859\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_af4d9ed02c039debcba0c7ce99197d08a}{clone}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00860\ \ \ \ \ \ \ \ \ data\_t\ \ \ \ \ \_\_d\ =\ this-\/>\_\_data\_;}
\DoxyCodeLine{00861\ \ \ \ \ \ \ \ \ shape\_type\ \_\_s\ =\ this-\/>\_\_shape\_;}
\DoxyCodeLine{00862\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classtensor}{\_\_self}}(\_\_d,\ \_\_s);}
\DoxyCodeLine{00863\ \ \ \ \ \}}
\DoxyCodeLine{00864\ }
\DoxyCodeLine{00874\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ clamp(const\_pointer\ \_\_min\_val\ =\ \textcolor{keyword}{nullptr},\ const\_pointer\ \_\_max\_val\ =\ \textcolor{keyword}{nullptr})\ \textcolor{keyword}{const};}
\DoxyCodeLine{00875\ }
\DoxyCodeLine{00881\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_a1bf5fc465f680a3b33fb1c509bc4dc93}{cos}}()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00882\ }
\DoxyCodeLine{00888\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_af0a1ce03a6de6dfff6a2ea5c99112a1e}{sin}}()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00889\ }
\DoxyCodeLine{00895\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_aeb1b86b8cee70ea11835c73337472fde}{sinh}}()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00896\ }
\DoxyCodeLine{00902\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_ad2e833191274a6b0dab157c1e11d64a4}{asinh}}()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00903\ }
\DoxyCodeLine{00909\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_a929e7852fcd3caeefe513545d27037b3}{cosh}}()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00910\ }
\DoxyCodeLine{00916\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_aebdbd731c2059f5cbbd5918c541ea986}{acosh}}()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00917\ }
\DoxyCodeLine{00924\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_a62d6154a5e082732a9f42327d071f09d}{logical\_xor}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00925\ }
\DoxyCodeLine{00932\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_af8daceec856815ac882af82b0fbc84dc}{logical\_xor}}(\textcolor{keyword}{const}\ value\_type\ \_\_val)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00933\ }
\DoxyCodeLine{00940\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_a5a320fd86b0e479a6795cc4b61179a4b}{logical\_and}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00941\ }
\DoxyCodeLine{00948\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_ac75503b9ffe82e9f4e705b56fbdf4431}{logical\_and}}(\textcolor{keyword}{const}\ value\_type\ \_\_val)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00949\ }
\DoxyCodeLine{00955\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_abd4feb2e4a8ea40a2aebb1c71a7d4ff1}{bitwise\_not}}()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00956\ }
\DoxyCodeLine{00963\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_a570fd42df92c758794f7e723d63eee44}{bitwise\_and}}(\textcolor{keyword}{const}\ value\_type\ \_\_val)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00964\ }
\DoxyCodeLine{00971\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_ab97fa0c42bda04f0d6472c385ebad3df}{bitwise\_and}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00972\ }
\DoxyCodeLine{00979\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_a40250679b04095915146fef202c9ad0d}{bitwise\_or}}(\textcolor{keyword}{const}\ value\_type\ \_\_val)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00980\ }
\DoxyCodeLine{00987\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_aa44e1727908dcde0b489636d39a9d36c}{bitwise\_or}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00988\ }
\DoxyCodeLine{00995\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_a200275c2657717c819dd999ed3cb9227}{bitwise\_xor}}(\textcolor{keyword}{const}\ value\_type\ \_\_val)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00996\ }
\DoxyCodeLine{01003\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_ae10f9eaae862dc5d2310cd724cc2f8ac}{bitwise\_xor}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\ \textcolor{keyword}{const};}
\DoxyCodeLine{01004\ }
\DoxyCodeLine{01011\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_a2936dc04429a63739592064ea98880fb}{bitwise\_left\_shift}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \_\_amount)\ \textcolor{keyword}{const};}
\DoxyCodeLine{01012\ }
\DoxyCodeLine{01019\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_a947c9bfcbd602caa26a4d95530d70aa6}{bitwise\_right\_shift}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \_\_amount)\ \textcolor{keyword}{const};}
\DoxyCodeLine{01020\ }
\DoxyCodeLine{01029\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_aaad2cf47c11950f3eadb37e979f80915}{matmul}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\ \textcolor{keyword}{const};}
\DoxyCodeLine{01030\ }
\DoxyCodeLine{01039\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ reshape(\textcolor{keyword}{const}\ shape\_type\ \_\_shape)\ \textcolor{keyword}{const};}
\DoxyCodeLine{01040\ }
\DoxyCodeLine{01047\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_a81940759f28f7a48c816cd9ec446b9b3}{reshape\_as}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\ \{\ \textcolor{keywordflow}{return}\ this-\/>reshape(\_\_other.\_\_shape\_);\ \}}
\DoxyCodeLine{01056\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_a387313f030fd5a23bf15e9995d0adc17}{cross\_product}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\ \textcolor{keyword}{const};}
\DoxyCodeLine{01057\ }
\DoxyCodeLine{01064\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_a095db7282b7b96c942254897446a2d7a}{absolute}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_tensor)\ \textcolor{keyword}{const};}
\DoxyCodeLine{01065\ }
\DoxyCodeLine{01074\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_a8f97c11689b76f314fea48555461b56b}{dot}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\ \textcolor{keyword}{const};}
\DoxyCodeLine{01075\ }
\DoxyCodeLine{01081\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_ab4a4f04b5b3cd8a3995aae37e4c8febe}{relu}}()\ \textcolor{keyword}{const};}
\DoxyCodeLine{01082\ }
\DoxyCodeLine{01090\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_aa0400a2a89687c79b39aae7df2fdf5cf}{transpose}}()\ \textcolor{keyword}{const};}
\DoxyCodeLine{01091\ }
\DoxyCodeLine{01100\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_a3a1c379f02eb70c79bf377ad66e179de}{pow}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\ \textcolor{keyword}{const};}
\DoxyCodeLine{01101\ }
\DoxyCodeLine{01108\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_a0f48db22414046cc753f29b2c200668f}{pow}}(\textcolor{keyword}{const}\ value\_type\ \_\_val)\ \textcolor{keyword}{const};}
\DoxyCodeLine{01109\ }
\DoxyCodeLine{01116\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_a70e4695eb515074f90a7bdc0e44cff6d}{cumprod}}(index\_type\ \_\_dim\ =\ -\/1)\ \textcolor{keyword}{const};}
\DoxyCodeLine{01117\ }
\DoxyCodeLine{01127\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_a7f8ce161d42ac5aaec8a1c9a461e21f7}{cat}}(\textcolor{keyword}{const}\ std::vector<tensor>\&\ \_others,\ index\_type\ \_dim)\ \textcolor{keyword}{const};}
\DoxyCodeLine{01128\ }
\DoxyCodeLine{01135\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_a6a468a01a82f881e6adb610bd87bb127}{argmax}}(index\_type\ \_\_dim)\ \textcolor{keyword}{const};}
\DoxyCodeLine{01136\ }
\DoxyCodeLine{01143\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \mbox{\hyperlink{classtensor_a1610887cad5d2ea8a0eef6fb5e38fd9f}{unsqueeze}}(index\_type\ \_\_dim)\ \textcolor{keyword}{const};}
\DoxyCodeLine{01144\ }
\DoxyCodeLine{01149\ \ \ \ \ index\_type\ \mbox{\hyperlink{classtensor_a81394901132a9eaf23d2b8750ef0b064}{lcm}}()\ \textcolor{keyword}{const};}
\DoxyCodeLine{01150\ }
\DoxyCodeLine{01154\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_a5558b4bd06c2493e3fff919f7bcf3f28}{sqrt\_}}()\ \{}
\DoxyCodeLine{01155\ \ \ \ \ \ \ \ \ this-\/>\_\_check\_is\_scalar\_type(\textcolor{stringliteral}{"{}Cannot\ get\ the\ exponential\ of\ non\ scalar\ values"{}});}
\DoxyCodeLine{01156\ }
\DoxyCodeLine{01157\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{01158\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{01159\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01160\ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i]\ =\ \textcolor{keyword}{static\_cast<}value\_type\textcolor{keyword}{>}(std::exp(\textcolor{keywordtype}{double}(this-\/>\_\_data\_[\_\_i])));}
\DoxyCodeLine{01161\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01162\ \ \ \ \ \}}
\DoxyCodeLine{01163\ }
\DoxyCodeLine{01167\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_af157a541d53f179a11390a5150c8616c}{exp\_}}()\ \{}
\DoxyCodeLine{01168\ \ \ \ \ \ \ \ \ this-\/>\_\_check\_is\_scalar\_type(\textcolor{stringliteral}{"{}Cannot\ get\ the\ exponential\ of\ non\ scalar\ values"{}});}
\DoxyCodeLine{01169\ }
\DoxyCodeLine{01170\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{01171\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{01172\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01173\ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i]\ =\ \textcolor{keyword}{static\_cast<}value\_type\textcolor{keyword}{>}(std::exp(\textcolor{keywordtype}{double}(this-\/>\_\_data\_[\_\_i])));}
\DoxyCodeLine{01174\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01175\ \ \ \ \ \}}
\DoxyCodeLine{01176\ }
\DoxyCodeLine{01180\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_aff085a6faf6db3c4c390076be3b29ef2}{log2\_}}()\ \{}
\DoxyCodeLine{01181\ \ \ \ \ \ \ \ \ this-\/>\_\_check\_is\_integral\_type(\textcolor{stringliteral}{"{}Given\ data\ type\ must\ be\ an\ integral"{}});}
\DoxyCodeLine{01182\ }
\DoxyCodeLine{01183\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{01184\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{01185\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01186\ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i]\ =\ \textcolor{keyword}{static\_cast<}value\_type\textcolor{keyword}{>}(std::log2(\textcolor{keywordtype}{double}(this-\/>\_\_data\_[\_\_i])));}
\DoxyCodeLine{01187\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01188\ \ \ \ \ \}}
\DoxyCodeLine{01189\ }
\DoxyCodeLine{01193\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_aa68d8032a606f2001d0730ad6aec7ed7}{log10\_}}()\ \{}
\DoxyCodeLine{01194\ \ \ \ \ \ \ \ \ this-\/>\_\_check\_is\_integral\_type(\textcolor{stringliteral}{"{}Given\ data\ type\ must\ be\ an\ integral"{}});}
\DoxyCodeLine{01195\ }
\DoxyCodeLine{01196\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{01197\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{01198\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01199\ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i]\ =\ \textcolor{keyword}{static\_cast<}value\_type\textcolor{keyword}{>}(std::log10(\textcolor{keywordtype}{double}(this-\/>\_\_data\_[\_\_i])));}
\DoxyCodeLine{01200\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01201\ \ \ \ \ \}}
\DoxyCodeLine{01202\ }
\DoxyCodeLine{01203\ }
\DoxyCodeLine{01207\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_aa9fc20caa8cf9a1a57a44c74edd2be2b}{log\_}}()\ \{}
\DoxyCodeLine{01208\ \ \ \ \ \ \ \ \ this-\/>\_\_check\_is\_integral\_type(\textcolor{stringliteral}{"{}Given\ data\ type\ must\ be\ an\ integral"{}});}
\DoxyCodeLine{01209\ }
\DoxyCodeLine{01210\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{01211\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{01212\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01213\ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i]\ =\ \textcolor{keyword}{static\_cast<}value\_type\textcolor{keyword}{>}(std::log(\textcolor{keywordtype}{double}(this-\/>\_\_data\_[\_\_i])));}
\DoxyCodeLine{01214\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01215\ \ \ \ \ \}}
\DoxyCodeLine{01216\ }
\DoxyCodeLine{01220\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_affbb069c3c362649a62f1a71c33a9a21}{frac\_}}()\ \{}
\DoxyCodeLine{01221\ \ \ \ \ \ \ \ \ this-\/>\_\_check\_is\_scalar\_type(\textcolor{stringliteral}{"{}Cannot\ get\ the\ fraction\ of\ a\ non-\/scalar\ type"{}});}
\DoxyCodeLine{01222\ }
\DoxyCodeLine{01223\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{01224\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{01225\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01226\ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i]\ =\ \textcolor{keyword}{static\_cast<}value\_type\textcolor{keyword}{>}(this-\/>\_\_frac(this-\/>\_\_data\_[\_\_i]));}
\DoxyCodeLine{01227\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01228\ \ \ \ \ \}}
\DoxyCodeLine{01229\ }
\DoxyCodeLine{01233\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_a55144a057c60a4feae1c4a5d884a6e08}{fmod\_}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other);}
\DoxyCodeLine{01234\ }
\DoxyCodeLine{01238\ \ \ \ \ \textcolor{keywordtype}{void}\ fmod\_(\textcolor{keyword}{const}\ value\_type\ \_\_val);}
\DoxyCodeLine{01239\ }
\DoxyCodeLine{01243\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_aa7466d7c1c7eac81e1500964807c6a87}{cos\_}}()\ \{}
\DoxyCodeLine{01244\ \ \ \ \ \ \ \ \ this-\/>\_\_check\_is\_scalar\_type(\textcolor{stringliteral}{"{}Cannot\ perform\ a\ cosine\ on\ non-\/scalar\ data\ type"{}});}
\DoxyCodeLine{01245\ }
\DoxyCodeLine{01246\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{01247\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{01248\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01249\ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i]\ =}
\DoxyCodeLine{01250\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{static\_cast<}value\_type\textcolor{keyword}{>}(std::cos(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(this-\/>\_\_data\_[\_\_i])));}
\DoxyCodeLine{01251\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01252\ \ \ \ \ \}}
\DoxyCodeLine{01253\ }
\DoxyCodeLine{01257\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_a6be46341930fb272ae132eb81cb78e99}{cosh\_}}()\ \{}
\DoxyCodeLine{01258\ \ \ \ \ \ \ \ \ this-\/>\_\_check\_is\_scalar\_type(\textcolor{stringliteral}{"{}Cannot\ perform\ a\ cosh\ on\ non-\/scalar\ data\ type"{}});}
\DoxyCodeLine{01259\ }
\DoxyCodeLine{01260\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{01261\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{01262\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01263\ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i]\ =}
\DoxyCodeLine{01264\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{static\_cast<}value\_type\textcolor{keyword}{>}(std::cosh(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(this-\/>\_\_data\_[\_\_i])));}
\DoxyCodeLine{01265\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01266\ \ \ \ \ \}}
\DoxyCodeLine{01267\ }
\DoxyCodeLine{01271\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_af8d95d60da860cd5658c368afbac8382}{acosh\_}}()\ \{}
\DoxyCodeLine{01272\ \ \ \ \ \ \ \ \ this-\/>\_\_check\_is\_scalar\_type(\textcolor{stringliteral}{"{}Cannot\ perform\ a\ acosh\ on\ non-\/scalar\ data\ type"{}});}
\DoxyCodeLine{01273\ }
\DoxyCodeLine{01274\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{01275\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{01276\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01277\ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i]\ =}
\DoxyCodeLine{01278\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{static\_cast<}value\_type\textcolor{keyword}{>}(std::acosh(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(this-\/>\_\_data\_[\_\_i])));}
\DoxyCodeLine{01279\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01280\ \ \ \ \ \}}
\DoxyCodeLine{01281\ }
\DoxyCodeLine{01285\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_a6950ceb8984fc959053f113d567b16a5}{sinh\_}}()\ \{}
\DoxyCodeLine{01286\ \ \ \ \ \ \ \ \ this-\/>\_\_check\_is\_scalar\_type(\textcolor{stringliteral}{"{}Cannot\ perform\ a\ sin\ on\ non-\/scalar\ data\ type"{}});}
\DoxyCodeLine{01287\ }
\DoxyCodeLine{01288\ \ \ \ \ \ \ \ \ std::transform(this-\/>\_\_data\_.begin(),\ this-\/>\_\_data\_.end(),\ this-\/>\_\_data\_.begin(),}
\DoxyCodeLine{01289\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [](const\_reference\ \_\_v)\ \{}
\DoxyCodeLine{01290\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ return\ static\_cast<value\_type>(std::sinh(static\_cast<double>(\_\_v)))}
\DoxyCodeLine{01291\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{01292\ \ \ \ \ \}}
\DoxyCodeLine{01293\ }
\DoxyCodeLine{01297\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_a530fc216c0ba29e0d952e9fb1cce2eae}{asinh\_}}()\ \{}
\DoxyCodeLine{01298\ \ \ \ \ \ \ \ \ this-\/>\_\_check\_is\_scalar\_type(\textcolor{stringliteral}{"{}Cannot\ perform\ asinh\ on\ non-\/scalar\ data\ type"{}});}
\DoxyCodeLine{01299\ }
\DoxyCodeLine{01300\ \ \ \ \ \ \ \ \ std::transform(this-\/>\_\_data\_.begin(),\ this-\/>\_\_data\_.end(),\ this-\/>\_\_data\_.begin(),}
\DoxyCodeLine{01301\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [](const\_reference\ \_\_v)\ \{}
\DoxyCodeLine{01302\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ return\ static\_cast<value\_type>(std::asinh(static\_cast<double>(\_\_v)))}
\DoxyCodeLine{01303\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{01304\ \ \ \ \ \}}
\DoxyCodeLine{01305\ }
\DoxyCodeLine{01309\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_a8b43919732fd6187b53ff8ddd18ee860}{ceil\_}}()\ \{}
\DoxyCodeLine{01310\ \ \ \ \ \ \ \ \ this-\/>\_\_check\_is\_scalar\_type(\textcolor{stringliteral}{"{}Cannot\ get\ the\ ceiling\ of\ a\ non\ scalar\ value"{}});}
\DoxyCodeLine{01311\ }
\DoxyCodeLine{01312\ \ \ \ \ \ \ \ \ std::transform(this-\/>\_\_data\_.begin(),\ this-\/>\_\_data\_.end(),\ this-\/>\_\_data\_.begin(),}
\DoxyCodeLine{01313\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [](const\_reference\ \_\_v)\ \{}
\DoxyCodeLine{01314\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ return\ static\_cast<value\_type>(std::ceil(static\_cast<double>(\_\_v)))}
\DoxyCodeLine{01315\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{01316\ \ \ \ \ \}}
\DoxyCodeLine{01317\ }
\DoxyCodeLine{01321\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_a6318a92fdf6474f9b2f8cde820f2230d}{floor\_}}()\ \{}
\DoxyCodeLine{01322\ \ \ \ \ \ \ \ \ this-\/>\_\_check\_is\_scalar\_type(\textcolor{stringliteral}{"{}Cannot\ get\ the\ floor\ of\ a\ non\ scalar\ value"{}});}
\DoxyCodeLine{01323\ }
\DoxyCodeLine{01324\ \ \ \ \ \ \ \ \ std::transform(this-\/>\_\_data\_.begin(),\ this-\/>\_\_data\_.end(),\ this-\/>\_\_data\_.begin(),}
\DoxyCodeLine{01325\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [](const\_reference\ \_\_v)\ \{}
\DoxyCodeLine{01326\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ return\ static\_cast<value\_type>(std::floor(static\_cast<double>(\_\_v)))}
\DoxyCodeLine{01327\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{01328\ \ \ \ \ \}}
\DoxyCodeLine{01329\ }
\DoxyCodeLine{01333\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_a5d175d2c6884b43e1530fead8df35aed}{sin\_}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01334\ \ \ \ \ \ \ \ \ this-\/>\_\_check\_is\_scalar\_type(\textcolor{stringliteral}{"{}Cannot\ perform\ a\ sin\ on\ non-\/scalar\ data\ type"{}});}
\DoxyCodeLine{01335\ }
\DoxyCodeLine{01336\ \ \ \ \ \ \ \ \ std::transform(this-\/>\_\_data\_.begin(),\ this-\/>\_\_data\_.end(),\ this-\/>\_\_data\_.begin(),}
\DoxyCodeLine{01337\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [](const\_reference\ \_\_v)\ \{}
\DoxyCodeLine{01338\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ return\ static\_cast<value\_type>(std::sin(static\_cast<double>(\_\_v)))}
\DoxyCodeLine{01339\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{01340\ \ \ \ \ \}}
\DoxyCodeLine{01341\ }
\DoxyCodeLine{01345\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_a0e71c49ca5485d2407842ee72c1e5aad}{relu\_}}();}
\DoxyCodeLine{01346\ }
\DoxyCodeLine{01350\ \ \ \ \ \textcolor{keywordtype}{void}\ clamp\_(const\_pointer\ \_\_min\_val\ =\ \textcolor{keyword}{nullptr},\ const\_pointer\ \_\_max\_val\ =\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{01351\ }
\DoxyCodeLine{01355\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_ac57983dd6df8f7ca1928e163617e3f39}{logical\_not\_}}()\textcolor{keyword}{\ const\ }\{\ this-\/>bitwise\_not\_();\ \}}
\DoxyCodeLine{01356\ }
\DoxyCodeLine{01360\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_ac8252b697b080ee7a46df90d49a71cd2}{logical\_or\_}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other);}
\DoxyCodeLine{01361\ }
\DoxyCodeLine{01365\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_ab32cb8d651eff3944a937a5a44475fa9}{logical\_or\_}}(\textcolor{keyword}{const}\ value\_type\ \_\_val);}
\DoxyCodeLine{01366\ }
\DoxyCodeLine{01370\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_a49863ae3e46368e7608cfbcc7a6457b4}{logical\_xor\_}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other);}
\DoxyCodeLine{01371\ }
\DoxyCodeLine{01375\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_a1a295718e73e075331e2b06d666bc134}{logical\_xor\_}}(\textcolor{keyword}{const}\ value\_type\ \_\_val);}
\DoxyCodeLine{01376\ }
\DoxyCodeLine{01377\ \ \ \ \ \textcolor{keywordtype}{void}\ logical\_and\_(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other);}
\DoxyCodeLine{01378\ \ \ \ \ \textcolor{keywordtype}{void}\ logical\_and\_(\textcolor{keyword}{const}\ value\_type\ \_\_val);}
\DoxyCodeLine{01379\ }
\DoxyCodeLine{01380\ \ \ \ \ \textcolor{keywordtype}{void}\ pow\_(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\ \textcolor{keyword}{const};}
\DoxyCodeLine{01381\ }
\DoxyCodeLine{01382\ \ \ \ \ \textcolor{keywordtype}{void}\ pow\_(\textcolor{keyword}{const}\ value\_type\ \_\_val)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01383\ \ \ \ \ \ \ \ \ this-\/>\_\_check\_is\_integral\_type(\textcolor{stringliteral}{"{}cannot\ get\ the\ power\ of\ a\ non\ integral\ value"{}});}
\DoxyCodeLine{01384\ }
\DoxyCodeLine{01385\ \ \ \ \ \ \ \ \ std::transform(this-\/>\_\_data\_.begin(),\ this-\/>\_\_data\_.end(),\ this-\/>\_\_data\_.begin(),}
\DoxyCodeLine{01386\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [\&\_\_val](const\_reference\ \_\_v)\ \{}
\DoxyCodeLine{01387\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ return\ static\_cast<value\_type>(}
\DoxyCodeLine{01388\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::pow(static\_cast<double>(\_\_v),\ static\_cast<double>(\_\_val)))}
\DoxyCodeLine{01389\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{01390\ \ \ \ \ \}}
\DoxyCodeLine{01391\ }
\DoxyCodeLine{01392\ \ \ \ \ \textcolor{keywordtype}{void}\ bitwise\_left\_shift\_(\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \_\_amount)\ \{}
\DoxyCodeLine{01393\ \ \ \ \ \ \ \ \ this-\/>\_\_check\_is\_integral\_type(}
\DoxyCodeLine{01394\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Cannot\ perform\ a\ bitwise\ left\ shift\ on\ non-\/integral\ values"{}});}
\DoxyCodeLine{01395\ }
\DoxyCodeLine{01396\ \ \ \ \ \ \ \ \ std::transform(this-\/>\_\_data\_.begin(),\ this-\/>\_\_data\_.end(),\ this-\/>\_\_data\_.begin(),}
\DoxyCodeLine{01397\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [\&\_\_amount](const\_reference\ \_\_v)\ \{\ return\ \_\_v\ <<=\ \_\_amount;\ \});}
\DoxyCodeLine{01398\ \ \ \ \ \}}
\DoxyCodeLine{01399\ }
\DoxyCodeLine{01400\ \ \ \ \ \textcolor{keywordtype}{void}\ bitwise\_right\_shift\_(\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \_\_amount)\ \{}
\DoxyCodeLine{01401\ \ \ \ \ \ \ \ \ this-\/>\_\_check\_is\_integral\_type(}
\DoxyCodeLine{01402\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Cannot\ perform\ a\ bitwise\ right\ shift\ on\ non-\/integral\ values"{}});}
\DoxyCodeLine{01403\ }
\DoxyCodeLine{01404\ \ \ \ \ \ \ \ \ std::transform(this-\/>\_\_data\_.begin(),\ this-\/>\_\_data\_.end(),\ this-\/>\_\_data\_.begin(),}
\DoxyCodeLine{01405\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [\&\_\_amount](const\_reference\ \_\_v)\ \{\ return\ \_\_v\ >>=\ amount;\ \});}
\DoxyCodeLine{01406\ \ \ \ \ \}}
\DoxyCodeLine{01407\ }
\DoxyCodeLine{01408\ \ \ \ \ \textcolor{keywordtype}{void}\ bitwise\_and\_(\textcolor{keyword}{const}\ value\_type\ \_\_val);}
\DoxyCodeLine{01409\ \ \ \ \ \textcolor{keywordtype}{void}\ bitwise\_and\_(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other);}
\DoxyCodeLine{01410\ }
\DoxyCodeLine{01411\ \ \ \ \ \textcolor{keywordtype}{void}\ bitwise\_or\_(\textcolor{keyword}{const}\ value\_type\ \_\_val);}
\DoxyCodeLine{01412\ \ \ \ \ \textcolor{keywordtype}{void}\ bitwise\_or\_(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other);}
\DoxyCodeLine{01413\ }
\DoxyCodeLine{01414\ \ \ \ \ \textcolor{keywordtype}{void}\ bitwise\_xor\_(\textcolor{keyword}{const}\ value\_type\ \_\_val);}
\DoxyCodeLine{01415\ \ \ \ \ \textcolor{keywordtype}{void}\ bitwise\_xor\_(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other);}
\DoxyCodeLine{01416\ }
\DoxyCodeLine{01417\ \ \ \ \ \textcolor{keywordtype}{void}\ bitwise\_not\_();}
\DoxyCodeLine{01418\ }
\DoxyCodeLine{01419\ \ \ \ \ \textcolor{keywordtype}{void}\ view(std::initializer\_list<index\_type>\ \_\_new\_sh);}
\DoxyCodeLine{01420\ \ \ \ \ \textcolor{keywordtype}{void}\ print()\ const\ noexcept;}
\DoxyCodeLine{01421\ }
\DoxyCodeLine{01422\ \ \ \ \ static\ \mbox{\hyperlink{classtensor}{tensor}}\ zeros(const\ shape\_type\&\ \_\_sh)\ \{}
\DoxyCodeLine{01423\ \ \ \ \ \ \ \ \ \_\_check\_is\_scalar\_type(\textcolor{stringliteral}{"{}template\ type\ must\ be\ a\ scalar\ :\ tensor.zeros()"{}});}
\DoxyCodeLine{01424\ \ \ \ \ \ \ \ \ data\_t\ \_\_d(std::accumulate(\_\_sh.begin(),\ \_\_sh.end(),\ 1,\ std::multiplies<index\_type>()),}
\DoxyCodeLine{01425\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ value\_type(0));}
\DoxyCodeLine{01426\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(\_\_d,\ \_\_sh);}
\DoxyCodeLine{01427\ \ \ \ \ \}}
\DoxyCodeLine{01428\ }
\DoxyCodeLine{01429\ \ \ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{classtensor}{tensor}}\ ones(\textcolor{keyword}{const}\ shape\_type\&\ \_\_sh)\ \{}
\DoxyCodeLine{01430\ \ \ \ \ \ \ \ \ \_\_check\_is\_scalar\_type(\textcolor{stringliteral}{"{}template\ type\ must\ be\ a\ scalar\ :\ tensor.ones()"{}});}
\DoxyCodeLine{01431\ \ \ \ \ \ \ \ \ data\_t\ \_\_d(std::accumulate(\_\_sh.begin(),\ \_\_sh.end(),\ 1,\ std::multiplies<index\_type>()),}
\DoxyCodeLine{01432\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ value\_type(1));}
\DoxyCodeLine{01433\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(\_\_d,\ \_\_sh);}
\DoxyCodeLine{01434\ \ \ \ \ \}}
\DoxyCodeLine{01435\ }
\DoxyCodeLine{01436\ \ \ \ \ \textcolor{keywordtype}{void}\ zeros\_(\textcolor{keyword}{const}\ shape\_type\&\ \_\_sh\ =\ \{\})\ \{}
\DoxyCodeLine{01437\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_\_sh.empty())}
\DoxyCodeLine{01438\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01439\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_sh\ =\ this-\/>\_\_shape\_;}
\DoxyCodeLine{01440\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01441\ }
\DoxyCodeLine{01442\ \ \ \ \ \ \ \ \ this-\/>\_\_data\_\ =}
\DoxyCodeLine{01443\ \ \ \ \ \ \ \ \ \ \ \ \ data\_t(std::accumulate(\_\_sh.begin(),\ \_\_sh.end(),\ 1,\ std::multiplies<index\_type>()),}
\DoxyCodeLine{01444\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ value\_type(0));}
\DoxyCodeLine{01445\ \ \ \ \ \}}
\DoxyCodeLine{01446\ }
\DoxyCodeLine{01447\ \ \ \ \ \textcolor{keywordtype}{void}\ ones\_(\textcolor{keyword}{const}\ shape\_type\&\ \_\_sh\ =\ \{\})\ \{}
\DoxyCodeLine{01448\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_\_sh.empty())}
\DoxyCodeLine{01449\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01450\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_sh\ =\ this-\/>\_\_shape\_;}
\DoxyCodeLine{01451\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01452\ }
\DoxyCodeLine{01453\ \ \ \ \ \ \ \ \ this-\/>\_\_data\_\ =}
\DoxyCodeLine{01454\ \ \ \ \ \ \ \ \ \ \ \ \ data\_t(std::accumulate(\_\_sh.begin(),\ \_\_sh.end(),\ 1,\ std::multiplies<index\_type>()),}
\DoxyCodeLine{01455\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ value\_type(0));}
\DoxyCodeLine{01456\ \ \ \ \ \}}
\DoxyCodeLine{01457\ }
\DoxyCodeLine{01458\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ randomize(\textcolor{keyword}{const}\ shape\_type\&\ \_\_sh,\ \textcolor{keywordtype}{bool}\ \_\_bounded\ =\ \textcolor{keyword}{false});}
\DoxyCodeLine{01459\ \ \ \ \ \textcolor{keywordtype}{void}\ \ \ randomize\_(\textcolor{keyword}{const}\ shape\_type\&\ \_\_sh,\ \textcolor{keywordtype}{bool}\ \_\_bounded\ =\ \textcolor{keyword}{false});}
\DoxyCodeLine{01460\ }
\DoxyCodeLine{01461\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor<index\_type>}}\ argmax\_(index\_type\ \_\_dim)\ \textcolor{keyword}{const};}
\DoxyCodeLine{01462\ }
\DoxyCodeLine{01463\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor<index\_type>}}\ argsort(index\_type\ \_\_dim\ =\ -\/1LL,\ \textcolor{keywordtype}{bool}\ \_\_ascending\ =\ \textcolor{keyword}{true})\ \textcolor{keyword}{const};}
\DoxyCodeLine{01464\ }
\DoxyCodeLine{01465\ \ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{01466\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ \_\_check\_is\_scalar\_type(\textcolor{keyword}{const}\ std::string\ \_\_msg)\ \{}
\DoxyCodeLine{01467\ \ \ \ \ \ \ \ \ assert(!\_\_msg.empty());}
\DoxyCodeLine{01468\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!std::is\_scalar<value\_type>::value)}
\DoxyCodeLine{01469\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01470\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(\_\_msg);}
\DoxyCodeLine{01471\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01472\ \ \ \ \ \}}
\DoxyCodeLine{01473\ }
\DoxyCodeLine{01474\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ \_\_check\_is\_integral\_type(\textcolor{keyword}{const}\ std::string\ \_\_msg)\ \{}
\DoxyCodeLine{01475\ \ \ \ \ \ \ \ \ assert(!\_\_msg.empty());}
\DoxyCodeLine{01476\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!std::is\_integral<value\_type>::value)}
\DoxyCodeLine{01477\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01478\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(\_\_msg);}
\DoxyCodeLine{01479\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01480\ \ \ \ \ \}}
\DoxyCodeLine{01481\ }
\DoxyCodeLine{01482\ \ \ \ \ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ \_\_t>}
\DoxyCodeLine{01483\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ \_\_check\_is\_same\_type(\textcolor{keyword}{const}\ std::string\ \_\_msg)\ \{}
\DoxyCodeLine{01484\ \ \ \ \ \ \ \ \ assert(!\_\_msg.empty());}
\DoxyCodeLine{01485\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!std::is\_same<value\_type,\ \_\_t>::value)}
\DoxyCodeLine{01486\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01487\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(\_\_msg);}
\DoxyCodeLine{01488\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01489\ \ \ \ \ \}}
\DoxyCodeLine{01490\ }
\DoxyCodeLine{01491\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ \_\_check\_is\_arithmetic\_type(\textcolor{keyword}{const}\ std::string\ \_\_msg)\ \{}
\DoxyCodeLine{01492\ \ \ \ \ \ \ \ \ assert(!\_\_msg.empty());}
\DoxyCodeLine{01493\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!std::is\_arithmetic<value\_type>::value)}
\DoxyCodeLine{01494\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01495\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(\_\_msg);}
\DoxyCodeLine{01496\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01497\ \ \ \ \ \}}
\DoxyCodeLine{01498\ }
\DoxyCodeLine{01499\ \ \ \ \ \textcolor{keywordtype}{void}\ \_\_compute\_strides()\ \{}
\DoxyCodeLine{01500\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (this-\/>\_\_shape\_.empty())}
\DoxyCodeLine{01501\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01502\ \ \ \ \ \ \ \ \ \ \ \ \ std::cerr\ <<\ \textcolor{stringliteral}{"{}Shape\ must\ be\ initialized\ before\ computing\ strides"{}}\ <<\ std::endl;}
\DoxyCodeLine{01503\ \ \ \ \ \ \ \ \ \ \ \ \ std::exit(EXIT\_FAILURE);}
\DoxyCodeLine{01504\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01505\ }
\DoxyCodeLine{01506\ \ \ \ \ \ \ \ \ this-\/>\_\_strides\_\ =\ shape\_type(this-\/>\_\_shape\_.size(),\ 1);}
\DoxyCodeLine{01507\ }
\DoxyCodeLine{01508\ \ \ \ \ \ \ \ \ index\_type\ \_\_st\ =\ 1,\ \_\_i\ =\ this-\/>\_\_shape\_.size()\ -\/\ 1;}
\DoxyCodeLine{01509\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ >=\ 0;\ \_\_i-\/-\/)}
\DoxyCodeLine{01510\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01511\ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>\_\_strides\_[\_\_i]\ =\ \_\_st;}
\DoxyCodeLine{01512\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_st\ *=\ this-\/>\_\_shape\_[\_\_i];}
\DoxyCodeLine{01513\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01514\ \ \ \ \ \}}
\DoxyCodeLine{01515\ }
\DoxyCodeLine{01516\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_compute\_index(\textcolor{keyword}{const}\ std::vector<index\_type>\&\ \_\_idx)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01517\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_\_idx.size()\ !=\ this-\/>\_\_shape\_.size())}
\DoxyCodeLine{01518\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01519\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::out\_of\_range(\textcolor{stringliteral}{"{}input\ indices\ does\ not\ match\ the\ tensor\ \_\_shape\_"{}});}
\DoxyCodeLine{01520\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01521\ }
\DoxyCodeLine{01522\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_index\ =\ 0,\ \_\_i\ =\ 0;}
\DoxyCodeLine{01523\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_shape\_.size();\ \_\_i++)}
\DoxyCodeLine{01524\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01525\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_index\ +=\ \_\_idx[\_\_i]\ *\ this-\/>\_\_strides\_[\_\_i];}
\DoxyCodeLine{01526\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01527\ }
\DoxyCodeLine{01528\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_index;}
\DoxyCodeLine{01529\ \ \ \ \ \}}
\DoxyCodeLine{01530\ }
\DoxyCodeLine{01531\ \ \ \ \ \textcolor{keyword}{static}\ uint64\_t\ \_\_computeSize(\textcolor{keyword}{const}\ shape\_type\&\ \_\_dims)\ \{}
\DoxyCodeLine{01532\ \ \ \ \ \ \ \ \ uint64\_t\ \_\_ret\ =\ 1ULL;}
\DoxyCodeLine{01533\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ index\_type\&\ \_\_d\ :\ \_\_dims)}
\DoxyCodeLine{01534\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01535\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret\ *=\ \_\_d;}
\DoxyCodeLine{01536\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01537\ }
\DoxyCodeLine{01538\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_ret;}
\DoxyCodeLine{01539\ \ \ \ \ \}}
\DoxyCodeLine{01540\ }
\DoxyCodeLine{01541\ \ \ \ \ uint64\_t\ \_\_compute\_outer\_size(\textcolor{keyword}{const}\ index\_type\ \_\_dim)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01542\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ just\ a\ placeholder\ for\ now}}
\DoxyCodeLine{01543\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0ULL;}
\DoxyCodeLine{01544\ \ \ \ \ \}}
\DoxyCodeLine{01545\ }
\DoxyCodeLine{01546\ \ \ \ \ \textcolor{keywordtype}{float}\ \_\_frac(const\_reference\ \_\_scalar)\ \{\ \textcolor{keywordflow}{return}\ std::fmod(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{float}\textcolor{keyword}{>}(\_\_scalar),\ 1.0f);\ \}}
\DoxyCodeLine{01547\ \ \ \ \ index\_type\ \_\_lcm(\textcolor{keyword}{const}\ index\_type\ \_\_a,\ \textcolor{keyword}{const}\ index\_type\ \_\_b)\ \{}
\DoxyCodeLine{01548\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (\_\_a\ *\ \_\_b)\ /\ std::gcd(\_\_a,\ \_\_b);}
\DoxyCodeLine{01549\ \ \ \ \ \}}
\DoxyCodeLine{01550\ \};\ \ \textcolor{comment}{//\ tensor\ class}}
\DoxyCodeLine{01551\ }
\DoxyCodeLine{01552\ }
\DoxyCodeLine{01553\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{01554\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::sinh}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01555\ \ \ \ \ this-\/>\_\_check\_is\_scalar\_type(\textcolor{stringliteral}{"{}Cannot\ perform\ a\ sin\ on\ non-\/scalar\ data\ type"{}});}
\DoxyCodeLine{01556\ \ \ \ \ data\_t\ \_\_ret(this-\/>\_\_data\_.size());}
\DoxyCodeLine{01557\ }
\DoxyCodeLine{01558\ \ \ \ \ std::transform(this-\/>\_\_data\_.begin(),\ this-\/>\_\_data\_.end(),\ \_\_ret.begin(),}
\DoxyCodeLine{01559\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [](const\_reference\ \_\_v)\ \{}
\DoxyCodeLine{01560\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ return\ static\_cast<value\_type>(std::sinh(static\_cast<double>(\_\_v)));}
\DoxyCodeLine{01561\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{01562\ }
\DoxyCodeLine{01563\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(\_\_ret,\ this-\/>\_\_shape\_);}
\DoxyCodeLine{01564\ \}}
\DoxyCodeLine{01565\ }
\DoxyCodeLine{01566\ }
\DoxyCodeLine{01567\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{01568\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::sin}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01569\ \ \ \ \ this-\/>\_\_check\_is\_scalar\_type(\textcolor{stringliteral}{"{}Cannot\ perform\ a\ sin\ on\ non-\/scalar\ data\ type"{}});}
\DoxyCodeLine{01570\ \ \ \ \ data\_t\ \_\_ret(this-\/>\_\_data\_.size());}
\DoxyCodeLine{01571\ }
\DoxyCodeLine{01572\ \ \ \ \ std::transform(this-\/>\_\_data\_.begin(),\ this-\/>\_\_data\_.end(),\ \_\_ret.begin(),}
\DoxyCodeLine{01573\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [](const\_reference\ \_\_v)\ \{}
\DoxyCodeLine{01574\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ return\ static\_cast<value\_type>(std::sin(static\_cast<double>(\_\_v)));}
\DoxyCodeLine{01575\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{01576\ }
\DoxyCodeLine{01577\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(\_\_ret,\ this-\/>\_\_shape\_);}
\DoxyCodeLine{01578\ \}}
\DoxyCodeLine{01579\ }
\DoxyCodeLine{01580\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{01581\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::frac}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01582\ \ \ \ \ this-\/>\_\_check\_is\_scalar\_type(\textcolor{stringliteral}{"{}Cannot\ get\ the\ fraction\ of\ a\ non-\/scalar\ type"{}});}
\DoxyCodeLine{01583\ \ \ \ \ data\_t\ \_\_ret(this-\/>\_\_data\_.size());}
\DoxyCodeLine{01584\ }
\DoxyCodeLine{01585\ \ \ \ \ std::transform(}
\DoxyCodeLine{01586\ \ \ \ \ \ \ \ \ this-\/>\_\_data\_.begin(),\ this-\/>\_\_data\_.end(),\ \_\_ret.begin(),}
\DoxyCodeLine{01587\ \ \ \ \ \ \ \ \ [\textcolor{keyword}{this}](const\_reference\ \_\_v)\ \{\ return\ static\_cast<value\_type>(this-\/>\_\_frac(\_\_v));\ \});}
\DoxyCodeLine{01588\ }
\DoxyCodeLine{01589\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(\_\_ret,\ this-\/>\_\_shape\_);}
\DoxyCodeLine{01590\ \}}
\DoxyCodeLine{01591\ }
\DoxyCodeLine{01592\ }
\DoxyCodeLine{01593\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{01594\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::cos}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01595\ \ \ \ \ this-\/>\_\_check\_is\_scalar\_type(\textcolor{stringliteral}{"{}Cannot\ perform\ a\ cosine\ on\ non-\/scalar\ data\ type"{}});}
\DoxyCodeLine{01596\ \ \ \ \ data\_t\ \_\_ret(this-\/>\_\_data\_.size());}
\DoxyCodeLine{01597\ }
\DoxyCodeLine{01598\ \ \ \ \ std::transform(this-\/>\_\_data\_.begin(),\ this-\/>\_\_data\_.end(),\ \_\_ret.begin(),}
\DoxyCodeLine{01599\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [](const\_reference\ \_\_v)\ \{}
\DoxyCodeLine{01600\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ return\ static\_cast<value\_type>(std::cos(static\_cast<double>(\_\_v)));}
\DoxyCodeLine{01601\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{01602\ }
\DoxyCodeLine{01603\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(\_\_ret,\ this-\/>\_\_shape\_);}
\DoxyCodeLine{01604\ \}}
\DoxyCodeLine{01605\ }
\DoxyCodeLine{01606\ }
\DoxyCodeLine{01607\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{01608\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::log}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01609\ \ \ \ \ this-\/>\_\_check\_is\_integral\_type(\textcolor{stringliteral}{"{}Given\ data\ type\ must\ be\ an\ integral"{}});}
\DoxyCodeLine{01610\ \ \ \ \ std::vector<value\_type>\ \_\_ret(this-\/>\_\_data\_.size());}
\DoxyCodeLine{01611\ }
\DoxyCodeLine{01612\ \ \ \ \ std::transform(this-\/>\_\_data\_.begin(),\ this-\/>\_\_data\_.end(),\ \_\_ret.begin(),}
\DoxyCodeLine{01613\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [](const\_reference\ \_\_v)\ \{}
\DoxyCodeLine{01614\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ return\ static\_cast<value\_type>(std::log(static\_cast<double>(\_\_v)));}
\DoxyCodeLine{01615\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{01616\ }
\DoxyCodeLine{01617\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(\_\_ret,\ this-\/>\_\_shape\_);}
\DoxyCodeLine{01618\ \}}
\DoxyCodeLine{01619\ }
\DoxyCodeLine{01620\ }
\DoxyCodeLine{01621\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{01622\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::asinh}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01623\ \ \ \ \ this-\/>\_\_check\_is\_scalar\_type(\textcolor{stringliteral}{"{}Cannot\ perform\ a\ sin\ on\ non-\/scalar\ data\ type"{}});}
\DoxyCodeLine{01624\ \ \ \ \ data\_t\ \_\_ret(this-\/>\_\_data\_.size());}
\DoxyCodeLine{01625\ }
\DoxyCodeLine{01626\ \ \ \ \ std::transform(this-\/>\_\_data\_.begin(),\ this-\/>\_\_data\_.end(),\ \_\_ret.begin(),}
\DoxyCodeLine{01627\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [](const\_reference\ \_\_v)\ \{}
\DoxyCodeLine{01628\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ return\ static\_cast<value\_type>(std::asinh(static\_cast<double>(\_\_v)));}
\DoxyCodeLine{01629\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{01630\ }
\DoxyCodeLine{01631\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(\_\_ret,\ this-\/>\_\_shape\_);}
\DoxyCodeLine{01632\ \}}
\DoxyCodeLine{01633\ }
\DoxyCodeLine{01634\ }
\DoxyCodeLine{01635\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{01636\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::cosh}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01637\ \ \ \ \ this-\/>\_\_check\_is\_scalar\_type(\textcolor{stringliteral}{"{}Cannot\ perform\ a\ cosh\ on\ non-\/scalar\ data\ type"{}});}
\DoxyCodeLine{01638\ \ \ \ \ data\_t\ \_\_ret(this-\/>\_\_data\_.size());}
\DoxyCodeLine{01639\ }
\DoxyCodeLine{01640\ \ \ \ \ std::transform(this-\/>\_\_data\_.begin(),\ this-\/>\_\_data\_.end(),\ \_\_ret.begin(),}
\DoxyCodeLine{01641\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [](const\_reference\ \_\_v)\ \{}
\DoxyCodeLine{01642\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ return\ static\_cast<value\_type>(std::cosh(static\_cast<double>(\_\_v)));}
\DoxyCodeLine{01643\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{01644\ }
\DoxyCodeLine{01645\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(\_\_ret,\ this-\/>\_\_shape\_);}
\DoxyCodeLine{01646\ \}}
\DoxyCodeLine{01647\ }
\DoxyCodeLine{01648\ }
\DoxyCodeLine{01649\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{01650\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::sqrt}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01651\ \ \ \ \ this-\/>\_\_check\_is\_scalar\_type(\textcolor{stringliteral}{"{}Cannot\ get\ the\ square\ root\ of\ non\ scalar\ values"{}});}
\DoxyCodeLine{01652\ \ \ \ \ data\_t\ \_\_ret(this-\/>\_\_data\_.size());}
\DoxyCodeLine{01653\ }
\DoxyCodeLine{01654\ \ \ \ \ std::transform(this-\/>\_\_data\_.begin(),\ this-\/>\_\_data\_.end(),\ \_\_ret.begin(),\ [](\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ val)\ \{}
\DoxyCodeLine{01655\ \ \ \ \ \ \ \ \ return\ static\_cast<value\_type>(std::sqrt(static\_cast<double>(val)));}
\DoxyCodeLine{01656\ \ \ \ \ \});}
\DoxyCodeLine{01657\ }
\DoxyCodeLine{01658\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(\_\_ret,\ this-\/>\_\_shape\_);}
\DoxyCodeLine{01659\ \}}
\DoxyCodeLine{01660\ }
\DoxyCodeLine{01661\ }
\DoxyCodeLine{01662\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{01663\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::acosh}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01664\ \ \ \ \ this-\/>\_\_check\_is\_scalar\_type(\textcolor{stringliteral}{"{}Cannot\ perform\ a\ acosh\ on\ non-\/scalar\ data\ type"{}});}
\DoxyCodeLine{01665\ \ \ \ \ data\_t\ \_\_ret(this-\/>\_\_data\_.size());}
\DoxyCodeLine{01666\ }
\DoxyCodeLine{01667\ \ \ \ \ std::transform(this-\/>\_\_data\_.begin(),\ this-\/>\_\_data\_.end(),\ \_\_ret.begin(),\ [](\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ val)\ \{}
\DoxyCodeLine{01668\ \ \ \ \ \ \ \ \ return\ static\_cast<value\_type>(std::acosh(static\_cast<double>(val)));}
\DoxyCodeLine{01669\ \ \ \ \ \});}
\DoxyCodeLine{01670\ }
\DoxyCodeLine{01671\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(\_\_ret,\ this-\/>\_\_shape\_);}
\DoxyCodeLine{01672\ \}}
\DoxyCodeLine{01673\ }
\DoxyCodeLine{01674\ }
\DoxyCodeLine{01675\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{01676\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::log10}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01677\ \ \ \ \ this-\/>\_\_check\_is\_integral\_type(\textcolor{stringliteral}{"{}Given\ data\ type\ must\ be\ an\ integral"{}});}
\DoxyCodeLine{01678\ \ \ \ \ data\_t\ \_\_ret(this-\/>\_\_data\_.size());}
\DoxyCodeLine{01679\ }
\DoxyCodeLine{01680\ \textcolor{preprocessor}{\#if\ defined(\_\_ARM\_NEON)}}
\DoxyCodeLine{01681\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ \ \ \ \ simd\_size\ =\ 4;}
\DoxyCodeLine{01682\ \ \ \ \ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{size\_t}\ simd\_end\ \ =\ this-\/>\_\_data\_.size()\ -\/\ (this-\/>\_\_data\_.size()\ \%\ simd\_size);}
\DoxyCodeLine{01683\ }
\DoxyCodeLine{01684\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{01685\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i\ +=\ simd\_size)}
\DoxyCodeLine{01686\ \ \ \ \ \{}
\DoxyCodeLine{01687\ \ \ \ \ \ \ \ \ int32x4\_t\ \ \ vals\ \ \ \ \ \ \ =\ vld1q\_s32(\&this-\/>\_\_data\_[\_\_i]);}
\DoxyCodeLine{01688\ \ \ \ \ \ \ \ \ float32x4\_t\ fvals\ \ \ \ \ \ =\ vcvtq\_f32\_s32(vals);}
\DoxyCodeLine{01689\ \ \ \ \ \ \ \ \ float32x4\_t\ log\_vals\ \ \ =\ vlogq\_f32(fvals);}
\DoxyCodeLine{01690\ \ \ \ \ \ \ \ \ float32x4\_t\ log10\_vals\ =\ vmulq\_n\_f32(log\_vals,\ 0.4342944819032518f);}
\DoxyCodeLine{01691\ \ \ \ \ \ \ \ \ vst1q\_f32(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keywordtype}{float}*\textcolor{keyword}{>}(\&\_\_ret[\_\_i]),\ log10\_vals);}
\DoxyCodeLine{01692\ \ \ \ \ \}}
\DoxyCodeLine{01693\ }
\DoxyCodeLine{01694\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{01695\ \ \ \ \ \{}
\DoxyCodeLine{01696\ \ \ \ \ \ \ \ \ \_\_ret[\_\_i]\ =\ \textcolor{keyword}{static\_cast<}value\_type\textcolor{keyword}{>}(std::log10(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(this-\/>\_\_data\_[\_\_i])));}
\DoxyCodeLine{01697\ \ \ \ \ \}}
\DoxyCodeLine{01698\ }
\DoxyCodeLine{01699\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{01700\ \ \ \ \ std::transform(this-\/>\_\_data\_.begin(),\ this-\/>\_\_data\_.end(),\ \_\_ret.begin(),}
\DoxyCodeLine{01701\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [](const\_reference\ \_\_v)\ \{}
\DoxyCodeLine{01702\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ return\ static\_cast<value\_type>(std::log10(static\_cast<double>(\_\_v)));}
\DoxyCodeLine{01703\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{01704\ }
\DoxyCodeLine{01705\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01706\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(\_\_ret,\ this-\/>\_\_shape\_);}
\DoxyCodeLine{01707\ \}}
\DoxyCodeLine{01708\ }
\DoxyCodeLine{01709\ }
\DoxyCodeLine{01710\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{01711\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::log2}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01712\ \ \ \ \ this-\/>\_\_check\_is\_integral\_type(\textcolor{stringliteral}{"{}Given\ data\ type\ must\ be\ an\ integral"{}});}
\DoxyCodeLine{01713\ \ \ \ \ std::vector<value\_type>\ \_\_ret(this-\/>\_\_data\_.size());}
\DoxyCodeLine{01714\ }
\DoxyCodeLine{01715\ \ \ \ \ std::transform(this-\/>\_\_data\_.begin(),\ this-\/>\_\_data\_.end(),\ \_\_ret.begin(),}
\DoxyCodeLine{01716\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [](const\_reference\ \_\_v)\ \{}
\DoxyCodeLine{01717\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ return\ static\_cast<value\_type>(std::log2(static\_cast<double>(\_\_v)));}
\DoxyCodeLine{01718\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{01719\ }
\DoxyCodeLine{01720\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(\_\_ret,\ this-\/>\_\_shape\_);}
\DoxyCodeLine{01721\ \}}
\DoxyCodeLine{01722\ }
\DoxyCodeLine{01723\ }
\DoxyCodeLine{01724\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{01725\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::exp}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01726\ \ \ \ \ this-\/>\_\_check\_is\_scalar\_type(\textcolor{stringliteral}{"{}Cannot\ get\ the\ exponential\ of\ non\ scalar\ values"{}});}
\DoxyCodeLine{01727\ \ \ \ \ std::vector<value\_type>\ \_\_ret(this-\/>\_\_data\_.size());}
\DoxyCodeLine{01728\ }
\DoxyCodeLine{01729\ \ \ \ \ std::transform(this-\/>\_\_data\_.begin(),\ this-\/>\_\_data\_.end(),\ \_\_ret.begin(),}
\DoxyCodeLine{01730\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [](const\_reference\ \_\_v)\ \{}
\DoxyCodeLine{01731\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ return\ static\_cast<value\_type>(std::exp(static\_cast<double>(\_\_v)));}
\DoxyCodeLine{01732\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{01733\ }
\DoxyCodeLine{01734\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(\_\_ret,\ this-\/>\_\_shape\_);}
\DoxyCodeLine{01735\ \}}
\DoxyCodeLine{01736\ }
\DoxyCodeLine{01737\ }
\DoxyCodeLine{01738\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{01739\ \textcolor{keyword}{typename}\ tensor<\_Tp>::index\_type\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::lcm}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01740\ \ \ \ \ this-\/>\_\_check\_is\_scalar\_type(\textcolor{stringliteral}{"{}Given\ template\ type\ must\ be\ an\ int"{}});}
\DoxyCodeLine{01741\ \ \ \ \ index\_type\ \_\_ret\ =\ \textcolor{keyword}{static\_cast<}index\_type\textcolor{keyword}{>}(this-\/>\_\_data\_[0]);}
\DoxyCodeLine{01742\ }
\DoxyCodeLine{01743\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 1;}
\DoxyCodeLine{01744\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{01745\ \ \ \ \ \{}
\DoxyCodeLine{01746\ \ \ \ \ \ \ \ \ \_\_ret\ =\ this-\/>\_\_lcm(\textcolor{keyword}{static\_cast<}index\_type\textcolor{keyword}{>}(this-\/>\_\_data\_[\_\_i]),\ \_\_ret);}
\DoxyCodeLine{01747\ \ \ \ \ \}}
\DoxyCodeLine{01748\ }
\DoxyCodeLine{01749\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_ret;}
\DoxyCodeLine{01750\ \}}
\DoxyCodeLine{01751\ }
\DoxyCodeLine{01752\ }
\DoxyCodeLine{01753\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{01754\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::sinh}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01755\ \ \ \ \ this-\/>\_\_check\_is\_integral\_type(\textcolor{stringliteral}{"{}Given\ template\ type\ must\ be\ integral"{}});}
\DoxyCodeLine{01756\ \ \ \ \ data\_t\ \_\_ret(this-\/>\_\_data\_.size());}
\DoxyCodeLine{01757\ }
\DoxyCodeLine{01758\ \ \ \ \ std::transform(this-\/>\_\_data\_.begin(),\ this-\/>\_\_data\_.end(),\ this-\/>\_\_ret.begin(),}
\DoxyCodeLine{01759\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [](const\_reference\ \_\_v)\ \{}
\DoxyCodeLine{01760\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ return\ static\_cast<value\_type>(std::sinh(static\_cast<double>(\_\_v)));}
\DoxyCodeLine{01761\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{01762\ }
\DoxyCodeLine{01763\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(\_\_ret,\ this-\/>\_\_shape\_);}
\DoxyCodeLine{01764\ \}}
\DoxyCodeLine{01765\ }
\DoxyCodeLine{01766\ }
\DoxyCodeLine{01767\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{01768\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::logical\_or\_}}(\textcolor{keyword}{const}\ value\_type\ \_\_val)\ \{}
\DoxyCodeLine{01769\ \ \ \ \ \textcolor{keywordflow}{if}\ (!std::is\_integral<value\_type>::value\ \&\&\ !std::is\_same<value\_type,\ bool>::value)}
\DoxyCodeLine{01770\ \ \ \ \ \{}
\DoxyCodeLine{01771\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(}
\DoxyCodeLine{01772\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Cannot\ get\ the\ element\ wise\ not\ of\ non-\/integral\ and\ non-\/boolean\ value"{}});}
\DoxyCodeLine{01773\ \ \ \ \ \}}
\DoxyCodeLine{01774\ }
\DoxyCodeLine{01775\ \ \ \ \ std::transform(this-\/>\_\_data\_.begin(),\ this-\/>\_\_data\_.end(),\ this-\/>\_\_data\_.begin(),}
\DoxyCodeLine{01776\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [\&\_\_val](const\_reference\ \_\_v)\ \{\ return\ static\_cast<value\_type>(\_\_v\ ||\ \_\_val);\ \});}
\DoxyCodeLine{01777\ \}}
\DoxyCodeLine{01778\ }
\DoxyCodeLine{01779\ }
\DoxyCodeLine{01780\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{01781\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::logical\_xor\_}}(\textcolor{keyword}{const}\ value\_type\ \_\_val)\ \{}
\DoxyCodeLine{01782\ \ \ \ \ \textcolor{keywordflow}{if}\ (!std::is\_integral<value\_type>::value\ \&\&\ !std::is\_same<value\_type,\ bool>::value)}
\DoxyCodeLine{01783\ \ \ \ \ \{}
\DoxyCodeLine{01784\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(}
\DoxyCodeLine{01785\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Cannot\ get\ the\ element\ wise\ xor\ of\ non-\/integral\ and\ non-\/boolean\ value"{}});}
\DoxyCodeLine{01786\ \ \ \ \ \}}
\DoxyCodeLine{01787\ }
\DoxyCodeLine{01788\ \ \ \ \ std::transform(this-\/>\_\_data\_.begin(),\ this-\/>\_\_data\_.end(),\ this-\/>\_\_data\_.begin(),}
\DoxyCodeLine{01789\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [\&\_\_val](const\_reference\ \_\_v)\ \{\ return\ static\_cast<value\_type>(\_\_v\ \string^\ \_\_val);\ \});}
\DoxyCodeLine{01790\ \}}
\DoxyCodeLine{01791\ }
\DoxyCodeLine{01792\ }
\DoxyCodeLine{01793\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{01794\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::logical\_and\_}}(\textcolor{keyword}{const}\ value\_type\ \_\_val)\ \{}
\DoxyCodeLine{01795\ \ \ \ \ \textcolor{keywordflow}{if}\ (!std::is\_integral<value\_type>::value\ \&\&\ !std::is\_same<value\_type,\ bool>::value)}
\DoxyCodeLine{01796\ \ \ \ \ \{}
\DoxyCodeLine{01797\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(}
\DoxyCodeLine{01798\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Cannot\ get\ the\ element\ wise\ and\ of\ non-\/integral\ and\ non-\/boolean\ value"{}});}
\DoxyCodeLine{01799\ \ \ \ \ \}}
\DoxyCodeLine{01800\ }
\DoxyCodeLine{01801\ \ \ \ \ std::transform(this-\/>\_\_data\_.begin(),\ this-\/>\_\_data\_.end(),\ this-\/>\_\_data\_.begin(),}
\DoxyCodeLine{01802\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [\&\_\_val](const\_reference\ \_\_v)\ \{\ return\ static\_cast<value\_type>(\_\_v\ \&\&\ \_\_val);\ \});}
\DoxyCodeLine{01803\ \}}
\DoxyCodeLine{01804\ }
\DoxyCodeLine{01805\ }
\DoxyCodeLine{01806\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{01807\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::bitwise\_or\_}}(\textcolor{keyword}{const}\ value\_type\ \_\_val)\ \{}
\DoxyCodeLine{01808\ \ \ \ \ \textcolor{keywordflow}{if}\ (!std::is\_integral<value\_type>::value\ \&\&\ !std::is\_same<value\_type,\ bool>::value)}
\DoxyCodeLine{01809\ \ \ \ \ \{}
\DoxyCodeLine{01810\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(}
\DoxyCodeLine{01811\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Cannot\ perform\ a\ bitwise\ OR\ on\ non-\/integral\ or\ non-\/boolean\ values"{}});}
\DoxyCodeLine{01812\ \ \ \ \ \}}
\DoxyCodeLine{01813\ }
\DoxyCodeLine{01814\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{01815\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{01816\ \ \ \ \ \{}
\DoxyCodeLine{01817\ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i]\ |=\ \_\_val;}
\DoxyCodeLine{01818\ \ \ \ \ \}}
\DoxyCodeLine{01819\ \}}
\DoxyCodeLine{01820\ }
\DoxyCodeLine{01821\ }
\DoxyCodeLine{01822\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{01823\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::bitwise\_xor\_}}(\textcolor{keyword}{const}\ value\_type\ \_\_val)\ \{}
\DoxyCodeLine{01824\ \ \ \ \ \textcolor{keywordflow}{if}\ (!std::is\_integral<value\_type>::value\ \&\&\ !std::is\_same<value\_type,\ bool>::value)}
\DoxyCodeLine{01825\ \ \ \ \ \{}
\DoxyCodeLine{01826\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(}
\DoxyCodeLine{01827\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Cannot\ perform\ a\ bitwise\ XOR\ on\ non-\/integral\ or\ non-\/boolean\ values"{}});}
\DoxyCodeLine{01828\ \ \ \ \ \}}
\DoxyCodeLine{01829\ }
\DoxyCodeLine{01830\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{01831\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{01832\ \ \ \ \ \{}
\DoxyCodeLine{01833\ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i]\ \string^=\ \_\_val;}
\DoxyCodeLine{01834\ \ \ \ \ \}}
\DoxyCodeLine{01835\ \}}
\DoxyCodeLine{01836\ }
\DoxyCodeLine{01837\ }
\DoxyCodeLine{01838\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{01839\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::bitwise\_not\_}}()\ \{}
\DoxyCodeLine{01840\ \ \ \ \ \textcolor{keywordflow}{if}\ (!std::is\_integral<value\_type>::value\ \&\&\ !std::is\_same<value\_type,\ bool>::value)}
\DoxyCodeLine{01841\ \ \ \ \ \{}
\DoxyCodeLine{01842\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(\textcolor{stringliteral}{"{}Cannot\ perform\ a\ bitwise\ not\ on\ non\ integral\ or\ boolean\ value"{}});}
\DoxyCodeLine{01843\ \ \ \ \ \}}
\DoxyCodeLine{01844\ }
\DoxyCodeLine{01845\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{01846\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{01847\ \ \ \ \ \{}
\DoxyCodeLine{01848\ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i]\ =\ \string~this-\/>\_\_data\_[\_\_i];}
\DoxyCodeLine{01849\ \ \ \ \ \}}
\DoxyCodeLine{01850\ \}}
\DoxyCodeLine{01851\ }
\DoxyCodeLine{01852\ }
\DoxyCodeLine{01853\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{01854\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::bitwise\_and\_}}(\textcolor{keyword}{const}\ value\_type\ \_\_val)\ \{}
\DoxyCodeLine{01855\ \ \ \ \ \textcolor{keywordflow}{if}\ (!std::is\_integral<value\_type>::value\ \&\&\ !std::is\_same<value\_type,\ bool>::value)}
\DoxyCodeLine{01856\ \ \ \ \ \{}
\DoxyCodeLine{01857\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(}
\DoxyCodeLine{01858\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Cannot\ perform\ a\ bitwise\ AND\ on\ non-\/integral\ or\ non-\/boolean\ values"{}});}
\DoxyCodeLine{01859\ \ \ \ \ \}}
\DoxyCodeLine{01860\ }
\DoxyCodeLine{01861\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{01862\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{01863\ \ \ \ \ \{}
\DoxyCodeLine{01864\ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i]\ \&=\ \_\_val;}
\DoxyCodeLine{01865\ \ \ \ \ \}}
\DoxyCodeLine{01866\ \}}
\DoxyCodeLine{01867\ }
\DoxyCodeLine{01868\ }
\DoxyCodeLine{01869\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{01870\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\&\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::operator=}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\ \{}
\DoxyCodeLine{01871\ \ \ \ \ \textcolor{keywordflow}{if}\ (\textcolor{keyword}{this}\ !=\ \&\_\_other)}
\DoxyCodeLine{01872\ \ \ \ \ \{}
\DoxyCodeLine{01873\ \ \ \ \ \ \ \ \ this-\/>\_\_data\_\ \ \ \ =\ \_\_other.storage();}
\DoxyCodeLine{01874\ \ \ \ \ \ \ \ \ this-\/>\_\_shape\_\ \ \ =\ \_\_other.shape();}
\DoxyCodeLine{01875\ \ \ \ \ \ \ \ \ this-\/>\_\_strides\_\ =\ \_\_other.strides();}
\DoxyCodeLine{01876\ \ \ \ \ \}}
\DoxyCodeLine{01877\ }
\DoxyCodeLine{01878\ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{01879\ \}}
\DoxyCodeLine{01880\ }
\DoxyCodeLine{01881\ }
\DoxyCodeLine{01882\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{01883\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\&\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::operator=}}(\mbox{\hyperlink{classtensor}{tensor}}\&\&\ \_\_other)\ \textcolor{keyword}{noexcept}\ \{}
\DoxyCodeLine{01884\ \ \ \ \ \textcolor{keywordflow}{if}\ (\textcolor{keyword}{this}\ !=\ \&\_\_other)}
\DoxyCodeLine{01885\ \ \ \ \ \{}
\DoxyCodeLine{01886\ \ \ \ \ \ \ \ \ this-\/>\_\_data\_\ \ \ \ =\ std::move(\_\_other.storage());}
\DoxyCodeLine{01887\ \ \ \ \ \ \ \ \ this-\/>\_\_shape\_\ \ \ =\ std::move(\_\_other.shape());}
\DoxyCodeLine{01888\ \ \ \ \ \ \ \ \ this-\/>\_\_strides\_\ =\ std::move(\_\_other.strides());}
\DoxyCodeLine{01889\ \ \ \ \ \}}
\DoxyCodeLine{01890\ }
\DoxyCodeLine{01891\ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{01892\ \}}
\DoxyCodeLine{01893\ }
\DoxyCodeLine{01894\ }
\DoxyCodeLine{01895\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{01896\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::print}}()\ const\ noexcept\ \{}
\DoxyCodeLine{01897\ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}Shape:\ ["{}};}
\DoxyCodeLine{01898\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ this-\/>\_\_shape\_.size();\ ++i)}
\DoxyCodeLine{01899\ \ \ \ \ \{}
\DoxyCodeLine{01900\ \ \ \ \ \ \ \ \ std::cout\ <<\ this-\/>\_\_shape\_[i];}
\DoxyCodeLine{01901\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (i\ <\ this-\/>\_\_shape\_.size()\ -\/\ 1)}
\DoxyCodeLine{01902\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01903\ \ \ \ \ \ \ \ \ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{},\ "{}};}
\DoxyCodeLine{01904\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01905\ \ \ \ \ \}}
\DoxyCodeLine{01906\ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}]\(\backslash\)nData:\ "{}};}
\DoxyCodeLine{01907\ \ \ \ \ \textcolor{keywordflow}{if}\ (!this-\/>\_\_data\_.empty())}
\DoxyCodeLine{01908\ \ \ \ \ \{}
\DoxyCodeLine{01909\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ \_\_v\ :\ this-\/>\_\_data\_)}
\DoxyCodeLine{01910\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01911\ \ \ \ \ \ \ \ \ \ \ \ \ std::cout\ <<\ \_\_v\ <<\ \textcolor{stringliteral}{"{}\ "{}};}
\DoxyCodeLine{01912\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01913\ \ \ \ \ \}}
\DoxyCodeLine{01914\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{01915\ \ \ \ \ \{}
\DoxyCodeLine{01916\ \ \ \ \ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}Empty"{}};}
\DoxyCodeLine{01917\ \ \ \ \ \}}
\DoxyCodeLine{01918\ \ \ \ \ std::cout\ <<\ std::endl;}
\DoxyCodeLine{01919\ \}}
\DoxyCodeLine{01920\ }
\DoxyCodeLine{01921\ }
\DoxyCodeLine{01922\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{01923\ \textcolor{keyword}{typename}\ tensor<\_Tp>::reference\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::at}}(tensor<\_Tp>::shape\_type\ \_\_idx)\ \{}
\DoxyCodeLine{01924\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_\_idx.empty())}
\DoxyCodeLine{01925\ \ \ \ \ \{}
\DoxyCodeLine{01926\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::invalid\_argument(\textcolor{stringliteral}{"{}Passing\ an\ empty\ vector\ as\ indices\ for\ a\ tensor"{}});}
\DoxyCodeLine{01927\ \ \ \ \ \}}
\DoxyCodeLine{01928\ }
\DoxyCodeLine{01929\ \ \ \ \ index\_type\ \_\_i\ =\ this-\/>\_\_compute\_index(\_\_idx);}
\DoxyCodeLine{01930\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_\_i\ <\ 0\ ||\ \_\_i\ >=\ this-\/>\_\_data\_.size())}
\DoxyCodeLine{01931\ \ \ \ \ \{}
\DoxyCodeLine{01932\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::invalid\_argument(\textcolor{stringliteral}{"{}input\ indices\ are\ out\ of\ bounds"{}});}
\DoxyCodeLine{01933\ \ \ \ \ \}}
\DoxyCodeLine{01934\ }
\DoxyCodeLine{01935\ \ \ \ \ \textcolor{keywordflow}{return}\ this-\/>\_\_data\_[\_\_i];}
\DoxyCodeLine{01936\ \}}
\DoxyCodeLine{01937\ }
\DoxyCodeLine{01938\ }
\DoxyCodeLine{01939\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{01940\ \textcolor{keyword}{typename}\ tensor<\_Tp>::const\_reference\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::at}}(\textcolor{keyword}{const}\ tensor<\_Tp>::shape\_type\ \_\_idx)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01941\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_\_idx.empty())}
\DoxyCodeLine{01942\ \ \ \ \ \{}
\DoxyCodeLine{01943\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::invalid\_argument(\textcolor{stringliteral}{"{}Passing\ an\ empty\ vector\ as\ indices\ for\ a\ tensor"{}});}
\DoxyCodeLine{01944\ \ \ \ \ \}}
\DoxyCodeLine{01945\ }
\DoxyCodeLine{01946\ \ \ \ \ index\_type\ \_\_i\ =\ this-\/>\_\_compute\_index(\_\_idx);}
\DoxyCodeLine{01947\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_\_i\ <\ 0\ ||\ \_\_i\ >=\ this-\/>\_\_data\_.size())}
\DoxyCodeLine{01948\ \ \ \ \ \{}
\DoxyCodeLine{01949\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::invalid\_argument(\textcolor{stringliteral}{"{}input\ indices\ are\ out\ of\ bounds"{}});}
\DoxyCodeLine{01950\ \ \ \ \ \}}
\DoxyCodeLine{01951\ }
\DoxyCodeLine{01952\ \ \ \ \ \textcolor{keywordflow}{return}\ this-\/>\_\_data\_[\_\_i];}
\DoxyCodeLine{01953\ \}}
\DoxyCodeLine{01954\ }
\DoxyCodeLine{01955\ }
\DoxyCodeLine{01956\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{01957\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::operator+}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01958\ \ \ \ \ this-\/>\_\_check\_is\_arithmetic\_type(\textcolor{stringliteral}{"{}template\ class\ must\ be\ an\ arithmetic\ type"{}});}
\DoxyCodeLine{01959\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_\_other.shape()\ !=\ this-\/>\_\_shape\_)}
\DoxyCodeLine{01960\ \ \ \ \ \{}
\DoxyCodeLine{01961\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::invalid\_argument(\textcolor{stringliteral}{"{}Cannot\ add\ two\ tensors\ with\ different\ shapes"{}});}
\DoxyCodeLine{01962\ \ \ \ \ \}}
\DoxyCodeLine{01963\ }
\DoxyCodeLine{01964\ \ \ \ \ data\_t\ \_\_d(this-\/>\_\_data\_.size());}
\DoxyCodeLine{01965\ }
\DoxyCodeLine{01966\ \ \ \ \ std::transform(this-\/>\_\_data\_.begin(),\ this-\/>\_\_data\_.end(),\ \_\_other.storage().begin(),}
\DoxyCodeLine{01967\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_d.begin(),\ [](const\_reference\ \_\_v,\ const\_reference\ \_\_w)\ \{}
\DoxyCodeLine{01968\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ return\ static\_cast<value\_type>(\_\_v\ +\ \_\_w);}
\DoxyCodeLine{01969\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{01970\ }
\DoxyCodeLine{01971\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(\_\_d,\ this-\/>\_\_shape\_);}
\DoxyCodeLine{01972\ \}}
\DoxyCodeLine{01973\ }
\DoxyCodeLine{01974\ }
\DoxyCodeLine{01975\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{01976\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::operator-\/}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01977\ \ \ \ \ this-\/>\_\_check\_is\_arithmetic\_type(\textcolor{stringliteral}{"{}template\ class\ must\ be\ an\ arithmetic\ type"{}});}
\DoxyCodeLine{01978\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_\_other.shape()\ !=\ this-\/>\_\_shape\_)}
\DoxyCodeLine{01979\ \ \ \ \ \{}
\DoxyCodeLine{01980\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::invalid\_argument(\textcolor{stringliteral}{"{}Cannot\ add\ two\ tensors\ with\ different\ shapes"{}});}
\DoxyCodeLine{01981\ \ \ \ \ \}}
\DoxyCodeLine{01982\ }
\DoxyCodeLine{01983\ \ \ \ \ data\_t\ \_\_d(this-\/>\_\_data\_.size());}
\DoxyCodeLine{01984\ }
\DoxyCodeLine{01985\ \ \ \ \ std::transform(this-\/>\_\_data\_.begin(),\ this-\/>\_\_data\_.end(),\ \_\_other.storage().begin(),}
\DoxyCodeLine{01986\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_d.begin(),\ [](const\_reference\ \_\_v,\ const\_reference\ \_\_w)\ \{}
\DoxyCodeLine{01987\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ return\ static\_cast<value\_type>(\_\_v\ -\/\ \_\_w);}
\DoxyCodeLine{01988\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{01989\ }
\DoxyCodeLine{01990\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(\_\_d,\ this-\/>\_\_shape\_);}
\DoxyCodeLine{01991\ \}}
\DoxyCodeLine{01992\ }
\DoxyCodeLine{01993\ }
\DoxyCodeLine{01994\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{01995\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::operator+}}(\textcolor{keyword}{const}\ value\_type\ \_\_scalar)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01996\ \ \ \ \ this-\/>\_\_check\_is\_arithmetic\_type(\textcolor{stringliteral}{"{}template\ class\ must\ be\ an\ arithmetic\ type"{}});}
\DoxyCodeLine{01997\ }
\DoxyCodeLine{01998\ \ \ \ \ std::transform(}
\DoxyCodeLine{01999\ \ \ \ \ \ \ \ \ this-\/>\_\_data\_.begin(),\ this-\/>\_\_data\_.end(),\ this-\/>\_\_data\_.begin(),}
\DoxyCodeLine{02000\ \ \ \ \ \ \ \ \ [\&\_\_scalar](const\_reference\ \_\_v)\ \{\ return\ static\_cast<value\_type>(\_\_v\ +\ \_\_scalar);\ \});}
\DoxyCodeLine{02001\ }
\DoxyCodeLine{02002\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(*\textcolor{keyword}{this});}
\DoxyCodeLine{02003\ \}}
\DoxyCodeLine{02004\ }
\DoxyCodeLine{02005\ }
\DoxyCodeLine{02006\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{02007\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::operator-\/}}(\textcolor{keyword}{const}\ value\_type\ \_\_scalar)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02008\ \ \ \ \ this-\/>\_\_check\_is\_arithmetic\_type(\textcolor{stringliteral}{"{}template\ class\ must\ be\ an\ arithmetic\ type"{}});}
\DoxyCodeLine{02009\ }
\DoxyCodeLine{02010\ \ \ \ \ std::transform(}
\DoxyCodeLine{02011\ \ \ \ \ \ \ \ \ this-\/>\_\_data\_.begin(),\ this-\/>\_\_data\_.end(),\ this-\/>\_\_data\_.begin(),}
\DoxyCodeLine{02012\ \ \ \ \ \ \ \ \ [\&\_\_scalar](const\_reference\ \_\_v)\ \{\ return\ static\_cast<value\_type>(\_\_v\ -\/\ \_\_scalar);\ \});}
\DoxyCodeLine{02013\ }
\DoxyCodeLine{02014\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(*\textcolor{keyword}{this});}
\DoxyCodeLine{02015\ \}}
\DoxyCodeLine{02016\ }
\DoxyCodeLine{02017\ }
\DoxyCodeLine{02018\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{02019\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::operator+=}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02020\ \ \ \ \ this-\/>\_\_check\_is\_arithmetic\_type(\textcolor{stringliteral}{"{}template\ class\ must\ be\ an\ arithmetic\ type"{}});}
\DoxyCodeLine{02021\ \ \ \ \ assert(this-\/>\_\_shape\_\ ==\ \_\_other.shape()\ \&\&\ this-\/>\_\_data\_.size()\ ==\ \_\_other.size(0));}
\DoxyCodeLine{02022\ }
\DoxyCodeLine{02023\ \ \ \ \ std::transform(this-\/>\_\_data\_.begin(),\ this-\/>\_\_data\_.end(),\ \_\_other.storage().begin(),}
\DoxyCodeLine{02024\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>\_\_data\_.begin(),\ [](const\_reference\ \_\_v,\ const\_reference\ \_\_w)\ \{}
\DoxyCodeLine{02025\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ return\ static\_cast<value\_type>(\_\_v\ +\ \_\_w);}
\DoxyCodeLine{02026\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{02027\ }
\DoxyCodeLine{02028\ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{02029\ \}}
\DoxyCodeLine{02030\ }
\DoxyCodeLine{02031\ }
\DoxyCodeLine{02032\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{02033\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::operator+=}}(const\_reference\ \_\_scalar)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02034\ \ \ \ \ this-\/>\_\_check\_is\_arithmetic\_type(\textcolor{stringliteral}{"{}template\ class\ must\ be\ an\ arithmetic\ type"{}});}
\DoxyCodeLine{02035\ }
\DoxyCodeLine{02036\ \ \ \ \ std::transform(}
\DoxyCodeLine{02037\ \ \ \ \ \ \ \ \ this-\/>\_\_data\_.begin(),\ this-\/>\_\_data\_.end(),\ this-\/>\_\_data\_.begin(),}
\DoxyCodeLine{02038\ \ \ \ \ \ \ \ \ [\&\_\_scalar](const\_reference\ \_\_v)\ \{\ return\ static\_cast<value\_type>(\_\_v\ +\ \_\_scalar);\ \});}
\DoxyCodeLine{02039\ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{02040\ \}}
\DoxyCodeLine{02041\ }
\DoxyCodeLine{02042\ }
\DoxyCodeLine{02043\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{02044\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::operator-\/=}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02045\ \ \ \ \ this-\/>\_\_check\_is\_arithmetic\_type(\textcolor{stringliteral}{"{}template\ class\ must\ be\ an\ arithmetic\ type"{}});}
\DoxyCodeLine{02046\ \ \ \ \ assert(this-\/>\_\_shape\_\ ==\ \_\_other.shape()\ \&\&\ this-\/>\_\_data\_.size()\ ==\ \_\_other.size(0));}
\DoxyCodeLine{02047\ }
\DoxyCodeLine{02048\ \ \ \ \ std::transform(this-\/>\_\_data\_.begin(),\ this-\/>\_\_data\_.end(),\ \_\_other.storage().begin(),}
\DoxyCodeLine{02049\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>\_\_data\_.begin(),\ [](const\_reference\ \_\_v,\ const\_reference\ \_\_w)\ \{}
\DoxyCodeLine{02050\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ return\ static\_cast<value\_type>(\_\_v\ -\/\ \_\_w);}
\DoxyCodeLine{02051\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{02052\ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{02053\ \}}
\DoxyCodeLine{02054\ }
\DoxyCodeLine{02055\ }
\DoxyCodeLine{02056\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{02057\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::operator*=}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02058\ \ \ \ \ this-\/>\_\_check\_is\_arithmetic\_type(\textcolor{stringliteral}{"{}template\ class\ must\ be\ an\ arithmetic\ type"{}});}
\DoxyCodeLine{02059\ \ \ \ \ assert(this-\/>\_\_shape\_\ ==\ \_\_other.shape()\ \&\&\ this-\/>\_\_data\_.size()\ ==\ \_\_other.size(0));}
\DoxyCodeLine{02060\ }
\DoxyCodeLine{02061\ \ \ \ \ std::transform(this-\/>\_\_data\_.begin(),\ this-\/>\_\_data\_.end(),\ \_\_other.storage().begin(),}
\DoxyCodeLine{02062\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>\_\_data\_.begin(),\ [](const\_reference\ \_\_v,\ const\_reference\ \_\_w)\ \{}
\DoxyCodeLine{02063\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ return\ static\_cast<value\_type>(\_\_v\ *\ \_\_w);}
\DoxyCodeLine{02064\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{02065\ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{02066\ \}}
\DoxyCodeLine{02067\ }
\DoxyCodeLine{02068\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{02069\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::operator*=}}(const\_reference\ \_\_scalar)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02070\ \ \ \ \ this-\/>\_\_check\_is\_arithmetic\_type(\textcolor{stringliteral}{"{}template\ class\ must\ be\ an\ arithmetic\ type"{}});}
\DoxyCodeLine{02071\ }
\DoxyCodeLine{02072\ \ \ \ \ std::transform(this-\/>\_\_data\_.begin(),\ this-\/>\_\_data\_.end(),\ this-\/>\_\_data\_.begin(),}
\DoxyCodeLine{02073\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [](const\_reference\ \_\_v)\ \{\ return\ static\_cast<value\_type>(\_\_v\ *\ \_\_scalar);\ \});}
\DoxyCodeLine{02074\ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{02075\ \}}
\DoxyCodeLine{02076\ }
\DoxyCodeLine{02077\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{02078\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor_a98997813fec16f4b37cbcf1220801c2f}{tensor<\_Tp>::operator/=}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02079\ \ \ \ \ this-\/>\_\_check\_is\_arithmetic\_type(\textcolor{stringliteral}{"{}template\ class\ must\ be\ an\ arithmetic\ type"{}});}
\DoxyCodeLine{02080\ \ \ \ \ assert(this-\/>\_\_shape\_\ ==\ \_\_other.shape()\ \&\&\ this-\/>\_\_data\_.size()\ ==\ \_\_other.size(0));}
\DoxyCodeLine{02081\ }
\DoxyCodeLine{02082\ \ \ \ \ std::transform(this-\/>\_\_data\_.begin(),\ this-\/>\_\_data\_.end(),\ \_\_other.storage().begin(),}
\DoxyCodeLine{02083\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>\_\_data\_.begin(),\ [](const\_reference\ \_\_v,\ const\_reference\ \_\_w)\ \{}
\DoxyCodeLine{02084\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ return\ static\_cast<value\_type>(\_\_v\ /\ \_\_w);}
\DoxyCodeLine{02085\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{02086\ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{02087\ \}}
\DoxyCodeLine{02088\ }
\DoxyCodeLine{02089\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{02090\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor_a98997813fec16f4b37cbcf1220801c2f}{tensor<\_Tp>::operator/=}}(const\_reference\ \_\_scalar)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02091\ \ \ \ \ this-\/>\_\_check\_is\_arithmetic\_type(\textcolor{stringliteral}{"{}template\ class\ must\ be\ an\ arithmetic\ type"{}});}
\DoxyCodeLine{02092\ }
\DoxyCodeLine{02093\ \ \ \ \ std::transform(this-\/>\_\_data\_.begin(),\ this-\/>\_\_data\_.end(),\ this-\/>\_\_data\_.begin(),}
\DoxyCodeLine{02094\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [](const\_reference\ \_\_v)\ \{\ return\ static\_cast<value\_type>(\_\_v\ /\ \_\_scalar);\ \});}
\DoxyCodeLine{02095\ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{02096\ \}}
\DoxyCodeLine{02097\ }
\DoxyCodeLine{02098\ }
\DoxyCodeLine{02099\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{02100\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::operator-\/=}}(const\_reference\ \_\_scalar)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02101\ \ \ \ \ this-\/>\_\_check\_is\_arithmetic\_type(\textcolor{stringliteral}{"{}template\ class\ must\ be\ an\ arithmetic\ type"{}});}
\DoxyCodeLine{02102\ }
\DoxyCodeLine{02103\ \ \ \ \ std::transform(this-\/>\_\_data\_.begin(),\ this-\/>\_\_data\_.end(),\ this-\/>\_\_data\_.begin(),}
\DoxyCodeLine{02104\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [](const\_reference\ \_\_v,\ const\_reference\ \_\_w)\ \{}
\DoxyCodeLine{02105\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ return\ static\_cast<value\_type>(\_\_v\ -\/\ \_\_w);}
\DoxyCodeLine{02106\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{02107\ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{02108\ \}}
\DoxyCodeLine{02109\ }
\DoxyCodeLine{02110\ }
\DoxyCodeLine{02111\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{02112\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::randomize}}(\textcolor{keyword}{const}\ shape\_type\&\ \_\_sh,\ \textcolor{keywordtype}{bool}\ \_\_bounded)\ \{}
\DoxyCodeLine{02113\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(*this).randomize\_(\_\_sh,\ \_\_bounded);}
\DoxyCodeLine{02114\ \}}
\DoxyCodeLine{02115\ }
\DoxyCodeLine{02116\ }
\DoxyCodeLine{02117\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{02118\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::randomize\_}}(\textcolor{keyword}{const}\ shape\_type\&\ \_\_sh,\ \textcolor{keywordtype}{bool}\ \_\_bounded)\ \{}
\DoxyCodeLine{02119\ \ \ \ \ this-\/>\_\_check\_is\_scalar\_type(\textcolor{stringliteral}{"{}template\ class\ must\ be\ a\ scalar\ type"{}});}
\DoxyCodeLine{02120\ }
\DoxyCodeLine{02121\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_s;}
\DoxyCodeLine{02122\ \ \ \ \ \textcolor{keywordflow}{if}\ (this-\/>\_\_shape\_\ !=\ \_\_sh)}
\DoxyCodeLine{02123\ \ \ \ \ \{}
\DoxyCodeLine{02124\ \ \ \ \ \ \ \ \ \_\_s\ =\ this-\/>\_\_computeSize(\_\_sh);}
\DoxyCodeLine{02125\ \ \ \ \ \}}
\DoxyCodeLine{02126\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{02127\ \ \ \ \ \{}
\DoxyCodeLine{02128\ \ \ \ \ \ \ \ \ \_\_s\ =\ this-\/>\_\_data\_.size();}
\DoxyCodeLine{02129\ \ \ \ \ \}}
\DoxyCodeLine{02130\ }
\DoxyCodeLine{02131\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_\_s\ !=\ this-\/>\_\_data\_.size())}
\DoxyCodeLine{02132\ \ \ \ \ \{}
\DoxyCodeLine{02133\ \ \ \ \ \ \ \ \ this-\/>\_\_data\_.resize(\_\_s);}
\DoxyCodeLine{02134\ \ \ \ \ \}}
\DoxyCodeLine{02135\ }
\DoxyCodeLine{02136\ \ \ \ \ std::random\_device\ rd;}
\DoxyCodeLine{02137\ \ \ \ \ std::mt19937\ \ \ \ \ \ \ gen(rd());}
\DoxyCodeLine{02138\ }
\DoxyCodeLine{02139\ \ \ \ \ std::uniform\_real\_distribution<float>\ bounded\_dist(0.0f,\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{float}\textcolor{keyword}{>}(RAND\_MAX));}
\DoxyCodeLine{02140\ \ \ \ \ std::uniform\_real\_distribution<float>\ unbounded\_dist(0.0f,\ 1.0f);}
\DoxyCodeLine{02141\ }
\DoxyCodeLine{02142\ \ \ \ \ index\_type\ \_\_i\ =\ 0;}
\DoxyCodeLine{02143\ }
\DoxyCodeLine{02144\ \textcolor{preprocessor}{\#if\ defined(\_\_AVX\_\_)}}
\DoxyCodeLine{02145\ \ \ \ \ \textcolor{keyword}{const}\ \_\_m256\ scale\ =\ \_mm256\_set1\_ps(\_\_bounded\ ?\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{float}\textcolor{keyword}{>}(RAND\_MAX)\ :\ 1.0f);}
\DoxyCodeLine{02146\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ +\ 8\ <=\ \textcolor{keyword}{static\_cast<}index\_type\textcolor{keyword}{>}(\_\_s);\ \_\_i\ +=\ 8)}
\DoxyCodeLine{02147\ \ \ \ \ \{}
\DoxyCodeLine{02148\ \ \ \ \ \ \ \ \ \_\_m256\ random\_values\ =\ \_mm256\_setr\_ps(}
\DoxyCodeLine{02149\ \ \ \ \ \ \ \ \ \ \ \ \ bounded\_dist(gen),\ bounded\_dist(gen),\ bounded\_dist(gen),\ bounded\_dist(gen),}
\DoxyCodeLine{02150\ \ \ \ \ \ \ \ \ \ \ \ \ bounded\_dist(gen),\ bounded\_dist(gen),\ bounded\_dist(gen),\ bounded\_dist(gen));}
\DoxyCodeLine{02151\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\_\_bounded)}
\DoxyCodeLine{02152\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02153\ \ \ \ \ \ \ \ \ \ \ \ \ random\_values\ =\ \_mm256\_div\_ps(random\_values,\ scale);}
\DoxyCodeLine{02154\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02155\ \ \ \ \ \ \ \ \ \_mm256\_storeu\_ps(\&this-\/>\_\_data\_[\_\_i],\ random\_values);}
\DoxyCodeLine{02156\ \ \ \ \ \}}
\DoxyCodeLine{02157\ \textcolor{preprocessor}{\#elif\ defined(\_\_SSE\_\_)}}
\DoxyCodeLine{02158\ \ \ \ \ \textcolor{keyword}{const}\ \_\_m128\ scale\ =\ \_mm\_set1\_ps(\_\_bounded\ ?\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{float}\textcolor{keyword}{>}(RAND\_MAX)\ :\ 1.0f);}
\DoxyCodeLine{02159\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ +\ 4\ <=\ \textcolor{keyword}{static\_cast<}index\_type\textcolor{keyword}{>}(\_\_s);\ \_\_i\ +=\ 4)}
\DoxyCodeLine{02160\ \ \ \ \ \{}
\DoxyCodeLine{02161\ \ \ \ \ \ \ \ \ \_\_m128\ random\_values\ =}
\DoxyCodeLine{02162\ \ \ \ \ \ \ \ \ \ \ \ \ \_mm\_setr\_ps(bounded\_dist(gen),\ bounded\_dist(gen),\ bounded\_dist(gen),\ bounded\_dist(gen));}
\DoxyCodeLine{02163\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\_\_bounded)}
\DoxyCodeLine{02164\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02165\ \ \ \ \ \ \ \ \ \ \ \ \ random\_values\ =\ \_mm\_div\_ps(random\_values,\ scale);}
\DoxyCodeLine{02166\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02167\ \ \ \ \ \ \ \ \ \_mm\_storeu\_ps(\&this-\/>\_\_data\_[\_\_i],\ random\_values);}
\DoxyCodeLine{02168\ \ \ \ \ \}}
\DoxyCodeLine{02169\ \textcolor{preprocessor}{\#elif\ defined(\_\_ARM\_NEON)}}
\DoxyCodeLine{02170\ \ \ \ \ \textcolor{keyword}{const}\ float32x4\_t\ scale\ =\ vdupq\_n\_f32(\_\_bounded\ ?\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{float}\textcolor{keyword}{>}(RAND\_MAX)\ :\ 1.0f);}
\DoxyCodeLine{02171\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ +\ 4\ <=\ \textcolor{keyword}{static\_cast<}index\_type\textcolor{keyword}{>}(\_\_s);\ \_\_i\ +=\ 4)}
\DoxyCodeLine{02172\ \ \ \ \ \{}
\DoxyCodeLine{02173\ \ \ \ \ \ \ \ \ float32x4\_t\ random\_values\ =}
\DoxyCodeLine{02174\ \ \ \ \ \ \ \ \ \ \ \ \ vsetq\_f32(bounded\_dist(gen),\ bounded\_dist(gen),\ bounded\_dist(gen),\ bounded\_dist(gen));}
\DoxyCodeLine{02175\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\_\_bounded)}
\DoxyCodeLine{02176\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02177\ \ \ \ \ \ \ \ \ \ \ \ \ random\_values\ =\ vmulq\_f32(random\_values,\ vrecpeq\_f32(scale));}
\DoxyCodeLine{02178\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02179\ \ \ \ \ \ \ \ \ vst1q\_f32(\&this-\/>\_\_data\_[\_\_i],\ random\_values);}
\DoxyCodeLine{02180\ \ \ \ \ \}}
\DoxyCodeLine{02181\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02182\ }
\DoxyCodeLine{02183\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ static\_cast<index\_type>(\_\_s);\ \_\_i++)}
\DoxyCodeLine{02184\ \ \ \ \ \{}
\DoxyCodeLine{02185\ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i]\ =\ value\_type(\_\_bounded\ ?\ bounded\_dist(gen)\ :\ unbounded\_dist(gen));}
\DoxyCodeLine{02186\ \ \ \ \ \}}
\DoxyCodeLine{02187\ \}}
\DoxyCodeLine{02188\ }
\DoxyCodeLine{02189\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{02190\ \mbox{\hyperlink{classtensor}{tensor<typename\ tensor<\_Tp>::index\_type}}>\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::argmax\_}}(index\_type\ \_\_dim)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02191\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_\_dim\ <\ 0\ ||\ \_\_dim\ >=\ this-\/>\_\_shape\_.size())}
\DoxyCodeLine{02192\ \ \ \ \ \{}
\DoxyCodeLine{02193\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::out\_of\_range(\textcolor{stringliteral}{"{}Dimension\ out\ of\ range\ in\ argmax"{}});}
\DoxyCodeLine{02194\ \ \ \ \ \}}
\DoxyCodeLine{02195\ }
\DoxyCodeLine{02196\ \ \ \ \ shape\_type\ \_\_ret\_sh\ =\ this-\/>\_\_shape\_;}
\DoxyCodeLine{02197\ \ \ \ \ \_\_ret\_sh.erase(\_\_ret\_sh.begin()\ +\ \_\_dim);}
\DoxyCodeLine{02198\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor<index\_type>}}\ \_\_ret;}
\DoxyCodeLine{02199\ \ \ \ \ \_\_ret.\_\_shape\_\ =\ \_\_ret\_sh;}
\DoxyCodeLine{02200\ \ \ \ \ \_\_ret.\_\_data\_.resize(this-\/>\_\_computeSize(\_\_ret\_sh),\ 0);}
\DoxyCodeLine{02201\ }
\DoxyCodeLine{02202\ \ \ \ \ index\_type\ \_\_outer\_size\ =\ 1LL;}
\DoxyCodeLine{02203\ \ \ \ \ index\_type\ \_\_inner\_size\ =\ 1LL;}
\DoxyCodeLine{02204\ }
\DoxyCodeLine{02205\ \ \ \ \ index\_type\ \_\_i\ =\ 0;}
\DoxyCodeLine{02206\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ \_\_dim;\ \_\_i++)}
\DoxyCodeLine{02207\ \ \ \ \ \{}
\DoxyCodeLine{02208\ \ \ \ \ \ \ \ \ \_\_outer\_size\ *=\ this-\/>\_\_shape\_[\_\_i];}
\DoxyCodeLine{02209\ \ \ \ \ \}}
\DoxyCodeLine{02210\ }
\DoxyCodeLine{02211\ \ \ \ \ \textcolor{keywordflow}{for}\ (\_\_i\ =\ \_\_dim\ +\ 1;\ \_\_i\ <\ this-\/>\_\_shape\_.size();\ \_\_i++)}
\DoxyCodeLine{02212\ \ \ \ \ \{}
\DoxyCodeLine{02213\ \ \ \ \ \ \ \ \ \_\_inner\_size\ *=\ this-\/>\_\_shape\_[\_\_i];}
\DoxyCodeLine{02214\ \ \ \ \ \}}
\DoxyCodeLine{02215\ }
\DoxyCodeLine{02216\ \textcolor{preprocessor}{\#if\ defined(\_\_AVX2\_\_)}}
\DoxyCodeLine{02217\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_same\_v<\_Tp,\ float>)}
\DoxyCodeLine{02218\ \ \ \ \ \{}
\DoxyCodeLine{02219\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\_\_i\ =\ 0;\ \_\_i\ <\ \_\_outer\_size;\ \_\_i++)}
\DoxyCodeLine{02220\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02221\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (index\_type\ \_\_j\ =\ 0;\ \_\_j\ <\ \_\_inner\_size;\ \_\_j++)}
\DoxyCodeLine{02222\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02223\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_m256\ \ \_\_max\_vec\ \ \ \ \ \ \ =\ \_mm256\_set1\_ps(-\/std::numeric\_limits<float>::infinity());}
\DoxyCodeLine{02224\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_m256i\ \_\_index\_vec\ \ \ \ \ =\ \_mm256\_setzero\_si256();}
\DoxyCodeLine{02225\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_m256i\ \_\_increment\ \ \ \ \ =\ \_mm256\_set1\_epi32(1);}
\DoxyCodeLine{02226\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_m256i\ \_\_current\_index\ =\ \_mm256\_setr\_epi32(0,\ 1,\ 2,\ 3,\ 4,\ 5,\ 6,\ 7);}
\DoxyCodeLine{02227\ }
\DoxyCodeLine{02228\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ index\_type\ \_\_k\ =\ 0;}
\DoxyCodeLine{02229\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_k\ +\ 8\ <=\ this-\/>\_\_shape\_[\_\_dim];\ \_\_k\ +=\ 8)}
\DoxyCodeLine{02230\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02231\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_m256\ \_\_data\_vec\ =\ \_mm256\_loadu\_ps(}
\DoxyCodeLine{02232\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&this-\/>\_\_data\_[(\_\_i\ *\ this-\/>\_\_shape\_[\_\_dim]\ +\ \_\_k)\ *\ \_\_inner\_size\ +\ \_\_j]);}
\DoxyCodeLine{02233\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_m256\ \_\_mask\ \ \ =\ \_mm256\_cmp\_ps(\_\_data\_vec,\ \_\_max\_vec,\ \_CMP\_GT\_OQ);}
\DoxyCodeLine{02234\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_max\_vec\ \ \ \ \ \ \ =\ \_mm256\_blendv\_ps(\_\_max\_vec,\ \_\_data\_vec,\ \_\_mask);}
\DoxyCodeLine{02235\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_index\_vec\ \ \ \ \ =\ \_mm256\_blendv\_epi8(\_\_index\_vec,\ \_\_current\_index,}
\DoxyCodeLine{02236\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_mm256\_castps\_si256(\_\_mask));}
\DoxyCodeLine{02237\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_current\_index\ =\ \_mm256\_add\_epi32(\_\_current\_index,\ \_\_increment);}
\DoxyCodeLine{02238\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02239\ }
\DoxyCodeLine{02240\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ \ \ \_\_max\_values[8];}
\DoxyCodeLine{02241\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ int32\_t\ \_\_indices[8];}
\DoxyCodeLine{02242\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_mm256\_storeu\_ps(\_\_max\_values,\ \_\_max\_vec);}
\DoxyCodeLine{02243\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_mm256\_storeu\_si256((\_\_m256i*)\ \_\_indices,\ \_\_index\_vec);}
\DoxyCodeLine{02244\ }
\DoxyCodeLine{02245\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ \ \ \ \ \ \_\_max\_value\ =\ \_\_max\_values[0];}
\DoxyCodeLine{02246\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ index\_type\ \_\_max\_index\ =\ \_\_indices[0];}
\DoxyCodeLine{02247\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ \_\_i\ =\ 1;\ \_\_i\ <\ 8;\ \_\_i++)}
\DoxyCodeLine{02248\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02249\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_\_max\_values[\_\_i]\ >\ \_\_max\_value)}
\DoxyCodeLine{02250\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02251\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_max\_value\ =\ \_\_max\_values[i];}
\DoxyCodeLine{02252\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_max\_index\ =\ \_\_indices[i];}
\DoxyCodeLine{02253\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02254\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02255\ }
\DoxyCodeLine{02256\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_k\ <\ this-\/>\_\_shape\_[\_\_dim];\ \_\_k++)}
\DoxyCodeLine{02257\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02258\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ \_\_v\ =}
\DoxyCodeLine{02259\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[(\_\_i\ *\ this-\/>\_\_shape\_[\_\_dim]\ +\ \_\_k)\ *\ \_\_inner\_size\ +\ \_\_j];}
\DoxyCodeLine{02260\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_\_v\ >\ \_\_max\_value)}
\DoxyCodeLine{02261\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02262\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_max\_value\ =\ \_\_v;}
\DoxyCodeLine{02263\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_max\_index\ =\ \_\_k;}
\DoxyCodeLine{02264\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02265\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02266\ }
\DoxyCodeLine{02267\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret.\_\_data\_[\_\_i\ *\ \_\_inner\_size\ +\ \_\_j]\ =\ max\_index;}
\DoxyCodeLine{02268\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02269\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02270\ \ \ \ \ \}}
\DoxyCodeLine{02271\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{02272\ \textcolor{preprocessor}{\#elif\ defined(\_\_ARM\_NEON)}}
\DoxyCodeLine{02273\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_same\_v<\_Tp,\ float>)}
\DoxyCodeLine{02274\ \ \ \ \ \{}
\DoxyCodeLine{02275\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\_\_i\ =\ 0;\ \_\_i\ <\ \_\_outer\_size;\ \_\_i++)}
\DoxyCodeLine{02276\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02277\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (index\_type\ \_\_j\ =\ 0;\ \_\_j\ <\ \_\_inner\_size;\ \_\_j++)}
\DoxyCodeLine{02278\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02279\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ float32x4\_t\ max\_vec\ \ \ \ \ \ \ =\ vdupq\_n\_f32(-\/std::numeric\_limits<float>::infinity());}
\DoxyCodeLine{02280\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ uint32x4\_t\ \ index\_vec\ \ \ \ \ =\ vdupq\_n\_u32(0);}
\DoxyCodeLine{02281\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ uint32x4\_t\ \ increment\ \ \ \ \ =\ vdupq\_n\_u32(1);}
\DoxyCodeLine{02282\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ uint32x4\_t\ \ current\_index\ =\ \{0,\ 1,\ 2,\ 3\};}
\DoxyCodeLine{02283\ }
\DoxyCodeLine{02284\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ index\_type\ \_\_k\ =\ 0;}
\DoxyCodeLine{02285\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_k\ +\ 4\ <=\ this-\/>\_\_shape\_[\_\_dim];\ \_\_k\ +=\ 4)}
\DoxyCodeLine{02286\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02287\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ float32x4\_t\ data\_vec\ =\ vld1q\_f32(}
\DoxyCodeLine{02288\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&this-\/>\_\_data\_[(\_\_i\ *\ this-\/>\_\_shape\_[\_\_dim]\ +\ \_\_k)\ *\ \_\_inner\_size\ +\ \_\_j]);}
\DoxyCodeLine{02289\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ uint32x4\_t\ mask\ =\ vcgtq\_f32(data\_vec,\ max\_vec);}
\DoxyCodeLine{02290\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ max\_vec\ \ \ \ \ \ \ \ \ =\ vbslq\_f32(mask,\ data\_vec,\ max\_vec);}
\DoxyCodeLine{02291\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ index\_vec\ \ \ \ \ \ \ =\ vbslq\_u32(mask,\ current\_index,\ index\_vec);}
\DoxyCodeLine{02292\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ current\_index\ \ \ =\ vaddq\_u32(current\_index,\ increment);}
\DoxyCodeLine{02293\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02294\ }
\DoxyCodeLine{02295\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ \ \ \ max\_values[4];}
\DoxyCodeLine{02296\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ uint32\_t\ indices[4];}
\DoxyCodeLine{02297\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ vst1q\_f32(max\_values,\ max\_vec);}
\DoxyCodeLine{02298\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ vst1q\_u32(indices,\ index\_vec);}
\DoxyCodeLine{02299\ }
\DoxyCodeLine{02300\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ \ \ \ \ \ max\_value\ =\ max\_values[0];}
\DoxyCodeLine{02301\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ index\_type\ max\_index\ =\ indices[0];}
\DoxyCodeLine{02302\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 1;\ i\ <\ 4;\ ++i)}
\DoxyCodeLine{02303\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02304\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (max\_values[i]\ >\ max\_value)}
\DoxyCodeLine{02305\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02306\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ max\_value\ =\ max\_values[i];}
\DoxyCodeLine{02307\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ max\_index\ =\ indices[i];}
\DoxyCodeLine{02308\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02309\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02310\ }
\DoxyCodeLine{02311\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_k\ <\ this-\/>\_\_shape\_[\_\_dim];\ \_\_k++)}
\DoxyCodeLine{02312\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02313\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ \_\_v\ =}
\DoxyCodeLine{02314\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[(\_\_i\ *\ this-\/>\_\_shape\_[\_\_dim]\ +\ \_\_k)\ *\ \_\_inner\_size\ +\ \_\_j];}
\DoxyCodeLine{02315\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_\_v\ >\ max\_value)}
\DoxyCodeLine{02316\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02317\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ max\_value\ =\ \_\_v;}
\DoxyCodeLine{02318\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ max\_index\ =\ \_\_k;}
\DoxyCodeLine{02319\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02320\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02321\ }
\DoxyCodeLine{02322\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret.\_\_data\_[\_\_i\ *\ \_\_inner\_size\ +\ \_\_j]\ =\ max\_index;}
\DoxyCodeLine{02323\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02324\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02325\ \ \ \ \ \}}
\DoxyCodeLine{02326\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{02327\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02328\ \ \ \ \ \{}
\DoxyCodeLine{02329\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\_\_i\ =\ 0;\ \_\_i\ <\ \_\_outer\_size;\ \_\_i++)}
\DoxyCodeLine{02330\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02331\ \ \ \ \ \ \ \ \ \ \ \ \ index\_type\ \_\_j\ =\ 0;}
\DoxyCodeLine{02332\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_j\ <\ \_\_inner\_size;\ \_\_j++)}
\DoxyCodeLine{02333\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02334\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ index\_type\ \_\_max\_index\ =\ 0;}
\DoxyCodeLine{02335\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ value\_type\ \_\_max\_value\ =}
\DoxyCodeLine{02336\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i\ *\ this-\/>\_\_shape\_[\_\_dim]\ *\ \_\_inner\_size\ +\ \_\_j];}
\DoxyCodeLine{02337\ }
\DoxyCodeLine{02338\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ index\_type\ \_\_k\ =\ 1;}
\DoxyCodeLine{02339\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_k\ <\ this-\/>\_\_shape\_[\_\_dim];\ \_\_k++)}
\DoxyCodeLine{02340\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02341\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ value\_type\ \_\_v\ =}
\DoxyCodeLine{02342\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[(\_\_i\ *\ this-\/>\_\_shape\_[\_\_dim]\ +\ \_\_k)\ *\ \_\_inner\_size\ +\ \_\_j];}
\DoxyCodeLine{02343\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_\_v\ >\ \_\_max\_value)}
\DoxyCodeLine{02344\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02345\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_max\_value\ =\ \_\_v;}
\DoxyCodeLine{02346\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_max\_index\ =\ \_\_k;}
\DoxyCodeLine{02347\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02348\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02349\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret.\_\_data\_[\_\_i\ *\ \_\_inner\_size\ +\ \_\_j]\ =\ \_\_max\_index;}
\DoxyCodeLine{02350\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02351\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02352\ \ \ \ \ \}}
\DoxyCodeLine{02353\ }
\DoxyCodeLine{02354\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_ret;}
\DoxyCodeLine{02355\ \}}
\DoxyCodeLine{02356\ }
\DoxyCodeLine{02357\ }
\DoxyCodeLine{02358\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{02359\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::argmax}}(index\_type\ \_\_dim)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02360\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_\_dim\ <\ 0\ ||\ \_\_dim\ >=\ this-\/>\_\_shape\_.size())}
\DoxyCodeLine{02361\ \ \ \ \ \{}
\DoxyCodeLine{02362\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::out\_of\_range(\textcolor{stringliteral}{"{}Dimension\ out\ of\ range\ in\ argmax"{}});}
\DoxyCodeLine{02363\ \ \ \ \ \}}
\DoxyCodeLine{02364\ }
\DoxyCodeLine{02365\ \ \ \ \ shape\_type\ \_\_ret\_sh\ =\ this-\/>\_\_shape\_;}
\DoxyCodeLine{02366\ \ \ \ \ \_\_ret\_sh.erase(\_\_ret\_sh.begin()\ +\ \_\_dim);}
\DoxyCodeLine{02367\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \_\_ret;}
\DoxyCodeLine{02368\ \ \ \ \ \_\_ret.\_\_shape\_\ =\ \_\_ret\_sh;}
\DoxyCodeLine{02369\ \ \ \ \ \_\_ret.\_\_data\_.resize(this-\/>\_\_computeSize(\_\_ret\_sh),\ value\_type(0));}
\DoxyCodeLine{02370\ }
\DoxyCodeLine{02371\ \ \ \ \ index\_type\ \_\_outer\_size\ =\ 1;}
\DoxyCodeLine{02372\ \ \ \ \ index\_type\ \_\_inner\_size\ =\ 1;}
\DoxyCodeLine{02373\ }
\DoxyCodeLine{02374\ \ \ \ \ index\_type\ \_\_i\ =\ 0;}
\DoxyCodeLine{02375\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ \_\_dim;\ \_\_i++)}
\DoxyCodeLine{02376\ \ \ \ \ \{}
\DoxyCodeLine{02377\ \ \ \ \ \ \ \ \ \_\_outer\_size\ *=\ this-\/>\_\_shape\_[\_\_i];}
\DoxyCodeLine{02378\ \ \ \ \ \}}
\DoxyCodeLine{02379\ }
\DoxyCodeLine{02380\ \ \ \ \ \textcolor{keywordflow}{for}\ (\_\_i\ =\ \_\_dim\ +\ 1;\ \_\_i\ <\ static\_cast<index\_type>(this-\/>\_\_shape\_.size());\ \_\_i++)}
\DoxyCodeLine{02381\ \ \ \ \ \{}
\DoxyCodeLine{02382\ \ \ \ \ \ \ \ \ \_\_inner\_size\ *=\ this-\/>\_\_shape\_[\_\_i];}
\DoxyCodeLine{02383\ \ \ \ \ \}}
\DoxyCodeLine{02384\ }
\DoxyCodeLine{02385\ \textcolor{preprocessor}{\#if\ defined(\_\_AVX2\_\_)}}
\DoxyCodeLine{02386\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_same\_v<\_Tp,\ float>)}
\DoxyCodeLine{02387\ \ \ \ \ \{}
\DoxyCodeLine{02388\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\_\_i\ =\ 0;\ \_\_i\ <\ \_\_outer\_size;\ \_\_i++)}
\DoxyCodeLine{02389\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02390\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (index\_type\ \_\_j\ =\ 0;\ \_\_j\ <\ \_\_inner\_size;\ \_\_j++)}
\DoxyCodeLine{02391\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02392\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_m256\ \ \ \ \ max\_vec\ =\ \_mm256\_set1\_ps(-\/std::numeric\_limits<float>::infinity());}
\DoxyCodeLine{02393\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ index\_type\ \_\_k\ \ \ \ \ =\ 0;}
\DoxyCodeLine{02394\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_k\ +\ 8\ <=\ this-\/>\_\_shape\_[\_\_dim];\ \_\_k\ +=\ 8)}
\DoxyCodeLine{02395\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02396\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_m256\ data\_vec\ =\ \_mm256\_loadu\_ps(}
\DoxyCodeLine{02397\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&this-\/>\_\_data\_[(\_\_i\ *\ this-\/>\_\_shape\_[\_\_dim]\ +\ \_\_k)\ *\ \_\_inner\_size\ +\ \_\_j]);}
\DoxyCodeLine{02398\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ max\_vec\ =\ \_mm256\_max\_ps(max\_vec,\ data\_vec);}
\DoxyCodeLine{02399\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02400\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ max\_value\ =\ \_mm256\_reduce\_max\_ps(max\_vec);}
\DoxyCodeLine{02401\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_k\ <\ this-\/>\_\_shape\_[\_\_dim];\ \_\_k++)}
\DoxyCodeLine{02402\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02403\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ \_\_v\ =}
\DoxyCodeLine{02404\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[(\_\_i\ *\ this-\/>\_\_shape\_[\_\_dim]\ +\ \_\_k)\ *\ \_\_inner\_size\ +\ \_\_j];}
\DoxyCodeLine{02405\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ max\_value\ =\ std::max(max\_value,\ \_\_v);}
\DoxyCodeLine{02406\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02407\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret.\_\_data\_[\_\_i\ *\ \_\_inner\_size\ +\ \_\_j]\ =\ max\_value;}
\DoxyCodeLine{02408\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02409\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02410\ \ \ \ \ \}}
\DoxyCodeLine{02411\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{02412\ \textcolor{preprocessor}{\#elif\ defined(\_\_ARM\_NEON)}}
\DoxyCodeLine{02413\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_same\_v<\_Tp,\ float>)}
\DoxyCodeLine{02414\ \ \ \ \ \{}
\DoxyCodeLine{02415\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\_\_i\ =\ 0;\ \_\_i\ <\ \_\_outer\_size;\ \_\_i++)}
\DoxyCodeLine{02416\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02417\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (index\_type\ \_\_j\ =\ 0;\ \_\_j\ <\ \_\_inner\_size;\ \_\_j++)}
\DoxyCodeLine{02418\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02419\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ float32x4\_t\ max\_vec\ =\ vdupq\_n\_f32(-\/std::numeric\_limits<float>::infinity());}
\DoxyCodeLine{02420\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ index\_type\ \ \_\_k\ \ \ \ \ =\ 0;}
\DoxyCodeLine{02421\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_k\ +\ 4\ <=\ this-\/>\_\_shape\_[\_\_dim];\ \_\_k\ +=\ 4)}
\DoxyCodeLine{02422\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02423\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ float32x4\_t\ data\_vec\ =\ vld1q\_f32(}
\DoxyCodeLine{02424\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&this-\/>\_\_data\_[(\_\_i\ *\ this-\/>\_\_shape\_[\_\_dim]\ +\ \_\_k)\ *\ \_\_inner\_size\ +\ \_\_j]);}
\DoxyCodeLine{02425\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ max\_vec\ =\ vmaxq\_f32(max\_vec,\ data\_vec);}
\DoxyCodeLine{02426\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02427\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ max\_value\ =\ vmaxvq\_f32(max\_vec);}
\DoxyCodeLine{02428\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_k\ <\ this-\/>\_\_shape\_[\_\_dim];\ \_\_k++)}
\DoxyCodeLine{02429\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02430\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ \_\_v\ =}
\DoxyCodeLine{02431\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[(\_\_i\ *\ this-\/>\_\_shape\_[\_\_dim]\ +\ \_\_k)\ *\ \_\_inner\_size\ +\ \_\_j];}
\DoxyCodeLine{02432\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ max\_value\ =\ std::max(max\_value,\ \_\_v);}
\DoxyCodeLine{02433\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02434\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret.\_\_data\_[\_\_i\ *\ \_\_inner\_size\ +\ \_\_j]\ =\ max\_value;}
\DoxyCodeLine{02435\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02436\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02437\ \ \ \ \ \}}
\DoxyCodeLine{02438\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{02439\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02440\ \ \ \ \ \{}
\DoxyCodeLine{02441\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\_\_i\ =\ 0;\ \_\_i\ <\ \_\_outer\_size;\ \_\_i++)}
\DoxyCodeLine{02442\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02443\ \ \ \ \ \ \ \ \ \ \ \ \ index\_type\ \_\_j\ =\ 0;}
\DoxyCodeLine{02444\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_j\ <\ \_\_inner\_size;\ \_\_j++)}
\DoxyCodeLine{02445\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02446\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ value\_type\ \_\_max\_value\ =}
\DoxyCodeLine{02447\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i\ *\ this-\/>\_\_shape\_[\_\_dim]\ *\ \_\_inner\_size\ +\ \_\_j];}
\DoxyCodeLine{02448\ }
\DoxyCodeLine{02449\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ index\_type\ \_\_k\ =\ 1;}
\DoxyCodeLine{02450\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_k\ <\ this-\/>\_\_shape\_[\_\_dim];\ \_\_k++)}
\DoxyCodeLine{02451\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02452\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ value\_type\ \_\_v\ =}
\DoxyCodeLine{02453\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[(\_\_i\ *\ this-\/>\_\_shape\_[\_\_dim]\ +\ \_\_k)\ *\ \_\_inner\_size\ +\ \_\_j];}
\DoxyCodeLine{02454\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_\_v\ >\ \_\_max\_value)}
\DoxyCodeLine{02455\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02456\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_max\_value\ =\ \_\_v;}
\DoxyCodeLine{02457\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02458\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02459\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret.\_\_data\_[\_\_i\ *\ \_\_inner\_size\ +\ \_\_j]\ =\ \_\_max\_value;}
\DoxyCodeLine{02460\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02461\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02462\ \ \ \ \ \}}
\DoxyCodeLine{02463\ }
\DoxyCodeLine{02464\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_ret;}
\DoxyCodeLine{02465\ \}}
\DoxyCodeLine{02466\ }
\DoxyCodeLine{02467\ }
\DoxyCodeLine{02468\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{02469\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::unsqueeze}}(index\_type\ \_\_dim)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02470\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_\_dim\ <\ 0\ ||\ \_\_dim\ >\ \textcolor{keyword}{static\_cast<}index\_type\textcolor{keyword}{>}(this-\/>\_\_shape\_.size()))}
\DoxyCodeLine{02471\ \ \ \ \ \{}
\DoxyCodeLine{02472\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::out\_of\_range(\textcolor{stringliteral}{"{}Dimension\ out\ of\ range\ in\ unsqueeze"{}});}
\DoxyCodeLine{02473\ \ \ \ \ \}}
\DoxyCodeLine{02474\ }
\DoxyCodeLine{02475\ \ \ \ \ shape\_type\ \_\_s\ =\ this-\/>\_\_shape\_;}
\DoxyCodeLine{02476\ \ \ \ \ \_\_s.insert(\_\_s.begin()\ +\ \_\_dim,\ 1);}
\DoxyCodeLine{02477\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \_\_ret;}
\DoxyCodeLine{02478\ \ \ \ \ \_\_ret.\_\_shape\_\ =\ \_\_s;}
\DoxyCodeLine{02479\ \ \ \ \ \_\_ret.\_\_data\_\ \ =\ this-\/>\_\_data\_;}
\DoxyCodeLine{02480\ }
\DoxyCodeLine{02481\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_ret;}
\DoxyCodeLine{02482\ \}}
\DoxyCodeLine{02483\ }
\DoxyCodeLine{02484\ }
\DoxyCodeLine{02485\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{02486\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::view}}(std::initializer\_list<index\_type>\ \_\_sh)\ \{}
\DoxyCodeLine{02487\ \ \ \ \ index\_type\ \_\_s\ =\ this-\/>\_\_computeSize(\_\_sh);}
\DoxyCodeLine{02488\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_\_s\ !=\ this-\/>\_\_data\_.size())}
\DoxyCodeLine{02489\ \ \ \ \ \{}
\DoxyCodeLine{02490\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::invalid\_argument(\textcolor{stringliteral}{"{}Total\ elements\ do\ not\ match\ for\ new\ shape"{}});}
\DoxyCodeLine{02491\ \ \ \ \ \}}
\DoxyCodeLine{02492\ \ \ \ \ this-\/>\_\_shape\_\ =\ \_\_sh;}
\DoxyCodeLine{02493\ \ \ \ \ this-\/>\_\_compute\_strides();}
\DoxyCodeLine{02494\ \}}
\DoxyCodeLine{02495\ }
\DoxyCodeLine{02496\ }
\DoxyCodeLine{02497\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{02498\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::cat}}(\textcolor{keyword}{const}\ std::vector<\mbox{\hyperlink{classtensor}{tensor<\_Tp>}}>\&\ \_\_others,\ index\_type\ \_\_dim)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02499\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_t\ :\ \_\_others)}
\DoxyCodeLine{02500\ \ \ \ \ \{}
\DoxyCodeLine{02501\ \ \ \ \ \ \ \ \ index\_type\ \_\_i\ =\ 0;}
\DoxyCodeLine{02502\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_shape\_.size();\ \_\_i++)}
\DoxyCodeLine{02503\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02504\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_\_i\ !=\ \_\_dim\ \&\&\ this-\/>\_\_shape\_[\_\_i]\ !=\ \_\_t.\_\_shape\_[\_\_i])}
\DoxyCodeLine{02505\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02506\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::invalid\_argument(}
\DoxyCodeLine{02507\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Cannot\ concatenate\ tensors\ with\ different\ shapes\ along\ non-\/concatenation\ dimensions"{}});}
\DoxyCodeLine{02508\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02509\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02510\ \ \ \ \ \}}
\DoxyCodeLine{02511\ }
\DoxyCodeLine{02512\ \ \ \ \ shape\_type\ \_\_ret\_sh\ =\ this-\/>\_\_shape\_;}
\DoxyCodeLine{02513\ }
\DoxyCodeLine{02514\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_t\ :\ \_\_others)}
\DoxyCodeLine{02515\ \ \ \ \ \{}
\DoxyCodeLine{02516\ \ \ \ \ \ \ \ \ \_\_ret\_sh[\_\_dim]\ +=\ \_\_t.\_\_shape\_[\_\_dim];}
\DoxyCodeLine{02517\ \ \ \ \ \}}
\DoxyCodeLine{02518\ }
\DoxyCodeLine{02519\ \ \ \ \ data\_t\ \_\_c;}
\DoxyCodeLine{02520\ \ \ \ \ \_\_c.reserve(this-\/>\_\_data\_.size());}
\DoxyCodeLine{02521\ \ \ \ \ \_\_c.insert(\_\_c.end(),\ this-\/>\_\_data\_.begin(),\ this-\/>\_\_data\_.end());}
\DoxyCodeLine{02522\ }
\DoxyCodeLine{02523\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_t\ :\ \_\_others)}
\DoxyCodeLine{02524\ \ \ \ \ \{}
\DoxyCodeLine{02525\ \ \ \ \ \ \ \ \ \_\_c.insert(\_\_c.end(),\ \_\_t.\_\_data\_.begin(),\ \_\_t.\_\_data\_.end());}
\DoxyCodeLine{02526\ \ \ \ \ \}}
\DoxyCodeLine{02527\ }
\DoxyCodeLine{02528\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(\_\_c,\ \_\_ret\_sh);}
\DoxyCodeLine{02529\ \}}
\DoxyCodeLine{02530\ }
\DoxyCodeLine{02531\ }
\DoxyCodeLine{02532\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{02533\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::cumprod}}(index\_type\ \_\_dim)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02534\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_\_dim\ ==\ -\/1)}
\DoxyCodeLine{02535\ \ \ \ \ \{}
\DoxyCodeLine{02536\ \ \ \ \ \ \ \ \ data\_t\ \_\_flat\ =\ this-\/>\_\_data\_;}
\DoxyCodeLine{02537\ \ \ \ \ \ \ \ \ data\_t\ \_\_ret(\_\_flat.size());}
\DoxyCodeLine{02538\ \ \ \ \ \ \ \ \ \_\_ret[0]\ =\ \_\_flat[0];}
\DoxyCodeLine{02539\ }
\DoxyCodeLine{02540\ \textcolor{preprocessor}{\#if\ defined(\_\_AVX2\_\_)}}
\DoxyCodeLine{02541\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_same\_v<\_Tp,\ float>)}
\DoxyCodeLine{02542\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02543\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 1;}
\DoxyCodeLine{02544\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ +\ 8\ <=\ \_\_flat.size();\ \_\_i\ +=\ 8)}
\DoxyCodeLine{02545\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02546\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_m256\ prev\ \ \ =\ \_mm256\_loadu\_ps(\&\_\_ret[\_\_i\ -\/\ 1]);}
\DoxyCodeLine{02547\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_m256\ curr\ \ \ =\ \_mm256\_loadu\_ps(\&\_\_flat[\_\_i]);}
\DoxyCodeLine{02548\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_m256\ result\ =\ \_mm256\_mul\_ps(prev,\ curr);}
\DoxyCodeLine{02549\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_mm256\_storeu\_ps(\&\_\_ret[\_\_i],\ result);}
\DoxyCodeLine{02550\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02551\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ \_\_flat.size();\ \_\_i++)}
\DoxyCodeLine{02552\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02553\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_i]\ =\ \_\_ret[\_\_i\ -\/\ 1]\ *\ \_\_flat[\_\_i];}
\DoxyCodeLine{02554\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02555\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02556\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{02557\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02558\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 1;}
\DoxyCodeLine{02559\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ \_\_flat.size();\ \_\_i++)}
\DoxyCodeLine{02560\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02561\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_i]\ =\ \_\_ret[\_\_i\ -\/\ 1]\ *\ \_\_flat[\_\_i];}
\DoxyCodeLine{02562\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02563\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02564\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{02565\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 1;}
\DoxyCodeLine{02566\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ \_\_flat.size();\ \_\_i++)}
\DoxyCodeLine{02567\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02568\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_i]\ =\ \_\_ret[\_\_i\ -\/\ 1]\ *\ \_\_flat[\_\_i];}
\DoxyCodeLine{02569\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02570\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02571\ }
\DoxyCodeLine{02572\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(\_\_ret,\ \{\_\_flat.size()\});}
\DoxyCodeLine{02573\ \ \ \ \ \}}
\DoxyCodeLine{02574\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{02575\ \ \ \ \ \{}
\DoxyCodeLine{02576\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_\_dim\ <\ 0\ ||\ \_\_dim\ >=\ \textcolor{keyword}{static\_cast<}index\_type\textcolor{keyword}{>}(this-\/>\_\_shape\_.size()))}
\DoxyCodeLine{02577\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02578\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::invalid\_argument(\textcolor{stringliteral}{"{}Invalid\ dimension\ provided."{}});}
\DoxyCodeLine{02579\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02580\ }
\DoxyCodeLine{02581\ \ \ \ \ \ \ \ \ data\_t\ \_\_ret(this-\/>\_\_data\_);}
\DoxyCodeLine{02582\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ TODO\ :\ compute\_outer\_size()\ implementation}}
\DoxyCodeLine{02583\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_outer\_size\ =\ this-\/>\_\_compute\_outer\_size(\_\_dim);}
\DoxyCodeLine{02584\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_inner\_size\ =\ this-\/>\_\_shape\_[\_\_dim];}
\DoxyCodeLine{02585\ }
\DoxyCodeLine{02586\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_st\ =\ this-\/>\_\_strides\_[\_\_dim];}
\DoxyCodeLine{02587\ }
\DoxyCodeLine{02588\ \textcolor{preprocessor}{\#if\ defined(\_\_AVX2\_\_)}}
\DoxyCodeLine{02589\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_same\_v<\_Tp,\ float>)}
\DoxyCodeLine{02590\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02591\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;\ \_\_i\ <\ \_\_outer\_size;\ ++\_\_i)}
\DoxyCodeLine{02592\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02593\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_base\ =\ \_\_i\ *\ \_\_st;}
\DoxyCodeLine{02594\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_base]\ =\ \_\_data\_[\_\_base];}
\DoxyCodeLine{02595\ }
\DoxyCodeLine{02596\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_j\ =\ 1;}
\DoxyCodeLine{02597\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_j\ +\ 8\ <=\ \_\_inner\_size;\ \_\_j\ +=\ 8)}
\DoxyCodeLine{02598\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02599\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_m256\ prev\ \ \ =\ \_mm256\_loadu\_ps(\&\_\_ret[\_\_base\ +\ \_\_j\ -\/\ 1]);}
\DoxyCodeLine{02600\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_m256\ curr\ \ \ =\ \_mm256\_loadu\_ps(\&\_\_data\_[\_\_base\ +\ \_\_j]);}
\DoxyCodeLine{02601\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_m256\ result\ =\ \_mm256\_mul\_ps(prev,\ curr);}
\DoxyCodeLine{02602\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_mm256\_storeu\_ps(\&\_\_ret[\_\_base\ +\ \_\_j],\ result);}
\DoxyCodeLine{02603\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02604\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_j\ <\ \_\_inner\_size;\ \_\_j++)}
\DoxyCodeLine{02605\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02606\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_curr\ =\ \_\_base\ +\ \_\_j;}
\DoxyCodeLine{02607\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_curr]\ =\ \_\_ret[\_\_base\ +\ \_\_j\ -\/\ 1]\ *\ \_\_data\_[\_\_curr];}
\DoxyCodeLine{02608\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02609\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02610\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02611\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{02612\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02613\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;\ \_\_i\ <\ \_\_outer\_size;\ ++\_\_i)}
\DoxyCodeLine{02614\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02615\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_base\ =\ \_\_i\ *\ \_\_st;}
\DoxyCodeLine{02616\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_base]\ =\ \_\_data\_[\_\_base];}
\DoxyCodeLine{02617\ }
\DoxyCodeLine{02618\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ \_\_j\ =\ 1;\ \_\_j\ <\ \_\_inner\_size;\ \_\_j++)}
\DoxyCodeLine{02619\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02620\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_curr\ =\ \_\_base\ +\ \_\_j;}
\DoxyCodeLine{02621\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_curr]\ =\ \_\_ret[\_\_base\ +\ \_\_j\ -\/\ 1]\ *\ \_\_data\_[\_\_curr];}
\DoxyCodeLine{02622\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02623\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02624\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02625\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{02626\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{02627\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ \_\_outer\_size;\ ++\_\_i)}
\DoxyCodeLine{02628\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02629\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_base\ =\ \_\_i\ *\ \_\_st;}
\DoxyCodeLine{02630\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_base]\ =\ \_\_data\_[\_\_base];}
\DoxyCodeLine{02631\ }
\DoxyCodeLine{02632\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_j\ =\ 1;}
\DoxyCodeLine{02633\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_j\ <\ \_\_inner\_size;\ \_\_j++)}
\DoxyCodeLine{02634\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02635\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_curr\ =\ \_\_base\ +\ \_\_j;}
\DoxyCodeLine{02636\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_curr]\ =\ \_\_ret[\_\_base\ +\ \_\_j\ -\/\ 1]\ *\ \_\_data\_[\_\_curr];}
\DoxyCodeLine{02637\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02638\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02639\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02640\ }
\DoxyCodeLine{02641\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(\_\_ret,\ this-\/>\_\_shape\_);}
\DoxyCodeLine{02642\ \ \ \ \ \}}
\DoxyCodeLine{02643\ \}}
\DoxyCodeLine{02644\ }
\DoxyCodeLine{02645\ }
\DoxyCodeLine{02646\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{02647\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::slice}}(index\_type\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_dim,}
\DoxyCodeLine{02648\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::optional<index\_type>\ \_\_start,}
\DoxyCodeLine{02649\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::optional<index\_type>\ \_\_end,}
\DoxyCodeLine{02650\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ index\_type\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_step)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02651\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_\_dim\ <\ 0ULL\ ||\ \_\_dim\ >=\ \textcolor{keyword}{static\_cast<}index\_type\textcolor{keyword}{>}(this-\/>\_\_shape\_.size()))}
\DoxyCodeLine{02652\ \ \ \ \ \{}
\DoxyCodeLine{02653\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::out\_of\_range(\textcolor{stringliteral}{"{}Dimension\ out\ of\ range."{}});}
\DoxyCodeLine{02654\ \ \ \ \ \}}
\DoxyCodeLine{02655\ }
\DoxyCodeLine{02656\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \_\_ret;}
\DoxyCodeLine{02657\ }
\DoxyCodeLine{02658\ \ \ \ \ index\_type\ \_\_s\ \ \ \ \ \ \ =\ this-\/>\_\_shape\_[\_\_dim];}
\DoxyCodeLine{02659\ \ \ \ \ index\_type\ \_\_start\_i\ =\ \_\_start.value\_or(0ULL);}
\DoxyCodeLine{02660\ \ \ \ \ index\_type\ \_\_end\_i\ \ \ =\ \_\_end.value\_or(\_\_s);}
\DoxyCodeLine{02661\ }
\DoxyCodeLine{02662\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_\_start\_i\ <\ 0ULL)}
\DoxyCodeLine{02663\ \ \ \ \ \{}
\DoxyCodeLine{02664\ \ \ \ \ \ \ \ \ \_\_start\_i\ +=\ \_\_s;}
\DoxyCodeLine{02665\ \ \ \ \ \}}
\DoxyCodeLine{02666\ }
\DoxyCodeLine{02667\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_\_end\_i\ <\ 0ULL)}
\DoxyCodeLine{02668\ \ \ \ \ \{}
\DoxyCodeLine{02669\ \ \ \ \ \ \ \ \ \_\_end\_i\ +=\ \_\_s;}
\DoxyCodeLine{02670\ \ \ \ \ \}}
\DoxyCodeLine{02671\ }
\DoxyCodeLine{02672\ \ \ \ \ \_\_start\_i\ =\ std::max(index\_type(0ULL),\ std::min(\_\_start\_i,\ \_\_s));}
\DoxyCodeLine{02673\ \ \ \ \ \_\_end\_i\ \ \ =\ std::max(index\_type(0ULL),\ std::min(\_\_end\_i,\ \_\_s));}
\DoxyCodeLine{02674\ }
\DoxyCodeLine{02675\ \ \ \ \ index\_type\ \_\_slice\_size\ =\ (\_\_end\_i\ -\/\ \_\_start\_i\ +\ \_\_step\ -\/\ 1)\ /\ \_\_step;}
\DoxyCodeLine{02676\ \ \ \ \ shape\_type\ \_\_ret\_dims\ \ \ =\ this-\/>\_\_shape\_;}
\DoxyCodeLine{02677\ \ \ \ \ \_\_ret\_dims[-\/\_\_dim]\ \ \ \ \ \ =\ \_\_slice\_size;}
\DoxyCodeLine{02678\ \ \ \ \ \_\_ret\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ \mbox{\hyperlink{classtensor}{tensor}}(\_\_ret\_dims);}
\DoxyCodeLine{02679\ }
\DoxyCodeLine{02680\ \textcolor{preprocessor}{\#if\ defined(\_\_CUDACC\_\_)}}
\DoxyCodeLine{02681\ \ \ \ \ \textcolor{keywordflow}{if}\ (this-\/>\_\_data\_.size()\ >=\ 1024)}
\DoxyCodeLine{02682\ \ \ \ \ \{}
\DoxyCodeLine{02683\ \ \ \ \ \ \ \ \ \_Tp*\ d\_input;}
\DoxyCodeLine{02684\ \ \ \ \ \ \ \ \ \_Tp*\ d\_output;}
\DoxyCodeLine{02685\ \ \ \ \ \ \ \ \ cudaMalloc(\&d\_input,\ this-\/>\_\_data\_.size()\ *\ \textcolor{keyword}{sizeof}(\_Tp));}
\DoxyCodeLine{02686\ \ \ \ \ \ \ \ \ cudaMalloc(\&d\_output,\ \_\_ret.\_\_data\_.size()\ *\ \textcolor{keyword}{sizeof}(\_Tp));}
\DoxyCodeLine{02687\ }
\DoxyCodeLine{02688\ \ \ \ \ \ \ \ \ cudaMemcpy(d\_input,\ this-\/>\_\_data\_.data(),\ this-\/>\_\_data\_.size()\ *\ \textcolor{keyword}{sizeof}(\_Tp),}
\DoxyCodeLine{02689\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cudaMemcpyHostToDevice);}
\DoxyCodeLine{02690\ }
\DoxyCodeLine{02691\ \ \ \ \ \ \ \ \ dim3\ block(256);}
\DoxyCodeLine{02692\ \ \ \ \ \ \ \ \ dim3\ grid(((\_\_slice\_size\ +\ block.x\ -\/\ 1)\ /\ block.x));}
\DoxyCodeLine{02693\ \ \ \ \ \ \ \ \ slice\_kernel<<<grid,\ block>>>(d\_input,\ d\_output,\ \_\_start\_i,\ \_\_end\_i,\ \_\_step,\ \_\_slice\_size);}
\DoxyCodeLine{02694\ }
\DoxyCodeLine{02695\ \ \ \ \ \ \ \ \ cudaMemcpy(\_\_ret.\_\_data\_.data(),\ d\_output,\ \_\_ret.\_\_data\_.size()\ *\ \textcolor{keyword}{sizeof}(\_Tp),}
\DoxyCodeLine{02696\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cudaMemcpyDeviceToHost);}
\DoxyCodeLine{02697\ }
\DoxyCodeLine{02698\ \ \ \ \ \ \ \ \ cudaFree(d\_input);}
\DoxyCodeLine{02699\ \ \ \ \ \ \ \ \ cudaFree(d\_output);}
\DoxyCodeLine{02700\ \ \ \ \ \}}
\DoxyCodeLine{02701\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{02702\ \ \ \ \ \{}
\DoxyCodeLine{02703\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02704\ }
\DoxyCodeLine{02705\ \textcolor{preprocessor}{\#if\ defined(\_\_ARM\_NEON)}}
\DoxyCodeLine{02706\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_same\_v<\_Tp,\ float>\ \&\&\ \_\_step\ ==\ 1)}
\DoxyCodeLine{02707\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02708\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \ vector\_size\ =\ 4;}
\DoxyCodeLine{02709\ \ \ \ \ \ \ \ \ \ \ \ \ index\_type\ vector\_end\ =\ \_\_start\_i\ +\ ((\_\_end\_i\ -\/\ \_\_start\_i)\ /\ vector\_size)\ *\ vector\_size;}
\DoxyCodeLine{02710\ }
\DoxyCodeLine{02711\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (index\_type\ i\ =\ \_\_start\_i,\ j\ =\ 0;\ i\ <\ vector\_end;}
\DoxyCodeLine{02712\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ i\ +=\ vector\_size,\ j\ +=\ vector\_size)}
\DoxyCodeLine{02713\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02714\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ float32x4\_t\ vec\ =\ vld1q\_f32(\&(this-\/>\_\_data\_[i]));}
\DoxyCodeLine{02715\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ vst1q\_f32(\&(\_\_ret.\_\_data\_[j]),\ vec);}
\DoxyCodeLine{02716\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02717\ }
\DoxyCodeLine{02718\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (index\_type\ i\ =\ vector\_end,\ j\ =\ vector\_end\ -\/\ \_\_start\_i;\ i\ <\ \_\_end\_i;\ ++i,\ ++j)}
\DoxyCodeLine{02719\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02720\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret.\_\_data\_[j]\ =\ this-\/>\_\_data\_[i];}
\DoxyCodeLine{02721\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02722\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02723\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{02724\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02725\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02726\ \ \ \ \ \ \ \ \ \ \ \ \ index\_type\ \_\_i\ =\ \_\_start\_i,\ \_\_j\ =\ 0ULL;}
\DoxyCodeLine{02727\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ \_\_end\_i;\ \_\_i\ +=\ \_\_step,\ \_\_j++)}
\DoxyCodeLine{02728\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02729\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret(\{\_\_j\})\ =\ this-\/>at(\{\_\_i\});}
\DoxyCodeLine{02730\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02731\ \textcolor{preprocessor}{\#if\ defined(\_\_ARM\_NEON)}}
\DoxyCodeLine{02732\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02733\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02734\ }
\DoxyCodeLine{02735\ \textcolor{preprocessor}{\#if\ defined(\_\_CUDACC\_\_)}}
\DoxyCodeLine{02736\ \ \ \ \ \}}
\DoxyCodeLine{02737\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02738\ }
\DoxyCodeLine{02739\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_ret;}
\DoxyCodeLine{02740\ \}}
\DoxyCodeLine{02741\ }
\DoxyCodeLine{02742\ }
\DoxyCodeLine{02743\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{02744\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::fmod}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\&\ \_\_other)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02745\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(*this).fmod\_(\_\_other);}
\DoxyCodeLine{02746\ \}}
\DoxyCodeLine{02747\ }
\DoxyCodeLine{02748\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{02749\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::fmod}}(\textcolor{keyword}{const}\ value\_type\ \_\_val)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02750\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classtensor}{\_\_self}}(*this).fmod\_(\_\_val);}
\DoxyCodeLine{02751\ \}}
\DoxyCodeLine{02752\ }
\DoxyCodeLine{02753\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{02754\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::fmod\_}}(\textcolor{keyword}{const}\ value\_type\ \_\_val)\ \{}
\DoxyCodeLine{02755\ \ \ \ \ this-\/>\_\_check\_is\_scalar\_type(\textcolor{stringliteral}{"{}Cannot\ divide\ a\ non\ scalar\ type"{}});}
\DoxyCodeLine{02756\ \textcolor{preprocessor}{\#if\ defined(\_\_ARM\_NEON)}}
\DoxyCodeLine{02757\ \ \ \ \ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{size\_t}\ simd\_size\ =\ 4;}
\DoxyCodeLine{02758\ \ \ \ \ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{size\_t}\ simd\_end\ \ =\ this-\/>\_\_data\_.size()\ -\/\ (this-\/>\_\_data\_.size()\ -\/\ simd\_size);}
\DoxyCodeLine{02759\ }
\DoxyCodeLine{02760\ \ \ \ \ float32x4\_t\ \_\_b\ =\ vdupq\_n\_f32(\textcolor{keyword}{static\_cast<}float32\_t\textcolor{keyword}{>}(\_\_val));}
\DoxyCodeLine{02761\ }
\DoxyCodeLine{02762\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{02763\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ simd\_end;\ \_\_i\ +=\ simd\_size)}
\DoxyCodeLine{02764\ \ \ \ \ \{}
\DoxyCodeLine{02765\ \ \ \ \ \ \ \ \ float32x4\_t\ \_\_a\ \ \ \ \ \ \ \ \ =\ vld1q\_f32(\&this-\/>\_\_data\_[\_\_i]);}
\DoxyCodeLine{02766\ \ \ \ \ \ \ \ \ float32x4\_t\ \_\_div\ \ \ \ \ \ \ =\ vdivq\_f32(\_\_a,\ \_\_b);}
\DoxyCodeLine{02767\ \ \ \ \ \ \ \ \ float32x4\_t\ \_\_floor\_div\ =\ vrndq\_f32(\_\_div);}
\DoxyCodeLine{02768\ \ \ \ \ \ \ \ \ float32x4\_t\ \_\_mult\ \ \ \ \ \ =\ vmulq\_f32(\_\_floor\_div,\ \_\_b);}
\DoxyCodeLine{02769\ \ \ \ \ \ \ \ \ float32x4\_t\ \_\_mod\ \ \ \ \ \ \ =\ vsubq\_f32(\_\_a,\ \_\_mult);}
\DoxyCodeLine{02770\ }
\DoxyCodeLine{02771\ \ \ \ \ \ \ \ \ vst1q\_f32(\&this-\/>\_\_data\_[\_\_i],\ \_\_mod);}
\DoxyCodeLine{02772\ \ \ \ \ \}}
\DoxyCodeLine{02773\ }
\DoxyCodeLine{02774\ }
\DoxyCodeLine{02775\ \ \ \ \ \_\_i\ =\ simd\_end;}
\DoxyCodeLine{02776\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{02777\ \ \ \ \ \{}
\DoxyCodeLine{02778\ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i]\ =\ std::fmod(this-\/>\_\_data\_[\_\_i],\ \_\_val);}
\DoxyCodeLine{02779\ \ \ \ \ \}}
\DoxyCodeLine{02780\ }
\DoxyCodeLine{02781\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{02782\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{02783\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{02784\ \ \ \ \ \{}
\DoxyCodeLine{02785\ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i]\ =\ \textcolor{keyword}{static\_cast<}value\_type\textcolor{keyword}{>}(}
\DoxyCodeLine{02786\ \ \ \ \ \ \ \ \ \ \ \ \ std::fmod(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(this-\/>\_\_data\_[\_\_i]),\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(\_\_val)));}
\DoxyCodeLine{02787\ \ \ \ \ \}}
\DoxyCodeLine{02788\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02789\ \}}
\DoxyCodeLine{02790\ }
\DoxyCodeLine{02791\ }
\DoxyCodeLine{02792\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{02793\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::fmod\_}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\&\ \_\_other)\ \{}
\DoxyCodeLine{02794\ \ \ \ \ this-\/>\_\_check\_is\_scalar\_type(\textcolor{stringliteral}{"{}Cannot\ divide\ non\ scalar\ values"{}});}
\DoxyCodeLine{02795\ \ \ \ \ \textcolor{keywordflow}{if}\ (this-\/>\_\_shape\_\ !=\ \_\_other.shape()\ ||\ this-\/>\_\_data\_.size()\ !=\ \_\_other.size(0))}
\DoxyCodeLine{02796\ \ \ \ \ \{}
\DoxyCodeLine{02797\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::invalid\_argument(\textcolor{stringliteral}{"{}Cannot\ divide\ two\ tensors\ of\ different\ shapes\ :\ fmax"{}});}
\DoxyCodeLine{02798\ \ \ \ \ \}}
\DoxyCodeLine{02799\ \textcolor{preprocessor}{\#if\ defined(\_\_ARM\_NEON)}}
\DoxyCodeLine{02800\ \ \ \ \ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{size\_t}\ simd\_size\ =\ 4;}
\DoxyCodeLine{02801\ \ \ \ \ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{size\_t}\ simd\_end\ \ =\ this-\/>\_\_data\_.size()\ -\/\ (this-\/>\_\_data\_.size()\ \%\ simd\_size);}
\DoxyCodeLine{02802\ }
\DoxyCodeLine{02803\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{02804\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ simd\_end;\ \_\_i\ +=\ simd\_size)}
\DoxyCodeLine{02805\ \ \ \ \ \{}
\DoxyCodeLine{02806\ \ \ \ \ \ \ \ \ float32x4\_t\ \_\_a\ \ \ \ \ \ \ \ \ =\ vld1q\_f32(\&this-\/>\_\_data\_[\_\_i]);}
\DoxyCodeLine{02807\ \ \ \ \ \ \ \ \ float32x4\_t\ \_\_b\ \ \ \ \ \ \ \ \ =\ vld1q\_f32(\&\_\_other[\_\_i]);}
\DoxyCodeLine{02808\ \ \ \ \ \ \ \ \ float32x4\_t\ \_\_div\ \ \ \ \ \ \ =\ vdivq\_f32(\_\_a,\ \_\_b);}
\DoxyCodeLine{02809\ \ \ \ \ \ \ \ \ float32x4\_t\ \_\_floor\_div\ =\ vrndq\_f32(\_\_div);}
\DoxyCodeLine{02810\ \ \ \ \ \ \ \ \ float32x4\_t\ \_\_mult\ \ \ \ \ \ =\ vmulq\_f32(\_\_floor\_div,\ \_\_b);}
\DoxyCodeLine{02811\ \ \ \ \ \ \ \ \ float32x4\_t\ \_\_mod\ \ \ \ \ \ \ =\ vsubq\_f32(\_\_a,\ \_\_mult);}
\DoxyCodeLine{02812\ }
\DoxyCodeLine{02813\ \ \ \ \ \ \ \ \ vst1q\_f32(\&this-\/>\_\_data\_[\_\_i],\ \_\_mod);}
\DoxyCodeLine{02814\ \ \ \ \ \}}
\DoxyCodeLine{02815\ \ \ \ \ \_\_i\ =\ simd\_end;}
\DoxyCodeLine{02816\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{02817\ \ \ \ \ \{}
\DoxyCodeLine{02818\ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i]\ =\ std::fmod(this-\/>\_\_data\_[\_\_i],\ \_\_other[\_\_i]);}
\DoxyCodeLine{02819\ \ \ \ \ \}}
\DoxyCodeLine{02820\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{02821\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{02822\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{02823\ \ \ \ \ \{}
\DoxyCodeLine{02824\ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i]\ =\ \textcolor{keyword}{static\_cast<}value\_type\textcolor{keyword}{>}(}
\DoxyCodeLine{02825\ \ \ \ \ \ \ \ \ \ \ \ \ std::fmod(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(this-\/>\_\_data\_[\_\_i]),\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(\_\_other[\_\_i])));}
\DoxyCodeLine{02826\ \ \ \ \ \}}
\DoxyCodeLine{02827\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02828\ \}}
\DoxyCodeLine{02829\ }
\DoxyCodeLine{02830\ }
\DoxyCodeLine{02831\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{02832\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::fmax}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02833\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(*this).\mbox{\hyperlink{classtensor_a50fcf3eb344fc6566d95db639681cada}{fmax\_}}(\_\_other);}
\DoxyCodeLine{02834\ \}}
\DoxyCodeLine{02835\ }
\DoxyCodeLine{02836\ }
\DoxyCodeLine{02837\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{02838\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::fmax}}(\textcolor{keyword}{const}\ value\_type\ \_\_val)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02839\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classtensor}{\_\_self}}(*this).\mbox{\hyperlink{classtensor_a50fcf3eb344fc6566d95db639681cada}{fmax\_}}(\_\_val);}
\DoxyCodeLine{02840\ \}}
\DoxyCodeLine{02841\ }
\DoxyCodeLine{02842\ }
\DoxyCodeLine{02843\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{02844\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_a50fcf3eb344fc6566d95db639681cada}{tensor<\_Tp>::fmax\_}}(\textcolor{keyword}{const}\ value\_type\ \_\_val)\ \{}
\DoxyCodeLine{02845\ \textcolor{preprocessor}{\#if\ defined(\_\_ARM\_NEON)}}
\DoxyCodeLine{02846\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ simd\_size\ =\ 4;}
\DoxyCodeLine{02847\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ simd\_end\ \ =\ this-\/>\_\_data\_.size()\ -\/\ (this-\/>\_\_data\_.size()\ \%\ simd\_size);}
\DoxyCodeLine{02848\ }
\DoxyCodeLine{02849\ \ \ \ \ float32x4\_t\ scalar\_val\ =\ vdupq\_n\_f32(\_\_val);}
\DoxyCodeLine{02850\ }
\DoxyCodeLine{02851\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;\ \_\_i\ <\ simd\_end;\ \_\_i\ +=\ simd\_size)}
\DoxyCodeLine{02852\ \ \ \ \ \{}
\DoxyCodeLine{02853\ \ \ \ \ \ \ \ \ float32x4\_t\ \_\_a\ \ \ \ \ \ \ =\ vld1q\_f32(\&this-\/>\_\_data\_[\_\_i]);}
\DoxyCodeLine{02854\ \ \ \ \ \ \ \ \ float32x4\_t\ \_\_max\_val\ =\ vmaxq\_f32(\_\_a,\ scalar\_val);}
\DoxyCodeLine{02855\ \ \ \ \ \ \ \ \ vst1q\_f32(\&this-\/>\_\_data\_[\_\_i],\ \_\_max\_val);}
\DoxyCodeLine{02856\ \ \ \ \ \}}
\DoxyCodeLine{02857\ }
\DoxyCodeLine{02858\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ \_\_i\ =\ simd\_end;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{02859\ \ \ \ \ \{}
\DoxyCodeLine{02860\ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i]\ =\ std::fmax(this-\/>\_\_data\_[\_\_i],\ \_\_val);}
\DoxyCodeLine{02861\ \ \ \ \ \}}
\DoxyCodeLine{02862\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{02863\ \ \ \ \ std::transform(this-\/>\_\_data\_.begin(),\ this-\/>\_\_data\_.end(),\ this-\/>\_\_data\_.begin(),}
\DoxyCodeLine{02864\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [\&\_\_val](const\_reference\ \_\_v)\ \{\ return\ std::fmax(\_\_v,\ \_\_val);\ \});}
\DoxyCodeLine{02865\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02866\ \}}
\DoxyCodeLine{02867\ }
\DoxyCodeLine{02868\ }
\DoxyCodeLine{02869\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{02870\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor_a50fcf3eb344fc6566d95db639681cada}{tensor<\_Tp>::fmax\_}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor<value\_type>}}\&\ \_\_other)\ \{}
\DoxyCodeLine{02871\ \ \ \ \ assert(this-\/>\_\_shape\_\ ==\ \_\_other.shape()\ \&\&\ this-\/>\_\_data\_.size()\ ==\ \_\_other.size(0));}
\DoxyCodeLine{02872\ \textcolor{preprocessor}{\#if\ defined(\_\_ARM\_NEON)}}
\DoxyCodeLine{02873\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ simd\_size\ =\ 4;}
\DoxyCodeLine{02874\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ simd\_end\ \ =\ this-\/>\_\_data\_.size()\ -\/\ (this-\/>\_\_data\_.size()\ \%\ simd\_size);}
\DoxyCodeLine{02875\ }
\DoxyCodeLine{02876\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;\ \_\_i\ <\ simd\_end;\ \_\_i\ +=\ simd\_size)}
\DoxyCodeLine{02877\ \ \ \ \ \{}
\DoxyCodeLine{02878\ \ \ \ \ \ \ \ \ float32x4\_t\ \_\_a\ \ \ \ \ \ \ =\ vld1q\_f32(\&this-\/>\_\_data\_[\_\_i]);}
\DoxyCodeLine{02879\ \ \ \ \ \ \ \ \ float32x4\_t\ \_\_b\ \ \ \ \ \ \ =\ vld1q\_f32(\&(\_\_other[\_\_i]));}
\DoxyCodeLine{02880\ \ \ \ \ \ \ \ \ float32x4\_t\ \_\_max\_val\ =\ vmaxq\_f32(\_\_a,\ \_\_b);}
\DoxyCodeLine{02881\ \ \ \ \ \ \ \ \ vst1q\_f32(\&this-\/>\_\_data\_[\_\_i],\ \_\_max\_val);}
\DoxyCodeLine{02882\ \ \ \ \ \}}
\DoxyCodeLine{02883\ }
\DoxyCodeLine{02884\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ \_\_i\ =\ simd\_end;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{02885\ \ \ \ \ \{}
\DoxyCodeLine{02886\ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i]\ =\ std::fmax(this-\/>\_\_data\_[\_\_i],\ \_\_other[\_\_i]);}
\DoxyCodeLine{02887\ \ \ \ \ \}}
\DoxyCodeLine{02888\ }
\DoxyCodeLine{02889\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{02890\ \ \ \ \ std::transform(this-\/>\_\_data.begin(),\ this-\/>\_\_data\_.end(),\ \_\_other.begin(),\ this-\/>\_\_data.begin(),}
\DoxyCodeLine{02891\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [](const\_reference\ \_\_v,\ const\_reference\ \_\_w)\ \{\ return\ std::fmax(\_\_v,\ \_\_w);\ \});}
\DoxyCodeLine{02892\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02893\ \}}
\DoxyCodeLine{02894\ }
\DoxyCodeLine{02895\ }
\DoxyCodeLine{02896\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{02897\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::count\_nonzero}}(index\_type\ \_\_dim)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02898\ \ \ \ \ this-\/>\_\_check\_is\_scalar\_type(\textcolor{stringliteral}{"{}Cannot\ compare\ a\ non-\/scalar\ value\ to\ zero"{}});}
\DoxyCodeLine{02899\ }
\DoxyCodeLine{02900\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_c\ =\ 0;}
\DoxyCodeLine{02901\ }
\DoxyCodeLine{02902\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_\_dim\ ==\ -\/1)}
\DoxyCodeLine{02903\ \ \ \ \ \{}
\DoxyCodeLine{02904\ \textcolor{preprocessor}{\#pragma\ omp\ parallel}}
\DoxyCodeLine{02905\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02906\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ local\_count\ =\ 0;}
\DoxyCodeLine{02907\ }
\DoxyCodeLine{02908\ \textcolor{preprocessor}{\#ifdef\ \_\_AVX\_\_}}
\DoxyCodeLine{02909\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_same\_v<value\_type,\ float>)}
\DoxyCodeLine{02910\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02911\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ size\ =\ this-\/>\_\_data\_.size();}
\DoxyCodeLine{02912\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ i\ \ \ \ =\ 0;}
\DoxyCodeLine{02913\ }
\DoxyCodeLine{02914\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ i\ +\ 8\ <=\ size;\ i\ +=\ 8)}
\DoxyCodeLine{02915\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02916\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_m256\ vec\ \ \ \ \ \ \ \ \ \ =\ \_mm256\_loadu\_ps(\&this-\/>\_\_data\_[i]);}
\DoxyCodeLine{02917\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_m256\ nonzero\_mask\ =\ \_mm256\_cmp\_ps(vec,\ \_mm256\_setzero\_ps(),\ \_CMP\_NEQ\_OQ);}
\DoxyCodeLine{02918\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ local\_count\ +=\ \_mm256\_movemask\_ps(nonzero\_mask);}
\DoxyCodeLine{02919\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02920\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02921\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02922\ \textcolor{preprocessor}{\#ifdef\ \_\_ARM\_NEON}}
\DoxyCodeLine{02923\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_same\_v<value\_type,\ float>)}
\DoxyCodeLine{02924\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02925\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ size\ =\ this-\/>\_\_data\_.size();}
\DoxyCodeLine{02926\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ i\ \ \ \ =\ 0;}
\DoxyCodeLine{02927\ }
\DoxyCodeLine{02928\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ i\ +\ 4\ <=\ size;\ i\ +=\ 4)}
\DoxyCodeLine{02929\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02930\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ float32x4\_t\ vec\ \ \ \ \ \ \ \ \ \ =\ vld1q\_f32(\&this-\/>\_\_data\_[i]);}
\DoxyCodeLine{02931\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ uint32x4\_t\ \ nonzero\_mask\ =\ vcgtq\_f32(vec,\ vdupq\_n\_f32(0.0f));}
\DoxyCodeLine{02932\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ local\_count\ +=\ vaddvq\_u32(nonzero\_mask);}
\DoxyCodeLine{02933\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02934\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02935\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02936\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ j\ =\ i;\ j\ <\ this-\/>\_\_data\_.size();\ j++)}
\DoxyCodeLine{02937\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02938\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (this-\/>\_\_data\_[j]\ !=\ 0)}
\DoxyCodeLine{02939\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02940\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ local\_count++;}
\DoxyCodeLine{02941\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02942\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02943\ }
\DoxyCodeLine{02944\ \textcolor{preprocessor}{\#pragma\ omp\ atomic}}
\DoxyCodeLine{02945\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_c\ +=\ local\_count;}
\DoxyCodeLine{02946\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02947\ \ \ \ \ \}}
\DoxyCodeLine{02948\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{02949\ \ \ \ \ \{}
\DoxyCodeLine{02950\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_\_dim\ <\ 0\ ||\ \_\_dim\ >=\ \textcolor{keyword}{static\_cast<}index\_type\textcolor{keyword}{>}(\_\_shape\_.size()))}
\DoxyCodeLine{02951\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02952\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::invalid\_argument(\textcolor{stringliteral}{"{}Invalid\ dimension\ provided."{}});}
\DoxyCodeLine{02953\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02954\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(\textcolor{stringliteral}{"{}Dimension-\/specific\ non-\/zero\ counting\ is\ not\ implemented\ yet."{}});}
\DoxyCodeLine{02955\ \ \ \ \ \}}
\DoxyCodeLine{02956\ }
\DoxyCodeLine{02957\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_c;}
\DoxyCodeLine{02958\ \}}
\DoxyCodeLine{02959\ }
\DoxyCodeLine{02960\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{02961\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::matmul}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02962\ \ \ \ \ \textcolor{keywordflow}{if}\ (this-\/>\_\_shape\_.size()\ !=\ 2\ ||\ \_\_other.shape().size()\ !=\ 2)}
\DoxyCodeLine{02963\ \ \ \ \ \{}
\DoxyCodeLine{02964\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::invalid\_argument(\textcolor{stringliteral}{"{}matmul\ is\ only\ supported\ for\ 2D\ tensors"{}});}
\DoxyCodeLine{02965\ \ \ \ \ \}}
\DoxyCodeLine{02966\ }
\DoxyCodeLine{02967\ \ \ \ \ \textcolor{keywordflow}{if}\ (this-\/>\_\_shape\_[1]\ !=\ \_\_other.shape()[0])}
\DoxyCodeLine{02968\ \ \ \ \ \{}
\DoxyCodeLine{02969\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::invalid\_argument(\textcolor{stringliteral}{"{}Shape\ mismatch\ for\ matrix\ multiplication"{}});}
\DoxyCodeLine{02970\ \ \ \ \ \}}
\DoxyCodeLine{02971\ }
\DoxyCodeLine{02972\ \ \ \ \ shape\_type\ \_\_ret\_sh\ =\ \{this-\/>\_\_shape\_[0],\ \_\_other.shape()[1]\};}
\DoxyCodeLine{02973\ \ \ \ \ data\_t\ \ \ \ \ \_\_ret\_d(\_\_ret\_sh[0]\ *\ \_\_ret\_sh[1],\ 0);}
\DoxyCodeLine{02974\ }
\DoxyCodeLine{02975\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ blockSize\ =\ 64;}
\DoxyCodeLine{02976\ }
\DoxyCodeLine{02977\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \_\_ret\_sh[0];\ i\ +=\ blockSize)}
\DoxyCodeLine{02978\ \ \ \ \ \{}
\DoxyCodeLine{02979\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \_\_ret\_sh[1];\ j\ +=\ blockSize)}
\DoxyCodeLine{02980\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02981\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ 0;\ k\ <\ this-\/>\_\_shape\_[1];\ k\ +=\ blockSize)}
\DoxyCodeLine{02982\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02983\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ ii\ =\ i;\ ii\ <\ std::min(static\_cast<index\_type>(i\ +\ blockSize),\ \_\_ret\_sh[0]);}
\DoxyCodeLine{02984\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ii++)}
\DoxyCodeLine{02985\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02986\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ jj\ =\ j;}
\DoxyCodeLine{02987\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ jj\ <\ std::min(static\_cast<index\_type>(j\ +\ blockSize),\ \_\_ret\_sh[1]);\ jj++)}
\DoxyCodeLine{02988\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02989\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ value\_type\ \_\_sum\ =\ 0;}
\DoxyCodeLine{02990\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ kk\ =\ k;\ kk\ <\ std::min(static\_cast<index\_type>(k\ +\ blockSize),}
\DoxyCodeLine{02991\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>\_\_shape\_[1]);}
\DoxyCodeLine{02992\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ kk++)}
\DoxyCodeLine{02993\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02994\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_sum\ +=\ this-\/>at(\{ii,\ kk\})\ *\ \_\_other.at(\{kk,\ jj\});}
\DoxyCodeLine{02995\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02996\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret\_d[ii\ *\ \_\_ret\_sh[1]\ +\ jj]\ +=\ \_\_sum;}
\DoxyCodeLine{02997\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02998\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02999\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03000\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03001\ \ \ \ \ \}}
\DoxyCodeLine{03002\ }
\DoxyCodeLine{03003\ \textcolor{preprocessor}{\#ifdef\ \_\_ARM\_NEON}}
\DoxyCodeLine{03004\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ neonBlockSize\ =\ 4;}
\DoxyCodeLine{03005\ }
\DoxyCodeLine{03006\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \_\_ret\_sh[0];\ i\ +=\ neonBlockSize)}
\DoxyCodeLine{03007\ \ \ \ \ \{}
\DoxyCodeLine{03008\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \_\_ret\_sh[1];\ j\ +=\ neonBlockSize)}
\DoxyCodeLine{03009\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03010\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ 0;\ k\ <\ this-\/>\_\_shape\_[1];\ k\ +=\ neonBlockSize)}
\DoxyCodeLine{03011\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03012\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ ii\ =\ i;}
\DoxyCodeLine{03013\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ii\ <\ std::min(static\_cast<index\_type>(i\ +\ neonBlockSize),\ \_\_ret\_sh[0]);\ ii++)}
\DoxyCodeLine{03014\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03015\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ jj\ =\ j;}
\DoxyCodeLine{03016\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ jj\ <\ std::min(static\_cast<index\_type>(j\ +\ neonBlockSize),\ \_\_ret\_sh[1]);}
\DoxyCodeLine{03017\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ jj++)}
\DoxyCodeLine{03018\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03019\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ float32x4\_t\ sum\_vec\ =\ vdupq\_n\_f32(0);}
\DoxyCodeLine{03020\ }
\DoxyCodeLine{03021\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ kk\ =\ k;\ kk\ <\ std::min(static\_cast<index\_type>(k\ +\ neonBlockSize),}
\DoxyCodeLine{03022\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>\_\_shape\_[1]);}
\DoxyCodeLine{03023\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ kk\ +=\ 4)}
\DoxyCodeLine{03024\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03025\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ float32x4\_t\ a\_vec\ =}
\DoxyCodeLine{03026\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ vld1q\_f32(\&this-\/>\_\_data\_[ii\ *\ this-\/>\_\_shape\_[1]\ +\ kk]);}
\DoxyCodeLine{03027\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ float32x4\_t\ b\_vec\ =}
\DoxyCodeLine{03028\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ vld1q\_f32(\&\_\_other.\_\_data\_[kk\ *\ \_\_other.shape()[1]\ +\ jj]);}
\DoxyCodeLine{03029\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sum\_vec\ =\ vmlaq\_f32(sum\_vec,\ a\_vec,\ b\_vec);}
\DoxyCodeLine{03030\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03031\ }
\DoxyCodeLine{03032\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ float32x2\_t\ sum\_low\ \ =\ vget\_low\_f32(sum\_vec);}
\DoxyCodeLine{03033\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ float32x2\_t\ sum\_high\ =\ vget\_high\_f32(sum\_vec);}
\DoxyCodeLine{03034\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sum\_low\ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ vadd\_f32(sum\_low,\ sum\_high);}
\DoxyCodeLine{03035\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ float32x2\_t\ sum\_dup\ \ =\ vpadd\_f32(sum\_low,\ sum\_low);}
\DoxyCodeLine{03036\ }
\DoxyCodeLine{03037\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret\_d[ii\ *\ \_\_ret\_sh[1]\ +\ jj]\ +=\ vget\_lane\_f32(sum\_dup,\ 0);}
\DoxyCodeLine{03038\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03039\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03040\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03041\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03042\ \ \ \ \ \}}
\DoxyCodeLine{03043\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03044\ }
\DoxyCodeLine{03045\ \textcolor{preprocessor}{\#ifdef\ \_\_CUDACC\_\_}}
\DoxyCodeLine{03046\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ threadsPerBlock\ =\ 256;}
\DoxyCodeLine{03047\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ blocksPerGrid\ \ \ =\ (\_\_ret\_sh[0]\ *\ \_\_ret\_sh[1]\ +\ threadsPerBlock\ -\/\ 1)\ /\ threadsPerBlock;}
\DoxyCodeLine{03048\ }
\DoxyCodeLine{03049\ \ \ \ \ \_Tp\ *d\_a,\ *d\_b,\ *d\_c;}
\DoxyCodeLine{03050\ \ \ \ \ cudaMalloc(\&d\_a,\ this-\/>\_\_data\_.size()\ *\ \textcolor{keyword}{sizeof}(\_Tp));}
\DoxyCodeLine{03051\ \ \ \ \ cudaMalloc(\&d\_b,\ \_\_other.\_\_data\_.size()\ *\ \textcolor{keyword}{sizeof}(\_Tp));}
\DoxyCodeLine{03052\ \ \ \ \ cudaMalloc(\&d\_c,\ \_\_ret\_d.size()\ *\ \textcolor{keyword}{sizeof}(\_Tp));}
\DoxyCodeLine{03053\ }
\DoxyCodeLine{03054\ \ \ \ \ cudaMemcpy(d\_a,\ this-\/>\_\_data\_.data(),\ this-\/>\_\_data\_.size()\ *\ \textcolor{keyword}{sizeof}(\_Tp),}
\DoxyCodeLine{03055\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cudaMemcpyHostToDevice);}
\DoxyCodeLine{03056\ \ \ \ \ cudaMemcpy(d\_b,\ \_\_other.\_\_data\_.data(),\ \_\_other.\_\_data\_.size()\ *\ \textcolor{keyword}{sizeof}(\_Tp),}
\DoxyCodeLine{03057\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cudaMemcpyHostToDevice);}
\DoxyCodeLine{03058\ }
\DoxyCodeLine{03059\ \ \ \ \ matmul\_kernel<<<blocksPerGrid,\ threadsPerBlock>>>(d\_a,\ d\_b,\ d\_c,\ this-\/>\_\_shape\_[0],}
\DoxyCodeLine{03060\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>\_\_shape\_[1],\ \_\_other.shape()[1]);}
\DoxyCodeLine{03061\ }
\DoxyCodeLine{03062\ \ \ \ \ cudaMemcpy(\_\_ret\_d.data(),\ d\_c,\ \_\_ret\_d.size()\ *\ \textcolor{keyword}{sizeof}(\_Tp),\ cudaMemcpyDeviceToHost);}
\DoxyCodeLine{03063\ }
\DoxyCodeLine{03064\ \ \ \ \ cudaFree(d\_a);}
\DoxyCodeLine{03065\ \ \ \ \ cudaFree(d\_b);}
\DoxyCodeLine{03066\ \ \ \ \ cudaFree(d\_c);}
\DoxyCodeLine{03067\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03068\ }
\DoxyCodeLine{03069\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(\_\_ret\_d,\ \_\_ret\_sh);}
\DoxyCodeLine{03070\ \}}
\DoxyCodeLine{03071\ }
\DoxyCodeLine{03072\ }
\DoxyCodeLine{03073\ \textcolor{preprocessor}{\#ifdef\ \_\_CUDACC\_\_}}
\DoxyCodeLine{03074\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{03075\ \_\_global\_\_\ \textcolor{keywordtype}{void}\ matmul\_kernel(\_Tp*\ a,\ \_Tp*\ b,\ \_Tp*\ c,\ \textcolor{keywordtype}{int}\ m,\ \textcolor{keywordtype}{int}\ n,\ \textcolor{keywordtype}{int}\ k)\ \{}
\DoxyCodeLine{03076\ \ \ \ \ \textcolor{keywordtype}{int}\ row\ =\ blockIdx.y\ *\ blockDim.y\ +\ threadIdx.y;}
\DoxyCodeLine{03077\ \ \ \ \ \textcolor{keywordtype}{int}\ col\ =\ blockIdx.x\ *\ blockDim.x\ +\ threadIdx.x;}
\DoxyCodeLine{03078\ }
\DoxyCodeLine{03079\ \ \ \ \ \textcolor{keywordflow}{if}\ (row\ <\ m\ \&\&\ col\ <\ k)}
\DoxyCodeLine{03080\ \ \ \ \ \{}
\DoxyCodeLine{03081\ \ \ \ \ \ \ \ \ \_Tp\ sum\ =\ 0;}
\DoxyCodeLine{03082\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ n;\ i++)}
\DoxyCodeLine{03083\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03084\ \ \ \ \ \ \ \ \ \ \ \ \ sum\ +=\ a[row\ *\ n\ +\ i]\ *\ b[i\ *\ k\ +\ col];}
\DoxyCodeLine{03085\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03086\ }
\DoxyCodeLine{03087\ \ \ \ \ \ \ \ \ c[row\ *\ k\ +\ col]\ =\ sum;}
\DoxyCodeLine{03088\ \ \ \ \ \}}
\DoxyCodeLine{03089\ \}}
\DoxyCodeLine{03090\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03091\ }
\DoxyCodeLine{03092\ }
\DoxyCodeLine{03093\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{03094\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::reshape}}(\textcolor{keyword}{const}\ shape\_type\ \_\_sh)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{03095\ \ \ \ \ data\_t\ \_\_d\ =\ this-\/>\_\_data\_;}
\DoxyCodeLine{03096\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_s\ =\ this-\/>\_\_computeSize(\_\_sh);}
\DoxyCodeLine{03097\ }
\DoxyCodeLine{03098\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_\_s\ !=\ this-\/>\_\_data\_.size())}
\DoxyCodeLine{03099\ \ \ \ \ \{}
\DoxyCodeLine{03100\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::invalid\_argument(}
\DoxyCodeLine{03101\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}input\ shape\ must\ have\ size\ of\ elements\ equal\ to\ the\ current\ number\ of\ elements\ in\ the\ tensor\ data"{}});}
\DoxyCodeLine{03102\ \ \ \ \ \}}
\DoxyCodeLine{03103\ }
\DoxyCodeLine{03104\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classtensor}{\_\_self}}(\_\_d,\ \_\_sh);}
\DoxyCodeLine{03105\ \}}
\DoxyCodeLine{03106\ }
\DoxyCodeLine{03107\ }
\DoxyCodeLine{03108\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{03109\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::cross\_product}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{03110\ \ \ \ \ this-\/>\_\_check\_is\_arithmetic\_type(\textcolor{stringliteral}{"{}Cannot\ perform\ a\ cross\ product\ on\ non-\/scalar\ data\ types"{}});}
\DoxyCodeLine{03111\ \ \ \ \ \textcolor{keywordflow}{if}\ (this-\/>empty()\ ||\ \_\_other.empty())}
\DoxyCodeLine{03112\ \ \ \ \ \{}
\DoxyCodeLine{03113\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::invalid\_argument(\textcolor{stringliteral}{"{}Cannot\ cross\ product\ an\ empty\ vector"{}});}
\DoxyCodeLine{03114\ \ \ \ \ \}}
\DoxyCodeLine{03115\ }
\DoxyCodeLine{03116\ \ \ \ \ \textcolor{keywordflow}{if}\ (this-\/>shape()\ !=\ std::vector<int>\{3\}\ ||\ \_\_other.shape()\ !=\ std::vector<int>\{3\})}
\DoxyCodeLine{03117\ \ \ \ \ \{}
\DoxyCodeLine{03118\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::invalid\_argument(\textcolor{stringliteral}{"{}Cross\ product\ can\ only\ be\ performed\ on\ 3-\/element\ vectors"{}});}
\DoxyCodeLine{03119\ \ \ \ \ \}}
\DoxyCodeLine{03120\ }
\DoxyCodeLine{03121\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \_\_ret(\{3\});}
\DoxyCodeLine{03122\ }
\DoxyCodeLine{03123\ \textcolor{preprocessor}{\#if\ defined(\_\_ARM\_NEON)\ \&\&\ defined(\_\_aarch64\_\_)}}
\DoxyCodeLine{03124\ \ \ \ \ float32x4\_t\ \_\_a\ =\ vld1q\_f32(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }\textcolor{keywordtype}{float}*\textcolor{keyword}{>}(this-\/>\_\_data\_.data()));}
\DoxyCodeLine{03125\ \ \ \ \ float32x4\_t\ \_\_b\ =\ vld1q\_f32(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }\textcolor{keywordtype}{float}*\textcolor{keyword}{>}(\_\_other.storage().data()));}
\DoxyCodeLine{03126\ }
\DoxyCodeLine{03127\ \ \ \ \ float32x4\_t\ \_\_a\_yzx\ =\ vextq\_f32(\_\_a,\ \_\_a,\ 1);}
\DoxyCodeLine{03128\ \ \ \ \ float32x4\_t\ \_\_b\_yzx\ =\ vextq\_f32(\_\_b,\ \_\_b,\ 1);}
\DoxyCodeLine{03129\ }
\DoxyCodeLine{03130\ \ \ \ \ float32x4\_t\ \_\_result\ =\ vsubq\_f32(vmulq\_f32(\_\_a\_yzx,\ \_\_b),\ vmulq\_f32(\_\_a,\ \_\_b\_yzx));}
\DoxyCodeLine{03131\ }
\DoxyCodeLine{03132\ \ \ \ \ \_\_result\ =\ vextq\_f32(\_\_result,\ \_\_result,\ 3);}
\DoxyCodeLine{03133\ }
\DoxyCodeLine{03134\ \ \ \ \ vst1q\_f32(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keywordtype}{float}*\textcolor{keyword}{>}(\_\_ret.storage().data()),\ \_\_result);}
\DoxyCodeLine{03135\ \textcolor{preprocessor}{\#elif\ defined(\_\_CUDACC\_\_)}}
\DoxyCodeLine{03136\ \ \ \ \ pointer\ \_\_d\_a;}
\DoxyCodeLine{03137\ \ \ \ \ pointer\ \_\_d\_b;}
\DoxyCodeLine{03138\ \ \ \ \ pointer\ \_\_d\_c;}
\DoxyCodeLine{03139\ }
\DoxyCodeLine{03140\ \ \ \ \ cudaMalloc(\&\_\_d\_a,\ 3\ *\ \textcolor{keyword}{sizeof}(value\_type));}
\DoxyCodeLine{03141\ \ \ \ \ cudaMalloc(\&\_\_d\_b,\ 3\ *\ \textcolor{keyword}{sizeof}(value\_type));}
\DoxyCodeLine{03142\ \ \ \ \ cudaMalloc(\&\_\_d\_c,\ 3\ *\ \textcolor{keyword}{sizeof}(value\_type));}
\DoxyCodeLine{03143\ }
\DoxyCodeLine{03144\ \ \ \ \ cudaMemcpy(\_\_d\_a,\ this-\/>\_\_data\_.data(),\ 3\ *\ \textcolor{keyword}{sizeof}(value\_type),\ cudaMemcpyHostToDevice);}
\DoxyCodeLine{03145\ \ \ \ \ cudaMemcpy(\_\_d\_b,\ \_\_other.storage().data(),\ 3\ *\ \textcolor{keyword}{sizeof}(value\_type),\ cudaMemcpyHostToDevice);}
\DoxyCodeLine{03146\ }
\DoxyCodeLine{03147\ \ \ \ \ dim3\ block(1);}
\DoxyCodeLine{03148\ \ \ \ \ dim3\ grid(1);}
\DoxyCodeLine{03149\ \ \ \ \ cross\_product\_kernel<<<grid,\ block>>>(\_\_d\_a,\ \_\_d\_b,\ \_\_d\_c);}
\DoxyCodeLine{03150\ }
\DoxyCodeLine{03151\ \ \ \ \ cudaMemcpy(\_\_ret.storage().data(),\ \_\_d\_c,\ 3\ *\ \textcolor{keyword}{sizeof}(value\_type),\ cudaMemcpyDeviceToHost);}
\DoxyCodeLine{03152\ }
\DoxyCodeLine{03153\ \ \ \ \ cudaFree(\_\_d\_a);}
\DoxyCodeLine{03154\ \ \ \ \ cudaFree(\_\_d\_b);}
\DoxyCodeLine{03155\ \ \ \ \ cudaFree(\_\_d\_c);}
\DoxyCodeLine{03156\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{03157\ \ \ \ \ const\_reference\ \_\_a1\ =\ this-\/>\_\_data\_[0];}
\DoxyCodeLine{03158\ \ \ \ \ const\_reference\ \_\_a2\ =\ this-\/>\_\_data\_[1];}
\DoxyCodeLine{03159\ \ \ \ \ const\_reference\ \_\_a3\ =\ this-\/>\_\_data\_[2];}
\DoxyCodeLine{03160\ }
\DoxyCodeLine{03161\ \ \ \ \ const\_reference\ \_\_b1\ =\ \_\_other[0];}
\DoxyCodeLine{03162\ \ \ \ \ const\_reference\ \_\_b2\ =\ \_\_other[1];}
\DoxyCodeLine{03163\ \ \ \ \ const\_reference\ \_\_b3\ =\ \_\_other[2];}
\DoxyCodeLine{03164\ }
\DoxyCodeLine{03165\ \ \ \ \ \_\_ret[0]\ =\ \_\_a2\ *\ \_\_b3\ -\/\ \_\_a3\ *\ \_\_b2;}
\DoxyCodeLine{03166\ \ \ \ \ \_\_ret[1]\ =\ \_\_a3\ *\ \_\_b1\ -\/\ \_\_a1\ *\ \_\_b3;}
\DoxyCodeLine{03167\ \ \ \ \ \_\_ret[2]\ =\ \_\_a1\ *\ \_\_b2\ -\/\ \_\_a2\ *\ \_\_b1;}
\DoxyCodeLine{03168\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03169\ \textcolor{preprocessor}{\#if\ defined(\_\_AVX2\_\_)}}
\DoxyCodeLine{03170\ \ \ \ \ \_\_m256\ \_\_a\ =\ \_mm256\_loadu\_ps(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }\textcolor{keywordtype}{float}*\textcolor{keyword}{>}(this-\/>\_\_data\_.data()));}
\DoxyCodeLine{03171\ \ \ \ \ \_\_m256\ \_\_b\ =\ \_mm256\_loadu\_ps(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }\textcolor{keywordtype}{float}*\textcolor{keyword}{>}(\_\_other.storage().data()));}
\DoxyCodeLine{03172\ }
\DoxyCodeLine{03173\ \ \ \ \ \_\_m256\ \_\_a\_yzx\ =\ \_mm256\_permute\_ps(\_\_a,\ \_MM\_SHUFFLE(3,\ 0,\ 2,\ 1));}
\DoxyCodeLine{03174\ \ \ \ \ \_\_m256\ \_\_b\_yzx\ =\ \_mm256\_permute\_ps(\_\_b,\ \_MM\_SHUFFLE(3,\ 0,\ 2,\ 1));}
\DoxyCodeLine{03175\ }
\DoxyCodeLine{03176\ \ \ \ \ \_\_m256\ \_\_result\ =\ \_mm256\_sub\_ps(\_mm256\_mul\_ps(\_\_a\_yzx,\ \_\_b),\ \_mm256\_mul\_ps(\_\_a,\ \_\_b\_yzx));}
\DoxyCodeLine{03177\ }
\DoxyCodeLine{03178\ \ \ \ \ \_\_result\ =\ \_mm256\_permute\_ps(\_\_result,\ \_MM\_SHUFFLE(3,\ 0,\ 2,\ 1));}
\DoxyCodeLine{03179\ }
\DoxyCodeLine{03180\ \ \ \ \ \_mm256\_storeu\_ps(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keywordtype}{float}*\textcolor{keyword}{>}(\_\_ret.storage().data()),\ \_\_result);}
\DoxyCodeLine{03181\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03182\ \textcolor{preprocessor}{\#if\ defined(\_\_SSE\_\_)}}
\DoxyCodeLine{03183\ \ \ \ \ \_\_m128\ \_\_a\ =\ \_mm\_loadu\_ps(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }\textcolor{keywordtype}{float}*\textcolor{keyword}{>}(this-\/>\_\_data\_.data()));}
\DoxyCodeLine{03184\ \ \ \ \ \_\_m128\ \_\_b\ =\ \_mm\_loadu\_ps(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }\textcolor{keywordtype}{float}*\textcolor{keyword}{>}(\_\_other.storage().data()));}
\DoxyCodeLine{03185\ }
\DoxyCodeLine{03186\ \ \ \ \ \_\_m128\ \_\_a\_yzx\ =\ \_mm\_shuffle\_ps(\_\_a,\ \_\_a,\ \_MM\_SHUFFLE(3,\ 0,\ 2,\ 1));}
\DoxyCodeLine{03187\ \ \ \ \ \_\_m128\ \_\_b\_yzx\ =\ \_mm\_shuffle\_ps(\_\_b,\ \_\_b,\ \_MM\_SHUFFLE(3,\ 0,\ 2,\ 1));}
\DoxyCodeLine{03188\ }
\DoxyCodeLine{03189\ \ \ \ \ \_\_m128\ \_\_result\ =\ \_mm\_sub\_ps(\_mm\_mul\_ps(\_\_a\_yzx,\ \_\_b),\ \_mm\_mul\_ps(\_\_a,\ \_\_b\_yzx));}
\DoxyCodeLine{03190\ }
\DoxyCodeLine{03191\ \ \ \ \ \_\_result\ =\ \_mm\_shuffle\_ps(\_\_result,\ \_\_result,\ \_MM\_SHUFFLE(3,\ 0,\ 2,\ 1));}
\DoxyCodeLine{03192\ }
\DoxyCodeLine{03193\ \ \ \ \ \_mm\_storeu\_ps(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keywordtype}{float}*\textcolor{keyword}{>}(\_\_ret.storage().data()),\ \_\_result);}
\DoxyCodeLine{03194\ }
\DoxyCodeLine{03195\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03196\ }
\DoxyCodeLine{03197\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_ret;}
\DoxyCodeLine{03198\ \}}
\DoxyCodeLine{03199\ }
\DoxyCodeLine{03200\ \textcolor{preprocessor}{\#ifdef\ \_\_CUDACC\_\_}}
\DoxyCodeLine{03201\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{03202\ \_\_global\_\_\ \textcolor{keywordtype}{void}\ cross\_product\_kernel(\_Tp*\ a,\ \_Tp*\ b,\ \_Tp*\ c)\ \{}
\DoxyCodeLine{03203\ \ \ \ \ c[0]\ =\ a[1]\ *\ b[2]\ -\/\ a[2]\ *\ b[1];}
\DoxyCodeLine{03204\ \ \ \ \ c[1]\ =\ a[2]\ *\ b[0]\ -\/\ a[0]\ *\ b[2];}
\DoxyCodeLine{03205\ \ \ \ \ c[2]\ =\ a[0]\ *\ b[1]\ -\/\ a[1]\ *\ b[0];}
\DoxyCodeLine{03206\ \}}
\DoxyCodeLine{03207\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03208\ }
\DoxyCodeLine{03209\ }
\DoxyCodeLine{03210\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{03211\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::absolute}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_tensor)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{03212\ \ \ \ \ this-\/>\_\_check\_is\_scalar\_type(\textcolor{stringliteral}{"{}Cannot\ call\ absolute\ on\ non-\/scalar\ value"{}});}
\DoxyCodeLine{03213\ }
\DoxyCodeLine{03214\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_s\ =\ \_\_tensor.storage().size();}
\DoxyCodeLine{03215\ \ \ \ \ data\_t\ \_\_a;}
\DoxyCodeLine{03216\ }
\DoxyCodeLine{03217\ \ \ \ \ \_\_a.reserve(\_\_s);}
\DoxyCodeLine{03218\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{03219\ }
\DoxyCodeLine{03220\ \textcolor{preprocessor}{\#ifdef\ \_\_AVX\_\_}}
\DoxyCodeLine{03221\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_same\_v<value\_type,\ float>)}
\DoxyCodeLine{03222\ \ \ \ \ \{}
\DoxyCodeLine{03223\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ +\ 8\ <=\ \_\_s;\ \_\_i\ +=\ 8)}
\DoxyCodeLine{03224\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03225\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_m256\ input\ \ \ \ \ =\ \_mm256\_loadu\_ps(\&\_\_tensor.storage()[\_\_i]);}
\DoxyCodeLine{03226\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_m256\ abs\_value\ =\ \_mm256\_abs\_ps(input);}
\DoxyCodeLine{03227\ \ \ \ \ \ \ \ \ \ \ \ \ \_mm256\_storeu\_ps(\&\_\_a[\_\_i],\ abs\_value);}
\DoxyCodeLine{03228\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03229\ \ \ \ \ \}}
\DoxyCodeLine{03230\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03231\ }
\DoxyCodeLine{03232\ \textcolor{preprocessor}{\#if\ defined(\_\_SSE\_\_)}}
\DoxyCodeLine{03233\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_same\_v<value\_type,\ float>)}
\DoxyCodeLine{03234\ \ \ \ \ \{}
\DoxyCodeLine{03235\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ +\ 4\ <=\ \_\_s;\ \_\_i\ +=\ 4)}
\DoxyCodeLine{03236\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03237\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_m128\ input\ \ \ \ \ =\ \_mm\_loadu\_ps(\&\_\_tensor.storage()[\_\_i]);}
\DoxyCodeLine{03238\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_m128\ abs\_value\ =\ \_mm\_abs\_ps(input);}
\DoxyCodeLine{03239\ \ \ \ \ \ \ \ \ \ \ \ \ \_mm\_storeu\_ps(\&\_\_a[\_\_i],\ abs\_value);}
\DoxyCodeLine{03240\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03241\ \ \ \ \ \}}
\DoxyCodeLine{03242\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03243\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ \_\_s;\ \_\_i++)}
\DoxyCodeLine{03244\ \ \ \ \ \{}
\DoxyCodeLine{03245\ \ \ \ \ \ \ \ \ \_\_a.push\_back(\textcolor{keyword}{static\_cast<}value\_type\textcolor{keyword}{>}(std::fabs(\textcolor{keywordtype}{float}(\_\_tensor.storage()[\_\_i]))));}
\DoxyCodeLine{03246\ \ \ \ \ \}}
\DoxyCodeLine{03247\ }
\DoxyCodeLine{03248\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(\_\_a,\ \_\_tensor.\_\_shape\_);}
\DoxyCodeLine{03249\ \}}
\DoxyCodeLine{03250\ }
\DoxyCodeLine{03251\ }
\DoxyCodeLine{03252\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{03253\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::dot}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{03254\ \ \ \ \ this-\/>\_\_check\_is\_scalar\_type(\textcolor{stringliteral}{"{}Cannot\ perform\ a\ dot\ product\ on\ non\ scalar\ data\ types"{}});}
\DoxyCodeLine{03255\ \ \ \ \ \textcolor{keywordflow}{if}\ (this-\/>empty()\ ||\ \_\_other.empty())}
\DoxyCodeLine{03256\ \ \ \ \ \{}
\DoxyCodeLine{03257\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::invalid\_argument(\textcolor{stringliteral}{"{}Cannot\ dot\ product\ an\ empty\ vector"{}});}
\DoxyCodeLine{03258\ \ \ \ \ \}}
\DoxyCodeLine{03259\ }
\DoxyCodeLine{03260\ \ \ \ \ \textcolor{keywordflow}{if}\ (this-\/>\_\_shape\_.size()\ ==\ 1\ \&\&\ \_\_other.shape().size()\ ==\ 1)}
\DoxyCodeLine{03261\ \ \ \ \ \{}
\DoxyCodeLine{03262\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (this-\/>\_\_shape\_[0]\ !=\ \_\_other.shape()[0])}
\DoxyCodeLine{03263\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03264\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::invalid\_argument(\textcolor{stringliteral}{"{}Vectors\ must\ have\ the\ same\ size\ for\ dot\ product"{}});}
\DoxyCodeLine{03265\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03266\ }
\DoxyCodeLine{03267\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}*\ \_\_this\_data\ \ =\ this-\/>\_\_data\_.data();}
\DoxyCodeLine{03268\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}*\ \_\_other\_data\ =\ \_\_other.storage().data();}
\DoxyCodeLine{03269\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ \ \_\_size\ \ \ \ \ \ \ =\ this-\/>\_\_data\_.size();}
\DoxyCodeLine{03270\ }
\DoxyCodeLine{03271\ \ \ \ \ \ \ \ \ value\_type\ \_\_ret\ =\ 0;}
\DoxyCodeLine{03272\ }
\DoxyCodeLine{03273\ \textcolor{preprocessor}{\#ifdef\ \_\_CUDACC\_\_}}
\DoxyCodeLine{03274\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (this-\/>\_\_is\_cuda\_tensor\ \&\&\ \_\_other.\_\_is\_cuda\_tensor)}
\DoxyCodeLine{03275\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03276\ \ \ \ \ \ \ \ \ \ \ \ \ thrust::device\_vector<value\_type>\ d\_result(1);}
\DoxyCodeLine{03277\ \ \ \ \ \ \ \ \ \ \ \ \ thrust::transform(thrust::device,\ \_\_this\_data,\ \_\_this\_data\ +\ \_\_size,\ \_\_other\_data,}
\DoxyCodeLine{03278\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ d\_result.begin(),\ thrust::multiplies<value\_type>());}
\DoxyCodeLine{03279\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret\ =\ thrust::reduce(d\_result.begin(),\ d\_result.end());}
\DoxyCodeLine{03280\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03281\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{03282\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03283\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03284\ \textcolor{preprocessor}{\#if\ defined(\_\_AVX\_\_)}}
\DoxyCodeLine{03285\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_same\_v<value\_type,\ float>\ \&\&\ \_\_size\ >=\ 8)}
\DoxyCodeLine{03286\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03287\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_m256\ sum\ =\ \_mm256\_setzero\_ps();}
\DoxyCodeLine{03288\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ \_\_size\ -\/\ 7;\ i\ +=\ 8)}
\DoxyCodeLine{03289\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03290\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_m256\ a\ =\ \_mm256\_loadu\_ps(\_\_this\_data\ +\ i);}
\DoxyCodeLine{03291\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_m256\ b\ =\ \_mm256\_loadu\_ps(\_\_other\_data\ +\ i);}
\DoxyCodeLine{03292\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sum\ \ \ \ \ \ =\ \_mm256\_add\_ps(sum,\ \_mm256\_mul\_ps(a,\ b));}
\DoxyCodeLine{03293\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03294\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret\ =\ \_mm256\_reduce\_add\_ps(sum);}
\DoxyCodeLine{03295\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ \_\_size\ -\/\ (\_\_size\ \%\ 8);\ i\ <\ \_\_size;\ i++)}
\DoxyCodeLine{03296\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03297\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret\ +=\ \_\_this\_data[i]\ *\ \_\_other\_data[i];}
\DoxyCodeLine{03298\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03299\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03300\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{03301\ \textcolor{preprocessor}{\#elif\ defined(\_\_SSE\_\_)}}
\DoxyCodeLine{03302\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_same\_v<value\_type,\ float>\ \&\&\ \_\_size\ >=\ 4)}
\DoxyCodeLine{03303\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03304\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_m128\ sum\ =\ \_mm\_setzero\_ps();}
\DoxyCodeLine{03305\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ \_\_size\ -\/\ 3;\ i\ +=\ 4)}
\DoxyCodeLine{03306\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03307\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_m128\ a\ =\ \_mm\_loadu\_ps(\_\_this\_data\ +\ i);}
\DoxyCodeLine{03308\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_m128\ b\ =\ \_mm\_loadu\_ps(\_\_other\_data\ +\ i);}
\DoxyCodeLine{03309\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sum\ \ \ \ \ \ =\ \_mm\_add\_ps(sum,\ \_mm\_mul\_ps(a,\ b));}
\DoxyCodeLine{03310\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03311\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret\ =\ \_mm\_reduce\_add\_ps(sum);}
\DoxyCodeLine{03312\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ \_\_size\ -\/\ (\_\_size\ \%\ 4);\ i\ <\ \_\_size;\ i++)}
\DoxyCodeLine{03313\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03314\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret\ +=\ \_\_this\_data[i]\ *\ \_\_other\_data[i];}
\DoxyCodeLine{03315\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03316\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03317\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{03318\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03319\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03320\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret\ =\ std::inner\_product(\_\_this\_data,\ \_\_this\_data\ +\ \_\_size,\ \_\_other\_data,}
\DoxyCodeLine{03321\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ value\_type(0));}
\DoxyCodeLine{03322\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03323\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03324\ }
\DoxyCodeLine{03325\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(\{\_\_ret\},\ \{1\});}
\DoxyCodeLine{03326\ \ \ \ \ \}}
\DoxyCodeLine{03327\ }
\DoxyCodeLine{03328\ \ \ \ \ \textcolor{keywordflow}{if}\ (this-\/>\_\_shape\_.size()\ ==\ 2\ \&\&\ \_\_other.shape().size()\ ==\ 2)}
\DoxyCodeLine{03329\ \ \ \ \ \{}
\DoxyCodeLine{03330\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ this-\/>matmul(\_\_other);}
\DoxyCodeLine{03331\ \ \ \ \ \}}
\DoxyCodeLine{03332\ }
\DoxyCodeLine{03333\ \ \ \ \ \textcolor{keywordflow}{if}\ (this-\/>\_\_shape\_.size()\ ==\ 3\ \&\&\ \_\_other.shape().size()\ ==\ 3)}
\DoxyCodeLine{03334\ \ \ \ \ \{}
\DoxyCodeLine{03335\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ this-\/>cross\_product(\_\_other);}
\DoxyCodeLine{03336\ \ \ \ \ \}}
\DoxyCodeLine{03337\ }
\DoxyCodeLine{03338\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self();}
\DoxyCodeLine{03339\ \}}
\DoxyCodeLine{03340\ }
\DoxyCodeLine{03341\ }
\DoxyCodeLine{03342\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{03343\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::relu}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{03344\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(*this).relu\_();}
\DoxyCodeLine{03345\ \}}
\DoxyCodeLine{03346\ }
\DoxyCodeLine{03347\ }
\DoxyCodeLine{03348\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{03349\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::relu\_}}()\ \{}
\DoxyCodeLine{03350\ \ \ \ \ this-\/>\_\_check\_is\_scalar\_type(\textcolor{stringliteral}{"{}Cannot\ relu\ non-\/scalar\ type"{}});}
\DoxyCodeLine{03351\ }
\DoxyCodeLine{03352\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_s\ =\ this-\/>\_\_data\_.size();}
\DoxyCodeLine{03353\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{03354\ }
\DoxyCodeLine{03355\ \textcolor{preprocessor}{\#ifdef\ \_\_CUDACC\_\_}}
\DoxyCodeLine{03356\ \ \ \ \ \textcolor{keywordflow}{if}\ (this-\/>\_\_is\_cuda\_tensor)}
\DoxyCodeLine{03357\ \ \ \ \ \{}
\DoxyCodeLine{03358\ \ \ \ \ \ \ \ \ value\_type*\ d\_data\ =\ thrust::raw\_pointer\_cast(this-\/>\_\_data\_.data());}
\DoxyCodeLine{03359\ \ \ \ \ \ \ \ \ thrust::transform(thrust::device,\ d\_data,\ d\_data\ +\ \_\_s,\ d\_data,}
\DoxyCodeLine{03360\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ []\ \_\_device\_\_(value\_type\ x)\ \{\ \textcolor{keywordflow}{return}\ max(x,\ value\_type(0));\ \});}
\DoxyCodeLine{03361\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{03362\ \ \ \ \ \}}
\DoxyCodeLine{03363\ \textcolor{preprocessor}{\#elif\ defined(\_\_SSE\_\_)}}
\DoxyCodeLine{03364\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_same\_v<value\_type,\ float>)}
\DoxyCodeLine{03365\ \ \ \ \ \{}
\DoxyCodeLine{03366\ \ \ \ \ \ \ \ \ \_\_m128\ zero\ =\ \_mm\_setzero\_ps();}
\DoxyCodeLine{03367\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ +\ 4\ <=\ \_\_s;\ \_\_i\ +=\ 4)}
\DoxyCodeLine{03368\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03369\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_m128\ \_\_x\ \ \ \ =\ \_mm\_loadu\_ps(\&this-\/>\_\_data\_[\_\_i]);}
\DoxyCodeLine{03370\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_m128\ result\ =\ \_mm\_max\_ps(\_\_x,\ zero);}
\DoxyCodeLine{03371\ \ \ \ \ \ \ \ \ \ \ \ \ \_mm\_storeu\_ps(\&this-\/>\_\_data\_[\_\_i],\ result);}
\DoxyCodeLine{03372\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03373\ \ \ \ \ \}}
\DoxyCodeLine{03374\ \textcolor{preprocessor}{\#elif\ defined(\_\_AVX\_\_)}}
\DoxyCodeLine{03375\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_same\_v<value\_type,\ float>)}
\DoxyCodeLine{03376\ \ \ \ \ \{}
\DoxyCodeLine{03377\ \ \ \ \ \ \ \ \ \_\_m256\ zero\ =\ \_mm256\_setzero\_ps();}
\DoxyCodeLine{03378\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ +\ 8\ <=\ \_\_s;\ \_\_i\ +=\ 8)}
\DoxyCodeLine{03379\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03380\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_m256\ \_\_x\ \ \ \ =\ \_mm256\_loadu\_ps(\&this-\/>\_\_data\_[\_\_i]);}
\DoxyCodeLine{03381\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_m256\ result\ =\ \_mm256\_max\_ps(\_\_x,\ zero);}
\DoxyCodeLine{03382\ \ \ \ \ \ \ \ \ \ \ \ \ \_mm256\_storeu\_ps(\&this-\/>\_\_data\_[\_\_i],\ result);}
\DoxyCodeLine{03383\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03384\ \ \ \ \ \}}
\DoxyCodeLine{03385\ \textcolor{preprocessor}{\#elif\ \_\_ARM\_NEON}}
\DoxyCodeLine{03386\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_same\_v<value\_type,\ float>)}
\DoxyCodeLine{03387\ \ \ \ \ \{}
\DoxyCodeLine{03388\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ float32x4\_t\ vZero\ =\ vdupq\_n\_f32(0.0f);}
\DoxyCodeLine{03389\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ +\ 4\ <=\ \_\_s;\ \_\_i\ +=\ 4)}
\DoxyCodeLine{03390\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03391\ \ \ \ \ \ \ \ \ \ \ \ \ float32x4\_t\ \_\_v\ =\ vld1q\_f32(\&this-\/>\_\_data\_[\_\_i]);}
\DoxyCodeLine{03392\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_v\ \ \ \ \ \ \ \ \ \ \ \ \ =\ vmaxq\_f32(\_\_v,\ vZero);}
\DoxyCodeLine{03393\ \ \ \ \ \ \ \ \ \ \ \ \ vst1q\_f32(\&this-\/>\_\_data\_[\_\_i],\ \_\_v);}
\DoxyCodeLine{03394\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03395\ \ \ \ \ \}}
\DoxyCodeLine{03396\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_same\_v<value\_type,\ int32\_t>)}
\DoxyCodeLine{03397\ \ \ \ \ \{}
\DoxyCodeLine{03398\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ int32x4\_t\ vZero\ =\ vdupq\_n\_s32(0);}
\DoxyCodeLine{03399\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ +\ 4\ <=\ \_\_s;\ \_\_i\ +=\ 4)}
\DoxyCodeLine{03400\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03401\ \ \ \ \ \ \ \ \ \ \ \ \ int32x4\_t\ \_\_v\ =\ vld1q\_s32(\&this-\/>\_\_data\_[\_\_i]);}
\DoxyCodeLine{03402\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_v\ \ \ \ \ \ \ \ \ \ \ =\ vmaxq\_s32(\_\_v,\ vZero);}
\DoxyCodeLine{03403\ \ \ \ \ \ \ \ \ \ \ \ \ vst1q\_s32(\&this-\/>\_\_data\_[\_\_i],\ \_\_v);}
\DoxyCodeLine{03404\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03405\ \ \ \ \ \}}
\DoxyCodeLine{03406\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{03407\ \ \ \ \ \textcolor{keywordflow}{for}\ (\_\_i\ =\ 0;\ \_\_i\ <\ \_\_s;\ \_\_i++)}
\DoxyCodeLine{03408\ \ \ \ \ \{}
\DoxyCodeLine{03409\ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i]\ =\ std::max(this-\/>\_\_data\_[\_\_i],\ value\_type(0));}
\DoxyCodeLine{03410\ \ \ \ \ \}}
\DoxyCodeLine{03411\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03412\ \}}
\DoxyCodeLine{03413\ }
\DoxyCodeLine{03414\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{03415\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::transpose}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{03416\ \ \ \ \ \textcolor{keywordflow}{if}\ (this-\/>\_\_shape\_.size()\ !=\ 2)}
\DoxyCodeLine{03417\ \ \ \ \ \{}
\DoxyCodeLine{03418\ \ \ \ \ \ \ \ \ std::cerr\ <<\ \textcolor{stringliteral}{"{}Matrix\ transposition\ can\ only\ be\ done\ on\ 2D\ tensors"{}}\ <<\ std::endl;}
\DoxyCodeLine{03419\ \ \ \ \ \ \ \ \ std::exit(EXIT\_FAILURE);}
\DoxyCodeLine{03420\ \ \ \ \ \}}
\DoxyCodeLine{03421\ }
\DoxyCodeLine{03422\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor}}\ \_\_ret(\{this-\/>\_\_shape\_[1],\ this-\/>\_\_shape\_[0]\});}
\DoxyCodeLine{03423\ }
\DoxyCodeLine{03424\ \ \ \ \ \textcolor{keyword}{const}\ index\_type\ rows\ =\ this-\/>\_\_shape\_[0];}
\DoxyCodeLine{03425\ \ \ \ \ \textcolor{keyword}{const}\ index\_type\ cols\ =\ this-\/>\_\_shape\_[1];}
\DoxyCodeLine{03426\ }
\DoxyCodeLine{03427\ \textcolor{preprocessor}{\#ifdef\ \_\_CUDACC\_\_}}
\DoxyCodeLine{03428\ \ \ \ \ \textcolor{keywordflow}{if}\ (this-\/>\_\_is\_cuda\_tensor)}
\DoxyCodeLine{03429\ \ \ \ \ \{}
\DoxyCodeLine{03430\ \ \ \ \ \ \ \ \ dim3\ blockDim(16,\ 16);}
\DoxyCodeLine{03431\ \ \ \ \ \ \ \ \ dim3\ gridDim((cols\ +\ blockDim.x\ -\/\ 1)\ /\ blockDim.x,\ (rows\ +\ blockDim.y\ -\/\ 1)\ /\ blockDim.y);}
\DoxyCodeLine{03432\ }
\DoxyCodeLine{03433\ \ \ \ \ \ \ \ \ transpose\_kernel<<<gridDim,\ blockDim>>>(thrust::raw\_pointer\_cast(this-\/>\_\_data\_.data()),}
\DoxyCodeLine{03434\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ thrust::raw\_pointer\_cast(\_\_ret.\_\_data\_.data()),}
\DoxyCodeLine{03435\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ rows,\ cols);}
\DoxyCodeLine{03436\ \ \ \ \ \ \ \ \ cudaDeviceSynchronize();}
\DoxyCodeLine{03437\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_ret;}
\DoxyCodeLine{03438\ \ \ \ \ \}}
\DoxyCodeLine{03439\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03440\ }
\DoxyCodeLine{03441\ \textcolor{preprocessor}{\#ifdef\ \_\_ARM\_NEON}}
\DoxyCodeLine{03442\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_same\_v<\_Tp,\ float>)}
\DoxyCodeLine{03443\ \ \ \ \ \{}
\DoxyCodeLine{03444\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (index\_type\ i\ =\ 0;\ i\ <\ rows;\ i\ +=\ 4)}
\DoxyCodeLine{03445\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03446\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (index\_type\ j\ =\ 0;\ j\ <\ cols;\ j\ +=\ 4)}
\DoxyCodeLine{03447\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03448\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (i\ +\ 4\ <=\ rows\ \&\&\ j\ +\ 4\ <=\ cols)}
\DoxyCodeLine{03449\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03450\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ float32x4x4\_t\ input;}
\DoxyCodeLine{03451\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ 0;\ k\ <\ 4;\ k++)}
\DoxyCodeLine{03452\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03453\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ input.val[k]\ =\ vld1q\_f32(\&this-\/>\_\_data\_[(i\ +\ k)\ *\ cols\ +\ j]);}
\DoxyCodeLine{03454\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03455\ }
\DoxyCodeLine{03456\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ float32x4x4\_t\ output\ =\ vld4q\_f32(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }\textcolor{keywordtype}{float}*\textcolor{keyword}{>}(\&input));}
\DoxyCodeLine{03457\ }
\DoxyCodeLine{03458\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ 0;\ k\ <\ 4;\ k++)}
\DoxyCodeLine{03459\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03460\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ vst1q\_f32(\&\_\_ret.\_\_data\_[(j\ +\ k)\ *\ rows\ +\ i],\ output.val[k]);}
\DoxyCodeLine{03461\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03462\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03463\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{03464\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03465\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (index\_type\ ii\ =\ i;\ ii\ <\ std::min(i\ +\ 4,\ rows);\ ii++)}
\DoxyCodeLine{03466\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03467\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (index\_type\ jj\ =\ j;\ jj\ <\ std::min(j\ +\ 4,\ cols);\ jj++)}
\DoxyCodeLine{03468\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03469\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret.at(\{jj,\ ii\})\ =\ this-\/>at(\{ii,\ jj\});}
\DoxyCodeLine{03470\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03471\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03472\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03473\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03474\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03475\ \ \ \ \ \}}
\DoxyCodeLine{03476\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{03477\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03478\ \ \ \ \ \{}
\DoxyCodeLine{03479\ \ \ \ \ \ \ \ \ index\_type\ \_\_i\ =\ 0;}
\DoxyCodeLine{03480\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ rows;\ \_\_i++)}
\DoxyCodeLine{03481\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03482\ \ \ \ \ \ \ \ \ \ \ \ \ index\_type\ \_\_j\ =\ 0;}
\DoxyCodeLine{03483\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_j\ <\ cols;\ \_\_j++)}
\DoxyCodeLine{03484\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03485\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret.at(\{\_\_j,\ \_\_i\})\ =\ this-\/>at(\{\_\_i,\ \_\_j\});}
\DoxyCodeLine{03486\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03487\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03488\ \ \ \ \ \}}
\DoxyCodeLine{03489\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_ret;}
\DoxyCodeLine{03490\ \}}
\DoxyCodeLine{03491\ }
\DoxyCodeLine{03492\ \textcolor{preprocessor}{\#ifdef\ \_\_CUDACC\_\_}}
\DoxyCodeLine{03493\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{03494\ \_\_global\_\_\ \textcolor{keywordtype}{void}\ transpose\_kernel(\_Tp*\ input,\ \_Tp*\ output,\ \textcolor{keywordtype}{int}\ rows,\ \textcolor{keywordtype}{int}\ cols)\ \{}
\DoxyCodeLine{03495\ \ \ \ \ \textcolor{keywordtype}{int}\ i\ =\ blockIdx.y\ *\ blockDim.y\ +\ threadIdx.y;}
\DoxyCodeLine{03496\ \ \ \ \ \textcolor{keywordtype}{int}\ j\ =\ blockIdx.x\ *\ blockDim.x\ +\ threadIdx.x;}
\DoxyCodeLine{03497\ }
\DoxyCodeLine{03498\ \ \ \ \ \textcolor{keywordflow}{if}\ (i\ <\ rows\ \&\&\ j\ <\ cols)}
\DoxyCodeLine{03499\ \ \ \ \ \{}
\DoxyCodeLine{03500\ \ \ \ \ \ \ \ \ output[j\ *\ rows\ +\ i]\ =\ input[i\ *\ cols\ +\ j];}
\DoxyCodeLine{03501\ \ \ \ \ \}}
\DoxyCodeLine{03502\ \}}
\DoxyCodeLine{03503\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03504\ }
\DoxyCodeLine{03505\ }
\DoxyCodeLine{03506\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{03507\ \mbox{\hyperlink{classtensor}{tensor<typename\ tensor<\_Tp>::index\_type}}>\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::argsort}}(index\_type\ \_\_d,}
\DoxyCodeLine{03508\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ \ \ \ \ \ \ \_\_ascending)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{03509\ \ \ \ \ index\_type\ \_\_adjusted\ =\ (\_\_d\ <\ 0LL)\ ?\ \_\_d\ +\ this-\/>\_\_data\_.size()\ :\ \_\_d;}
\DoxyCodeLine{03510\ }
\DoxyCodeLine{03511\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_\_adjusted\ !=\ 0LL)}
\DoxyCodeLine{03512\ \ \ \ \ \{}
\DoxyCodeLine{03513\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::out\_of\_range(\textcolor{stringliteral}{"{}Invalid\ dimension\ for\ argsort:\ only\ 1D\ tensors\ are\ supported"{}});}
\DoxyCodeLine{03514\ \ \ \ \ \}}
\DoxyCodeLine{03515\ }
\DoxyCodeLine{03516\ \ \ \ \ index\_type\ \ \ \ \ \ \ \ \ \ \ \ \ \ size\ =\ \textcolor{keyword}{static\_cast<}index\_type\textcolor{keyword}{>}(this-\/>\_\_data\_.size());}
\DoxyCodeLine{03517\ \ \ \ \ std::vector<index\_type>\ \_\_indices(size);}
\DoxyCodeLine{03518\ \ \ \ \ std::iota(\_\_indices.begin(),\ \_\_indices.end(),\ 0);}
\DoxyCodeLine{03519\ }
\DoxyCodeLine{03520\ \ \ \ \ std::sort(\_\_indices.begin(),\ \_\_indices.end(),\ [\&](index\_type\ \_\_a,\ index\_type\ \_\_b)\ \{}
\DoxyCodeLine{03521\ \ \ \ \ \ \ \ \ return\ \_\_ascending\ ?\ this-\/>\_\_data\_[\_\_a]\ <\ this-\/>\_\_data\_[\_\_b]}
\DoxyCodeLine{03522\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ this-\/>\_\_data\_[\_\_a]\ >\ this-\/>\_\_data\_[\_\_b];}
\DoxyCodeLine{03523\ \ \ \ \ \});}
\DoxyCodeLine{03524\ }
\DoxyCodeLine{03525\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classtensor}{tensor<index\_type>}}(\_\_indices);}
\DoxyCodeLine{03526\ \}}
\DoxyCodeLine{03527\ }
\DoxyCodeLine{03528\ }
\DoxyCodeLine{03529\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{03530\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::bitwise\_left\_shift}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \_\_amount)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{03531\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(*this).bitwise\_right\_shift\_(\_\_amount);}
\DoxyCodeLine{03532\ \}}
\DoxyCodeLine{03533\ }
\DoxyCodeLine{03534\ }
\DoxyCodeLine{03535\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{03536\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::bitwise\_xor}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{03537\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(*this).bitwise\_xor\_(\_\_other);}
\DoxyCodeLine{03538\ \}}
\DoxyCodeLine{03539\ }
\DoxyCodeLine{03540\ }
\DoxyCodeLine{03541\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{03542\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::bitwise\_right\_shift}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \_\_amount)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{03543\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(*this).bitwise\_right\_shift\_(\_\_amount);}
\DoxyCodeLine{03544\ \}}
\DoxyCodeLine{03545\ }
\DoxyCodeLine{03546\ }
\DoxyCodeLine{03547\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{03548\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::bitwise\_and\_}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\ \{}
\DoxyCodeLine{03549\ \ \ \ \ \textcolor{keywordflow}{if}\ (!std::is\_integral<value\_type>::value\ \&\&\ !std::is\_same<value\_type,\ bool>::value)}
\DoxyCodeLine{03550\ \ \ \ \ \{}
\DoxyCodeLine{03551\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(}
\DoxyCodeLine{03552\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Cannot\ perform\ a\ bitwise\ AND\ on\ non-\/integral\ or\ non-\/boolean\ values"{}});}
\DoxyCodeLine{03553\ \ \ \ \ \}}
\DoxyCodeLine{03554\ }
\DoxyCodeLine{03555\ \ \ \ \ assert(this-\/>\_\_shape\_\ ==\ \_\_other.shape()\ \&\&\ this-\/>size(0)\ ==\ \_\_other.size(0));}
\DoxyCodeLine{03556\ \textcolor{preprocessor}{\#ifdef\ \_\_ARM\_NEON}}
\DoxyCodeLine{03557\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ simd\_size\ =\ 4;}
\DoxyCodeLine{03558\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ simd\_end\ \ =\ this-\/>\_\_data\_.size()\ -\/\ (this-\/>\_\_data\_.size()\ \%\ simd\_size);}
\DoxyCodeLine{03559\ }
\DoxyCodeLine{03560\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;\ \_\_i\ <\ simd\_end;\ \_\_i\ +=\ simd\_size)}
\DoxyCodeLine{03561\ \ \ \ \ \{}
\DoxyCodeLine{03562\ \ \ \ \ \ \ \ \ uint32x4\_t\ data\_vec\ \ =\ vld1q\_u32(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }uint32\_t*\textcolor{keyword}{>}(\&this-\/>\_\_data\_[\_\_i]));}
\DoxyCodeLine{03563\ \ \ \ \ \ \ \ \ uint32x4\_t\ other\_vec\ =\ vld1q\_u32(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }uint32\_t*\textcolor{keyword}{>}(\&\_\_other[\_\_i]));}
\DoxyCodeLine{03564\ }
\DoxyCodeLine{03565\ \ \ \ \ \ \ \ \ uint32x4\_t\ xor\_vec\ =\ vandq\_u32(data\_vec,\ other\_vec);}
\DoxyCodeLine{03566\ }
\DoxyCodeLine{03567\ \ \ \ \ \ \ \ \ vst1q\_u32(\textcolor{keyword}{reinterpret\_cast<}uint32\_t*\textcolor{keyword}{>}(\&this-\/>\_\_data\_[\_\_i]),\ xor\_vec);}
\DoxyCodeLine{03568\ \ \ \ \ \}}
\DoxyCodeLine{03569\ }
\DoxyCodeLine{03570\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ \_\_i\ =\ simd\_end;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{03571\ \ \ \ \ \{}
\DoxyCodeLine{03572\ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i]\ \&=\ (\_\_other[\_\_i]);}
\DoxyCodeLine{03573\ \ \ \ \ \}}
\DoxyCodeLine{03574\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{03575\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{03576\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{03577\ \ \ \ \ \{}
\DoxyCodeLine{03578\ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i]\ \&=\ \_\_other[\_\_i];}
\DoxyCodeLine{03579\ \ \ \ \ \}}
\DoxyCodeLine{03580\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03581\ \}}
\DoxyCodeLine{03582\ }
\DoxyCodeLine{03583\ }
\DoxyCodeLine{03584\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{03585\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::bitwise\_or\_}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\ \{}
\DoxyCodeLine{03586\ \ \ \ \ \textcolor{keywordflow}{if}\ (!std::is\_integral<value\_type>::value\ \&\&\ !std::is\_same<value\_type,\ bool>::value)}
\DoxyCodeLine{03587\ \ \ \ \ \{}
\DoxyCodeLine{03588\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(}
\DoxyCodeLine{03589\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Cannot\ perform\ a\ bitwise\ OR\ on\ non-\/integral\ or\ non-\/boolean\ values"{}});}
\DoxyCodeLine{03590\ \ \ \ \ \}}
\DoxyCodeLine{03591\ }
\DoxyCodeLine{03592\ \ \ \ \ assert(this-\/>\_\_shape\_\ ==\ \_\_other.shape()\ \&\&\ this-\/>size(0)\ ==\ \_\_other.size(0));}
\DoxyCodeLine{03593\ \textcolor{preprocessor}{\#ifdef\ \_\_ARM\_NEON}}
\DoxyCodeLine{03594\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ simd\_size\ =\ 4;}
\DoxyCodeLine{03595\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ simd\_end\ \ =\ this-\/>\_\_data\_.size()\ -\/\ (this-\/>\_\_data\_.size()\ \%\ simd\_size);}
\DoxyCodeLine{03596\ }
\DoxyCodeLine{03597\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;\ \_\_i\ <\ simd\_end;\ \_\_i\ +=\ simd\_size)}
\DoxyCodeLine{03598\ \ \ \ \ \{}
\DoxyCodeLine{03599\ \ \ \ \ \ \ \ \ uint32x4\_t\ data\_vec\ \ =\ vld1q\_u32(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }uint32\_t*\textcolor{keyword}{>}(\&this-\/>\_\_data\_[\_\_i]));}
\DoxyCodeLine{03600\ \ \ \ \ \ \ \ \ uint32x4\_t\ other\_vec\ =\ vld1q\_u32(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }uint32\_t*\textcolor{keyword}{>}(\&\_\_other[\_\_i]));}
\DoxyCodeLine{03601\ }
\DoxyCodeLine{03602\ \ \ \ \ \ \ \ \ uint32x4\_t\ xor\_vec\ =\ vornq\_u32(data\_vec,\ other\_vec);}
\DoxyCodeLine{03603\ }
\DoxyCodeLine{03604\ \ \ \ \ \ \ \ \ vst1q\_u32(\textcolor{keyword}{reinterpret\_cast<}uint32\_t*\textcolor{keyword}{>}(\&this-\/>\_\_data\_[\_\_i]),\ xor\_vec);}
\DoxyCodeLine{03605\ \ \ \ \ \}}
\DoxyCodeLine{03606\ }
\DoxyCodeLine{03607\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ \_\_i\ =\ simd\_end;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{03608\ \ \ \ \ \{}
\DoxyCodeLine{03609\ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i]\ |=\ (\_\_other[\_\_i]);}
\DoxyCodeLine{03610\ \ \ \ \ \}}
\DoxyCodeLine{03611\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{03612\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{03613\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{03614\ \ \ \ \ \{}
\DoxyCodeLine{03615\ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i]\ |=\ \_\_other[\_\_i];}
\DoxyCodeLine{03616\ \ \ \ \ \}}
\DoxyCodeLine{03617\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03618\ \}}
\DoxyCodeLine{03619\ }
\DoxyCodeLine{03620\ }
\DoxyCodeLine{03621\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{03622\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::bitwise\_xor\_}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\ \{}
\DoxyCodeLine{03623\ \ \ \ \ \textcolor{keywordflow}{if}\ (!std::is\_integral<value\_type>::value\ \&\&\ !std::is\_same<value\_type,\ bool>::value)}
\DoxyCodeLine{03624\ \ \ \ \ \{}
\DoxyCodeLine{03625\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(}
\DoxyCodeLine{03626\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Cannot\ perform\ a\ bitwise\ XOR\ on\ non-\/integral\ or\ non-\/boolean\ values"{}});}
\DoxyCodeLine{03627\ \ \ \ \ \}}
\DoxyCodeLine{03628\ }
\DoxyCodeLine{03629\ \ \ \ \ assert(this-\/>\_\_shape\_\ ==\ \_\_other.shape()\ \&\&\ this-\/>size(0)\ ==\ \_\_other.size(0));}
\DoxyCodeLine{03630\ \textcolor{preprocessor}{\#ifdef\ \_\_ARM\_NEON}}
\DoxyCodeLine{03631\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ simd\_size\ =\ 4;}
\DoxyCodeLine{03632\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ simd\_end\ \ =\ this-\/>\_\_data\_.size()\ -\/\ (this-\/>\_\_data\_.size()\ \%\ simd\_size);}
\DoxyCodeLine{03633\ }
\DoxyCodeLine{03634\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;\ \_\_i\ <\ simd\_end;\ \_\_i\ +=\ simd\_size)}
\DoxyCodeLine{03635\ \ \ \ \ \{}
\DoxyCodeLine{03636\ \ \ \ \ \ \ \ \ uint32x4\_t\ data\_vec\ \ =\ vld1q\_u32(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }uint32\_t*\textcolor{keyword}{>}(\&this-\/>\_\_data\_[\_\_i]));}
\DoxyCodeLine{03637\ \ \ \ \ \ \ \ \ uint32x4\_t\ other\_vec\ =\ vld1q\_u32(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }uint32\_t*\textcolor{keyword}{>}(\&\_\_other[\_\_i]));}
\DoxyCodeLine{03638\ }
\DoxyCodeLine{03639\ \ \ \ \ \ \ \ \ uint32x4\_t\ xor\_vec\ =\ veorq\_u32(data\_vec,\ other\_vec);}
\DoxyCodeLine{03640\ }
\DoxyCodeLine{03641\ \ \ \ \ \ \ \ \ vst1q\_u32(\textcolor{keyword}{reinterpret\_cast<}uint32\_t*\textcolor{keyword}{>}(\&this-\/>\_\_data\_[\_\_i]),\ xor\_vec);}
\DoxyCodeLine{03642\ \ \ \ \ \}}
\DoxyCodeLine{03643\ }
\DoxyCodeLine{03644\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ \_\_i\ =\ simd\_end;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{03645\ \ \ \ \ \{}
\DoxyCodeLine{03646\ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i]\ \string^=\ (\_\_other[\_\_i]);}
\DoxyCodeLine{03647\ \ \ \ \ \}}
\DoxyCodeLine{03648\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{03649\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{03650\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{03651\ \ \ \ \ \{}
\DoxyCodeLine{03652\ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i]\ \string^=\ \_\_other[\_\_i];}
\DoxyCodeLine{03653\ \ \ \ \ \}}
\DoxyCodeLine{03654\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03655\ \}}
\DoxyCodeLine{03656\ }
\DoxyCodeLine{03657\ }
\DoxyCodeLine{03658\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{03659\ \mbox{\hyperlink{classtensor}{tensor<bool>}}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::logical\_not}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{03660\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(*this).logical\_not\_();}
\DoxyCodeLine{03661\ \}}
\DoxyCodeLine{03662\ }
\DoxyCodeLine{03663\ }
\DoxyCodeLine{03664\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{03665\ \mbox{\hyperlink{classtensor}{tensor<bool>}}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::logical\_or}}(\textcolor{keyword}{const}\ value\_type\ \_\_val)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{03666\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(*this).logical\_or\_(\_\_val);}
\DoxyCodeLine{03667\ \}}
\DoxyCodeLine{03668\ }
\DoxyCodeLine{03669\ }
\DoxyCodeLine{03670\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{03671\ \mbox{\hyperlink{classtensor}{tensor<bool>}}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::logical\_or}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\&\ \_\_other)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{03672\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(*this).logical\_or\_(\_\_other);}
\DoxyCodeLine{03673\ \}}
\DoxyCodeLine{03674\ }
\DoxyCodeLine{03675\ }
\DoxyCodeLine{03676\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{03677\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::logical\_xor}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{03678\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(*this).logical\_xor\_(\_\_other);}
\DoxyCodeLine{03679\ \}}
\DoxyCodeLine{03680\ }
\DoxyCodeLine{03681\ }
\DoxyCodeLine{03682\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{03683\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::logical\_xor}}(\textcolor{keyword}{const}\ value\_type\ \_\_val)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{03684\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(*this).logical\_xor\_(\_\_val);}
\DoxyCodeLine{03685\ \}}
\DoxyCodeLine{03686\ }
\DoxyCodeLine{03687\ }
\DoxyCodeLine{03688\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{03689\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::logical\_and}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{03690\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(*this).logical\_and\_(\_\_other);}
\DoxyCodeLine{03691\ \}}
\DoxyCodeLine{03692\ }
\DoxyCodeLine{03693\ }
\DoxyCodeLine{03694\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{03695\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::logical\_and}}(\textcolor{keyword}{const}\ value\_type\ \_\_val)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{03696\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(*this).logical\_and\_(\_\_val);}
\DoxyCodeLine{03697\ \}}
\DoxyCodeLine{03698\ }
\DoxyCodeLine{03699\ }
\DoxyCodeLine{03700\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{03701\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::logical\_or\_}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\&\ \_\_other)\ \{}
\DoxyCodeLine{03702\ \ \ \ \ \textcolor{keywordflow}{if}\ (!std::is\_integral<value\_type>::value\ \&\&\ !std::is\_same<value\_type,\ bool>::value)}
\DoxyCodeLine{03703\ \ \ \ \ \{}
\DoxyCodeLine{03704\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(}
\DoxyCodeLine{03705\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Cannot\ get\ the\ element\ wise\ not\ of\ non-\/integral\ and\ non-\/boolean\ value"{}});}
\DoxyCodeLine{03706\ \ \ \ \ \}}
\DoxyCodeLine{03707\ }
\DoxyCodeLine{03708\ \ \ \ \ assert(this-\/>\_\_shape\_\ ==\ \_\_other.shape());}
\DoxyCodeLine{03709\ \textcolor{preprocessor}{\#ifdef\ \_\_ARM\_NEON}}
\DoxyCodeLine{03710\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ simd\_size\ =\ 4;}
\DoxyCodeLine{03711\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ simd\_end\ \ =\ this-\/>\_\_data\_.size()\ -\/\ (this-\/>\_\_data\_.size()\ \%\ simd\_size);}
\DoxyCodeLine{03712\ }
\DoxyCodeLine{03713\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;\ \_\_i\ <\ simd\_end;\ \_\_i\ +=\ simd\_size)}
\DoxyCodeLine{03714\ \ \ \ \ \{}
\DoxyCodeLine{03715\ \ \ \ \ \ \ \ \ uint32x4\_t\ data\_vec\ \ =\ vld1q\_u32(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }uint32\_t*\textcolor{keyword}{>}(\&this-\/>\_\_data\_[\_\_i]));}
\DoxyCodeLine{03716\ \ \ \ \ \ \ \ \ uint32x4\_t\ other\_vec\ =\ vld1q\_u32(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }uint32\_t*\textcolor{keyword}{>}(\&this-\/>\_\_other[\_\_i]));}
\DoxyCodeLine{03717\ }
\DoxyCodeLine{03718\ \ \ \ \ \ \ \ \ uint32x4\_t\ or\_vec\ =\ vornq\_u32(data\_vec,\ other\_vec);}
\DoxyCodeLine{03719\ }
\DoxyCodeLine{03720\ \ \ \ \ \ \ \ \ vst1q\_u32(\textcolor{keyword}{reinterpret\_cast<}uint32\_t*\textcolor{keyword}{>}(\&this-\/>\_\_data\_[\_\_i]),\ or\_vec);}
\DoxyCodeLine{03721\ \ \ \ \ \}}
\DoxyCodeLine{03722\ }
\DoxyCodeLine{03723\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ \_\_i\ =\ simd\_end;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{03724\ \ \ \ \ \{}
\DoxyCodeLine{03725\ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i]\ =\ (this-\/>\_\_data\_[\_\_i]\ ||\ \_\_other[\_\_i]);}
\DoxyCodeLine{03726\ \ \ \ \ \}}
\DoxyCodeLine{03727\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{03728\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{03729\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{03730\ \ \ \ \ \{}
\DoxyCodeLine{03731\ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i]\ =\ (this-\/>\_\_data\_[\_\_i]\ ||\ \_\_other[\_\_i]);}
\DoxyCodeLine{03732\ \ \ \ \ \}}
\DoxyCodeLine{03733\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03734\ \}}
\DoxyCodeLine{03735\ }
\DoxyCodeLine{03736\ }
\DoxyCodeLine{03737\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{03738\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::logical\_xor\_}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\&\ \_\_other)\ \{}
\DoxyCodeLine{03739\ \ \ \ \ \textcolor{keywordflow}{if}\ (!std::is\_integral<value\_type>::value\ \&\&\ !std::is\_same<value\_type,\ bool>::value)}
\DoxyCodeLine{03740\ \ \ \ \ \{}
\DoxyCodeLine{03741\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(}
\DoxyCodeLine{03742\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Cannot\ get\ the\ element\ wise\ xor\ of\ non-\/integral\ and\ non-\/boolean\ value"{}});}
\DoxyCodeLine{03743\ \ \ \ \ \}}
\DoxyCodeLine{03744\ }
\DoxyCodeLine{03745\ \ \ \ \ assert(this-\/>\_\_shape\_\ ==\ \_\_other.shape());}
\DoxyCodeLine{03746\ \textcolor{preprocessor}{\#ifdef\ \_\_ARM\_NEON}}
\DoxyCodeLine{03747\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ simd\_size\ =\ 4;}
\DoxyCodeLine{03748\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ simd\_end\ \ =\ this-\/>\_\_data\_.size()\ -\/\ (this-\/>\_\_data\_.size()\ \%\ simd\_size);}
\DoxyCodeLine{03749\ }
\DoxyCodeLine{03750\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;\ \_\_i\ <\ simd\_end;\ \_\_i\ +=\ simd\_size)}
\DoxyCodeLine{03751\ \ \ \ \ \{}
\DoxyCodeLine{03752\ \ \ \ \ \ \ \ \ uint32x4\_t\ data\_vec\ \ =\ vld1q\_u32(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }uint32\_t*\textcolor{keyword}{>}(\&this-\/>\_\_data\_[\_\_i]));}
\DoxyCodeLine{03753\ \ \ \ \ \ \ \ \ uint32x4\_t\ other\_vec\ =\ vld1q\_u32(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }uint32\_t*\textcolor{keyword}{>}(\&\_\_other[\_\_i]));}
\DoxyCodeLine{03754\ }
\DoxyCodeLine{03755\ \ \ \ \ \ \ \ \ uint32x4\_t\ xor\_vec\ =\ veorq\_u32(data\_vec,\ other\_vec);}
\DoxyCodeLine{03756\ }
\DoxyCodeLine{03757\ \ \ \ \ \ \ \ \ vst1q\_u32(\textcolor{keyword}{reinterpret\_cast<}uint32\_t*\textcolor{keyword}{>}(\&this-\/>\_\_data\_[\_\_i]),\ xor\_vec);}
\DoxyCodeLine{03758\ \ \ \ \ \}}
\DoxyCodeLine{03759\ }
\DoxyCodeLine{03760\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ \_\_i\ =\ simd\_end;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{03761\ \ \ \ \ \{}
\DoxyCodeLine{03762\ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i]\ =\ (this-\/>\_\_data\_[\_\_i]\ \&\&\ \_\_other[\_\_i]);}
\DoxyCodeLine{03763\ \ \ \ \ \}}
\DoxyCodeLine{03764\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{03765\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{03766\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{03767\ \ \ \ \ \{}
\DoxyCodeLine{03768\ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i]\ =\ (this-\/>\_\_data\_[\_\_i]\ \string^\ \_\_other[\_\_i]);}
\DoxyCodeLine{03769\ \ \ \ \ \}}
\DoxyCodeLine{03770\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03771\ \}}
\DoxyCodeLine{03772\ }
\DoxyCodeLine{03773\ }
\DoxyCodeLine{03774\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{03775\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::logical\_and\_}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\&\ \_\_other)\ \{}
\DoxyCodeLine{03776\ \ \ \ \ \textcolor{keywordflow}{if}\ (!std::is\_integral<value\_type>::value\ \&\&\ !std::is\_same<value\_type,\ bool>::value)}
\DoxyCodeLine{03777\ \ \ \ \ \{}
\DoxyCodeLine{03778\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(}
\DoxyCodeLine{03779\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Cannot\ get\ the\ element-\/wise\ and\ of\ non-\/integral\ and\ non-\/boolean\ value"{}});}
\DoxyCodeLine{03780\ \ \ \ \ \}}
\DoxyCodeLine{03781\ }
\DoxyCodeLine{03782\ \ \ \ \ assert(this-\/>\_\_shape\_\ ==\ \_\_other.shape());}
\DoxyCodeLine{03783\ }
\DoxyCodeLine{03784\ \textcolor{preprocessor}{\#ifdef\ \_\_ARM\_NEON}}
\DoxyCodeLine{03785\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ simd\_size\ =\ 4;}
\DoxyCodeLine{03786\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ simd\_end\ \ =\ this-\/>\_\_data\_.size()\ -\/\ (this-\/>\_\_data\_.size()\ \%\ simd\_size);}
\DoxyCodeLine{03787\ }
\DoxyCodeLine{03788\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;\ \_\_i\ <\ simd\_end;\ \_\_i\ +=\ simd\_size)}
\DoxyCodeLine{03789\ \ \ \ \ \{}
\DoxyCodeLine{03790\ \ \ \ \ \ \ \ \ uint32x4\_t\ data\_vec\ \ =\ vld1q\_u32(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }uint32\_t*\textcolor{keyword}{>}(\&this-\/>\_\_data\_[\_\_i]));}
\DoxyCodeLine{03791\ \ \ \ \ \ \ \ \ uint32x4\_t\ other\_vec\ =\ vld1q\_u32(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }uint32\_t*\textcolor{keyword}{>}(\&\_\_other[\_\_i]));}
\DoxyCodeLine{03792\ }
\DoxyCodeLine{03793\ \ \ \ \ \ \ \ \ uint32x4\_t\ and\_vec\ =\ vandq\_u32(data\_vec,\ other\_vec);}
\DoxyCodeLine{03794\ }
\DoxyCodeLine{03795\ \ \ \ \ \ \ \ \ vst1q\_u32(\textcolor{keyword}{reinterpret\_cast<}uint32\_t*\textcolor{keyword}{>}(\&this-\/>\_\_data\_[\_\_i]),\ and\_vec);}
\DoxyCodeLine{03796\ \ \ \ \ \}}
\DoxyCodeLine{03797\ }
\DoxyCodeLine{03798\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ \_\_i\ =\ simd\_end;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{03799\ \ \ \ \ \{}
\DoxyCodeLine{03800\ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i]\ =\ (this-\/>\_\_data\_[\_\_i]\ \&\&\ \_\_other[\_\_i]);}
\DoxyCodeLine{03801\ \ \ \ \ \}}
\DoxyCodeLine{03802\ }
\DoxyCodeLine{03803\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{03804\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{03805\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{03806\ \ \ \ \ \{}
\DoxyCodeLine{03807\ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i]\ =\ (this-\/>\_\_data\_[\_\_i]\ \&\&\ \_\_other[\_\_i]);}
\DoxyCodeLine{03808\ \ \ \ \ \}}
\DoxyCodeLine{03809\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03810\ \}}
\DoxyCodeLine{03811\ }
\DoxyCodeLine{03812\ }
\DoxyCodeLine{03813\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{03814\ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::mean}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{03815\ \ \ \ \ this-\/>\_\_check\_is\_integral\_type(\textcolor{stringliteral}{"{}input\ must\ be\ of\ integral\ type\ to\ get\ the\ mean\ average"{}});}
\DoxyCodeLine{03816\ \ \ \ \ \textcolor{keywordtype}{double}\ \_\_m\ =\ 0.0f;}
\DoxyCodeLine{03817\ }
\DoxyCodeLine{03818\ \ \ \ \ \textcolor{keywordflow}{if}\ (this-\/>empty())}
\DoxyCodeLine{03819\ \ \ \ \ \{}
\DoxyCodeLine{03820\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0.0f;}
\DoxyCodeLine{03821\ \ \ \ \ \}}
\DoxyCodeLine{03822\ }
\DoxyCodeLine{03823\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{03824\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{03825\ \ \ \ \ \{}
\DoxyCodeLine{03826\ \ \ \ \ \ \ \ \ \_\_m\ +=\ this-\/>\_\_data\_[\_\_i];}
\DoxyCodeLine{03827\ \ \ \ \ \}}
\DoxyCodeLine{03828\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(\_\_m\ /\ double(this-\/>\_\_data\_.size()));}
\DoxyCodeLine{03829\ \}}
\DoxyCodeLine{03830\ }
\DoxyCodeLine{03831\ }
\DoxyCodeLine{03832\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{03833\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::pow}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{03834\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(*this).pow\_(\_\_other);}
\DoxyCodeLine{03835\ \}}
\DoxyCodeLine{03836\ }
\DoxyCodeLine{03837\ }
\DoxyCodeLine{03838\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{03839\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::pow}}(\textcolor{keyword}{const}\ value\_type\ \_\_val)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{03840\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(*this).pow\_(\_\_val);}
\DoxyCodeLine{03841\ \}}
\DoxyCodeLine{03842\ }
\DoxyCodeLine{03843\ }
\DoxyCodeLine{03844\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{03845\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::pow\_}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{03846\ \ \ \ \ this-\/>\_\_check\_is\_integral\_type(\textcolor{stringliteral}{"{}cannot\ get\ the\ power\ of\ a\ non\ integral\ value"{}});}
\DoxyCodeLine{03847\ }
\DoxyCodeLine{03848\ \ \ \ \ assert(this-\/>\_\_shape\_\ ==\ \_\_other.shape()\ \&\&\ this-\/>\_\_data\_.size()\ ==\ \_\_other.size(0));}
\DoxyCodeLine{03849\ \textcolor{preprocessor}{\#ifdef\ \_\_ARM\_NEON}}
\DoxyCodeLine{03850\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ simd\_size\ =\ 4;}
\DoxyCodeLine{03851\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ simd\_end\ \ =\ this-\/>\_\_data\_.size()\ -\/\ (this-\/>\_\_data\_.size()\ \%\ simd\_size);}
\DoxyCodeLine{03852\ }
\DoxyCodeLine{03853\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;\ \_\_i\ <\ simd\_end;\ \_\_i\ +=\ simd\_size)}
\DoxyCodeLine{03854\ \ \ \ \ \{}
\DoxyCodeLine{03855\ \ \ \ \ \ \ \ \ float32x4\_t\ base\_vec\ =\ vld1q\_f32(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }\textcolor{keywordtype}{float}*\textcolor{keyword}{>}(\&this-\/>\_\_data\_[\_\_i]));}
\DoxyCodeLine{03856\ \ \ \ \ \ \ \ \ float32x4\_t\ exp\_vec\ \ =\ vld1q\_f32(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }\textcolor{keywordtype}{float}*\textcolor{keyword}{>}(\&\_\_other[\_\_i]));}
\DoxyCodeLine{03857\ }
\DoxyCodeLine{03858\ \ \ \ \ \ \ \ \ float32x4\_t\ result\_vec\ =\ \{}
\DoxyCodeLine{03859\ \ \ \ \ \ \ \ \ \ \ \ \ std::pow(vgetq\_lane\_f32(base\_vec,\ 0),\ vgetq\_lane\_f32(exp\_vec,\ 0)),}
\DoxyCodeLine{03860\ \ \ \ \ \ \ \ \ \ \ \ \ std::pow(vgetq\_lane\_f32(base\_vec,\ 1),\ vgetq\_lane\_f32(exp\_vec,\ 1)),}
\DoxyCodeLine{03861\ \ \ \ \ \ \ \ \ \ \ \ \ std::pow(vgetq\_lane\_f32(base\_vec,\ 2),\ vgetq\_lane\_f32(exp\_vec,\ 2)),}
\DoxyCodeLine{03862\ \ \ \ \ \ \ \ \ \ \ \ \ std::pow(vgetq\_lane\_f32(base\_vec,\ 3),\ vgetq\_lane\_f32(exp\_vec,\ 3))\};}
\DoxyCodeLine{03863\ }
\DoxyCodeLine{03864\ \ \ \ \ \ \ \ \ vst1q\_f32(\&this-\/>\_\_data\_[\_\_i],\ result\_vec);}
\DoxyCodeLine{03865\ \ \ \ \ \}}
\DoxyCodeLine{03866\ }
\DoxyCodeLine{03867\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ \_\_i\ =\ simd\_end;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{03868\ \ \ \ \ \{}
\DoxyCodeLine{03869\ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i]\ =\ \textcolor{keyword}{static\_cast<}value\_type\textcolor{keyword}{>}(}
\DoxyCodeLine{03870\ \ \ \ \ \ \ \ \ \ \ \ \ std::pow(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(this-\/>\_\_data\_[\_\_i]),\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(\_\_other[\_\_i])));}
\DoxyCodeLine{03871\ \ \ \ \ \}}
\DoxyCodeLine{03872\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{03873\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{03874\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{03875\ \ \ \ \ \{}
\DoxyCodeLine{03876\ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i]\ =}
\DoxyCodeLine{03877\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{static\_cast<}value\_type\textcolor{keyword}{>}(std::pow(\textcolor{keywordtype}{double}(this-\/>\_\_data\_[\_\_i]),\ \textcolor{keywordtype}{double}(\_\_other[\_\_i])));}
\DoxyCodeLine{03878\ \ \ \ \ \}}
\DoxyCodeLine{03879\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03880\ \}}
\DoxyCodeLine{03881\ }
\DoxyCodeLine{03882\ }
\DoxyCodeLine{03883\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{03884\ \mbox{\hyperlink{classtensor}{tensor<bool>}}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::less\_equal}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{03885\ \ \ \ \ \textcolor{keywordflow}{if}\ (!std::is\_integral<value\_type>::value\ \&\&\ !std::is\_scalar<value\_type>::value)}
\DoxyCodeLine{03886\ \ \ \ \ \{}
\DoxyCodeLine{03887\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(\textcolor{stringliteral}{"{}Cannot\ compare\ non-\/integral\ or\ scalar\ value"{}});}
\DoxyCodeLine{03888\ \ \ \ \ \}}
\DoxyCodeLine{03889\ }
\DoxyCodeLine{03890\ \ \ \ \ assert(this-\/>\_\_shape\_\ ==\ \_\_other.shape()\ \&\&\ this-\/>size(0)\ ==\ \_\_other.size(0));}
\DoxyCodeLine{03891\ }
\DoxyCodeLine{03892\ \ \ \ \ std::vector<bool>\ \_\_ret(this-\/>\_\_data\_.size());}
\DoxyCodeLine{03893\ \textcolor{preprocessor}{\#ifdef\ \_\_ARM\_NEON}}
\DoxyCodeLine{03894\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_same\_v<\_Tp,\ float>)}
\DoxyCodeLine{03895\ \ \ \ \ \{}
\DoxyCodeLine{03896\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ vec\_size\ \ \ \ =\ 4;}
\DoxyCodeLine{03897\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ num\_vectors\ =\ this-\/>\_\_data\_.size()\ /\ vec\_size;}
\DoxyCodeLine{03898\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ remaining\ \ \ =\ this-\/>\_\_data\_.size()\ \%\ vec\_size;}
\DoxyCodeLine{03899\ }
\DoxyCodeLine{03900\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{03901\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ num\_vectors\ *\ vec\_size;\ \_\_i\ +=\ vec\_size)}
\DoxyCodeLine{03902\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03903\ \ \ \ \ \ \ \ \ \ \ \ \ float32x4\_t\ data\_vec1\ \ =\ vld1q\_f32(\&this-\/>\_\_data\_[\_\_i]);}
\DoxyCodeLine{03904\ \ \ \ \ \ \ \ \ \ \ \ \ float32x4\_t\ data\_vec2\ \ =\ vld1q\_f32(\&\_\_other.\_\_data\_[\_\_i]);}
\DoxyCodeLine{03905\ \ \ \ \ \ \ \ \ \ \ \ \ uint32x4\_t\ \ cmp\_result\ =\ vcleq\_f32(data\_vec1,\ data\_vec2);}
\DoxyCodeLine{03906\ \ \ \ \ \ \ \ \ \ \ \ \ uint32\_t\ \ \ \ mask\ \ \ \ \ \ \ =\ vaddvq\_u32(cmp\_result);}
\DoxyCodeLine{03907\ }
\DoxyCodeLine{03908\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_i]\ \ \ \ \ =\ mask\ \&\ 1;}
\DoxyCodeLine{03909\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_i\ +\ 1]\ =\ (mask\ >>\ 8)\ \&\ 1;}
\DoxyCodeLine{03910\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_i\ +\ 2]\ =\ (mask\ >>\ 16)\ \&\ 1;}
\DoxyCodeLine{03911\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_i\ +\ 3]\ =\ (mask\ >>\ 24)\ \&\ 1;}
\DoxyCodeLine{03912\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03913\ }
\DoxyCodeLine{03914\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{03915\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03916\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_i]\ =\ (this-\/>\_\_data\_[\_\_i]\ <=\ \_\_other.\_\_data\_[\_\_i]);}
\DoxyCodeLine{03917\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03918\ \ \ \ \ \}}
\DoxyCodeLine{03919\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{03920\ \ \ \ \ \{}
\DoxyCodeLine{03921\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{03922\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{03923\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03924\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_i]\ =\ (this-\/>\_\_data\_[\_\_i]\ <=\ \_\_other.\_\_data\_[\_\_i]);}
\DoxyCodeLine{03925\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03926\ \ \ \ \ \}}
\DoxyCodeLine{03927\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{03928\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{03929\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{03930\ \ \ \ \ \{}
\DoxyCodeLine{03931\ \ \ \ \ \ \ \ \ \_\_ret[\_\_i]\ =\ (this-\/>\_\_data\_[\_\_i]\ <=\ \_\_other[\_\_i])\ ?\ \textcolor{keyword}{true}\ :\ false;}
\DoxyCodeLine{03932\ \ \ \ \ \}}
\DoxyCodeLine{03933\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03934\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classtensor}{tensor<bool>}}(\_\_ret,\ this-\/>\_\_shape\_);}
\DoxyCodeLine{03935\ \}}
\DoxyCodeLine{03936\ }
\DoxyCodeLine{03937\ }
\DoxyCodeLine{03938\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{03939\ \mbox{\hyperlink{classtensor}{tensor<bool>}}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::less\_equal}}(\textcolor{keyword}{const}\ value\_type\ \_\_val)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{03940\ \ \ \ \ \textcolor{keywordflow}{if}\ (!std::is\_integral<value\_type>::value\ \&\&\ !std::is\_scalar<value\_type>::value)}
\DoxyCodeLine{03941\ \ \ \ \ \{}
\DoxyCodeLine{03942\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(\textcolor{stringliteral}{"{}Cannot\ compare\ non-\/integral\ or\ scalar\ value"{}});}
\DoxyCodeLine{03943\ \ \ \ \ \}}
\DoxyCodeLine{03944\ }
\DoxyCodeLine{03945\ \ \ \ \ std::vector<bool>\ \_\_ret(this-\/>\_\_data\_.size());}
\DoxyCodeLine{03946\ }
\DoxyCodeLine{03947\ \textcolor{preprocessor}{\#ifdef\ \_\_ARM\_NEON}}
\DoxyCodeLine{03948\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_same\_v<\_Tp,\ float>)}
\DoxyCodeLine{03949\ \ \ \ \ \{}
\DoxyCodeLine{03950\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ vec\_size\ \ \ \ =\ 4;}
\DoxyCodeLine{03951\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ num\_vectors\ =\ this-\/>\_\_data\_.size()\ /\ vec\_size;}
\DoxyCodeLine{03952\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ remaining\ \ \ =\ this-\/>\_\_data\_.size()\ \%\ vec\_size;}
\DoxyCodeLine{03953\ }
\DoxyCodeLine{03954\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{03955\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ num\_vectors\ *\ vec\_size;\ \_\_i\ +=\ vec\_size)}
\DoxyCodeLine{03956\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03957\ \ \ \ \ \ \ \ \ \ \ \ \ float32x4\_t\ data\_vec\ \ \ =\ vld1q\_f32(\&this-\/>\_\_data\_[\_\_i]);}
\DoxyCodeLine{03958\ \ \ \ \ \ \ \ \ \ \ \ \ float32x4\_t\ val\_vec\ \ \ \ =\ vdupq\_n\_f32(\_\_val);}
\DoxyCodeLine{03959\ \ \ \ \ \ \ \ \ \ \ \ \ uint32x4\_t\ \ cmp\_result\ =\ vcleq\_f32(data\_vec,\ val\_vec);}
\DoxyCodeLine{03960\ \ \ \ \ \ \ \ \ \ \ \ \ uint32\_t\ \ \ \ mask\ \ \ \ \ \ \ =\ vaddvq\_u32(cmp\_result);}
\DoxyCodeLine{03961\ }
\DoxyCodeLine{03962\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_i]\ \ \ \ \ =\ mask\ \&\ 1;}
\DoxyCodeLine{03963\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_i\ +\ 1]\ =\ (mask\ >>\ 8)\ \&\ 1;}
\DoxyCodeLine{03964\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_i\ +\ 2]\ =\ (mask\ >>\ 16)\ \&\ 1;}
\DoxyCodeLine{03965\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_i\ +\ 3]\ =\ (mask\ >>\ 24)\ \&\ 1;}
\DoxyCodeLine{03966\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03967\ }
\DoxyCodeLine{03968\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{03969\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03970\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_i]\ =\ (this-\/>\_\_data\_[\_\_i]\ <=\ \_\_val);}
\DoxyCodeLine{03971\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03972\ \ \ \ \ \}}
\DoxyCodeLine{03973\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{03974\ \ \ \ \ \{}
\DoxyCodeLine{03975\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{03976\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{03977\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03978\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_i]\ =\ (this-\/>\_\_data\_[\_\_i]\ <=\ \_\_val);}
\DoxyCodeLine{03979\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03980\ \ \ \ \ \}}
\DoxyCodeLine{03981\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{03982\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{03983\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{03984\ \ \ \ \ \{}
\DoxyCodeLine{03985\ \ \ \ \ \ \ \ \ \_\_ret[\_\_i]\ =\ (this-\/>\_\_data\_[\_\_i]\ <=\ \_\_val)\ ?\ \textcolor{keyword}{true}\ :\ false;}
\DoxyCodeLine{03986\ \ \ \ \ \}}
\DoxyCodeLine{03987\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03988\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classtensor}{tensor<bool>}}(\_\_ret,\ this-\/>\_\_shape\_);}
\DoxyCodeLine{03989\ \}}
\DoxyCodeLine{03990\ }
\DoxyCodeLine{03991\ }
\DoxyCodeLine{03992\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{03993\ \mbox{\hyperlink{classtensor}{tensor<bool>}}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::greater\_equal}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{03994\ \ \ \ \ \textcolor{keywordflow}{if}\ (!std::is\_integral<value\_type>::value\ \&\&\ !std::is\_scalar<value\_type>::value)}
\DoxyCodeLine{03995\ \ \ \ \ \{}
\DoxyCodeLine{03996\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(\textcolor{stringliteral}{"{}Cannot\ compare\ non-\/integral\ or\ scalar\ value"{}});}
\DoxyCodeLine{03997\ \ \ \ \ \}}
\DoxyCodeLine{03998\ }
\DoxyCodeLine{03999\ \ \ \ \ assert(this-\/>\_\_shape\_\ ==\ \_\_other.shape()\ \&\&\ this-\/>size(0)\ ==\ \_\_other.size(0));}
\DoxyCodeLine{04000\ }
\DoxyCodeLine{04001\ \ \ \ \ std::vector<bool>\ \_\_ret(this-\/>\_\_data\_.size());}
\DoxyCodeLine{04002\ \textcolor{preprocessor}{\#ifdef\ \_\_ARM\_NEON}}
\DoxyCodeLine{04003\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_same\_v<\_Tp,\ float>)}
\DoxyCodeLine{04004\ \ \ \ \ \{}
\DoxyCodeLine{04005\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ vec\_size\ \ \ \ =\ 4;}
\DoxyCodeLine{04006\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ num\_vectors\ =\ this-\/>\_\_data\_.size()\ /\ vec\_size;}
\DoxyCodeLine{04007\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ remaining\ \ \ =\ this-\/>\_\_data\_.size()\ \%\ vec\_size;}
\DoxyCodeLine{04008\ }
\DoxyCodeLine{04009\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{04010\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ num\_vectors\ *\ vec\_size;\ \_\_i\ +=\ vec\_size)}
\DoxyCodeLine{04011\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{04012\ \ \ \ \ \ \ \ \ \ \ \ \ float32x4\_t\ data\_vec1\ \ =\ vld1q\_f32(\&this-\/>\_\_data\_[\_\_i]);}
\DoxyCodeLine{04013\ \ \ \ \ \ \ \ \ \ \ \ \ float32x4\_t\ data\_vec2\ \ =\ vld1q\_f32(\&\_\_other.\_\_data\_[\_\_i]);}
\DoxyCodeLine{04014\ \ \ \ \ \ \ \ \ \ \ \ \ uint32x4\_t\ \ cmp\_result\ =\ vcgeq\_f32(data\_vec1,\ data\_vec2);}
\DoxyCodeLine{04015\ \ \ \ \ \ \ \ \ \ \ \ \ uint32\_t\ \ \ \ mask\ \ \ \ \ \ \ =\ vaddvq\_u32(cmp\_result);}
\DoxyCodeLine{04016\ }
\DoxyCodeLine{04017\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_i]\ \ \ \ \ =\ mask\ \&\ 1;}
\DoxyCodeLine{04018\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_i\ +\ 1]\ =\ (mask\ >>\ 8)\ \&\ 1;}
\DoxyCodeLine{04019\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_i\ +\ 2]\ =\ (mask\ >>\ 16)\ \&\ 1;}
\DoxyCodeLine{04020\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_i\ +\ 3]\ =\ (mask\ >>\ 24)\ \&\ 1;}
\DoxyCodeLine{04021\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{04022\ }
\DoxyCodeLine{04023\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{04024\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{04025\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_i]\ =\ (this-\/>\_\_data\_[\_\_i]\ >=\ \_\_other.\_\_data\_[\_\_i]);}
\DoxyCodeLine{04026\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{04027\ \ \ \ \ \}}
\DoxyCodeLine{04028\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{04029\ \ \ \ \ \{}
\DoxyCodeLine{04030\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{04031\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{04032\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{04033\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_i]\ =\ (this-\/>\_\_data\_[\_\_i]\ >=\ \_\_other.\_\_data\_[\_\_i]);}
\DoxyCodeLine{04034\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{04035\ \ \ \ \ \}}
\DoxyCodeLine{04036\ }
\DoxyCodeLine{04037\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{04038\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{04039\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{04040\ \ \ \ \ \{}
\DoxyCodeLine{04041\ \ \ \ \ \ \ \ \ \_\_ret[\_\_i]\ =\ (this-\/>\_\_data\_[\_\_i]\ >=\ \_\_other[\_\_i])\ ?\ \textcolor{keyword}{true}\ :\ false;}
\DoxyCodeLine{04042\ \ \ \ \ \}}
\DoxyCodeLine{04043\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{04044\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classtensor}{tensor<bool>}}(\_\_ret,\ this-\/>\_\_shape\_);}
\DoxyCodeLine{04045\ \}}
\DoxyCodeLine{04046\ }
\DoxyCodeLine{04047\ }
\DoxyCodeLine{04048\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{04049\ \mbox{\hyperlink{classtensor}{tensor<bool>}}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::greater\_equal}}(\textcolor{keyword}{const}\ value\_type\ \_\_val)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{04050\ \ \ \ \ \textcolor{keywordflow}{if}\ (!std::is\_integral<value\_type>::value\ \&\&\ !std::is\_scalar<value\_type>::value)}
\DoxyCodeLine{04051\ \ \ \ \ \{}
\DoxyCodeLine{04052\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(\textcolor{stringliteral}{"{}Cannot\ compare\ non-\/integral\ or\ scalar\ value"{}});}
\DoxyCodeLine{04053\ \ \ \ \ \}}
\DoxyCodeLine{04054\ }
\DoxyCodeLine{04055\ \ \ \ \ std::vector<bool>\ \_\_ret(this-\/>\_\_data\_.size());}
\DoxyCodeLine{04056\ \textcolor{preprocessor}{\#ifdef\ \_\_ARM\_NEON}}
\DoxyCodeLine{04057\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_same\_v<\_Tp,\ float>)}
\DoxyCodeLine{04058\ \ \ \ \ \{}
\DoxyCodeLine{04059\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ vec\_size\ \ \ \ =\ 4;}
\DoxyCodeLine{04060\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ num\_vectors\ =\ this-\/>\_\_data\_.size()\ /\ vec\_size;}
\DoxyCodeLine{04061\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ remaining\ \ \ =\ this-\/>\_\_data\_.size()\ \%\ vec\_size;}
\DoxyCodeLine{04062\ }
\DoxyCodeLine{04063\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \ \ \ \ \ \_\_i\ \ \ \ \ =\ 0;}
\DoxyCodeLine{04064\ \ \ \ \ \ \ \ \ float32x4\_t\ val\_vec\ =\ vdupq\_n\_f32(\_\_val);}
\DoxyCodeLine{04065\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ num\_vectors\ *\ vec\_size;\ \_\_i\ +=\ vec\_size)}
\DoxyCodeLine{04066\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{04067\ \ \ \ \ \ \ \ \ \ \ \ \ float32x4\_t\ data\_vec\ \ \ =\ vld1q\_f32(\&this-\/>\_\_data\_[\_\_i]);}
\DoxyCodeLine{04068\ \ \ \ \ \ \ \ \ \ \ \ \ uint32x4\_t\ \ cmp\_result\ =\ vcgeq\_f32(data\_vec,\ val\_vec);}
\DoxyCodeLine{04069\ \ \ \ \ \ \ \ \ \ \ \ \ uint32\_t\ \ \ \ mask\ \ \ \ \ \ \ =\ vaddvq\_u32(cmp\_result);}
\DoxyCodeLine{04070\ }
\DoxyCodeLine{04071\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_i]\ \ \ \ \ =\ mask\ \&\ 1;}
\DoxyCodeLine{04072\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_i\ +\ 1]\ =\ (mask\ >>\ 8)\ \&\ 1;}
\DoxyCodeLine{04073\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_i\ +\ 2]\ =\ (mask\ >>\ 16)\ \&\ 1;}
\DoxyCodeLine{04074\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_i\ +\ 3]\ =\ (mask\ >>\ 24)\ \&\ 1;}
\DoxyCodeLine{04075\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{04076\ }
\DoxyCodeLine{04077\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{04078\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{04079\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_i]\ =\ (this-\/>\_\_data\_[\_\_i]\ >=\ \_\_val);}
\DoxyCodeLine{04080\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{04081\ \ \ \ \ \}}
\DoxyCodeLine{04082\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{04083\ \ \ \ \ \{}
\DoxyCodeLine{04084\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{04085\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{04086\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{04087\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_i]\ =\ (this-\/>\_\_data\_[\_\_i]\ >=\ \_\_val);}
\DoxyCodeLine{04088\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{04089\ \ \ \ \ \}}
\DoxyCodeLine{04090\ }
\DoxyCodeLine{04091\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{04092\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{04093\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{04094\ \ \ \ \ \{}
\DoxyCodeLine{04095\ \ \ \ \ \ \ \ \ \_\_ret[\_\_i]\ =\ (this-\/>\_\_data\_[\_\_i]\ >=\ \_\_val)\ ?\ \textcolor{keyword}{true}\ :\ false;}
\DoxyCodeLine{04096\ \ \ \ \ \}}
\DoxyCodeLine{04097\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{04098\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classtensor}{tensor<bool>}}(\_\_ret,\ this-\/>\_\_shape\_);}
\DoxyCodeLine{04099\ \}}
\DoxyCodeLine{04100\ }
\DoxyCodeLine{04101\ }
\DoxyCodeLine{04102\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{04103\ \mbox{\hyperlink{classtensor}{tensor<bool>}}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::equal}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtensor}{tensor}}\&\ \_\_other)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{04104\ \ \ \ \ \textcolor{keywordflow}{if}\ (!std::is\_integral<value\_type>::value\ \&\&\ !std::is\_scalar<value\_type>::value)}
\DoxyCodeLine{04105\ \ \ \ \ \{}
\DoxyCodeLine{04106\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(\textcolor{stringliteral}{"{}Cannot\ compare\ non-\/integral\ or\ scalar\ value"{}});}
\DoxyCodeLine{04107\ \ \ \ \ \}}
\DoxyCodeLine{04108\ }
\DoxyCodeLine{04109\ \ \ \ \ assert(this-\/>\_\_shape\_\ ==\ \_\_other.shape()\ \&\&\ this-\/>size(0)\ ==\ \_\_other.size(0));}
\DoxyCodeLine{04110\ }
\DoxyCodeLine{04111\ \ \ \ \ std::vector<bool>\ \_\_ret(this-\/>\_\_data\_.size());}
\DoxyCodeLine{04112\ \textcolor{preprocessor}{\#ifdef\ \_\_ARM\_NEON}}
\DoxyCodeLine{04113\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_same\_v<\_Tp,\ float>)}
\DoxyCodeLine{04114\ \ \ \ \ \{}
\DoxyCodeLine{04115\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ vec\_size\ \ \ \ =\ 4;}
\DoxyCodeLine{04116\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ num\_vectors\ =\ this-\/>\_\_data\_.size()\ /\ vec\_size;}
\DoxyCodeLine{04117\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ remaining\ \ \ =\ this-\/>\_\_data\_.size()\ \%\ vec\_size;}
\DoxyCodeLine{04118\ }
\DoxyCodeLine{04119\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{04120\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ num\_vectors\ *\ vec\_size;\ \_\_i\ +=\ vec\_size)}
\DoxyCodeLine{04121\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{04122\ \ \ \ \ \ \ \ \ \ \ \ \ float32x4\_t\ data\_vec1\ \ =\ vld1q\_f32(\&this-\/>\_\_data\_[\_\_i]);}
\DoxyCodeLine{04123\ \ \ \ \ \ \ \ \ \ \ \ \ float32x4\_t\ data\_vec2\ \ =\ vld1q\_f32(\&\_\_other.\_\_data\_[\_\_i]);}
\DoxyCodeLine{04124\ \ \ \ \ \ \ \ \ \ \ \ \ uint32x4\_t\ \ cmp\_result\ =\ vceqq\_f32(data\_vec1,\ data\_vec2);}
\DoxyCodeLine{04125\ \ \ \ \ \ \ \ \ \ \ \ \ uint32\_t\ \ \ \ mask\ \ \ \ \ \ \ =\ vaddvq\_u32(cmp\_result);}
\DoxyCodeLine{04126\ }
\DoxyCodeLine{04127\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_i]\ \ \ \ \ =\ mask\ \&\ 1;}
\DoxyCodeLine{04128\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_i\ +\ 1]\ =\ (mask\ >>\ 8)\ \&\ 1;}
\DoxyCodeLine{04129\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_i\ +\ 2]\ =\ (mask\ >>\ 16)\ \&\ 1;}
\DoxyCodeLine{04130\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_i\ +\ 3]\ =\ (mask\ >>\ 24)\ \&\ 1;}
\DoxyCodeLine{04131\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{04132\ }
\DoxyCodeLine{04133\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{04134\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{04135\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_i]\ =\ (this-\/>\_\_data\_[\_\_i]\ ==\ \_\_other.\_\_data\_[\_\_i]);}
\DoxyCodeLine{04136\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{04137\ \ \ \ \ \}}
\DoxyCodeLine{04138\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{04139\ \ \ \ \ \{}
\DoxyCodeLine{04140\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{04141\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{04142\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{04143\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_i]\ =\ (this-\/>\_\_data\_[\_\_i]\ ==\ \_\_other.\_\_data\_[\_\_i]);}
\DoxyCodeLine{04144\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{04145\ \ \ \ \ \}}
\DoxyCodeLine{04146\ }
\DoxyCodeLine{04147\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{04148\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{04149\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{04150\ \ \ \ \ \{}
\DoxyCodeLine{04151\ \ \ \ \ \ \ \ \ \_\_ret[\_\_i]\ =\ (this-\/>\_\_data\_[\_\_i]\ ==\ \_\_other[\_\_i])\ ?\ \textcolor{keyword}{true}\ :\ false;}
\DoxyCodeLine{04152\ \ \ \ \ \}}
\DoxyCodeLine{04153\ }
\DoxyCodeLine{04154\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{04155\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classtensor}{tensor<bool>}}(\_\_ret,\ this-\/>\_\_shape\_);}
\DoxyCodeLine{04156\ \}}
\DoxyCodeLine{04157\ }
\DoxyCodeLine{04158\ }
\DoxyCodeLine{04159\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{04160\ \mbox{\hyperlink{classtensor}{tensor<bool>}}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::equal}}(\textcolor{keyword}{const}\ value\_type\ \_\_val)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{04161\ \ \ \ \ \textcolor{keywordflow}{if}\ (!std::is\_integral<value\_type>::value\ \&\&\ !std::is\_scalar<value\_type>::value)}
\DoxyCodeLine{04162\ \ \ \ \ \{}
\DoxyCodeLine{04163\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(\textcolor{stringliteral}{"{}Cannot\ compare\ non-\/integral\ or\ scalar\ value"{}});}
\DoxyCodeLine{04164\ \ \ \ \ \}}
\DoxyCodeLine{04165\ \ \ \ \ std::vector<bool>\ \_\_ret(this-\/>\_\_data\_.size());}
\DoxyCodeLine{04166\ \textcolor{preprocessor}{\#ifdef\ \_\_ARM\_NEON}}
\DoxyCodeLine{04167\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_same\_v<\_Tp,\ float>)}
\DoxyCodeLine{04168\ \ \ \ \ \{}
\DoxyCodeLine{04169\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ vec\_size\ \ \ \ =\ 4;}
\DoxyCodeLine{04170\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ num\_vectors\ =\ this-\/>\_\_data\_.size()\ /\ vec\_size;}
\DoxyCodeLine{04171\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ remaining\ \ \ =\ this-\/>\_\_data\_.size()\ \%\ vec\_size;}
\DoxyCodeLine{04172\ }
\DoxyCodeLine{04173\ \ \ \ \ \ \ \ \ float32x4\_t\ val\_vec\ =\ vdupq\_n\_f32(\_\_val);}
\DoxyCodeLine{04174\ }
\DoxyCodeLine{04175\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{04176\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ num\_vectors\ *\ vec\_size;\ \_\_i\ +=\ vec\_size)}
\DoxyCodeLine{04177\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{04178\ \ \ \ \ \ \ \ \ \ \ \ \ float32x4\_t\ data\_vec\ \ \ =\ vld1q\_f32(\&this-\/>\_\_data\_[\_\_i]);}
\DoxyCodeLine{04179\ \ \ \ \ \ \ \ \ \ \ \ \ uint32x4\_t\ \ cmp\_result\ =\ vceqq\_f32(data\_vec,\ val\_vec);}
\DoxyCodeLine{04180\ \ \ \ \ \ \ \ \ \ \ \ \ uint32\_t\ \ \ \ mask\ \ \ \ \ \ \ =\ vaddvq\_u32(cmp\_result);}
\DoxyCodeLine{04181\ }
\DoxyCodeLine{04182\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_i]\ \ \ \ \ =\ mask\ \&\ 1;}
\DoxyCodeLine{04183\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_i\ +\ 1]\ =\ (mask\ >>\ 8)\ \&\ 1;}
\DoxyCodeLine{04184\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_i\ +\ 2]\ =\ (mask\ >>\ 16)\ \&\ 1;}
\DoxyCodeLine{04185\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_i\ +\ 3]\ =\ (mask\ >>\ 24)\ \&\ 1;}
\DoxyCodeLine{04186\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{04187\ }
\DoxyCodeLine{04188\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{04189\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{04190\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_i]\ =\ (this-\/>\_\_data\_[\_\_i]\ ==\ \_\_val);}
\DoxyCodeLine{04191\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{04192\ \ \ \ \ \}}
\DoxyCodeLine{04193\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{04194\ \ \ \ \ \{}
\DoxyCodeLine{04195\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{04196\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{04197\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{04198\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret[\_\_i]\ =\ (this-\/>\_\_data\_[\_\_i]\ ==\ \_\_val);}
\DoxyCodeLine{04199\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{04200\ \ \ \ \ \}}
\DoxyCodeLine{04201\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{04202\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{04203\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{04204\ \ \ \ \ \{}
\DoxyCodeLine{04205\ \ \ \ \ \ \ \ \ \_\_ret[\_\_i]\ =\ (this-\/>\_\_data\_[\_\_i]\ >=\ \_\_val)\ ?\ \textcolor{keyword}{true}\ :\ false;}
\DoxyCodeLine{04206\ \ \ \ \ \}}
\DoxyCodeLine{04207\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{04208\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classtensor}{tensor<bool>}}(\_\_ret,\ this-\/>\_\_shape\_);}
\DoxyCodeLine{04209\ \}}
\DoxyCodeLine{04210\ }
\DoxyCodeLine{04211\ }
\DoxyCodeLine{04212\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{04213\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::sum}}(\textcolor{keyword}{const}\ index\_type\ \_\_axis)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{04214\ \ \ \ \ this-\/>\_\_check\_is\_scalar\_type(\textcolor{stringliteral}{"{}Cannot\ reduce\ tensor\ with\ non\ scalar\ type"{}});}
\DoxyCodeLine{04215\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_\_axis\ <\ 0LL\ ||\ \_\_axis\ >=\ \textcolor{keyword}{static\_cast<}index\_type\textcolor{keyword}{>}(this-\/>\_\_shape\_.size()))}
\DoxyCodeLine{04216\ \ \ \ \ \{}
\DoxyCodeLine{04217\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::invalid\_argument(\textcolor{stringliteral}{"{}Invalid\ axis\ for\ sum"{}});}
\DoxyCodeLine{04218\ \ \ \ \ \}}
\DoxyCodeLine{04219\ }
\DoxyCodeLine{04220\ \ \ \ \ shape\_type\ \_\_ret\_sh\ =\ this-\/>\_\_shape\_;}
\DoxyCodeLine{04221\ \ \ \ \ \_\_ret\_sh[\_\_axis]\ \ \ \ =\ 1LL;}
\DoxyCodeLine{04222\ }
\DoxyCodeLine{04223\ \ \ \ \ index\_type\ \_\_ret\_size\ =}
\DoxyCodeLine{04224\ \ \ \ \ \ \ \ \ std::accumulate(\_\_ret\_sh.begin(),\ \_\_ret\_sh.end(),\ 1,\ std::multiplies<index\_type>());}
\DoxyCodeLine{04225\ \ \ \ \ data\_t\ \_\_ret\_data(\_\_ret\_size,\ value\_type(0.0f));}
\DoxyCodeLine{04226\ }
\DoxyCodeLine{04227\ \textcolor{preprocessor}{\#if\ defined(\_\_ARM\_NEON)}}
\DoxyCodeLine{04228\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_same\_v<\_Tp,\ float>)}
\DoxyCodeLine{04229\ \ \ \ \ \{}
\DoxyCodeLine{04230\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ index\_type\ \_\_axis\_size\ \ =\ this-\/>\_\_shape\_[\_\_axis];}
\DoxyCodeLine{04231\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ index\_type\ \_\_outer\_size\ =\ this-\/>\_\_compute\_outer\_size(\_\_axis);}
\DoxyCodeLine{04232\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ index\_type\ \_\_inner\_size\ =\ this-\/>size(0)\ /\ (\_\_outer\_size\ *\ \_\_axis\_size);}
\DoxyCodeLine{04233\ }
\DoxyCodeLine{04234\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (index\_type\ \_\_outer\ =\ 0;\ \_\_outer\ <\ \_\_outer\_size;\ \_\_outer++)}
\DoxyCodeLine{04235\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{04236\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (index\_type\ \_\_inner\ =\ 0;\ \_\_inner\ <\ \_\_inner\_size;\ \_\_inner++)}
\DoxyCodeLine{04237\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{04238\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ float32x4\_t\ sum\_vec\ =\ vdupq\_n\_f32(0.0f);}
\DoxyCodeLine{04239\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ index\_type\ \ \_\_i\ \ \ \ \ =\ \_\_outer\ *\ \_\_axis\_size\ *\ \_\_inner\_size\ +\ \_\_inner;}
\DoxyCodeLine{04240\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ index\_type\ \ \_\_j\ \ \ \ \ =\ 0;}
\DoxyCodeLine{04241\ }
\DoxyCodeLine{04242\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_j\ +\ 4\ <=\ \_\_axis\_size;\ \_\_j\ +=\ 4)}
\DoxyCodeLine{04243\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{04244\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ float32x4\_t\ data\_vec\ =\ vld1q\_f32(\&this-\/>\_\_data\_[\_\_i]);}
\DoxyCodeLine{04245\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sum\_vec\ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ vaddq\_f32(sum\_vec,\ data\_vec);}
\DoxyCodeLine{04246\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_i\ +=\ \_\_inner\_size\ *\ 4;}
\DoxyCodeLine{04247\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{04248\ }
\DoxyCodeLine{04249\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ sum\ =\ vaddvq\_f32(sum\_vec);}
\DoxyCodeLine{04250\ }
\DoxyCodeLine{04251\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_j\ <\ \_\_axis\_size;\ \_\_j++)}
\DoxyCodeLine{04252\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{04253\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sum\ +=\ this-\/>\_\_data\_[\_\_i];}
\DoxyCodeLine{04254\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_i\ +=\ \_\_inner\_size;}
\DoxyCodeLine{04255\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{04256\ }
\DoxyCodeLine{04257\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret\_data[\_\_outer\ *\ \_\_inner\_size\ +\ \_\_inner]\ =\ sum;}
\DoxyCodeLine{04258\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{04259\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{04260\ \ \ \ \ \}}
\DoxyCodeLine{04261\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{04262\ \ \ \ \ \{}
\DoxyCodeLine{04263\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{04264\ \ \ \ \ \ \ \ \ index\_type\ \_\_i\ =\ 0;}
\DoxyCodeLine{04265\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ static\_cast<index\_type>(this-\/>\_\_data\_.size());\ \_\_i++)}
\DoxyCodeLine{04266\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{04267\ \ \ \ \ \ \ \ \ \ \ \ \ std::vector<index\_type>\ \_\_orig(this-\/>\_\_shape\_.size());}
\DoxyCodeLine{04268\ \ \ \ \ \ \ \ \ \ \ \ \ index\_type\ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_index\ =\ \_\_i;}
\DoxyCodeLine{04269\ }
\DoxyCodeLine{04270\ \ \ \ \ \ \ \ \ \ \ \ \ index\_type\ \_\_j\ =\ \textcolor{keyword}{static\_cast<}index\_type\textcolor{keyword}{>}(this-\/>\_\_shape\_.size())\ -\/\ 1;}
\DoxyCodeLine{04271\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_j\ >=\ 0;\ \_\_j-\/-\/)}
\DoxyCodeLine{04272\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{04273\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_orig[\_\_j]\ =\ \_\_index\ \%\ this-\/>\_\_shape\_[\_\_j];}
\DoxyCodeLine{04274\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_index\ /=\ this-\/>\_\_shape\_[\_\_j];}
\DoxyCodeLine{04275\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{04276\ }
\DoxyCodeLine{04277\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_orig[\_\_axis]\ \ \ \ \ \ \ \ \ =\ 0LL;}
\DoxyCodeLine{04278\ \ \ \ \ \ \ \ \ \ \ \ \ index\_type\ \_\_ret\_index\ =\ 0LL;}
\DoxyCodeLine{04279\ \ \ \ \ \ \ \ \ \ \ \ \ index\_type\ \_\_st\ \ \ \ \ \ \ \ =\ 1LL;}
\DoxyCodeLine{04280\ }
\DoxyCodeLine{04281\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\_\_j\ =\ \textcolor{keyword}{static\_cast<}index\_type\textcolor{keyword}{>}(this-\/>\_\_shape\_.size())\ -\/\ 1;\ \_\_j\ >=\ 0;\ \_\_j-\/-\/)}
\DoxyCodeLine{04282\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{04283\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret\_index\ +=\ \_\_orig[\_\_j]\ *\ \_\_st;}
\DoxyCodeLine{04284\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_st\ *=\ \_\_ret\_sh[\_\_j];}
\DoxyCodeLine{04285\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{04286\ }
\DoxyCodeLine{04287\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_ret\_data[\_\_ret\_index]\ +=\ this-\/>\_\_data\_[\_\_i];}
\DoxyCodeLine{04288\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{04289\ \textcolor{preprocessor}{\#if\ defined(\_\_ARM\_NEON)}}
\DoxyCodeLine{04290\ \ \ \ \ \}}
\DoxyCodeLine{04291\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{04292\ }
\DoxyCodeLine{04293\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(\_\_ret\_data,\ \_\_ret\_sh);}
\DoxyCodeLine{04294\ \}}
\DoxyCodeLine{04295\ }
\DoxyCodeLine{04296\ }
\DoxyCodeLine{04297\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{04298\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::row}}(\textcolor{keyword}{const}\ index\_type\ \_\_index)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{04299\ \ \ \ \ \textcolor{keywordflow}{if}\ (this-\/>\_\_shape\_.size()\ !=\ 2)}
\DoxyCodeLine{04300\ \ \ \ \ \{}
\DoxyCodeLine{04301\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(\textcolor{stringliteral}{"{}Cannot\ get\ a\ row\ from\ a\ non\ two\ dimensional\ tensor"{}});}
\DoxyCodeLine{04302\ \ \ \ \ \}}
\DoxyCodeLine{04303\ }
\DoxyCodeLine{04304\ \ \ \ \ \textcolor{keywordflow}{if}\ (this-\/>\_\_shape\_[0]\ <=\ \_\_index\ ||\ \_\_index\ <\ 0LL)}
\DoxyCodeLine{04305\ \ \ \ \ \{}
\DoxyCodeLine{04306\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::invalid\_argument(\textcolor{stringliteral}{"{}Index\ input\ is\ out\ of\ range"{}});}
\DoxyCodeLine{04307\ \ \ \ \ \}}
\DoxyCodeLine{04308\ }
\DoxyCodeLine{04309\ \ \ \ \ data\_t\ \_\_r(this-\/>\_\_data\_.begin()\ +\ (this-\/>\_\_shape\_[1]\ *\ \_\_index),}
\DoxyCodeLine{04310\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>\_\_data\_.begin()\ +\ (this-\/>\_\_shape\_[1]\ *\ \_\_index\ +\ this-\/>\_\_shape\_[1]));}
\DoxyCodeLine{04311\ }
\DoxyCodeLine{04312\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(\_\_r,\ \{this-\/>\_\_shape\_[1]\});}
\DoxyCodeLine{04313\ \}}
\DoxyCodeLine{04314\ }
\DoxyCodeLine{04315\ }
\DoxyCodeLine{04316\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{04317\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::col}}(\textcolor{keyword}{const}\ index\_type\ \_\_index)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{04318\ \ \ \ \ \textcolor{keywordflow}{if}\ (this-\/>\_\_shape\_.size()\ !=\ 2)}
\DoxyCodeLine{04319\ \ \ \ \ \{}
\DoxyCodeLine{04320\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(\textcolor{stringliteral}{"{}Cannot\ get\ a\ column\ from\ a\ non\ two\ dimensional\ tensor"{}});}
\DoxyCodeLine{04321\ \ \ \ \ \}}
\DoxyCodeLine{04322\ }
\DoxyCodeLine{04323\ \ \ \ \ \textcolor{keywordflow}{if}\ (this-\/>\_\_shape\_[1]\ <=\ \_\_index\ ||\ \_\_index\ <\ 0LL)}
\DoxyCodeLine{04324\ \ \ \ \ \{}
\DoxyCodeLine{04325\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::invalid\_argument(\textcolor{stringliteral}{"{}Index\ input\ out\ of\ range"{}});}
\DoxyCodeLine{04326\ \ \ \ \ \}}
\DoxyCodeLine{04327\ }
\DoxyCodeLine{04328\ \ \ \ \ data\_t\ \_\_c;}
\DoxyCodeLine{04329\ }
\DoxyCodeLine{04330\ \ \ \ \ index\_type\ \_\_i\ =\ 0;}
\DoxyCodeLine{04331\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_shape\_[0];\ \_\_i++)}
\DoxyCodeLine{04332\ \ \ \ \ \{}
\DoxyCodeLine{04333\ \ \ \ \ \ \ \ \ \_\_c.push\_back(this-\/>\_\_data\_[this-\/>\_\_compute\_index(\{\_\_i,\ \_\_index\})]);}
\DoxyCodeLine{04334\ \ \ \ \ \}}
\DoxyCodeLine{04335\ }
\DoxyCodeLine{04336\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(\_\_c,\ \{this-\/>\_\_shape\_[0]\});}
\DoxyCodeLine{04337\ \}}
\DoxyCodeLine{04338\ }
\DoxyCodeLine{04339\ }
\DoxyCodeLine{04340\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{04341\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::ceil}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{04342\ \ \ \ \ this-\/>\_\_check\_is\_scalar\_type(\textcolor{stringliteral}{"{}Cannot\ get\ the\ ceiling\ of\ a\ non\ scalar\ value"{}});}
\DoxyCodeLine{04343\ \ \ \ \ data\_t\ \_\_ret(this-\/>\_\_data\_.size());}
\DoxyCodeLine{04344\ }
\DoxyCodeLine{04345\ \textcolor{preprocessor}{\#ifdef\ \_\_ARM\_NEON}}
\DoxyCodeLine{04346\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ simd\_size\ =\ 4;}
\DoxyCodeLine{04347\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ simd\_end\ \ =\ this-\/>\_\_data\_.size()\ -\/\ (this-\/>\_\_data\_.size()\ \%\ simd\_size);}
\DoxyCodeLine{04348\ }
\DoxyCodeLine{04349\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;\ \_\_i\ <\ simd\_end;\ \_\_i\ +=\ simd\_size)}
\DoxyCodeLine{04350\ \ \ \ \ \{}
\DoxyCodeLine{04351\ \ \ \ \ \ \ \ \ float32x4\_t\ data\ \ \ =\ vld1q\_f32(\&this-\/>\_\_data\_[\_\_i]);}
\DoxyCodeLine{04352\ \ \ \ \ \ \ \ \ float32x4\_t\ ceiled\ =\ vrndpq\_f32(data);}
\DoxyCodeLine{04353\ \ \ \ \ \ \ \ \ vst1q\_f32(\&\_\_ret[\_\_i],\ ceiled);}
\DoxyCodeLine{04354\ \ \ \ \ \}}
\DoxyCodeLine{04355\ }
\DoxyCodeLine{04356\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ \_\_i\ =\ simd\_end;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{04357\ \ \ \ \ \{}
\DoxyCodeLine{04358\ \ \ \ \ \ \ \ \ \_\_ret[\_\_i]\ =\ std::ceil(this-\/>\_\_data\_[\_\_i]);}
\DoxyCodeLine{04359\ \ \ \ \ \}}
\DoxyCodeLine{04360\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{04361\ }
\DoxyCodeLine{04362\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{04363\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{04364\ \ \ \ \ \{}
\DoxyCodeLine{04365\ \ \ \ \ \ \ \ \ \_\_ret[\_\_i]\ =\ std::ceil(this-\/>\_\_data\_[\_\_i]);}
\DoxyCodeLine{04366\ \ \ \ \ \}}
\DoxyCodeLine{04367\ }
\DoxyCodeLine{04368\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{04369\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(\_\_ret,\ this-\/>\_\_shape\_);}
\DoxyCodeLine{04370\ \}}
\DoxyCodeLine{04371\ }
\DoxyCodeLine{04372\ }
\DoxyCodeLine{04373\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{04374\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::floor}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{04375\ \ \ \ \ this-\/>\_\_check\_is\_scalar\_type(\textcolor{stringliteral}{"{}Cannot\ get\ the\ floor\ of\ a\ non\ scalar\ value"{}});}
\DoxyCodeLine{04376\ \ \ \ \ data\_t\ \_\_ret(this-\/>\_\_data\_.size());}
\DoxyCodeLine{04377\ }
\DoxyCodeLine{04378\ \textcolor{preprocessor}{\#ifdef\ \_\_ARM\_NEON}}
\DoxyCodeLine{04379\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ simd\_size\ =\ 4;}
\DoxyCodeLine{04380\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ simd\_end\ \ =\ this-\/>\_\_data\_.size()\ -\/\ (this-\/>\_\_data\_.size()\ \%\ simd\_size);}
\DoxyCodeLine{04381\ }
\DoxyCodeLine{04382\ \ \ \ \ float32x4\_t\ zero\ =\ vdupq\_n\_f32(0.0f);}
\DoxyCodeLine{04383\ }
\DoxyCodeLine{04384\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;\ \_\_i\ <\ simd\_end;\ \_\_i\ +=\ simd\_size)}
\DoxyCodeLine{04385\ \ \ \ \ \{}
\DoxyCodeLine{04386\ \ \ \ \ \ \ \ \ float32x4\_t\ data\ \ \ \ =\ vld1q\_f32(\&this-\/>\_\_data\_[\_\_i]);}
\DoxyCodeLine{04387\ \ \ \ \ \ \ \ \ float32x4\_t\ floored\ =\ vrndmq\_f32(data);}
\DoxyCodeLine{04388\ \ \ \ \ \ \ \ \ vst1q\_f32(\&\_\_ret[\_\_i],\ floored);}
\DoxyCodeLine{04389\ \ \ \ \ \}}
\DoxyCodeLine{04390\ }
\DoxyCodeLine{04391\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ \_\_i\ =\ simd\_end;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{04392\ \ \ \ \ \{}
\DoxyCodeLine{04393\ \ \ \ \ \ \ \ \ \_\_ret[\_\_i]\ =\ std::floor(this-\/>\_\_data\_[\_\_i]);}
\DoxyCodeLine{04394\ \ \ \ \ \}}
\DoxyCodeLine{04395\ }
\DoxyCodeLine{04396\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{04397\ }
\DoxyCodeLine{04398\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{04399\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{04400\ \ \ \ \ \{}
\DoxyCodeLine{04401\ \ \ \ \ \ \ \ \ \_\_ret[\_\_i]\ =\ std::floor(this-\/>\_\_data\_[\_\_i]);}
\DoxyCodeLine{04402\ \ \ \ \ \}}
\DoxyCodeLine{04403\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{04404\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_self(\_\_ret,\ this-\/>\_\_shape\_);}
\DoxyCodeLine{04405\ \}}
\DoxyCodeLine{04406\ }
\DoxyCodeLine{04407\ }
\DoxyCodeLine{04408\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{04409\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>}}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::clamp}}(const\_pointer\ \_\_min\_val,\ const\_pointer\ \_\_max\_val)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{04410\ \ \ \ \ \mbox{\hyperlink{classtensor}{tensor<value\_type>}}\ \_\_t\ =\ \mbox{\hyperlink{classtensor}{\_\_self}}(*\textcolor{keyword}{this});}
\DoxyCodeLine{04411\ \ \ \ \ \_\_t.clamp\_(\_\_min\_val,\ \_\_max\_val);}
\DoxyCodeLine{04412\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_t;}
\DoxyCodeLine{04413\ \}}
\DoxyCodeLine{04414\ }
\DoxyCodeLine{04415\ }
\DoxyCodeLine{04416\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ \_Tp>}
\DoxyCodeLine{04417\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classtensor}{tensor<\_Tp>::clamp\_}}(const\_pointer\ \_\_min\_val,\ const\_pointer\ \_\_max\_val)\ \{}
\DoxyCodeLine{04418\ \textcolor{preprocessor}{\#if\ defined(\_\_AVX2\_\_)}}
\DoxyCodeLine{04419\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ simd\_size\ =\ 8;}
\DoxyCodeLine{04420\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ simd\_end\ \ =\ this-\/>\_\_data\_.size()\ -\/\ (this-\/>\_\_data\_.size()\ \%\ simd\_size);}
\DoxyCodeLine{04421\ }
\DoxyCodeLine{04422\ \ \ \ \ \_\_m256\ min\_vec\ =\ \_mm256\_set1\_ps(\_\_min\_val\ ?\ *\_\_min\_val\ :\ std::numeric\_limits<\_Tp>::lowest());}
\DoxyCodeLine{04423\ \ \ \ \ \_\_m256\ max\_vec\ =\ \_mm256\_set1\_ps(\_\_max\_val\ ?\ *\_\_max\_val\ :\ std::numeric\_limits<\_Tp>::max());}
\DoxyCodeLine{04424\ }
\DoxyCodeLine{04425\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;\ \_\_i\ <\ simd\_end;\ \_\_i\ +=\ simd\_size)}
\DoxyCodeLine{04426\ \ \ \ \ \{}
\DoxyCodeLine{04427\ \ \ \ \ \ \ \ \ \_\_m256\ data\_vec\ =\ \_mm256\_loadu\_ps(\&this-\/>\_\_data\_[\_\_i]);}
\DoxyCodeLine{04428\ \ \ \ \ \ \ \ \ \_\_m256\ clamped\ \ =\ \_mm256\_min\_ps(\_mm256\_max\_ps(data\_vec,\ min\_vec),\ max\_vec);}
\DoxyCodeLine{04429\ \ \ \ \ \ \ \ \ \_mm256\_storeu\_ps(\&this-\/>\_\_data\_[\_\_i],\ clamped);}
\DoxyCodeLine{04430\ \ \ \ \ \}}
\DoxyCodeLine{04431\ }
\DoxyCodeLine{04432\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ \_\_i\ =\ simd\_end;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{04433\ \ \ \ \ \{}
\DoxyCodeLine{04434\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_\_min\_val)}
\DoxyCodeLine{04435\ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i]\ =\ std::max(*\_\_min\_val,\ this-\/>\_\_data\_[\_\_i]);}
\DoxyCodeLine{04436\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_\_max\_val)}
\DoxyCodeLine{04437\ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i]\ =\ std::min(*\_\_max\_val,\ this-\/>\_\_data\_[\_\_i]);}
\DoxyCodeLine{04438\ \ \ \ \ \}}
\DoxyCodeLine{04439\ \textcolor{preprocessor}{\#elif\ defined(\_\_ARM\_NEON)}}
\DoxyCodeLine{04440\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ simd\_size\ =\ 4;}
\DoxyCodeLine{04441\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ simd\_end\ \ =\ this-\/>\_\_data\_.size()\ -\/\ (this-\/>\_\_data\_.size()\ \%\ simd\_size);}
\DoxyCodeLine{04442\ }
\DoxyCodeLine{04443\ \ \ \ \ float32x4\_t\ min\_vec\ =\ vdupq\_n\_f32(\_\_min\_val\ ?\ *\_\_min\_val\ :\ std::numeric\_limits<\_Tp>::lowest());}
\DoxyCodeLine{04444\ \ \ \ \ float32x4\_t\ max\_vec\ =\ vdupq\_n\_f32(\_\_max\_val\ ?\ *\_\_max\_val\ :\ std::numeric\_limits<\_Tp>::max());}
\DoxyCodeLine{04445\ }
\DoxyCodeLine{04446\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;\ \_\_i\ <\ simd\_end;\ \_\_i\ +=\ simd\_size)}
\DoxyCodeLine{04447\ \ \ \ \ \{}
\DoxyCodeLine{04448\ \ \ \ \ \ \ \ \ float32x4\_t\ data\_vec\ =\ vld1q\_f32(\&this-\/>\_\_data\_[\_\_i]);}
\DoxyCodeLine{04449\ \ \ \ \ \ \ \ \ float32x4\_t\ clamped\ \ =\ vminq\_f32(vmaxq\_f32(data\_vec,\ min\_vec),\ max\_vec);}
\DoxyCodeLine{04450\ \ \ \ \ \ \ \ \ vst1q\_f32(\&this-\/>\_\_data\_[\_\_i],\ clamped);}
\DoxyCodeLine{04451\ \ \ \ \ \}}
\DoxyCodeLine{04452\ }
\DoxyCodeLine{04453\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ \_\_i\ =\ simd\_end;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{04454\ \ \ \ \ \{}
\DoxyCodeLine{04455\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_\_min\_val)}
\DoxyCodeLine{04456\ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i]\ =\ std::max(*\_\_min\_val,\ this-\/>\_\_data\_[\_\_i]);}
\DoxyCodeLine{04457\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_\_max\_val)}
\DoxyCodeLine{04458\ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i]\ =\ std::min(*\_\_max\_val,\ this-\/>\_\_data\_[\_\_i]);}
\DoxyCodeLine{04459\ \ \ \ \ \}}
\DoxyCodeLine{04460\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{04461\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_\_i\ =\ 0;}
\DoxyCodeLine{04462\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \_\_i\ <\ this-\/>\_\_data\_.size();\ \_\_i++)}
\DoxyCodeLine{04463\ \ \ \ \ \{}
\DoxyCodeLine{04464\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_\_min\_val)}
\DoxyCodeLine{04465\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{04466\ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i]\ =\ std::max(*\_\_min\_val,\ this-\/>\_\_data\_[\_\_i]);}
\DoxyCodeLine{04467\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{04468\ }
\DoxyCodeLine{04469\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_\_max\_val)}
\DoxyCodeLine{04470\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{04471\ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>\_\_data\_[\_\_i]\ =\ std::min(*\_\_max\_val,\ this-\/>\_\_data\_[\_\_i]);}
\DoxyCodeLine{04472\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{04473\ \ \ \ \ \}}
\DoxyCodeLine{04474\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{04475\ \}}

\end{DoxyCode}
